
  <!DOCTYPE html>
  <html id="" class="">
    <!-- OriginalSrc: https://bbs.sumisora.net/read.php?tid=208251&fpage=9 -->
    <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />

      <title>[原创]以ef - the first tale. / Trial Version中资源文件的加密的解析简单介绍几个工具|【汉化破解研讨室】|【游戏汉化交流区】 - 『澄空学园』 GalGame专题网</title>
      

<link rel="stylesheet" type="text/css" href="assets/1570947647-5f21d2d0f0e14c54e3e080ff47c8ec08.css" referrerpolicy="no-referrer">
<link type="text/css" href="assets/1570947647-2f10d407050ab6b2185fb483267feb32.css" rel="stylesheet" referrerpolicy="no-referrer">
<link href="assets/1570947647-6ea61090578ddc8e91dc9b26707cebc8.css" rel="stylesheet" type="text/css" referrerpolicy="no-referrer">
<link rel="stylesheet" type="text/css" href="assets/1570947647-46d427da9cafb653c4ed606490c99b3a.css" referrerpolicy="no-referrer">


<style class="darkreader darkreader--fallback" media="screen"></style>
<style class="darkreader darkreader--text" media="screen"></style>
<style class="darkreader darkreader--invert" media="screen"></style>
<style class="darkreader darkreader--inline" media="screen">[data-darkreader-inline-bgcolor] {
  background-color: var(--darkreader-inline-bgcolor) !important;
}
[data-darkreader-inline-bgimage] {
  background-image: var(--darkreader-inline-bgimage) !important;
}
[data-darkreader-inline-border] {
  border-color: var(--darkreader-inline-border) !important;
}
[data-darkreader-inline-border-bottom] {
  border-bottom-color: var(--darkreader-inline-border-bottom) !important;
}
[data-darkreader-inline-border-left] {
  border-left-color: var(--darkreader-inline-border-left) !important;
}
[data-darkreader-inline-border-right] {
  border-right-color: var(--darkreader-inline-border-right) !important;
}
[data-darkreader-inline-border-top] {
  border-top-color: var(--darkreader-inline-border-top) !important;
}
[data-darkreader-inline-boxshadow] {
  box-shadow: var(--darkreader-inline-boxshadow) !important;
}
[data-darkreader-inline-color] {
  color: var(--darkreader-inline-color) !important;
}
[data-darkreader-inline-fill] {
  fill: var(--darkreader-inline-fill) !important;
}
[data-darkreader-inline-stroke] {
  stroke: var(--darkreader-inline-stroke) !important;
}
[data-darkreader-inline-outline] {
  outline-color: var(--darkreader-inline-outline) !important;
}</style>
<style class="darkreader darkreader--user-agent" media="screen">html {
    background-color: #191a1b !important;
}
html, body, input, textarea, select, button {
    background-color: #191a1b;
}
html, body, input, textarea, select, button {
    border-color: #5a5956;
    color: #f0ebe2;
}
a {
    color: #4791e7;
}
table {
    border-color: #4f4e4c;
}
::placeholder {
    color: #bfb9ac;
}
::selection {
    background-color: #125cb4;
    color: #fffffd;
}
::-moz-selection {
    background-color: #125cb4;
    color: #fffffd;
}
input:-webkit-autofill,
textarea:-webkit-autofill,
select:-webkit-autofill {
    background-color: #565a0f !important;
    color: #f0ebe2 !important;
}
::-webkit-scrollbar {
    background-color: #1d1f1f;
    color: #cbc5b9;
}
::-webkit-scrollbar-thumb {
    background-color: #2c2d2d;
}
::-webkit-scrollbar-thumb:hover {
    background-color: #343636;
}
::-webkit-scrollbar-thumb:active {
    background-color: #404142;
}
::-webkit-scrollbar-corner {
    background-color: #191a1b;
}
* {
    scrollbar-color: #2c2d2d #1d1f1f;
}</style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style type="text/css"> 
.tr3 td,.tr3 th{border-right:1px solid #D5E5E8;}
.y-style{text-align:center;}
.tr1 th{border-right:1px solid #D5E5E8;}
.tr1 td.td1{border-left:0}
 

.signature img { max-height:250px !important; }
</style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style class="darkreader darkreader--override" media="screen">.jfk-bubble {
    background-color: #000000 !important;
}
.vimvixen-hint {
    background-color: #765500 !important;
    border-color: #d5b22e !important;
    color: #f9edcc !important;
}</style>
<style type="text/css">@keyframes fadeInOpacity{0%{opacity:0}to{opacity:1}}:hover>*>.fbvd--wrapper{animation-name:fadeInOpacity;animation-duration:.3s;opacity:1}.fbvd--wrapper{position:absolute;top:10px;left:10px;opacity:0;text-align:center;margin:0;z-index:5}.fbvd--wrapper a{background: url("") no-repeat 3px 4.55px; background-color: #fff; display:inline-block;font:700 14px Helvetica,Arial,sans-serif;color:#4b4f56;text-decoration:none;vertical-align:middle;padding:0px 8px 0px;margin-right:8px;border-radius:2px; line-height: 22px; padding-left:19px; border: 1px solid #e7e7e7; background-size: 13px}.fbvd--wrapper a:last-child{margin-right:0}.fbvd--wrapper a:hover{text-decoration:none}.fbvd--wrapper a:focus{box-shadow:0 0 1px 2px rgba(88,144,255,.75),0 1px 1px rgba(0,0,0,.15);outline:none}.fbvd--wrapper b{font-size:13px;position:relative;top:1px;color:#3b5998;font-weight:400}</style>
<style class="darkreader darkreader--sync" media="screen"></style>

      <style class="mx-wc-style">
        .mx-wc-main img {max-width: 100%;}
        .mx-wc-main{
          box-sizing: content-box;
          background-color: rgb(25, 26, 27) !important;
          margin: 0 auto;
          margin-top: 20px;
          max-width: 1349px;
        }
        @media (min-width: 768px) {
          .mx-wc-main { padding: 15px 15px 80px 15px }
        }
        @media (max-width: 767px) {
          .mx-wc-main { padding: 15px 3px 80px 3px }
        }
  
      </style>
    </head>
    <body style="background-color: #ffffff !important; min-height: 100%; height: auto; position: static !important; overflow: auto !important; padding-bottom: 0px !important;" id="" class="">
      <div class="mx-wc-main">
        <div id="wrapA" class="mx-wc-selected-elem mx-wc-1570947647" style="display: block; float: none !important; position: relative !important; top: 0px !important; left: 0px !important; margin: 0px !important; flex: unset !important; width: 100% !important; max-width: 100% !important; box-sizing: border-box !important;">

<div id="header">
<div class="toptool tar">	<span>
	<a href="https://bbs.sumisora.net/read.php?tid=208251&amp;fpage=9&amp;skinco=simple" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">手机版</a>

	| <a style="cursor:pointer;" id="td_skin" data-mx-warn="Empty URL">风格切换<img src="assets/1570947647-5c8e409588b73ce4284cf5b9bd619e15.gif"></a>
	| <a href="https://bbs.sumisora.net/read.php?tid=10894912" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">学生手册</a>
	</span>
</div>
<table cellspacing="0" cellpadding="0" align="center" width="100%">
<tbody><tr>
	<td class="banner"><a href="https://bbs.sumisora.net/" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img id="forumlogo" src="assets/1570947647-7ac78a0e1e3ce795251288b0c8bd4b1b.png"></a></td>
	<td class="banner" id="banner" align="right"></td>
</tr>
<tr><td align="center" height="1" colspan="2"></td></tr>
</tbody></table>
<div id="h_guide" class="guide" colspan="2"><span class="s3">»</span>

	<span style="font-weight:bold" class="s3">silasu</span>&nbsp;<a href="https://bbs.sumisora.net/login.php?action=quit&amp;verify=034be2bd" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">退出</a> |
	<a id="td_profile" href="https://bbs.sumisora.net/profile.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">控制面板</a>
	| <a id="td_msg" href="https://bbs.sumisora.net/message.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">

	短消息</a>

	| <a id="td_sort" href="https://bbs.sumisora.net/sort.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">统计排行</a>

	| <a href="https://bbs.sumisora.net/member.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">会员</a>

	| <a href="https://bbs.sumisora.net/search.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">搜索</a>
	| <a style="cursor:pointer;" id="td_hack" data-mx-warn="Empty URL">社区服务<img src="assets/1570947647-5c8e409588b73ce4284cf5b9bd619e15.gif"></a>

	| <a href="https://bbs.sumisora.net/hack.php?H_name=galgamevote" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">GALGAME角色人气投票活动</a>

 | <a href="https://bbs.sumisora.net/yume/polls/" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">近期关注</a><!--[if lte IE 6]>
 | <a href="read.php?tid=10955539" style="color:red">本站已停止支持IE6，请升级或更换浏览器</a>
<![endif]-->
</div>



</div>
<div id="main">




<div class="t3" style="margin-top:8px"><table width="100%" cellspacing="0" cellpadding="0" align="center">
	<tbody><tr><td class="b"><img src="assets/1570947647-ca4a91079181c2a5cb3514b2e5b5f035.gif" align="absmiddle"> <a href="https://bbs.sumisora.net/index.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">『澄空学园』</a> » <a href="https://bbs.sumisora.net/thread.php?fid=77" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">【游戏汉化交流区】</a> » <a href="https://bbs.sumisora.net/thread.php?fid=78&amp;page=9" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">【汉化破解研讨室】</a> » <a href="https://bbs.sumisora.net/read.php?tid=208251" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">[原创]以ef - the first tale. / Trial Version中资源文件的加密的解析简单介绍几个工具</a> <a href="https://bbs.sumisora.net/rss.php?tid=208251" target="_blank" title="Rss订阅本帖最新内容" referrerpolicy="no-referrer" rel="noopener noreferrer"><img align="absmiddle" src="assets/1570947647-b4369735f1bfb33ab69477230a8ba635.png"></a></td></tr>
</tbody></table></div>

<!--ads begin-->

<!--ads end-->
<div class="t3"><table width="100%" align="center" cellspacing="0" cellpadding="0">
	<tbody><tr><td align="left"><div class="fl"><div class="pages"><a href="https://bbs.sumisora.net/read.php?tid=208251&amp;fpage=9&amp;toread=&amp;page=1" style="font-weight:bold" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">«</a><b> 1 </b><a href="https://bbs.sumisora.net/read.php?tid=208251&amp;fpage=9&amp;toread=&amp;page=2" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">2</a><input type="text" size="3" onkeydown="javascript: if(event.keyCode==13){ location='read.php?tid=208251&amp;fpage=9&amp;toread=&amp;page='+this.value+'';return false;}"><a href="https://bbs.sumisora.net/read.php?tid=208251&amp;fpage=9&amp;toread=&amp;page=2" style="font-weight:bold" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">»</a> Pages: ( 1/2 total ) </div></div></td><td align="right" style="padding-bottom:.2em"><a href="https://bbs.sumisora.net/post.php?action=reply&amp;fid=78&amp;tid=208251" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img src="assets/1570947647-132cb83b134d7ecd9b390389d489bc43.png"></a>

<a href="https://bbs.sumisora.net/post.php?fid=78" style="margin-left:.5em" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img src="assets/1570947647-8cab7ee31ae503cf78e5410d40cec291.png" id="td_post"></a>

</td></tr>
</tbody></table></div>



<form name="delatc" method="post">


<div class="t" style="margin-bottom: 0px; border-bottom: 0px; --darkreader-inline-border-bottom: initial;" data-darkreader-inline-border-bottom=""><table cellspacing="0" cellpadding="0" width="100%">
	<tbody><tr><th class="h"><strong class="fl w"><b>本页主题:</b> [原创]以ef - the first tale. / Trial Version中资源文件的加密的解析简单介绍几个工具</strong>
	<span class="fr w"><a data-mx-warn="Empty URL">&nbsp;</a><a href="https://bbs.sumisora.net/job.php?action=previous&amp;fid=78&amp;tid=208251&amp;fpage=9&amp;goto=previous" class="fn" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">上一主题</a> | <a href="https://bbs.sumisora.net/job.php?action=previous&amp;fid=78&amp;tid=208251&amp;fpage=9&amp;goto=next" class="fn" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">下一主题</a> | <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span> </th>
	</tr>
	<tr><td></td></tr>
	<tr class="tr2"><td colspan="2" class="tar">

		<a id="usetool" style="cursor:pointer" onclick="sendmsg('pw_ajax.php?action=usetool','',this.id)" data-mx-warn="Empty URL">[使用道具]</a>

		<br></td>
	</tr>
	<tr><td></td></tr>
</tbody></table></div>

<a name="tpc" data-mx-warn="Empty URL"></a>
<div class="t t2" style="border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top=""><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570947647-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>rednaxela</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=9227" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570947647-ce00c7df760cd0b54791980099058989.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_0"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空三年生上学期</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570947647-5fc5bacf4fd91c54a5fe72c4ceff18fa.gif"><br>

<span class="user-info2" id="showface_0">
<span class="user-infoWrap2">


精华:

		<a href="https://bbs.sumisora.net/search.php?authorid=9227&amp;digest=1" target="_blank" class="s4 f9" referrerpolicy="no-referrer" rel="noopener noreferrer">5</a>
<br>
发帖: <span class="s1 f9">375</span><br>
学分: <span class="s2 f9">35 点</span><br>
澄空币: <span class="s3 f9">895 KID</span><br>

		GPA: <span class="s2 f9">7 点</span><br>

		<span class="gray">注册时间:2005-04-15<br>
		最后登录:2016-04-07 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_tpc" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=208251&amp;pid=tpc&amp;article=0" onclick="return sendurl(this,4,event)" id="quote_tpc" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=208251&amp;pid=tpc&amp;article=0" id="modify_tpc" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=9227" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=208251&amp;pid=tpc" onclick="return sendurl(this,8)" id="report_tpc" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=208251&amp;uid=9227" title="只看楼主的所有帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('tpc')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_tpc" class="fl">&nbsp;[原创]以ef - the first tale. / Trial Version中资源文件的加密的解析简单介绍几个工具</h1>
			

			<div id="p_tpc" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_tpc"><span class="highslide"><img src="assets/1570947647-a8357062f7c893f6d4abf3ed0dc1663b.jpg" border="0" style="max-width: 100%;max-height: 800px;"></span><br><br>啊,umm,星炮组果然神人多,看样子已经完成了对ef - the first tale. / Trial Version (下面简称ef_ftt)的解析并制作出汉化测试了.先拜一下~致敬<br>也拜一下色神.那么快拆出OP果然是强人啊~<br><br>这个星期空闲的时间里正好也看了看这个游戏的加密方面的做法,在这里说说经过和结果,作为过程流水帐吧.主要是想把过程中在什么方面用了什么工具拿来讨论,也请各位分享一下自己在相应方面使用的是什么工具.考虑到程序基础参差不齐,写了不少比较基础无聊的东西,弄得很乱,请多包含. m(_ _)m 已经理解的部分敬请直接无视~ 啊啊,文本里本来对齐了的文字一发出来就都乱掉了......对了,图看不全的请存下来看把.显示器分辨率不够的话是会看不到右边半截的 囧<br>同时也还需要请求各路大虾解决一个问题.脚本文件100_01.sc我还是没有确实解开.这个可是最关键的游戏脚本文件...比较郁闷,下个星期要期末考了所以没时间继续跟下去了,猜是用了zlib压缩过.如果可以的话,解开了的人拜托说明一下解的方式吧.<br><br>估计大家刚下到这个trial版的时候,不少人都想过截出或者拆出那个OP吧? 下面主要以游戏安装目录下的scr.paz和mov.paz为关注点来对paz文件的加密方式进行说明. 选用scr.paz是因为脚本文件总是最小的,易于操作.不过,嗯? 既然是同样格式的资源文件,所有paz的处理方式不应该是一样的吗? 如果您有过跟我相同的疑问,那么留心了.答案是:处理方式不止一种<br><br>呃,顺便一提,"archive"这词我自己一般用"归档"来表达.中文里不知道该用什么词来表达好,"档案"什么的...=_=<br>同时值得注意的是,在80x86平台上,数据是以little-endian的方式来储存的.这点非常重要,害我费了很长时间的跟踪才解决的某问题就是拜这特点所赐.<br>Big-endian: 读入的一串字节中,首字节为最高位.例如Mac的Power系列处理器采用这种字节序.<br>Little-endian: 读入的一串字节中,末字节为最高位.例如x86架构的处理器采用这种字节序.<br>也就是说,在x86 PC上,如果在文件或内存中看到接连的4个字节是0x01 0x02 0x03 0x04的话,以32位int型读入后,应该是0x04030201.<br><br>////////////////<br>//  工具简介  //<br>////////////////<br><br>使用工具:<br><br>十六进制编辑器: WinHex<br>静态分析工具: &nbsp; W32Dasm<br>调试工具: &nbsp;  &nbsp;  OllyDbg<br>加密检测工具: &nbsp; Crypto Checker<br>文件监视工具: &nbsp; FileMon<br><br><br>WinHex<br><h6 class="quote">Quote:</h6><blockquote class="blockquote">WinHex是一款很不错的十六进制文件编辑与磁盘编辑软件。WinHex以文件小、速度快，功能齐全的Hex十六进位编辑器工具得到了ZDNet Software Library五颗星最高评价，可做Hex与ASCII码编辑修改、多文件查找替换功能、一般运算及逻辑运算、磁盘磁区编辑(支持FAT16、FAT32和NTFS)自动搜寻编辑、文件比对和分析等功能。</blockquote><br>这小玩意在十六进制编辑的功能上算是很不错的,关键是它能够读取正在运行的进程的内存.在需要从内存dump数据出来的时候,WinHex太方便了.<br><span class="highslide"><img src="assets/1570947647-4d489c28671a5b78ac10d4df5058de7d.jpg" border="0" style="max-width: 100%;max-height: 800px;"></span><br>用WinHex打开未处理过的ef_ftt中scr.paz的截图.一片混乱吧?<br><br>W32Dasm<br><br>常用的静态分析工具.所谓静态分析即从反汇编出来的程序清单上分析.<br><br><span class="highslide"><img src="assets/1570947647-9b44582ce6baed1d0297305c0a5ec3bf.jpg" border="0" style="max-width: 100%;max-height: 800px;"></span><br>用W32Dasm打开ef_trial.exe的截图.注意到什么有趣的东西了吗?<br><br>OllyDbg<br><br>可以说是Windows平台上最流行的RING3调试器了吧.介绍满天是我都不知道该写点什么了...<br><h6 class="quote">Quote:</h6><blockquote class="blockquote">OllyDbg是一款能够在Windows环境下的动态调试软件，与Softice不同的是，它运行在用户模式下，且结合了动态调试与静态分析的功能。</blockquote><br><br><span class="highslide"><img src="assets/1570947647-e0874523a6350b338840fec074298975.jpg" border="0" style="max-width: 100%;max-height: 800px;"></span><br>用OllyDbg打开并运行ef_trial.exe时的截图.注意到寄存器EAX的值了吗?<br><br><br>Crypto Checker<br>一个简单的命令行工具,用于分析程序用了什么加密算法.<br>例如:<br>D:\minori\ef_ftt\&gt; cc.com ef_trial.exe &gt; log.txt<br>这样就可以将分析结果存入log.txt后面分析.<br><br>支持的加密/压缩算法有:<br><h6 class="quote">Quote:</h6><blockquote class="blockquote"><br>+ BLOWFISH<br>+ CAST-128, CAST-256<br>+ CRC32, ICRC32 (Poly = 0EDB88320h)<br>+ HAVALx<br>+ HEAVENTOOLS (<a href="http://www.heaventools.com%29/" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">www.heaventools.com)</a><br>+ MARS<br>+ MD4, MD5<br>+ PKZIP<br>+ RC5, RC6<br>+ RSDSOFT (<a href="http://www.rsdsoft.com%29/" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">www.rsdsoft.com)</a><br>+ RIJNDAEL (AES)<br>+ RIPEMD-128, RIPEMD-160<br>+ SHA-160, SHA-256<br>+ SNEFRU 2.x<br>+ TIGER<br>+ TWOFISH<br>+ WAKE</blockquote><br><br>虽说是命令行程序,倒也不是不能截图...<br><span class="highslide"><img src="assets/1570947647-83451f19756f39f1273931d957a2f0d0.jpg" border="0" style="max-width: 100%;max-height: 800px;"></span><br>这个不用多说了吧...<br><br>FileMon<br>File Monitor,文件监视工具.可以监视指定范围(路径,文件类型,操作类型等)的所有文件操作.可以方便的知道到底一个程序执行时对哪些文件做了读/写操作.这工具有时候太强大也挺困扰的...一下就一大堆记录了 =_=<br><span class="highslide"><img src="assets/1570947647-3ae643d9f7c006f6a6c25b6ca2b9f4ff.jpg" border="0" style="max-width: 100%;max-height: 800px;"></span><br>嗯,这是正常启动ef_trial.exe时的其中一段记录.那个TSVNCache.exe请无视吧,那是因为装了Tortoise SVN客户端才出现的...<br><br>////////////////<br>//  准备工作  //<br>////////////////<br><br>存有侥幸之心的话,肯定不会一开始就想从调试跟踪做起的(不过这么想最后走的弯路可能更多了).所以,我们在开工前,先做点准备工作,寻找可能指向捷径的蛛丝马迹.<br><br>-----------------<br>--  准备工作1  --<br>-----------------<br>先从过往经验看起.很明显可以看出ef_ftt的系统与はるのあしおと是同一个系列的,所以先从这里入手.对春之足音有怨念的也不少吧?<br><br>或许这里有人玩过insani做的はるのあしおと demo/trial的英化版本.显然他们是做过相关破解的.然则,uh-uh,这demo/trial所采用的加密方式不要说与ef_ftt的不同,就同はるのあしおと的正式版也不一样.不过insani的东西并非完全无用.他们很可爱,在安装的时候会从安装包里解压启动一个名为minori-unpaz.exe的程序,将原本封在mov.paz里的OP给解出来,完成后将该exe删除.不留心注意的话是看不到这个exe文件的存在的.这个文件有什么用呢? 可以拿它来解官网原版的系统测试demo和web trial中的paz归档.除此之外没有什么别的好用途了.<br><br>去拜一下Google大神的话,会看到还有那么几个声称能解はるのあしおと的资源文件的程序.不过多数实际上都只能解demo/trial版的,包括之前在<a href="https://bbs.sumisora.net/read.php?tid=207722" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">工具帖</a>里提到的<a href="http://www.vector.co.jp/soft/win95/art/se247307.html" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">GameLoader</a>.<br><br>为什么demo/trial版与正式版不能用同一工具对应? 呵呵,那当然是因为加密算法不一样了.demo/trial版里的paz所采用的加密算法非常简单,就是对每个字节做取补操作.简单说来,要处理的话用像这样就可以了(伪代码,省略了缓冲相关和具体I/O的烦琐操作):<br><br>openFile(archiveFilename, "r"); // 以读模式打开所需要解的paz归档<br>openFile(newFilename, "w"); &nbsp;   // 以写模式创建一个新文件<br>int indexSize = readInt(); &nbsp;  &nbsp; // 读入头4个字节作为一个int型,不要对它取补<br>writeInt(indexSize); &nbsp;  &nbsp;  &nbsp;  &nbsp; // 将这个int值写到新文件里<br><br>while (!fileEnd) { &nbsp;  &nbsp;  &nbsp;  &nbsp;   // 遍历文件余下部分<br> &nbsp;  byte dataByte = readByte(); // 读入一个字节<br> &nbsp;  dataByte = -dataByte; &nbsp;  &nbsp;  // 对字节取补<br> &nbsp;  writeByte(dataByte); &nbsp;  &nbsp;   // 将处理后的字节也写到新文件里<br>}<br>//...<br>closeFile(); &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;   // 完事,收工<br><br>取补的逆运算还是取补.所以这种方式的加密和解密算法是一样的.<br>^ ^,如果就这么做的话,硬盘会狂响而且处理速度也很慢.真的想试的话,记得用些buffer再试.<br>对Java的程序员,也提一句:谨记Java里运算的最低类型是int.对byte的运算都会提升到int再执行.因而特别是在检查相等性的时候,记得做强制类型转换.<br><br>虽然对应はるのあしおと demo/trial版的工具派不上用场,可是解密后的paz归档还是值得一看.毕竟是同一系列的引擎,就算加密方法不同,解密后的结构基本上是一样的.<br><span class="highslide"><img src="assets/1570947647-99396b17efc516f3dc1a6d8c16338836.jpg" border="0" style="max-width: 100%;max-height: 800px;"></span><br>解密处理过后,用WinHex打开はるのあしおと 官方web_trial里scr.paz<br><br>观察上图.这是scr.paz的开头一部分.不通过调试跟踪要直观的猜测这些十六进制的数据或许不太容易,不过也并非不可能.啊,我应该用装图片或者音频的paz文件的,那些会有明显的header特征,比较好说明...算,硬来了....<br><br>在归档文件(archive file)中,我们总是希望能:(1)将里面已有的文件分离出来;(2)重新将文件打包回到归档文件里.<br>为了达到这两个目的,我们需要寻找提供归档内文件的[文件名],[文件大小],[起始位置],[有否压缩],[其它](例如在原始文件大小与归档内所占大小不同时需要的额外信息,为确定文件类型做的标记)等的信息.这些信息有可能是占4个字节的(如文件长度,起始位置等),可能是1-2个字节的(如有否压缩等标示位),也有可能是较长的固定长度或变长的(如文件名).它们一般会在被称为文件索引(file index)的地方.文件索引有可能在文件的开头,结尾,或者当文件内的数据是一段一段时处于每段的开头或结尾,又或者完全是分散于每个文件之前等,甚至文件索引与归档文件不在同一文件内也是可能的.当找到貌似文件索引的部分时,如果看到成串的ASCII字符则多数情况下就是文件名了(不过后缀可能缺失);如果看到的是意义不明的数据,可以分别按4字节,2字节等方式以little-endian字节序读出,看看是否与文件长度或起始位置相关.如果一个归档里有PNG文件,对辨认文件的实际起始-结束地址和文件长度很有帮助,因为有明确且易辨认的文件头和IEND段.<br>在这个例子里,我们比较幸运,文件索引位于归档文件的开头部分,而且非常清晰.<br><br>分析后可知:<br><span class="highslide"><img src="assets/1570947647-088f298bd4f2c75003ac08a642bc8ade.jpg" border="0" style="max-width: 100%;max-height: 800px;"></span><br>这个例子里,在[0x00,0x27]这个区间里的内容都属于文件头.<br>其中[0x00,0x03]这4个字节指明了后面紧跟着的文件索引的长度,"24 00 00 00"(注意是little-endian)=0x024=36字节.如果在前面处理加密数据时的取补操作对这4个字节也执行了,就会看到"DC 00 00 00",也就是0x0DC=220,那就看不出这4个字节的意义了.<br>其后,[0x04,0x27]区间内是文件索引.索引的开头,[0x04,0x07]这4个字节表明了索引内条目(entry)的个数.后面的内容就是一个一个的条目了,碰巧这里只有一个条目.这个条目内,一开始[0x08,0x0F]是一个表示原始文件的文件名的C-style字符串,也就是以"0x00"表示结尾的字符串;只是碰巧整个字符串占用了8个字节而已,并没有为符串预留的固定长度空间,因而索引内每个条目的长度也不固定.由于这个引擎是用C++写的,可以猜测在minori的实现里,文件名信息不是以本地char数组,而是以别的可容纳编译期未知长度的方式保存.<br>对endian有疑问的同学或许会问:"为什么数字要反过来读字节的信息,而字符串不用呢?" 字节序只在单个数据单元内起作用.前面的数字都是32位整型,占用4个字节,所以是在4个字节的范围内将字节顺序反转;而ASCII编码的字符串里每个数据单元其实是占一个字节的char(UNICODE或者GB2312,Shift-JIS之类的话则是占两个字节的w_char),因而无需反转顺序来读.<br>文件名之后,[0x010,0x013]是该条目对应文件的起始地址,是相对整个归档文件开头(0x00)的偏移量.接下来是4个字节的0x0,没发现什么特殊意义,只是结构性存在的一组0而已吧.这后面,[0x018,0x01B],[0x01C,0x01F],[0x020,0x023]看起来都是文件长度相关,在这里值是一样的,但并非总是一样.第一个是原始文件的实际长度,第二个是压缩后的文件长度,第三个是在归档文件内所占用的长度.关注点是:(1)头两个长度的值不一样时,说明文件被压缩过;(2)后两个长度的值不一样时,说明文件被有对齐(padding alignment)要求的加密算法加密过.这里由于文件没有被压缩,也没有采用要求一定对齐的特殊加密方式,所以三个值都是一样的.很快在ef_ftt的例子里,我们就能看到这三个值不同的时候.最后又有<br><br>普通paz归档里的文件索引信息非常丰富,足够构建对解密后的paz归档的拆包/打包的程序.这个结构同样适用于はるのあしおと的正式版以及ef_FFD和ef_ftt等.<br><br>假设有这样的数据结构:<br>// 用于储存文件索引里一个条目的信息<br>struct FileIndexEntry {<br> &nbsp;  string filename; &nbsp;  &nbsp; // 文件名<br> &nbsp;  int beginOffset; &nbsp;  &nbsp; // 起始位置<br> &nbsp;  int fileLength; &nbsp;  &nbsp;  // 原始文件长度<br> &nbsp;  int compressedLength; // 文件压缩后长度<br> &nbsp;  int paddedLength; &nbsp;   // 归档内实际占用长度<br> &nbsp; int mode; &nbsp;  &nbsp;  // 压缩模式<br>};<br><br>则简单的拆包处理算法如下(同样是伪代码):<br><br>vector&lt;FileIndexEntry*&gt; index; &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;   // 声明一个容纳索引里每个条目的容器,这里使用了vector<br>openFile(archiveFilename,"r"); &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;   // 以读模式打开所需要解的paz归档<br>int fileIndexLength = readInt(); &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp; // 读取文件索引长度<br>int entryCount = readInt(); &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;   // 读取索引内条目个数<br><br>// 获取文件索引信息<br>for (1 to entryCount) { &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp; // 遍历文件索引<br> &nbsp;  FileIndexEntry* entry = new FileIndexEntry; &nbsp; // 新建一个条目<br> &nbsp;  entry-&gt;filename = readString(); &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp; // 读入一个以0x00表示结束的字符串(c-string)作为文件名<br> &nbsp;  entry-&gt;beginOffset = readInt(); &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp; // 读入起始位置<br> &nbsp;  if (readInt() != 0) exit(1); &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp; // 如果接下来读到的不是4个字节的0x00,说明出错了,退出程序避免崩溃<br> &nbsp;  entry-&gt;fileLength = readInt(); &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  // 读入原始文件长度<br> &nbsp;  entry-&gt;compressedLength = readInt(); &nbsp;  &nbsp;  &nbsp;  // 读入文件压缩后长度<br> &nbsp;  entry-&gt;paddedLength = readInt(); &nbsp;  &nbsp;  &nbsp;  &nbsp;   // 读入归档内实际占用长度<br> &nbsp;  entry-&gt;mode = readInt(); &nbsp;  &nbsp;  &nbsp;  // 读入压缩模式,0为无压缩,1为有压缩<br> &nbsp;  if (!(entry-&gt;mode == 0 || entry-&gt;mode == 1)) exit(1); &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp; // 如果接下来读到的不是0x00000000或者0x00000001,说明出错了,退出程序避免崩溃<br> &nbsp;  index.push_back(entry); &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;   // 将刚读完的条目信息放入容器中<br>}<br><br>// 将文件从归档中分离出来<br>for_each (entry in index) { &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;   // 遍历刚读入的索引条目<br> &nbsp;  setFilePointer(entry-&gt;beginOffset); &nbsp;  &nbsp;  &nbsp;   // 将当前文件游标移动到文件的起始位置<br> &nbsp;  byte* data = readBytes(entry-&gt;paddedLength);  // 读入归档内实际占用长度的<br> &nbsp;  if (entry-&gt;mode != 0)<br> &nbsp;  &nbsp;   data = doUncompress(data, 0, entry-&gt;compressedLength); // 当确认是压缩过的文件时,先解压<br> &nbsp;  openFile(entry-&gt;filename, "w"); &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp; // 以写模式创建新文件<br> &nbsp;  writeFile(data, 0, entry-&gt;fileLength); &nbsp;  &nbsp;   // 将数据写到新文件里<br> &nbsp;  closeFile(); &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  // 关闭新文件的指针<br>}<br><br>//...<br>closeFile(); &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;   // 关闭所读的归档文件,收工<br><br>至于重新打包,自然就是上面的反过程: 先收集建立文件索引所需要的相关数据,然后写入索引,再写入文件.<br><br>嗯,はるのあしおと的demo/trial版所能利用的也就这么多了.剩下的看来还是得等到实际处理ef_ftt才能解决了.<br>可以确定解密后归档文件的结构相同而归档的加密方式不同.抱着侥幸心理使用上面提到的加密/解密方式对ef_ftt的paz归档处理的话,得到的还是一堆垃圾数据..可是会是什么加密方式呢?<br><br>-----------------<br>--  准备工作2  --<br>-----------------<br>在实际动手调试跟踪前,还是想再多知道点信息.怎么办呢?<br><br>首先,用Crypto Checker对ef_trial.exe分析一遍.正如前面的截图,结果如下:<br><br>## &nbsp;  &nbsp; Offset &nbsp;   Value &nbsp;  &nbsp; Method<br>----- &nbsp; -------- &nbsp; -------- &nbsp; --------<br> &nbsp;  1 &nbsp; 000CE2F0 &nbsp; 243F6A88 &nbsp; Blowfish P Box<br> &nbsp;  2 &nbsp; 000CE2F4 &nbsp; 85A308D3 &nbsp; Blowfish P Box<br> &nbsp;  3 &nbsp; 000CE2F8 &nbsp; 13198A2E &nbsp; Blowfish P Box<br> &nbsp;  4 &nbsp; 000CE2FC &nbsp; 03707344 &nbsp; Blowfish P Box<br><br> &nbsp;  5 &nbsp; 000D281C &nbsp; 77073096 &nbsp; CRC32 Table<br> &nbsp;  6 &nbsp; 000D2820 &nbsp; EE0E612C &nbsp; CRC32 Table<br> &nbsp;  7 &nbsp; 000D2824 &nbsp; 990951BA &nbsp; CRC32 Table<br> &nbsp;  8 &nbsp; 000D2828 &nbsp; 076DC419 &nbsp; CRC32 Table<br><br> &nbsp;  9 &nbsp; 0008B6CA &nbsp; EDB88320 &nbsp; CRC32 Polynomial<br> &nbsp; 10 &nbsp; 000D2A18 &nbsp; EDB88320 &nbsp; CRC32 Polynomial<br><br> &nbsp; 11 &nbsp; 000CE2F0 &nbsp; 243F6A88 &nbsp; HAVAL (Init)<br> &nbsp; 12 &nbsp; 000CE2F4 &nbsp; 85A308D3 &nbsp; HAVAL (Init)<br> &nbsp; 13 &nbsp; 000CE2F8 &nbsp; 13198A2E &nbsp; HAVAL (Init)<br> &nbsp; 14 &nbsp; 000CE2FC &nbsp; 03707344 &nbsp; HAVAL (Init)<br><br> &nbsp; 15 &nbsp; 0000C5CD &nbsp; 12345678 &nbsp; PKZip Key 0<br> &nbsp; 16 &nbsp; 0000C6A0 &nbsp; 12345678 &nbsp; PKZip Key 0<br><br>我们看到了几个常见加密算法的名字;嗯,最后那组PKZip是zip压缩,勉强也算是加密吧 XD<br>其中,CRC32和PKZip都不一定与paz归档的加密相关.因为PNG图片格式的象素阵列就是用zip来压缩的,而PNG文件的每一段(trunk)末尾都有该段的CRC32校验.所以,关注点集中在了Blowfish上.<br><br>然则,如果仔细阅读了游戏目录里的ef_trial.chm这个帮助文件的话,可以看到这个:<br><span class="highslide"><img src="assets/1570947647-c0f073c440e7f464023817e271dae6dc.jpg" border="0" style="max-width: 100%;max-height: 800px;"></span><br>没错,人家minori自己都已经说了确实用了Blowfish加密算法.看来目标明确,可以开工了~<br><br>Blowfish是一种高效的对称加密算法,具体介绍请看2楼.这帖里要写不下了...<br>总之要简单知道的是,Blowfish算法使用了多个数组,包括:<br>int pbox[18]; &nbsp;   // 包含18个32位整型的数组,构成了"P Box"<br>int sbox[4][256]; // 4个,每个包含256个32位整型的数组的数组,构成了"S Box"<br>而使用Blowfish算法来加密/解密时,需要先设置一个长度在4到56字节间的数据为key,用这个key对P Box和S Box做一定的变换,然后再使用P Box和S Box对待加密/解密内容做处理.常见的Blowfish实现里,设置key要么就是在构造函数里,要么是在叫init/initialize/setKey等名字的方法里;加密的方法一般叫encrypt,解密的叫decrypt,或者以别的方式设置了处理模式后调用process/doFinal之类名字的方法.为什么要关心函数名字? 因为可爱的minori给我们留下了能用名字找到的线索.后面会再提到的.<br><br>上面用Crypto Checker做的检查已经指出了P Box的初始值位于ef_trial.exe内的什么位置,[0x0CE2F0,0x0CE337]之间的72个字节就是这18个整型.可以发现,在该exe运行时,装载进内存后的P Box初始值对应在[0x04CE2F0,0x04CE337]之间.根据Blowfish算法的特征,同样可以定位到S Box的位置.总结如下:<br><br>运行时,<br>P_Box_init[0]: [004CE2F0]<br>P_Box_init[1]: [004CE2F4]<br>P_Box_init[2]: [004CE2F8]<br>P_Box_init[3]: [004CE2FC]<br>P_Box_init[4]: [004CE300]<br>P_Box_init[5]: [004CE304]<br>P_Box_init[6]: [004CE308]<br>P_Box_init[7]: [004CE30C]<br>P_Box_init[8]: [004CE310]<br>P_Box_init[9]: [004CE314]<br>P_Box_init[10]: [004CE318]<br>P_Box_init[11]: [004CE31C]<br>P_Box_init[12]: [004CE320]<br>P_Box_init[13]: [004CE324]<br>P_Box_init[14]: [004CE328]<br>P_Box_init[15]: [004CE32C]<br>P_Box_init[16]: [004CE330]<br>P_Box_init[17]: [004CE334]<br><br>S_Box_init[0]: [004CE338]<br>S_Box_init[1]: [004CE738]<br>S_Box_init[2]: [004CEB38]<br>S_Box_init[3]: [004CEF38]<br><br>记住这些地址将对后面的调试跟踪大有好处,便于确定在ef_trial.exe里Blowfish算法的具体位置.<br><br>-----------------<br>--  准备工作3  --<br>-----------------<br>本来靠前两步收集到的信息也足够满足的去开始跟踪了.不过总觉得还漏了什么没做...对,还没有做静态分析.该让W32Dasm出场了.<br><br><span class="highslide"><img src="assets/1570947647-9b44582ce6baed1d0297305c0a5ec3bf.jpg" border="0" style="max-width: 100%;max-height: 800px;"></span><br>用W32Dasm打开ef_trial.exe.开头是一些菜单,对话框的资源信息,输入表等.后面就是具体的反汇编后的程序了.要是觉得看汇编头大的话,那先来点轻松的.打开菜单里的Refs-&gt;String Data References,可以看到程序里所有使用过的字符串常量.里面值得认为"有趣"的信息简直太多了,直教人想猜测这程序原本的结构.不过这里我们还是有选择的来关注吧...<br><br>其中,观察以"."开头的字符串,可以发现这个游戏引擎所支持/使用的文件后缀有:<br>".avi"<br>".mpeg"<br>".mpg"<br>".paz"<br>".png"<br>".sav"<br>".tbr"<br>".wav"<br>也使用了.dat后缀(system.dat, cgv.dat等)和.ogg后缀(多了...voice.paz里全是)的文件,不过没有在这里出现.<br>后面跟踪时可以发现,ef_trial.exe程序在寻找paz归档时,其文件名是通过[归档名字]+[序号]+[.paz后缀]来生成的.通过FileMon的文件监视,可以知道,例如说对scr这个名字,会寻找"scr.paz","scr1.paz"一直到"scr9.paz"共10个文件.表示后缀的字符串常量就是像这样用的.所以有时候一些游戏的资源归档里找不到文件名后缀也是很有可能的.程序可以直接通过了解文件的类型自动给文件名加上后缀再去读.呃,碰到那种游戏总觉得很头疼.还好ef_ftt没那样.<br><br>而游戏脚本里会用到的指令有:<br>".chain" &nbsp;  &nbsp;  &nbsp; // 链接到另一个脚本文件里<br>".debug"<br>".deleteVar"<br>".effect"<br>".end"<br>".endScroll"<br>".exec"<br>".frame"<br>".goto"<br>".hscroll"<br>".HSVfilter"<br>".if"<br>".label"<br>".message"<br>".movie"<br>".movie2"<br>".overlay"<br>".panel"<br>".playBGM"<br>".playSE"<br>".playSE2"<br>".playVoice"<br>".pragma"<br>".screen"<br>".scroll"<br>".scrollAcc"<br>".scrollFG"<br>".select"<br>".set"<br>".setGlobal"<br>".setTimer"<br>".shakeScreen"<br>".stage"<br>".transition"<br>".vscroll"<br>".wait"<br>".waitTimer"<br>".wscroll"<br>熟悉visual novel的游戏脚本的人看指令的名字也大概知道指令的作用了吧.这里就不多说了.<br><br>往下看,看到类似这样的:<br>"Animater::Dump() is called."<br>虽然可以通过PEID也可以得知关于程序是由什么编译器编译的,有没有加壳等信息...<br><span class="highslide"><img src="assets/1570947647-94529ba24e50914f6643d4cf83828152.jpg" border="0" style="max-width: 100%;max-height: 800px;"></span><br>不过看到这"::"就能确定minori是用C++以面向对象的思想来编写这引擎的.呃,废话了...我只是前段时间看到了AQUAPLUS的那4个游戏的源码忍不住想吐一下槽而已...AQUAPLUS的代码好下等.(吐槽男:想学我吐槽?你还要再转多少次职才行啊...=_=)<br><br>继续往下看,发现了有趣的字符串:<br>"archive file open failed : %d "<br>"archive file open succeed : %d "<br>进一步向下能看到:<br>"BlowfishDecrypt() : invalid input buffer"<br>"BlowfishDecrypt() : invalid key length"<br>"BlowfishEncrypt() : invalid input buffer"<br>"BlowfishEncrypt() : invalid key length"<br>"BlowfishEncrypt() : output buffer "<br>"BlowfishEncryptionKey::SetKey() : failed : in_key == NULL"<br>"BlowfishEncryptionKey::SetKey() : failed : in_keyLength=%d"<br><br>这几个字符串,包括上面"Animater::Dump() is called."这类,很明显是引擎开发时在调试(debug)阶段所写下的调试信息.它们所被引用的地方,多半就是对应信息里的名字的函数(或者,面向对象里叫"方法",随便了)之所在.靠字符串引用(string reference)所得到的信息,可以让函数的"定位"工作事半功倍.可以推测,跟"archive file open"相关的调试信息应该出现在负责打开归档的函数里,而与"Blowfish"相关的调试信息自然就是在Blowfish算法相关的处理函数里.还记得前面提到的Blowfish相关的常见函数名吗? 这里要派上用场了.我们可以知道,minori的实现里,key是被放置在一个类型为BlowfishEncryptionKey的对象里.具体的加密/解密过程分别由BlowfishEncrypt/BlowfishDecrypt负责.<br><br>在W32Dasm的字符串引用对话框里双击某一字符串可以在反汇编后的程序代码内找到相应的引用位置.不过我们不准备用W32Dasm来具体分析反汇编后的代码.这里只要记住上面觉得有趣的字符串(或者有精力的话连地址也一起记下也未尝不可)就可以了.<br><br>-----------------<br>--  准备工作4  --<br>-----------------<br>具体开始调试前,前确认一下对80x86平台的汇编的熟悉程度.虽然也不是说要非常精通,至少还是得清楚各个寄存器的常规用途,各条指令的意义,各种运算,寻址方式等的.这篇帖里没办法涵盖汇编的具体知识.觉得汇编陌生的同学,找本书看看或者查一下手册吧.<br><br>不过有一点值得注意的可以在这里一提."函数"作为程序的一个基本单元,有着极其重要的作用.一般来说,一个函数都只负责做一件事.当它需要做繁多的操作时,就有可能将功能分解到更小的函数里去做.数学上的函数是输入参数到输出值的对应关系,计算机程序里也是一样.如果我们不想关心函数里具体做了什么操作,把它当黑箱对待的话,至少要知道输入了什么参数,输出了什么结果,这样也算是可以通过头尾猜一下这个函数的作用.那么要注意的就是,由编译器生成的汇编代码中,函数的参数表里的参数都是通过堆栈(stack)来传递的,也就是说在一个call之前看到了一个或多个push的话,就要留意一下被push上堆栈的值是多少,可能代表什么了;注意到C/C++的函数调用是按照参数表从右到左的顺序压栈,所以参数表里的第一个参数会是最后一个压栈的那个.函数的返回值都是通过EAX来传递的(虽然这并不意味着函数只能通过返回值来输出,事实上它也可以通过参数来输出,或者别的方式).在允许全局变量的程序设计语言里,全局变量也可能被函数用到,需要小心.在面向对象的程序中,事情稍微有点复杂,有些参数是被this指针带入函数的,不出现在call之前的那组push里.<br><br>Okay,也没什么好继续准备的了.在确认对Blowfish算法足够熟悉后,开始调试吧~<br><br>////////////////<br>//  实际调试  //<br>////////////////<br>使用OllyDbg来对ef_trial.exe进行调试跟踪.<br><br><span class="highslide"><img src="assets/1570947647-f64f8383822c6dabeec155bb1641bdcf.jpg" border="0" style="max-width: 100%;max-height: 800px;"></span><br>初次使用OllyDbg的同学可能会很迷茫...打开程序后出现一堆的子窗口,都不知道该干什么好.别着急,慢慢来.<br><br>先将其中CPU的窗口最大化,我们将主要使用这个窗口来进行调试.<br><span class="highslide"><img src="assets/1570947647-6ef5cf0474351d0003835a9f758a3e5c.jpg" border="0" style="max-width: 100%;max-height: 800px;"></span><br>注意到其中各部分的意义.在代码,寄存器,数据和堆栈这4个窗口里,按下Ctrl+G可以将当前显示位置跳转到指定的地址上.在代码窗口里按下Ctrl+F可以查找指令,按下分号可以在当前行输入注释.可以看到在一些系统函数的调用和一些字符串的引用位置上,注释栏里都已经有一些信息了.几个窗口的功能都可以通过鼠标右键菜单选择,不熟悉的同学都看看试试吧.<br>顶上工具条里的按钮的作用可以通过将鼠标移动到按钮上观察状态栏的显示来确定.常用的像重新运行程序[Ctrl+F2],设置断点[F2],步入[F7],步过[F8],运行程序[F9]等功能,还是用键盘快捷键比较方便吧.<br><br>然后,注意到有个指令输入栏,此处可以输入各种调试指令.这次的调试我们要在输入栏里设置一些断点.<br><br>想起之前用W32Dasm得到的那些有趣的字符串.用鼠标在代码窗口右击,选择"搜索"-&gt;"所有参考文本串",则可以看到新开了一个窗口,里面有很长一串列表.上下寻找,可以找到我们关心的Blowfish和archive部分.<br><span class="highslide"><img src="assets/1570947647-9ce49cb4e93b93505038e81c1e7bf8ab.jpg" border="0" style="max-width: 100%;max-height: 800px;"></span><br>双击其中一行就能转到对应的地址上.<br><br>例如,在图上高亮的那行双击后,会回到CPU窗口.地址已经转到0x00425FF5.<br>00425FF5 &nbsp; |.  68 7C6B4E00 push ef_trial.004E6B7C &nbsp;  &nbsp; ;  ASCII "BlowfishEncryptionKey::SetKey() : failed : in_key == NULL"<br>从这个地址开始向上找,找到这个函数的入口,也就是函数的首行.<br>00425FD0 &nbsp; /$  64:A1 00000&gt;mov eax,dword ptr fs:[0] &nbsp;  ;  BlowfishEncryptionKey::SetKey() : start<br>我在这行后加上了"BlowfishEncryptionKey::SetKey() : start"的注释,方便跟踪时提醒自己当前位置.<br>并且,在代码窗口里选择了0x00425FD0这行后,信息窗口里可以看到<br>Local Calls from 0040BC99, 0040BCB0, 004269B7, 004275A8<br>按下Ctrl+G分别跳转到这几个地址上.它们都是对BlowfishEncryptionKey::SetKey()函数的调用.向上寻找push,可以发现每次调用SetKey之前都有两次push,也就意味着这个函数是接受2个参数的.选择较靠上的那个push的行,按F2设置断点.程序在运行到设置了断点的地方就会停下来.这样就可以在SetKey被调用前先观察其参数了.对BlowfishEncrypt()和BlowfishDecrypt()也如法炮制.<br><br>这时也可以观察一下BlowfishDecrypt函数里的代码.很快在0x00426CB8发现了0x004CE338这个眼熟的地址.这不就是4个S Box中第一个的初始值的地址么?<br>00426CB8 &nbsp; |.  BE 38E34C00 mov esi,ef_trial.004CE338 &nbsp; ;  |S_Box_init[0]: [004CE338]<br>在这行做上注释.同样也对另外几个S Box初始值出现的行做上注释.所谓有备无患就是了.<br><br>在0x00426D3B这行上也发现了P Box初始值相关的操作.<br>00426D3B &nbsp; |.  8B83 F0E24C&gt;|mov eax,dword ptr ds:[ebx+4CE2F0] &nbsp;  ;  copy P_Box_init[EBX]<br>同样做上注释.<br><br><br>现在我们找到了Blowfish算法处理的代码,可是我们还不知道要被处理的内容是什么.Windows API中,提供文件的CRUD(创建Create,读取Read,更新Update,删除Delete,4个常见的数据操作类型)操作的函数,有CreateFile,ReadFile,WriteFile,DeleteFile等,通过前面在W32dasm查看输入表可以知道,ef_trial.exe里调用过CreateFileA(),ReadFile(),WriteFile(),DeleteFileA()等的几个具体版本(有些函数有后缀为A或者W的版本,分别对应ASCII环境和UNICODE环境,要注意).对这4个函数的调用全部设置断点.在指令输入栏里输入"bpx CreateFileA"就完成了对所有CreateFileA调用的断点设置.其他几个也同样用bpx指令解决吧.跟这些操作相关的还有一个CloseHandle(),也对它的调用设置一下断点.<br><br>一次典型的读取文件操作会包含下列操作:<br> &nbsp; 以文件名为一个参数调用CreateFile(),得到文件句柄<br>-&gt; 以刚获得的文件句柄为参数调用ReadFile()<br>-&gt; 程序对缓存内的数据进行处理<br>-&gt; 调用CloseFile将文件句柄关闭.<br><br>HANDLE CreateFile( &nbsp;  &nbsp; // 返回值是关注点,关系到后面读写操作中的参数 - 文件句柄<br> &nbsp;  PCTSTR pszFileName, // 这个参数是关注点 - 文件名<br> &nbsp;  DWORD  dwDesiredAccess,<br> &nbsp;  DWORD  dwShareMode,<br> &nbsp;  PSECURITY_ATTRIBUTES psa,<br> &nbsp;  DWORD  dwCreationDistribution,<br> &nbsp;  DWORD  dwFlagsAndAttributes,<br> &nbsp;  HANDLE hTemplateFile);<br><br>BOOL ReadFile( &nbsp;  &nbsp;  &nbsp;  // 返回值不关注也可以,正常返回是1,异常的话是0????????????????<br> &nbsp;  HANDLE hFile, &nbsp;  &nbsp;  // 这个要关注 - 文件句柄<br> &nbsp;  LPVOID lpBuffer, &nbsp;  // 同样要关注 - 读入内容的缓存地址<br> &nbsp;  DWORD  BytesToRead, // 还是要关注 - 读入内容的长度<br> &nbsp;  LPDWORD lpNumberOfBytesRead,<br> &nbsp;  LPOVERLAPPED lpOverlapped);<br><br>BOOL CloseHandle(HANDLE hobj);<br><br>开始实战.按下F9开始运行程序.很快来到第一个断点,是一个CreateFileA()的调用.通过对参数的观察(观察堆栈窗口里的数据)<br><span class="highslide"><img src="assets/1570947647-f1f659164af9768bfe37a64bb7cebdbe.jpg" border="0" style="max-width: 100%;max-height: 800px;"></span><br>可以知道这是对游戏目录\save\sysparams.txt文件的一次读取的准备.如果是初次运行ef_trial.exe,则这个文件还不存在,CreateFileA()会返回-1表示出错了.如果不是初次运行,则按F8"步过"这个调用,会看到函数返回了EAX=0x000000A4,这就是现在sysparams.txt文件所对应的句柄(handle)值了.继续执行下去(按F9),程序会中断在一个ReadFile()调用上.观察参数可以知道这正是对sysparams.txt的读操作.将参数中Buffer地址的值记下来,并在数据窗口内按Ctrl+G,输入该地址(这个时候应该输入0x00BC6128)并确定后,看到这里还是未初始化的一些数据.按F8"步过"这个ReadFile()调用,看到EAX=0x01表示读取成功,同时数据窗口里能看到有意义的数据了.这正是从sysparams.txt读入的内容.用文本编辑齐打开sysparams.txt,可以看到这是个纯文本文件,用于游戏的参数配置.继续执行下去(按F9),会来到一个CloseHandle()的调用,说明程序已经暂时不再需要处理sysparams.txt了,因而将其对应的文件句柄关闭.<br><br>做到这里,可以说是初战告捷,相信同学们对OllyDbg的操作已经有一定熟悉度了吧.接下来操作就不这么详细的说了.<br><br>接下来是对游戏目录\save\system.dat文件的CreateFileA()和ReadFile().如果是初次运行游戏则该文件尚未存在.为方便说明,请不要在初次运行ef_trial.exe做调试.<br>这次读取之后的数据看起来一团糊,<br><br>00BCFE28  E8 AB A8 54 68 9A E5 39  璜═h氬9<br>00BCFE30  CC C1 DB 15 D2 4F E7 49  塘?襉鏘<br>00BCFE38  AF 82 D3 B6 0E D7 CA 9C  瘋佣资<br>00BCFE40  03 5C 27 D1 0E 58 79 DB  \'?Xy<br>00BCFE48  21 87 1A 3B 56 D0 1F 95  !?;V?<br>00BCFE50  90 39 2F 93 7C 55 97 15  ?/搢U?<br><br>看不出意义.暂时不管了.按下F9继续执行.<br><br>这时程序应该停在0x004275A8上设置的断点.这是一个对BlowfishEncryptionKey::SetKey()的调用.开始兴奋了吧?<br>观察参数,<br><span class="highslide"><img src="assets/1570947647-ef34c996d785e0a58b35f6c6c4aaf08a.jpg" border="0" style="max-width: 100%;max-height: 800px;"></span><br>可以看到SetKey()的第一个参数是一个指针,指向一个字符串"minori";第二个参数是一个数字,乍一看不起眼,不过似乎跟"minori"这个字符串的长度一样.后续的跟踪将证明,这两个参数一个是指向key的指针,另一个正是key的长度.如何证明呢?<br>按F7"步入"到SetKey()里.可以看到我们之前在0x00425FD0这行所做的注释了.正是BlowfishEncryptionKey::SetKey()的入口.继续按F7,单步执行来到0x00425FDE.<br><br>00425FDE &nbsp; |.  mov eax,dword ptr ss:[esp+10] &nbsp;  ;  跟踪时可以发现这句把刚才的第一个参数赋值给了EAX<br>00425FE2 &nbsp; |. &gt;mov dword ptr fs:[0],esp<br>00425FE9 &nbsp; |.  push ebx<br>00425FEA &nbsp; |.  push ebp<br>00425FEB &nbsp; |.  push esi<br>00425FEC &nbsp; |.  xor esi,esi &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  ;  ESI清零<br>00425FEE &nbsp; |.  push edi &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  ;<br>00425FEF &nbsp; |.  cmp eax,esi &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  ;  比较EAX与ESI.实际上ESI在这里总是零,所以关注的是EAX-0的结果<br>00425FF1 &nbsp; |.  mov edi,ecx &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  ;<br>00425FF3 &nbsp; |.  jnz short ef_trial.00426007 &nbsp;  &nbsp; ;  如果EAX不等于0,这句跳转就会执行,跳过下面的这句错误信息<br>00425FF5 &nbsp; |.  push ef_trial.004E6B7C &nbsp;  &nbsp;  &nbsp;   ;  ASCII "BlowfishEncryptionKey::SetKey() : failed : in_key == NULL"<br><br>如果执行到0x00425FF5这句,意味着前面一次能影响状态位的操作(例如说这里我们关心的cmp和test等指令)没有引发跳转.这句错误信息告诉我们的是in_key为空指针,而前面验证的正好是EAX是否为零,说明EAX里的值就是对key的指针.至于为什么SetKey()的第二个参数是key的长度,这个等跟到BlowfishDecrypt()的时候再说.<br><br>于是,再次按下F9来到对BlowfishDecrypt()的一个调用处停下.观察参数,什么也看不出来(事实上我到现在也还是不理解那两个参数是什么,每次调用都是指向一样的值=_=).按F7步入.继续单步执行来到0x00426C71<br><br>00426C71 &nbsp; |.  E8 3AF4FFFF call ef_trial.004260B0 &nbsp;  &nbsp;  &nbsp;  &nbsp; ;  获取key长度<br><br>这行执行了一个调用.按下F8将会看到,EAX被赋值为0x06,不正好是前面SetKey()的第二个参数嘛.再看下面几行,<br><br>00426C76 &nbsp; |.  83F8 38 &nbsp;   cmp eax,38 &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp; ;  将EAX与56比较<br>00426C79 &nbsp; |.  7E 16 &nbsp;  &nbsp;  jle short ef_trial.00426C91 &nbsp;  &nbsp;  ;  若EAX不大于56则执行跳转,跳过下面的这句错误信息<br>00426C7B &nbsp; |.  68 746C4E00 push ef_trial.004E6C74 &nbsp;  &nbsp;  &nbsp;  &nbsp; ;  ASCII "BlowfishDecrypt() : invalid key length."<br><br>由Blowfish算法对key的长度要求,key的长度必须是4到56字节之间.这里的检验正好说明了,EAX里的值就是key的长度.后续跟踪将能发现这个值始终与SetKey()的第二个参数一致,证明SetKey()的第二个参数是key的长度.<br><br>BlowfishDecrypt()剩下的是很长看起来很郁闷的汇编代码.不想继续看了.按Ctrl+F9执行到BlowfishDecrypt()的返回语句(但是暂时不返回).发现数据窗口里的值变了,<br><br>00BCFE28  20 00 00 00 78 9C 73 8D &nbsp; ...x渟?<br>00BCFE30  74 8D 0F 76 0D 8C 77 71  t?v.寃q<br>00BCFE38  75 73 0C F5 09 E1 34 E2  us.???<br>00BCFE40  2A 29 CA 4C CC 89 4F CE  *)蔐虊O?<br>00BCFE48  CF 2D E0 34 E4 62 00 00  ??鋌..<br>00BCFE50  9F 19 09 43 00 00 00 00  ?.C....<br><br>虽然还是串看不出什么所以然的值,不过注意到最后的4个字节都是0x00,这看起来很像是为满足Blowfish而做的padding.对system.dat的解密大概是成功了吧.<br>心急的人或许会在这个时候就惊喜若狂,准备以"minori"这个key尝试用现成的Blowfish实现来对system.dat解密.不过结果会是让人失望的,"解"出来的值与游戏实际运行时解得的不一样.为什么呢? 肯定是什么地方做错了不是么...<br><br>不得不面对BlowfishDecrypt()里那堆又长又臭的汇编了.我们会惊讶的发现,BlowfishDecrypt()里包含了对P Box和S Box初始化的代码.这完全违背了Blowfish算法的初衷——这个算法之所以快,就是因为使用了大量的子密钥(subkey),而这些subkey的计算只在设定key的时候才需要计算,到encrypt和decrypt的时候不需要重复计算subkey.结果minori这里却好,每次调用BlowfishEncrypt()和BlowfishDecrypt()都给你重新初始化一次,结果那就是一个慢...只不过现在主流的机器性能都太好了,感觉不到这慢而已.(吐槽男: 你怎么又开始学我了...)<br><br>把其中关键的一段拿出来,是对当前P Box的初始填充:<br><br>00426D00 &nbsp; xor esi,esi &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp; ;  key offset count<br>00426D02 &nbsp; xor ebx,ebx &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp; ;  iteration count: iterate thorugh pbox<br>00426D04 &nbsp; /xor edi,edi &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;   ;  converted key<br>00426D06 &nbsp; |mov dword ptr ss:[esp+10],4 &nbsp;  &nbsp;  &nbsp;  ;  inner iteration count: 4 bytes of the key<br>00426D0E &nbsp; |/mov ecx,dword ptr ss:[esp+1070] &nbsp;   ;  on stack: mode?, key length?<br>00426D15 &nbsp; ||push esi &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  ;  arg1: count<br>00426D16 &nbsp; ||call ef_trial.004260C0 &nbsp;  &nbsp;  &nbsp;  &nbsp;   ;  negate a byte of key =&gt; EAX<br>00426D1B &nbsp; ||and eax,0FF &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  ;  leaving key byte<br>00426D20 &nbsp; ||shl edi,8 &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp; ;  left shift to make space for new key byte<br>00426D23 &nbsp; ||or edi,eax &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;   ;  add new key byte to EDI<br>00426D25 &nbsp; ||mov eax,dword ptr ss:[esp+18] &nbsp;  &nbsp;  ;  EAX = key length<br>00426D29 &nbsp; ||inc esi &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;   ;  incr ESI<br>00426D2A &nbsp; ||cmp esi,eax &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  ;  compare key offest with key length<br>00426D2C &nbsp; ||jl short ef_trial.00426D30<br>00426D2E &nbsp; ||xor esi,esi &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  ;  reset offset if it goes beyond key length<br>00426D30 &nbsp; ||mov eax,dword ptr ss:[esp+10] &nbsp;  &nbsp;  ;  inner iteration count<br>00426D34 &nbsp; ||dec eax<br>00426D35 &nbsp; ||mov dword ptr ss:[esp+10],eax &nbsp;  &nbsp;  ;  decr inner iteration count<br>00426D39 &nbsp; |\jnz short ef_trial.00426D0E &nbsp;  &nbsp;  &nbsp; ;  iterate through the key<br>00426D3B &nbsp; |mov eax,dword ptr ds:[ebx+4CE2F0] &nbsp;  ;  copy pbox_init[EBX]<br>00426D41 &nbsp; |add ebx,4 &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  ;  incr EBX by 4 for next copy<br>00426D44 &nbsp; |xor eax,edi &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;   ;  blowfish xor: ?<br>00426D46 &nbsp; |cmp ebx,48 &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp; ;  compare EBX with 0x48(72.)<br>00426D49 &nbsp; |mov dword ptr ss:[esp+ebx+1C],eax &nbsp;  ;  xor to pbox[EBX]<br>00426D4D &nbsp; \jl short ef_trial.00426D04 &nbsp;  &nbsp;  &nbsp;   ;  iterate through pbox for init(72.==18.*4.)<br><br>这就是我实际做的记录.不要抱怨是英文...我只是在这里想保持记录的原汁原味而已.其中最关键的就是这个:<br>00426D16 &nbsp; ||call ef_trial.004260C0 &nbsp;  &nbsp;  &nbsp;  &nbsp;   ;  该调用会将key中的一个字节取补,然后返回<br><br>这就是minori的ef_ftt中的Blowfish与标准的Blowfish不同之处.它会对key的每个字节取补后再使用.<br><br>心急的人再次去用现成的Blowfish实现尝试用取补后的"minori"为key对system.dat解密.<br>...<br>......<br>.........<br>可是怎么还是不对?<br><br>如果你用取补后的"minori"为key对system.dat解密成功,说明你用的Blowfish实现很庆幸没受little-endian的影响.如果失败了的话,解决起来也很简单:只要在几处把数值的字节序反转一下就可以了.<br><br>我的个人经验是用Java来写这些小程序的,并且采用BlowfishJ的Blowfish实现.在艰苦的调试过程中才发现因为字节序反了,在加法运算时会有错误的进位(异或运算当然还是没问题的),导致了最终运算结果与minori这里用的Blowfish不一样.其实JDK里本身也有Blowfish的实现,在javax.crypto包里.不过这个包里的程序都暂时还不是开放源代码的,所以也没办法看错误到底出在哪里了.<br><br>好吧,总算能正确解出用Blowfish加密的内容了.接下来只要把对应文件的key找到就可以了.不过,等等.在读入paz文件的过程中,连续看到了两次SetKey()的调用,而且中间并没有其他的操作.这是怎么一回事?<br>我差点以为minori用的是CBC模式的Blowfish了,不然在ECB模式下不应该出现两次的SetKey才对.后续的跟踪让我恍悟:原来paz文件里对文件索引部分和实际文件内容部分所用的key是不一样的.处理文件索引需要用两次SetKey()的前一个的key,处理实际文件内容部分则用后一次的key.<br>跟踪分析得知,paz文件是按下列顺序处理的:<br>"scr","bg","bg","st","sys","bgm","voice","se","se","mov"<div id="alert_tpc" style="color: gray; margin-top: 30px; --darkreader-inline-color:#bfb9ac;" data-darkreader-inline-color="">[ 此贴被rednaxela在2006-12-23 16:37重新编辑 ]</div></div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_tpc" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2006-11-25 09:46 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 楼主(rednaxela) 的帖子');" data-mx-warn="Empty URL">[楼 主]</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="865141" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570947647-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>rednaxela</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=9227" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570947647-ce00c7df760cd0b54791980099058989.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_1"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空三年生上学期</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570947647-5fc5bacf4fd91c54a5fe72c4ceff18fa.gif"><br>

<span class="user-info2" id="showface_1">
<span class="user-infoWrap2">


精华:

		<a href="https://bbs.sumisora.net/search.php?authorid=9227&amp;digest=1" target="_blank" class="s4 f9" referrerpolicy="no-referrer" rel="noopener noreferrer">5</a>
<br>
发帖: <span class="s1 f9">375</span><br>
学分: <span class="s2 f9">35 点</span><br>
澄空币: <span class="s3 f9">895 KID</span><br>

		GPA: <span class="s2 f9">7 点</span><br>

		<span class="gray">注册时间:2005-04-15<br>
		最后登录:2016-04-07 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_865141" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=208251&amp;pid=865141&amp;article=1" onclick="return sendurl(this,4,event)" id="quote_865141" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=208251&amp;pid=865141&amp;article=1" id="modify_865141" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=9227" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=208251&amp;pid=865141" onclick="return sendurl(this,8)" id="report_865141" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=208251&amp;uid=9227" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('865141')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_865141" class="fl">&nbsp;</h1>
			

			<div id="p_865141" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_865141">那么,找出这两组key的所在.<br><br>其实它们都在ef_trial.exe里乖乖的躺着.这里我直接把运行时它们的所在发出来:(被重复处理的paz文件就只发第一次处理的key了)<br><br>那么,找出这两组key的所在.<br><br>其实它们都在ef_trial.exe里乖乖的躺着.这里我直接把运行时它们的所在发出来:(被重复处理的paz文件就只发第一次处理的key了)<br><br>"scr"<br>BlowfishEncryptionKey::SetKey() (key=[0x004E4380], length=0x20)<br>(ef_trial.exe 000E4380 - 000E439F)<br>004E4380  37 E8 78 4D EA B4 88 3C  7鑨M甏?<br>004E4388  4F 52 35 DC C6 02 97 5E  OR5芷梌<br>004E4390  4F 15 BF 7D F8 A4 99 D0  O縸?櫺<br>004E4398  E8 71 4C AC C4 AC D9 47  鑡L??G<br><br>BlowfishEncryptionKey::SetKey() (key=[0x004E44C0], length=0x20)<br>(ef_trial.exe 000E44C0 - 000E44DF)<br>004E44C0  46 79 A3 CE 7F 4E D6 9D  FyＮN譂<br>004E44C8  62 0E 42 95 1D 19 1D 05  bB?<br>004E44D0  CB EC 7B 25 89 F3 CB 82  遂{%夡藗<br>004E44D8  1E 8D D9 FD 04 F4 10 18  嵸??<br><br>"bg"<br>BlowfishEncryptionKey::SetKey() (key=[0x004E43A0], length=0x20)<br><br>004E43A0  35 71 B4 F4 41 AA 16 22  5q呆A?"<br>004E43A8  4E 1F CF E8 71 71 55 E3  N翔qqU<br>004E43B0  E6 C0 CA 17 5B C4 C1 A6  胬?[牧<br>004E43B8  DE 07 80 0A 21 16 7C 9D  <br><br>BlowfishEncryptionKey::SetKey() (key=[0x004E44E0], length=0x20)<br><br>004E44E0  85 D5 AA 49 C1 57 AE 1A <br>004E44E8  44 48 5A DB FF 37 D3 98  <br>004E44F0  5B 41 CB 24 23 41 EB E3  <br>004E44F8  17 30 AD 2E CB 70 7F FA  <br><br>"st"<br>BlowfishEncryptionKey::SetKey() (key=[004E43E0], length=0x20)<br><br>004E43E0  DE 53 D1 35 18 3D 7A 81  <br>004E43E8  F0 DF FD F6 E2 2C 5A 0E <br>004E43F0  14 04 F6 89 85 AC 3C 7F  <br>004E43F8  DA 69 BF FF 81 10 99 FC  <br><br>BlowfishEncryptionKey::SetKey() (key=[004E4520], length=0x20)<br><br>004E4520  AF C8 D7 8F EB C4 09 09  ?讖肽..<br>004E4528  D9 43 9A 65 DF F8 CB DD  貱歟啉溯<br>004E4530  61 8E 21 4D 8C 3E AB 61  a?M?玜<br>004E4538  C6 8B C2 59 6F F3 07 0F  茓耏o?<br><br>"sys"<br>BlowfishEncryptionKey::SetKey() (key=[004E4400], length=0x20)<br><br>004E4400  F9 3D C1 3A EC F3 1E 1B  ??祗<br>004E4408  EB 72 1F E2 86 EB 7F 55  雛鈫?U<br>004E4410  7D F1 15 5D D3 43 54 7C  }?]覥T|<br>004E4418  70 D4 4D C8 33 B2 ED 37  p訫?岔7<br><br>BlowfishEncryptionKey::SetKey() (key=[004E4540], length=0x20)<br><br>004E4540  CB 43 5A 0C BA 5B 90 6E  薈Z.篬恘<br>004E4548  17 1F A4 50 6B 53 20 87  ?kS <br>004E4550  C4 22 8E 6A 62 11 94 5F  ?巎b擾<br>004E4558  00 20 99 FA 7E D5 A1 6B  . 欪~铡k<br><br>"bgm"<br>BlowfishEncryptionKey::SetKey() (key=[004E4420], length=0x20)<br><br>004E4420  0B 9F 34 F0 FB 16 2C 75  ?瘥,u<br>004E4428  B3 76 57 48 89 26 5E EA  硋WH?^<br>004E4430  88 55 B9 E0 62 32 12 83  圲灌b2<br>004E4438  F8 49 29 61 44 D4 EE E2  鳬)aD灶<br><br>BlowfishEncryptionKey::SetKey() (key=[004E4560], length=0x20)<br><br>004E4560  9F F4 26 ED AE A4 AE 0D  燈&amp;懋ぎ.<br>004E4568  B3 BB D8 76 0F 00 AC 0A  郴豽.?<br>004E4570  29 0C E5 08 02 A2 F0 00  ).??.<br>004E4578  5C 2C 73 4D 43 2B 05 E1  \,sMC+<br><br>"voice"<br>BlowfishEncryptionKey::SetKey() (key=[004E4440], length=0x20)<br><br>004E4440  59 A9 9D 02 42 AB 8D D1  Y?B珝<br>004E4448  7F 4C 88 82 DB 14 51 C0  L垈?Q<br>004E4450  5A C1 33 1C 10 DF 40 36  Z?這6<br>004E4458  86 88 16 83 81 0B D8 50  唸儊豍<br><br>BlowfishEncryptionKey::SetKey() (key=[004E4580], length=0x20)<br><br>004E4580  AF 4B EC 1C 02 E6 8B 6A  疜?鎷j<br>004E4588  24 B8 58 74 F9 77 08 99  $竂t鵺<br>004E4590  F6 1C B6 73 8A 98 C8 28  ?秙姌?<br>004E4598  2F B0 52 4C CE CF AF 05  /癛L蜗?<br><br>"se"<br>BlowfishEncryptionKey::SetKey() (key=[004E4460], length=0x20)<br><br>004E4460  E8 4B 2C DB 7F 7A EA 34  鐺,?z?<br>004E4468  45 13 51 AC 27 AB 71 8C  EQ?玵<br>004E4470  D8 83 94 DD 7B 73 67 FA  貎斴{sg<br>004E4478  F0 0F 94 AC 78 B1 A4 96  ?敩x堡<br><br>BlowfishEncryptionKey::SetKey() (key=[004E45A0], length=0x20)<br><br>004E45A0  41 77 1D 44 B4 29 11 C7  AwD?<br>004E45A8  9E 74 06 A4 18 EE 8D 27  瀟?顛'<br>004E45B0  4F E1 53 B4 D6 5A E6 7B  O酳粗Z鎨<br>004E45B8  8E 6C F7 B5 EB 58 D6 2B  巐鞯隭?<br><br>"mov"<br>BlowfishEncryptionKey::SetKey() (key=[004E44A0], length=0x20)<br><br>004E44A0  7E 32 D4 A7 2F 0C AE 61  ~2鸳/.產<br>004E44A8  B8 AA 15 A2 DC A5 97 C0  釜④?<br>004E44B0  A9 AC AF AF 00 D4 D1 F1  ┈?.匝<br>004E44B8  CB 1E E6 16 77 DD 0B 86  ??w?<br><br>BlowfishEncryptionKey::SetKey() (key=[004E45E0], length=0x20)<br><br>004E45E0  5B 69 EB D2 82 35 E9 28  [i胍??<br>004E45E8  17 0F 84 23 17 5E 56 69  ?^Vi<br>004E45F0  1B AB CE 9A 86 11 D4 5D  ?殕註<br>004E45F8  4E DE E5 01 28 1D 75 66  N掊(uf<br><br><span class="highslide"><img src="assets/1570947647-8b71be51084d6d5d6c73f7b4cacb32e0.jpg" border="0" style="max-width: 100%;max-height: 800px;"></span><br>于是,对文件索引和文件内容分别用Blowfish解密后的scr.paz如图.可以看到,后面还是有一大堆看似乱码的东西的.<br>留心关注一下文件索引部分.头三个文件,test.sc,opening.sc和movie.sc在索引里的条目,都有第一个文件长度(原始文件实际长度)与第二个文件长度(压缩后长度)相等,而与第三个文件长度(padding后在归档内实际占用的长度)不相等.这是没压缩过的文件使用Blowfish加密的典型表现.但是,索引里的第四个条目,100_10.sc却是三个文件长度都不一样,意味着有压缩.我还没来得及去试到底是采用了什么压缩算法.不过大概猜就是直接用了zlib来压的.解出来了的大虾拜托说明一下这个部分吧.<br><br><span class="highslide"><img src="assets/1570947647-54a090c4be7d3063bf8a1cc96e790dfb.jpg" border="0" style="max-width: 100%;max-height: 800px;"></span><br>前面也说了,对mov.paz是有特别处理的.从用Blowfish解出的文件索引部分就可以看出,这个索引与其他的paz文件解出的很不一样.幸好,还是有可辨认的部分.可以看到有op_logo.mpg和ef_demo.mpg两个文件的索引条目,条目内容都完整.可是用对应mov.paz的第二组Blowfish key解出来的东西却很怪.实际跟踪可以发现,其解密代码在这里:<br><br>00440178 &nbsp;  &gt; /8B53 08 &nbsp;   mov edx,dword ptr ds:[ebx+8] &nbsp;  &nbsp; ;  start of decoding movie; ebx+8 is base of dictionary<br>0044017B &nbsp;  . |33C0 &nbsp;  &nbsp;   xor eax,eax<br>0044017D &nbsp;  . |8A0431 &nbsp;  &nbsp; mov al,byte ptr ds:[ecx+esi]<br>00440180 &nbsp;  . |41 &nbsp;  &nbsp;  &nbsp;  inc ecx<br>00440181 &nbsp;  . |3BCF &nbsp;  &nbsp;   cmp ecx,edi<br>00440183 &nbsp;  . |8A0410 &nbsp;  &nbsp; mov al,byte ptr ds:[eax+edx]<br>00440186 &nbsp;  . |884431 FF &nbsp; mov byte ptr ds:[ecx+esi-1],al<br>0044018A &nbsp;  .^\72 EC &nbsp;  &nbsp;  jb short ef_trial.00440178<br><br>正如色神告诉我的,mov.paz是用了字典加密.有一个长度为256字节的字典,内容是打乱了的0x00-0xFF之间的值.要解密的话,只要把文件里的一个字节作为偏移量到字典里去找到真实值再替换回来就可以了.于是mov.paz的解密宣告成功,顺利解出201MB的ef_demo.mpg.<br><br><br>P.S. 在はるのあしおと 正式版的chm文件里同样能看到Blowfish的存在.看来从这正式版开始minori就已经开始用Blowfish了,用Crypto Checker也证实了Blowfish的存在.我没仔细看haruoto.exe,不过用W32Dasm观察string reference没看到含有"Blowfish"字样的调试信息.要具体跟的话得另外找时间咯...<br><br>希望这篇东西能成为OllyDbg入门级的生动实例吧...OTL,这王道的工具的能力在这帖里只展现了冰山一角啊...<div id="alert_865141" style="color: gray; margin-top: 30px; --darkreader-inline-color:#bfb9ac;" data-darkreader-inline-color="">[ 此贴被rednaxela在2006-12-03 20:13重新编辑 ]</div></div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_865141" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2006-11-25 09:47 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 1楼(rednaxela) 的帖子');" data-mx-warn="Empty URL">1 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="865152" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570947647-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>rednaxela</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=9227" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570947647-ce00c7df760cd0b54791980099058989.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_2"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空三年生上学期</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570947647-5fc5bacf4fd91c54a5fe72c4ceff18fa.gif"><br>

<span class="user-info2" id="showface_2">
<span class="user-infoWrap2">


精华:

		<a href="https://bbs.sumisora.net/search.php?authorid=9227&amp;digest=1" target="_blank" class="s4 f9" referrerpolicy="no-referrer" rel="noopener noreferrer">5</a>
<br>
发帖: <span class="s1 f9">375</span><br>
学分: <span class="s2 f9">35 点</span><br>
澄空币: <span class="s3 f9">895 KID</span><br>

		GPA: <span class="s2 f9">7 点</span><br>

		<span class="gray">注册时间:2005-04-15<br>
		最后登录:2016-04-07 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_865152" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=208251&amp;pid=865152&amp;article=2" onclick="return sendurl(this,4,event)" id="quote_865152" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=208251&amp;pid=865152&amp;article=2" id="modify_865152" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=9227" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=208251&amp;pid=865152" onclick="return sendurl(this,8)" id="report_865152" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=208251&amp;uid=9227" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('865152')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_865152" class="fl">&nbsp;</h1>
			

			<div id="p_865152" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_865152">在说明Blowfish相关前,还想再说说分析过程中的"花絮"般的事.<br><br>分析归档的文件结构前,最好能先解决掉解密问题.我这里做的分析都都是先行完成了解密后才分析的.<br><br>上面所描述的分析过程自然是省略了不少繁琐无大意义的过程.不过新手在调试过程中或许也会经历一样的过程,值得说说.在用OllyDbg对ef_trial.exe实际调试前,如果先用FileMon来观察一次到底对什么文件做了何种操作的话,在调试时就会减少很多不必要的surprise.例如说,如果对CreateFileA(),ReadFile(),WriteFile(),DeleteFileA()这几个函数的所有调用都设置了断点,那么在经过真正关注的文件操作之前,或许会有许多不关心的地方也被断下来了.要慢慢去确认是否是关心的文件的操作会很麻烦...<br><br>多次跟踪后发现system.dat和scr.paz相关的操作都值得关注.前者是因为它的疑似是key的值是"minori",很特殊.后者则是因为它是第一个被处理的paz归档,方便重新开始程序调适后迅速找到其处理代码的位置.不过,system.dat在ReadFile()后buffer里看到的值,在BlowfishDecrypt()后仍然意义不明,无法确定文件是不是只被Blowfish加密过.这个疑惑在scr.paz的处理部分得到解决.跟踪时能看到,对scr.paz进行了2次ReadFile(),头一次的结果决定了后一次所读的长度.而两次ReadFile()之间没有经过BlowfishDecrypt().这印证了paz归档的头4个字节是某种东西的长度,当然现在我们知道那是文件索引的长度.后一次ReadFile()后buffer里的值,会在BlowfishDecrypt()返回前出现可读的字符串,基本上说明了Blowfish的decrypt完成后就完成了解密过程.<br>因为开始缺少头绪,我把这些文件索引部分在decrypt前后的值都dump了出来.这个dump可以通过OllyDbg直接来做(在数据窗口用Ctrl+G定位,然后用鼠标选定要dump出来的范围,按Ctrl+C来复制旧可以),或者也可以用WinHex来做(打开相应进程的entire memory,跳到buffer的地址,同样用鼠标选定需要dump的区域,然后按Ctrl+Shift+N就可以直接dump到新文件里).然后又花了点时间才把前后的关系都理清楚吧...<br><br>说说解析文件索引里三个文件长度相关值的意义的过程.在はるのあしおと　demo/trial里这三个数字总是相等的,如果有不相等的地方我可能漏掉了,因为关注点不在那个上面.解决了ef_ftt里的scr.paz的解密问题后,观察文件索引,就能看到那三个数字都不同的100_10.sc的索引条目.先观察第二个和第三个数字,它们总是相等或很接近,结合Blowfish的特点可以推断出第三个数字是padding后实际占用的长度(因为它总是大于等于第二个数字).然后观察第一个和第二个数字.它们多数情况下相等,偏偏在这怪异的100_10.sc上却不等,并且第一个数字比第二个大.算是经验吧,推断出第一个数字是解压后的文件长度而第二个数字是压缩过后的文件长度.这样一来,三个数字的意义终于完全确定.这之中关键就在于,寻找"相等"与"不相等"所隐含的关系.<br><br><br>其实照我这种W32Dasm的使用方式,只用到了string reference和import module之类的查看,完全可以用OllyDbg来完成的.我用W32Dasm完全是因为习惯了...不想多装软件的话,不使用W32Dasm也可以.<br><br>hmm...对Blowfish的介绍先简单的放俩链接,过段时间再回来充实好了...<br><br>原Blowfish算法论文:<br><a href="https://www.schneier.com/paper-blowfish-fse.html" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">http://www.schneier.com/paper-blowfish-fse.html</a><br>一年后原作者的评论:<br><a href="https://www.schneier.com/paper-blowfish-oneyear.html" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">http://www.schneier.com/paper-blowfish-oneyear.html</a><br>一些免费的Blowfish实现的下载:<br><a href="https://www.schneier.com/blowfish-download.html" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">http://www.schneier.com/blowfish-download.html</a><br><br>占楼待续...想说说解析我使用的Blowfish实现与minori中的差距是如何被具体定位并解决的.可以看到不少"恶心"的代码<div id="alert_865152" style="color: gray; margin-top: 30px; --darkreader-inline-color:#bfb9ac;" data-darkreader-inline-color="">[ 此贴被rednaxela在2006-11-28 10:06重新编辑 ]</div></div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_865152" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2006-11-25 09:53 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 2楼(rednaxela) 的帖子');" data-mx-warn="Empty URL">2 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="865948" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570947647-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>sinfonias</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=49756" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570947647-bc3b3631a24154c2d9ba8189508a5212.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_3"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">新注册会员</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570947647-be59bc9a4edb96b6b54ba67c9267b93f.gif"><br>

<span class="user-info2" id="showface_3">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">3</span><br>
学分: <span class="s2 f9">0 点</span><br>
澄空币: <span class="s3 f9">1130 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2006-04-30<br>
		最后登录:2011-12-25 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_865948" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=208251&amp;pid=865948&amp;article=3" onclick="return sendurl(this,4,event)" id="quote_865948" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=208251&amp;pid=865948&amp;article=3" id="modify_865948" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=49756" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=208251&amp;pid=865948" onclick="return sendurl(this,8)" id="report_865948" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=208251&amp;uid=49756" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('865948')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_865948" class="fl">&nbsp;</h1>
			

			<div id="p_865948" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_865948">很精彩，从中学到不少东西，原来还有那么多好用的工具。<br><br>其实这个星期，我也试着破解了一下这个东西，主要是为了解那个op。说实话，以前没什么这方面的经验，花了很多时间。我是直接用OllyDbg跟踪的。<br><br>至于100_10.sc这个文件，楼主猜得没错，就是标准的zlib，去网(<a href="https://www.zlib.net/" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">www.zlib.net</a>)上下个zlib库，就可以直接解了。其他压缩文件也都是zlib。</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_865948" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2006-11-25 19:43 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 3楼(sinfonias) 的帖子');" data-mx-warn="Empty URL">3 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="866093" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570947647-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>rednaxela</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=9227" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570947647-ce00c7df760cd0b54791980099058989.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_4"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空三年生上学期</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570947647-5fc5bacf4fd91c54a5fe72c4ceff18fa.gif"><br>

<span class="user-info2" id="showface_4">
<span class="user-infoWrap2">


精华:

		<a href="https://bbs.sumisora.net/search.php?authorid=9227&amp;digest=1" target="_blank" class="s4 f9" referrerpolicy="no-referrer" rel="noopener noreferrer">5</a>
<br>
发帖: <span class="s1 f9">375</span><br>
学分: <span class="s2 f9">35 点</span><br>
澄空币: <span class="s3 f9">895 KID</span><br>

		GPA: <span class="s2 f9">7 点</span><br>

		<span class="gray">注册时间:2005-04-15<br>
		最后登录:2016-04-07 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_866093" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=208251&amp;pid=866093&amp;article=4" onclick="return sendurl(this,4,event)" id="quote_866093" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=208251&amp;pid=866093&amp;article=4" id="modify_866093" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=9227" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=208251&amp;pid=866093" onclick="return sendurl(this,8)" id="report_866093" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=208251&amp;uid=9227" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('866093')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_866093" class="fl">&nbsp;</h1>
			

			<div id="p_866093" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_866093">呵呵,感谢LS. zlib的实现我机上有是有,只是没时间去试. 这次倒猜得挺准的 XD<br>这东西写得也仓促.等考试之后再整理以下吧~关于Blowfish也还有想说的...</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_866093" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2006-11-25 20:37 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 4楼(rednaxela) 的帖子');" data-mx-warn="Empty URL">4 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="866150" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570947647-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>sinfonias</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=49756" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570947647-bc3b3631a24154c2d9ba8189508a5212.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_5"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">新注册会员</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570947647-be59bc9a4edb96b6b54ba67c9267b93f.gif"><br>

<span class="user-info2" id="showface_5">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">3</span><br>
学分: <span class="s2 f9">0 点</span><br>
澄空币: <span class="s3 f9">1130 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2006-04-30<br>
		最后登录:2011-12-25 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_866150" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=208251&amp;pid=866150&amp;article=5" onclick="return sendurl(this,4,event)" id="quote_866150" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=208251&amp;pid=866150&amp;article=5" id="modify_866150" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=49756" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=208251&amp;pid=866150" onclick="return sendurl(this,8)" id="report_866150" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=208251&amp;uid=49756" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('866150')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_866150" class="fl">&nbsp;</h1>
			

			<div id="p_866150" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_866150">hehe，<br>期待后续</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_866150" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2006-11-25 21:08 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 5楼(sinfonias) 的帖子');" data-mx-warn="Empty URL">5 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="867310" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570947647-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>rednaxela</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=9227" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570947647-ce00c7df760cd0b54791980099058989.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_6"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空三年生上学期</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570947647-5fc5bacf4fd91c54a5fe72c4ceff18fa.gif"><br>

<span class="user-info2" id="showface_6">
<span class="user-infoWrap2">


精华:

		<a href="https://bbs.sumisora.net/search.php?authorid=9227&amp;digest=1" target="_blank" class="s4 f9" referrerpolicy="no-referrer" rel="noopener noreferrer">5</a>
<br>
发帖: <span class="s1 f9">375</span><br>
学分: <span class="s2 f9">35 点</span><br>
澄空币: <span class="s3 f9">895 KID</span><br>

		GPA: <span class="s2 f9">7 点</span><br>

		<span class="gray">注册时间:2005-04-15<br>
		最后登录:2016-04-07 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_867310" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=208251&amp;pid=867310&amp;article=6" onclick="return sendurl(this,4,event)" id="quote_867310" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=208251&amp;pid=867310&amp;article=6" id="modify_867310" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=9227" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=208251&amp;pid=867310" onclick="return sendurl(this,8)" id="report_867310" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=208251&amp;uid=9227" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('867310')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_867310" class="fl">&nbsp;</h1>
			

			<div id="p_867310" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_867310">先另外挖个小坑放着好了...100_10.sc果然是zlib压缩的.昨天忍不住花了3分钟弄出来了...<br><br>游戏引擎概况:<br><br>ef_ftt的是以脚本来控制游戏流程,由游戏引擎来驱动的形式构成的.限定范围来说,这也是visual novel类游戏的常见实现方式.<br><br>熟悉NScripter或者吉里吉里2/KAG3的同学对"脚本"肯定不会陌生.在使用这两种引擎时,玩家所能看到听到的所有方面几乎都能用脚本来控制,包括主菜单,SAVE/LOAD菜单,标题界面,CG鉴赏,游戏模式,回想模式,系统设置界面,视频/音频播放,甚至像是pop-up菜单等.虽然编写菜单也是件头大的事,至少引擎给脚本提供了这种自由度.<br><br>而minori在はるのあしおと之后一直到现在的ef - the first tale.都使用了同一个系列的引擎.相对于之前的Wind - a breath of heart -的引擎是进步了不少,用起来的感觉也流畅了很多.从调试跟踪以及其他渠道获得的信息片段来看,这个引擎是个相当"customized"的实现,特化服务于minori本身的游戏需求.要使用该引擎,似乎每编写一部新的作品就要新写一部分的C++代码,调试信息中出现的"ef.cpp"大概能支持这个猜测.就玩家拿到的成品看,其标题界面,鉴赏界面等都是硬编码于exe之内,脚本只用来处理非交互的部分;与NScripter和吉里吉里2/KAG3的相比,这个脚本的自由度相对较低.调试时,在ef_ftt的标题界面的相关处理代码处,可以看到这界面就是个switch (cases 1..5),5个case正对应着标题的5个选项,其中有2个是硬编码链接到固定名字的脚本上的.New Game对应test.sc,Show Movie对应movie.sc.另外其实还有opening.sc的读入和解释也是硬编码进来的,不过没仔细跟出它到底在什么地方起作用了;还没看到那op_logo.mpg在ef_ftt里播过...<br><br>这引擎让我觉得非常欣赏的一点是嘴唇跟随的同步性非常好.不敢乱猜是如何实现的,不过总觉得这跟下面看到的message指令后的行号参数有关系...难道说在别的哪里还有对应的数据来控制图片的替换时间么? 眨眼的频率倒很直观的以变量的形式出现在脚本里了.<br><br>话说貌似没看到有移动立绘的指令.背景的滚动可以通过hscroll或者vscroll完成,不过立绘似乎只能靠不停用stage指令设置立绘的新位置来模拟出移动效果了.也不是不行...<br><br><span class="highslide"><img src="assets/1570947647-f6a752330453f52aba3df3466dd7c3e9.jpg" border="0" style="max-width: 100%;max-height: 800px;"></span><br>传说中的op_logo.mpg唯一一个镜头的截图.由此可以了解到,这个游戏引擎的名字是Musica, Media Unification System Interpreter and Compiler Authorization. ef_ftt所使用的版本是System 1.4 Advance.PEiD的分析告诉我们这引擎是用VC6编译器来编译的,应该说还是有可信度的.果然Windows上要写非.Net的C++程序时,VC6还是相当顺手的IDE...么.我很喜VC6SP4+VAX+ICC9的搭配.哎呀跑题了...<br><br>游戏脚本例子:<br><br>就以ef_ftt里开场的一段为例吧,<br><h6 class="quote">Quote:</h6><blockquote class="blockquote"><br>; ファイル: 100_01.txt<br>;■＜１章：ＯＰ＞<br>;■100はすべて夜色。<br>;.playBGM *<br>;.panel 0<br>.setGlobal EYE_SEQ_DEFAULT = 2<br>.transition 0 * 10<br>.stage &nbsp;  * WHITE.png 0 0<br>;.playBGM *<br>;.effect *<br>;（000からの雪の演出を、ここで止めてます）<br>.wait 500<br>;.playBGM *<br>.transition 0 * 10<br>.stage &nbsp;  * terop_10001a.png 0 0<br>.wait 450<br>.transition 0 * 10<br>.stage &nbsp;  * WHITE.png 0 0<br>;■夜空<br>;.transition 0 * 10<br>;.stage &nbsp;  * 10001_sky_c_sepia.png 0 0<br>.playBGM efBGM025mix.ogg<br>.transition 0 * 10<br>.stage &nbsp;  * ev01_sky_a_sepia.png 0 0<br>;（地文と違い、星は瞬きまくってますが……保留。全体的に夜·曇りを用意してもらうか？）<br>.panel 1<br>.message &nbsp;  100 &nbsp;  &nbsp;  &nbsp;  &nbsp; 凍えるような夜を歩く。<br>.transition 0 * 20<br>.stage &nbsp;  * ev01_sky_b_sepia.png 0 0<br>.message &nbsp;  110 &nbsp;  &nbsp;  &nbsp;  &nbsp; 靴の中にまで入り込んでくる冷気に身体を震わせ、張りつめたような静寂に少し耳が痛くなる。<br>.message &nbsp;  120 &nbsp;  &nbsp;  &nbsp;  &nbsp; 光に彩られた街から仰ぎ見る空に、星は見えない。<br>.message &nbsp;  130 &nbsp;  &nbsp;  &nbsp;  &nbsp; 月だけがぼんやりとした光を放っている。<br>.transition 0 * 20<br>.stage &nbsp;  past_window.png bgw_normal011a01_03_10001_sepia.png 0 0<br>.message &nbsp;  140 &nbsp;  &nbsp;   　紘　 &nbsp;  「寒ぃーっ……」<br>.message &nbsp;  150 &nbsp;  &nbsp;  &nbsp;  &nbsp; 吐息の白さが闇に溶けていく。<br>.message &nbsp;  160 &nbsp;  &nbsp;  &nbsp;  &nbsp; 俺は背筋を丸めて、ゆっくりと歩を進める。<br>.message &nbsp;  170 &nbsp;  &nbsp;  &nbsp;  &nbsp; 冬だから寒いのは当たり前なんだけどさ――</blockquote><br><br>从这一段例子来推测一下脚本的语法.所谓推测当然不能保证完全正确.尽人事而已.<br><br>最直观的一点,就是Musica的脚本是指令式的.熟悉NScripter的同学会很熟悉指令式的脚本,其实KAG2也是指令式的,而KAG3也可以以指令式方式编写脚本(以"@"为标示).KAG3里需要详细把每个参数名写出,在可读性方面应该说比Musica或者NScripter的要好吧,代价是书写的内容冗长.我的个人偏好是标记式的脚本,像KAG3推荐的TAG方式.纯粹是个人喜好而已.<br><br>Musica脚本的指令格式是在指令名前加上一个小数点"."为标示,随后以空白(whitespace,这里包括space和tab)为间隔写上指令所需要的参数.一行只能有一条指令.参数可以是数字或者字符串,以星号"*"表示空(null).注释方面,支持单行注释,以分号";"来表示所在行内其后的都是注释部分.<br><br><br>指令功能推测:<br><br>要推测指令的功能,当然就是要尽可能看到同一指令的不同用法,以及打开游戏运行到对应的地方来看效果.为了能直观的看到同一指令的不同用法,可以考虑使用Ultra Edit(我是用UE Studio)的Find in Files功能,将同一指令的搜索结果放在同一窗口(Results to Edit Window).<br><br>指令名: chain<br>指令参数: <br>作用: 跳转到另一脚本文件<br>注解: <br>例子:<br>; 下面要跳转到101_01.sc继续执行<br>.chain 101_01.sc<br><br>指令名: effect<br>参数: <br>作用: 使用特效<br>注解:<br>例子:<br>.effect *<br>.effect Rain<br>.effect Snow<br>.effect SnowH<br>.effect end<br><br>指令名: end<br>参数: 无参数<br>作用: 返回标题界面<br>注解: <br>例子:<br>; 游戏结束,返回标题界面<br>.end<br><br>指令名: message<br>参数: <br>作用: 跳转到另一脚本文件<br>注解: 参数有#,@等修饰...注意. #不显示,@显示【???】,不加修饰时显示【 名字 】<br>例子:<br><br>指令名: setGlobal<br>参数: <br>作用: 对一个全局变量赋值<br>注解: <br>例子:<br>.setGlobal EYE_SEQ_DEFAULT = 2<br><br>指令名: panel<br>参数: int<br>作用: 指定当前的文字面板模式<br>注解: 目前见到的参数范围是[0,3]区间内.<br>例子:<br>; 无文字面版<br>.panel 0<br><span class="highslide"><img src="assets/1570947647-19b6e9b034dda063d42725fa45c2cfd9.jpg" border="0" style="max-width: 100%;max-height: 800px;"></span><br><br><br>; 一般处于窗口下放的文字面板<br>.panel 1<br><span class="highslide"><img src="assets/1570947647-b9c4206b79c40b6a09ccc90054c72122.jpg" border="0" style="max-width: 100%;max-height: 800px;"></span><br><br><br>; 全窗口的文字面板<br>.panel 2<br><span class="highslide"><img src="assets/1570947647-fe6e20d734c986b400b2f34251cb2837.jpg" border="0" style="max-width: 100%;max-height: 800px;"></span><br><br><br>; "宽屏"模式的文字面板<br>.panel 3<br><span class="highslide"><img src="assets/1570947647-5b8a73eaf93d9a7eb43fba0ed399be9e.jpg" border="0" style="max-width: 100%;max-height: 800px;"></span><br><br><br><br><br><br><br>//////////////////////////////<br><br>后续...<br><br>".debug"<br>".deleteVar"<br><br><br>".endScroll"<br>".exec"<br>".frame"<br>".goto"<br>".hscroll"<br>".HSVfilter"<br>".if"<br>".label"<br><br>".movie"<br>".movie2"<br>".overlay"<br><br>".playBGM"<br>".playSE"<br>".playSE2"<br>".playVoice"<br>".pragma"<br>".screen"<br>".scroll"<br>".scrollAcc"<br>".scrollFG"<br>".select"<br>".set"<br>".setGlobal"<br>".setTimer"<br>".shakeScreen"<br>".stage"<br>".transition"<br>".vscroll"<br>".wait"<br>".waitTimer"<br>".wscroll"</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_867310" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2006-11-26 18:53 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 6楼(rednaxela) 的帖子');" data-mx-warn="Empty URL">6 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="868242" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570947647-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>kid23</b>
<div style="margin:.3em 0 .4em .2em">Nice boat....&amp;</div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=49785" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570947647-b842a1d7465be36c32cba70b8ace1d8d.jpg" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_7"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空の贵宾</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570947647-87bc1a6e935264a57e50e0d513f23aa7.gif"><br>

<span class="user-info2" id="showface_7">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">80</span><br>
学分: <span class="s2 f9">6 点</span><br>
澄空币: <span class="s3 f9">385 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2006-05-02<br>
		最后登录:2019-02-12 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_868242" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=208251&amp;pid=868242&amp;article=7" onclick="return sendurl(this,4,event)" id="quote_868242" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=208251&amp;pid=868242&amp;article=7" id="modify_868242" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=49785" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=208251&amp;pid=868242" onclick="return sendurl(this,8)" id="report_868242" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=208251&amp;uid=49785" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('868242')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_868242" class="fl">&nbsp;</h1>
			

			<div id="p_868242" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_868242">太强了＝＝！<br>不知工贼写出来的文章又会强到什么境界，期待ing．．．<br><br>PS：反汇编这玩意还真方便＝＝</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_868242" class="c"></div>

		<div><img class="signature" src="assets/1570947647-f23b8ffd0b6b327441aa828c9cd3243d.gif" align="absbottom"></div>
		<div class="signature" style="max-height:380px;maxHeight:380px; overflow:hidden;"><table width="100%"><tbody><tr><td>和谐中。。。。。。。
<br>I can be both of God and the Devil.<span class="highslide"><img src="assets/1570947647-ad724d48a06e259e9265777a06af3be4.jpg" border="0" style="max-width: 100%;max-height: 900px;"></span>
<br><span class="highslide"><img src="assets/1570947647-c41a8dfefef1beb859b0138d89ff4ba0.jpg" border="0" style="max-width: 100%;max-height: 900px;"></span></td><td></td></tr></tbody></table></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2006-11-27 15:55 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 7楼(kid23) 的帖子');" data-mx-warn="Empty URL">7 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="868901" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570947647-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>xaeroak15</b>
<div style="margin:.3em 0 .4em .2em">The End/Out/Age Of Infinity</div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=5408" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570947647-568f5127a2f8bd51cea96a2631f1dcca.jpg" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_8"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空の贵宾</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570947647-87bc1a6e935264a57e50e0d513f23aa7.gif"><br>

<span class="user-info2" id="showface_8">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">15300</span><br>
学分: <span class="s2 f9">185 点</span><br>
澄空币: <span class="s3 f9">2394 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2005-01-19<br>
		最后登录:2019-01-01 <br><br> 
		<img src="assets/1570947647-bccf9e916d51cf87702606f8b8a2433c.gif" title="万贴纪念勋章"> <img src="assets/1570947647-0e92d71e2d6d7d028eb6be3f4cfadcd0.gif" title="分流组专用勋章"> <img src="assets/1570947647-4b21092c7338c24ccb6bca86df00b70f.gif" title="10号入学纪念勋章"> <br></span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_868901" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=208251&amp;pid=868901&amp;article=8" onclick="return sendurl(this,4,event)" id="quote_868901" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=208251&amp;pid=868901&amp;article=8" id="modify_868901" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=5408" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=208251&amp;pid=868901" onclick="return sendurl(this,8)" id="report_868901" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=208251&amp;uid=5408" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('868901')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_868901" class="fl">&nbsp;</h1>
			

			<div id="p_868901" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_868901">又见lz,强悍得拜倒……<br><br>FileMon<br>File Monitor,文件监视工具.可以监视指定范围(路径,文件类型,操作类型等)的所有文件操作.可以方便的知道到底一个程序执行时对哪些文件做了读/写操作<br><br>这个软件感觉很有用，不止是用于跟踪，简单对付木马什么的也可以（不过高手不会给你机会吧）<br><br>看来这个游戏还没怎么挖空心思地反破解……以前看过一些游戏，运行的时候会自动生成一些文件<br><br>每次名字都不同，还都比较大,1m=50m不等，尤其是变换bgm的时候……而且貌似都加了密……<br>看来是“现买先卖”啊……要什么文件，先从大包里拿，然后游戏再解开再读……费劲啊……<br><br>zlib啊...貌似zip有好多种格式/算法的说bgz,gz...acdsee和3dmax竟然也曾经用zlib包过……<br><br>ps：WH一会中文一会英文有点晕……<div id="alert_868901" style="color: gray; margin-top: 30px; --darkreader-inline-color:#bfb9ac;" data-darkreader-inline-color="">[ 此贴被xaeroak15在2006-11-28 08:16重新编辑 ]</div></div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_868901" class="c"></div>

		<div><img class="signature" src="assets/1570947647-f23b8ffd0b6b327441aa828c9cd3243d.gif" align="absbottom"></div>
		<div class="signature" style="max-height:380px;maxHeight:380px; overflow:hidden;"><table width="100%"><tbody><tr><td><span class="highslide"><img src="assets/1570947647-9de25ff556ef1759280b61b08957cff5.jpg" border="0" style="max-width: 100%;max-height: 900px;"></span><br><span style="color: rgb(0, 0, 255); --darkreader-inline-color:#447fe5;" data-darkreader-inline-color=""><font size="2"><b>Suspicion...</b></font></span> </td><td></td></tr></tbody></table></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2006-11-28 07:53 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 8楼(xaeroak15) 的帖子');" data-mx-warn="Empty URL">8 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="868978" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570947647-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>rednaxela</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=9227" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570947647-ce00c7df760cd0b54791980099058989.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_9"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空三年生上学期</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570947647-5fc5bacf4fd91c54a5fe72c4ceff18fa.gif"><br>

<span class="user-info2" id="showface_9">
<span class="user-infoWrap2">


精华:

		<a href="https://bbs.sumisora.net/search.php?authorid=9227&amp;digest=1" target="_blank" class="s4 f9" referrerpolicy="no-referrer" rel="noopener noreferrer">5</a>
<br>
发帖: <span class="s1 f9">375</span><br>
学分: <span class="s2 f9">35 点</span><br>
澄空币: <span class="s3 f9">895 KID</span><br>

		GPA: <span class="s2 f9">7 点</span><br>

		<span class="gray">注册时间:2005-04-15<br>
		最后登录:2016-04-07 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_868978" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=208251&amp;pid=868978&amp;article=9" onclick="return sendurl(this,4,event)" id="quote_868978" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=208251&amp;pid=868978&amp;article=9" id="modify_868978" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=9227" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=208251&amp;pid=868978" onclick="return sendurl(this,8)" id="report_868978" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=208251&amp;uid=9227" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('868978')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_868978" class="fl">&nbsp;</h1>
			

			<div id="p_868978" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_868978">许多调试相关的工具都能对付木马病毒之类.上面的FileMon可以监视所有的文件操作类型,包括query(只查询,不打开),create,read,write,delete等,并且能将操作结果显示出来,例如是否成功执行之类.我第一次用的时候吓了一跳,原来机上"平静"时候的磁盘操作也那么多的...<br>另外,像是WinHex也可以用来对付木马.它可以查看正在运行的进程的内存数据.此时可以看到一个进程上到底挂了哪些DLL.现在不少木马/病毒都转向以DLL注入的方式来实现了,其中比较恶心的类型会很隐秘.一般的DLL注入通过WinHex就能看到了.感觉有什么不对的DLL在运行的话,动手把相应进程给杀掉然后看看那DLL在哪里吧~<br><br><br>这次举的例子其实并不典型.有太多的线索来简化调试过程了,而且使用的加密算法也并不难对付(然而如果不知道key的话,Blowfish可以说是无敌的...).主要是因为想多介绍几个工具和简化的可能性.试想如果没有那些调试信息的字符串,就得专门为了寻找解密算法的位置花点时间.不过如果使用的加密/解密算法是常见的算法的话,这个也好办.首先解密必定是对资源文件的解密.因而肯定发生在读取需要被解密的内容之后进行的.所以最初在ReadFile()上设置断点就是为了在它之后寻找可能的解密函数调用.其次,使用Crypto Checker来找出常见的加密/解密算法出现的可能之后,可以通过一些常量来进行定位.假如这次ef_ftt没有留下"Blowfish"相关的调试信息,可以先用十六进制编辑器打开exe文件,查找加密算法所使用的特征值的地址(Crypto Checker其实已经把地址指明了),然后将这个地址加上程序装载时的偏移量(例如0x00400000)就是这个特征值在运行时的虚拟地址.然后用OllyDbg查找常量,很快就能够找到加密/解密算法相关的函数位置.<br><br>我的方法也应该有很多地方不合理或者不完善的还请经验者多多指教 &lt;(_ _)&gt;</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_868978" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2006-11-28 10:02 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 9楼(rednaxela) 的帖子');" data-mx-warn="Empty URL">9 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="870192" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570947647-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>zjysdhrxp</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=69674" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570947647-566ee407346faacd4c2850efbd172b93.JPG" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_10"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空一年生上学期</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570947647-f43195cd588caa26c296fcc61910b3e6.gif"><br>

<span class="user-info2" id="showface_10">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">57</span><br>
学分: <span class="s2 f9">3 点</span><br>
澄空币: <span class="s3 f9">1085 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2006-10-19<br>
		最后登录:2010-05-24 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_870192" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=208251&amp;pid=870192&amp;article=10" onclick="return sendurl(this,4,event)" id="quote_870192" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=208251&amp;pid=870192&amp;article=10" id="modify_870192" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=69674" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=208251&amp;pid=870192" onclick="return sendurl(this,8)" id="report_870192" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=208251&amp;uid=69674" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('870192')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_870192" class="fl">&nbsp;</h1>
			

			<div id="p_870192" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_870192">FX大最高！华丽的技术文。XD<br>对于WIN下这些工具的使用入门真的使我获益良多。拜倒。。。。。。</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_870192" class="c"></div>

		<div><img class="signature" src="assets/1570947647-f23b8ffd0b6b327441aa828c9cd3243d.gif" align="absbottom"></div>
		<div class="signature" style="max-height:380px;maxHeight:380px; overflow:hidden;"><table width="100%"><tbody><tr><td>目前在J国工作，BLOG缺少人气中。OTL<br>HP: www.zjysdhr.org<br><span class="highslide"><img src="assets/1570947647-9c3c8b045c1d9133e04052a2ce48fcd9.JPG" border="0" style="max-width: 100%;max-height: 900px;"></span></td><td></td></tr></tbody></table></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2006-11-29 12:21 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 10楼(zjysdhrxp) 的帖子');" data-mx-warn="Empty URL">10 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="871540" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570947647-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>rednaxela</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=9227" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570947647-ce00c7df760cd0b54791980099058989.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_11"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空三年生上学期</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570947647-5fc5bacf4fd91c54a5fe72c4ceff18fa.gif"><br>

<span class="user-info2" id="showface_11">
<span class="user-infoWrap2">


精华:

		<a href="https://bbs.sumisora.net/search.php?authorid=9227&amp;digest=1" target="_blank" class="s4 f9" referrerpolicy="no-referrer" rel="noopener noreferrer">5</a>
<br>
发帖: <span class="s1 f9">375</span><br>
学分: <span class="s2 f9">35 点</span><br>
澄空币: <span class="s3 f9">895 KID</span><br>

		GPA: <span class="s2 f9">7 点</span><br>

		<span class="gray">注册时间:2005-04-15<br>
		最后登录:2016-04-07 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_871540" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=208251&amp;pid=871540&amp;article=11" onclick="return sendurl(this,4,event)" id="quote_871540" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=208251&amp;pid=871540&amp;article=11" id="modify_871540" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=9227" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=208251&amp;pid=871540" onclick="return sendurl(this,8)" id="report_871540" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=208251&amp;uid=9227" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('871540')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_871540" class="fl">&nbsp;</h1>
			

			<div id="p_871540" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_871540">好吧,考试结束了.回来把Blowfish相关的写上.<br><br>先简单带过一下对称密钥算法.所谓对称密钥算法,就是加密和解密时都使用相同的密钥的算法.这样的算法的效果并不应该依赖算法的隐秘性,而应该依赖密钥本身的隐秘性.<br><br>Blowfish是由Bruce Schneier在1994年发表的论文上首次提出的.它是一种对称密钥算法,有快速、紧凑、简单、可变安全性的特点,而且是免费的,是DES和IDEA的有力替代方案.Blowfish接受可变长的密钥,4到56字节(32到448位),对8字节(64位)的数据块进行加密/解密.使用了大量的子密钥,包括18个32位的子密钥(P Box)和4*256个32位的S盒(S Box),它们都会在初始化的时候由P Box和S Box的初始值同密钥运算生成,然后保留于内存中;子密钥和S盒是通过重复使用Blowfish本身生成的,使密码分析非常困难.初始化后,原本的密钥就不再参与加密和解密的运算了,在后续的加密和解密过程中,子密钥不需要被重复初始化,因而速度较之前的一些算法大大加快.这也让Blowfish算法有明确的应用范围:适合于大量数据的高速加密/解密,但是不适合于密钥经常变化的情况.这个特性也使破解过程中有一些"诡异办法"可用,就算不知道原始的密钥或者是初始化子密钥的方法不对也没关系.后面会再提到.<br><br>简单描述一下Blowfish的算法:<br><br>加密过程:<br>Blowfish包括16轮循环.输入是64位的数据,x.把x分割为两个32位的部分,xL和xR.然后,从i = 1到16: <br><br>xL = xL XOR Pi<br>xR = F(xL) XOR xR<br>交换xL and xR <br><br>第16轮循环结束后,再交换一次xL和xR来取消掉上面最后一轮的交换.<br>然后, xR = xR XOR P17并且xL = xL XOR P18.<br>最后, 重新合并xL和xR形成密文.<br><br>函数F如下:将xL均分为4部分: a,b,c,和d. 然后, F(xL) = ((S[1,a] + S[2,b] mod 2^32) XOR S[3,c]) + S[4,d] mod 2^32.<br><br>解密过程与加密过程一样,只是使用P Box的顺序相反,是从P18开始用到P1.<br><br><br>在具体对数据加密/解密操作前,需要先用密钥初始化P Box和S Box. P Box和S Box都是有固定的初始值的,其中P Box的初始值是PI(圆周率)的十六进制表示(减去开头的3).初始化的过程是:<br><br>1. 先按顺序对P Box和S Box以固定的初始值赋值.<br>2. P1与密钥的前32位异或,P2与第二个32位异或,直到整个P Box都被与密钥异或过的数据填充.密钥可以循环使用,也就是说"ABCDE"为密钥的话,第一次用"ABCD",第二次用"EABC",以此类推.<br>3. 使用(1)和(2)里生成的子密钥,对一串64位的全零用Blowfish加密.<br>4. 用(3)的结果替换P1和P2. <br>5. 以(3)的结果为输入,再用Blowfish加密一次. <br>6. 用(5)的结果替换P3和P4. <br>7. 以同样方式继续,直到整个P Box和所有的S Box都被加密替换过为止<br><br>总共需要521次循环来生成所有的子密钥.<br><br><br>在了解了Blowfish的算法后,可以来看看minori是如何使用Blowfish的.<br><br>上面分析ef_trial的时候,我们知道了BlowfishEncryptionKey::SetKey()的地址.本来setKey/initialize这类名字的函数应该是用于初始化的;但是在这个函数里观察过后,并没有看到形似初始化子密钥的代码.可以说处理检查是否为空(NULL)和检查长度外,没有做什么特别的事.在没有分析BlowfishDecrypt()前我都觉得很郁闷:难道没初始化就直接用了?<br><br>结果让我很惊讶.居然是每次encrypt/decrypt的时候才做这个初始化.也就是每次都重复初始化子密钥,完全与Blowfish的思想相反.<br>来看看BlowfishDecrypt()里的代码.最开始的一段前面提过了,是检查密钥长度的.然后来到这里:<br><br>00426CB3 &nbsp; mov ecx,100 &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp; ;  /count 0x100(256.) dwords<br>00426CB8 &nbsp; mov esi,ef_trial.004CE338 &nbsp;  &nbsp;  &nbsp;  &nbsp;  ;  |S_Box_init[0]: [004CE338]<br>00426CBD &nbsp; lea edi,dword ptr ss:[esp+68] &nbsp;  &nbsp;  &nbsp; ;  |S_box[0]: [ESP+68]<br>00426CC1 &nbsp; mov dword ptr ss:[esp+18],eax &nbsp;  &nbsp;  &nbsp; ; &nbsp; save key length<br>00426CC5 &nbsp; rep movs dword ptr es:[edi],dword ptr&gt;;  \copy S_Box<br>00426CC7 &nbsp; mov ecx,100 &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp; ;  /count 0x100(256.) dwords<br>00426CCC &nbsp; mov esi,ef_trial.004CE738 &nbsp;  &nbsp;  &nbsp;  &nbsp;  ;  |S_Box_init[1]: [004CE738]<br>00426CD1 &nbsp; lea edi,dword ptr ss:[esp+468] &nbsp;  &nbsp;   ;  |S_box[1]: [ESP+468]<br>00426CD8 &nbsp; rep movs dword ptr es:[edi],dword ptr&gt;;  \copy S_Box<br>00426CDA &nbsp; mov ecx,100 &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp; ;  /count 0x100(256.) dwords<br>00426CDF &nbsp; mov esi,ef_trial.004CEB38 &nbsp;  &nbsp;  &nbsp;  &nbsp;  ;  |S_Box_init[2]: [004CEB38]<br>00426CE4 &nbsp; lea edi,dword ptr ss:[esp+868] &nbsp;  &nbsp;   ;  |S_box[0]: [ESP+868]<br>00426CEB &nbsp; rep movs dword ptr es:[edi],dword ptr&gt;;  \copy S_Box<br>00426CED &nbsp; mov ecx,100 &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp; ;  /count 0x100(256.) dwords<br>00426CF2 &nbsp; mov esi,ef_trial.004CEF38 &nbsp;  &nbsp;  &nbsp;  &nbsp;  ;  |S_Box_init[3]: [004CEF38]<br>00426CF7 &nbsp; lea edi,dword ptr ss:[esp+C68] &nbsp;  &nbsp;   ;  |S_box[0]: [ESP+C68]<br>00426CFE &nbsp; rep movs dword ptr es:[edi],dword ptr&gt;;  \copy S_Box<br><br>这是我们先前发现使用了S Box初始值的地方.仔细分析发现这一部分的代码是分别将4个S Box都以初始值填充.也就是生成子密钥里(1)的部分了.<br>继续看,<br><br>00426D00 &nbsp; xor esi,esi &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp; ;  key offset count<br>00426D02 &nbsp; xor ebx,ebx &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp; ;  iteration count: iterate thorugh pbox<br>00426D04 &nbsp; /xor edi,edi &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;   ;  converted key<br>00426D06 &nbsp; |mov dword ptr ss:[esp+10],4 &nbsp;  &nbsp;  &nbsp;  ;  inner iteration count: 4 bytes of the key<br>00426D0E &nbsp; |/mov ecx,dword ptr ss:[esp+1070] &nbsp;   ;  on stack: mode?, key length?<br>00426D15 &nbsp; ||push esi &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  ;  param: count<br>00426D16 &nbsp; ||call ef_trial.004260C0 &nbsp;  &nbsp;  &nbsp;  &nbsp;   ;  negate a byte of key =&gt; EAX<br>00426D1B &nbsp; ||and eax,0FF &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  ;  leaving key byte<br>00426D20 &nbsp; ||shl edi,8 &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp; ;  left shift to make space for new key byte<br>00426D23 &nbsp; ||or edi,eax &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;   ;  add new key byte to EDI<br>00426D25 &nbsp; ||mov eax,dword ptr ss:[esp+18] &nbsp;  &nbsp;  ;  EAX = key length<br>00426D29 &nbsp; ||inc esi &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;   ;  incr ESI<br>00426D2A &nbsp; ||cmp esi,eax &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  ;  compare key offest with key length<br>00426D2C &nbsp; ||jl short ef_trial.00426D30<br>00426D2E &nbsp; ||xor esi,esi &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  ;  reset offset if it goes beyond key length<br>00426D30 &nbsp; ||mov eax,dword ptr ss:[esp+10] &nbsp;  &nbsp;  ;  inner iteration count<br>00426D34 &nbsp; ||dec eax<br>00426D35 &nbsp; ||mov dword ptr ss:[esp+10],eax &nbsp;  &nbsp;  ;  decr inner iteration count<br>00426D39 &nbsp; |\jnz short ef_trial.00426D0E &nbsp;  &nbsp;  &nbsp; ;  iterate through the key<br>00426D3B &nbsp; |mov eax,dword ptr ds:[ebx+4CE2F0] &nbsp;  ;  copy pbox_init[EBX]<br>00426D41 &nbsp; |add ebx,4 &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  ;  incr EBX by 4 for next copy<br>00426D44 &nbsp; |xor eax,edi &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;   ;  blowfish xor: ?<br>00426D46 &nbsp; |cmp ebx,48 &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp; ;  compare EBX with 0x48(72.)<br>00426D49 &nbsp; |mov dword ptr ss:[esp+ebx+1C],eax &nbsp;  ;  xor to pbox[EBX]<br>00426D4D &nbsp; \jl short ef_trial.00426D04 &nbsp;  &nbsp;  &nbsp;   ;  iterate through pbox for init(72.==18.*4.)<br><br>是初始化子密钥里(1)和(2)的部分.这里是对P Box的初始化.这里是一个二层的嵌套循环,外层由EBX控制,在完成对P Box赋初值的同时与密钥进行了异或运算;内层由[ESP+10]控制,主要作用是获取本轮外层循环中需要的密钥.就像前面提到过的,获取密钥的时候,这里做了点小手脚,对每个取入的密钥字节都取了反.于是用边准的Blowfish算法是解不开ef_ftt的资源的.<br>但是,由于原始的密钥在完成子密钥的生成后就没有用了,实际上我们等到全部的子密钥都生成完了之后,将其内容(包括P Box和4个S Box)从内存里dump出来,设置到我们的程序里,照样能使用标准的Blowfish算法的encrypt/decrypt来做我们要做的事.因为就算不dump出这些生成好的子密钥,也得通过跟踪找到原始的密钥dump出来,说到底没什么差别 (汗<br><br>当然,我们不想满足于此.继续把BlowfishDecrypt()的剩余部分看完.<br><br>在区间[0x00426D4F, 0x00426F7F]里的代码是生成子密钥步骤里的(3)(4)(5)(6)(7)中对P Box的生成部分.是一个单层循环,循环遍历了P Box,每个循环内其实就是Blowfish加密算法的实现.其中,可以看到某个函数被多次调用.例如这样:<br>00426E4C &nbsp; |call ef_trial.00426540 &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp; ;  -&gt; F(): 1<br>这个从0x00426540开始的函数,在这部分一共被调用了13次.跟踪步入后发现,这个实际上是对Blowfish算法里函数F的实现.可是一次加密应该需要16次的循环,每次都要用到函数F,为什么这里只有13次呢? 仔细看发现,其实是有16次F的使用,但是前3次被展开了,所以只有13次对0x00426540的调用.诡异吧...<br><br>区间[0x00426F85, 0x0042712B]是生成子密钥步骤里(7)中对S Box计算的部分.这里是一个二层嵌套循环,外层控制当前对哪个S Box操作,内层是对单个S Box的遍历和计算.其中内层也是一个对Blowfish加密算法的实现,本质上跟前面生成P Box的部分一样,只不过16次函数F的使用全部都是对0x00426540的调用而没有展开.<br><br>继续往下,[0x00427131, 0x00427540]区间内的代码终于是真正的Blowfish解密算法的实现了.基本上与算法描述里一样,不过函数F的使用全部都inline展开了.因为我在知道了密钥被取补之后在标准Blowfish上改进并实验发觉还是不能正确计算出解开的密文,于是在这里重点跟踪.还记得32位数据进入函数F后会被分为4部分,每个8位的数据来处理吗? 跟踪发现一开始数据是一样的但是endian反了,于是后面的用来在S Box里寻址的顺序就反了.于是就...都错了.诶总之知道哪里错了就好解决了.<br><br>到底是怎么出现这么诡异的代码呢? 如果minori那边的人都没问题清楚的知道Blowfish的特点的话,说不定他们把initialize和内部用的_encrypt给写成inline的了,结果大量的被编译器展开...结果反而更慢了 (汗<br><br><br>对应于minori的这种实现,一个简单(但是很慢)的实现可以如下:<br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code1'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code1" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> decrypt</span><span class="pun">(</span><span class="pln">
 &nbsp;  </span><span class="kwd">byte</span><span class="pun">[]</span><span class="pln"> inbuf</span><span class="pun">,</span><span class="pln">
 &nbsp;  </span><span class="kwd">int</span><span class="pln"> inpos</span><span class="pun">,</span><span class="pln">
 &nbsp;  </span><span class="kwd">byte</span><span class="pun">[]</span><span class="pln"> outbuf</span><span class="pun">,</span><span class="pln">
 &nbsp;  </span><span class="kwd">int</span><span class="pln"> outpos</span><span class="pun">,</span><span class="pln">
 &nbsp;  </span><span class="kwd">int</span><span class="pln"> len</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
 &nbsp;  len </span><span class="pun">-=</span><span class="pln"> len </span><span class="pun">%</span><span class="pln"> BLOCKSIZE</span><span class="pun">;</span><span class="pln">

 &nbsp;  </span><span class="kwd">int</span><span class="pln"> c </span><span class="pun">=</span><span class="pln"> inpos </span><span class="pun">+</span><span class="pln"> len</span><span class="pun">;</span><span class="pln">

 &nbsp;  </span><span class="kwd">int</span><span class="pln"> xL</span><span class="pun">,</span><span class="pln"> xR</span><span class="pun">;</span><span class="pln"> </span><span class="com">// hi is xL, lo is xR</span><span class="pln">

 &nbsp;  </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">inpos </span><span class="pun">&lt;</span><span class="pln"> c</span><span class="pun">)</span><span class="pln">
 &nbsp;  </span><span class="pun">{</span><span class="pln"> &nbsp;  &nbsp;  &nbsp;  &nbsp; 
 &nbsp;  &nbsp;   xL  </span><span class="pun">=</span><span class="pln">  inbuf</span><span class="pun">[</span><span class="pln">inpos</span><span class="pun">++]</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">24</span><span class="pun">;</span><span class="pln">
 &nbsp;  &nbsp;   xL </span><span class="pun">|=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">inbuf</span><span class="pun">[</span><span class="pln">inpos</span><span class="pun">++]</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">16</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">0x0ff0000</span><span class="pun">;</span><span class="pln">
 &nbsp;  &nbsp;   xL </span><span class="pun">|=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">inbuf</span><span class="pun">[</span><span class="pln">inpos</span><span class="pun">++]</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln">  </span><span class="lit">8</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">0x000ff00</span><span class="pun">;</span><span class="pln">
 &nbsp;  &nbsp;   xL </span><span class="pun">|=</span><span class="pln">  inbuf</span><span class="pun">[</span><span class="pln">inpos</span><span class="pun">++]</span><span class="pln"> &nbsp;  &nbsp;   </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">0x00000ff</span><span class="pun">;</span><span class="pln">

 &nbsp;  &nbsp;   xR  </span><span class="pun">=</span><span class="pln">  inbuf</span><span class="pun">[</span><span class="pln">inpos</span><span class="pun">++]</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">24</span><span class="pun">;</span><span class="pln">
 &nbsp;  &nbsp;   xR </span><span class="pun">|=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">inbuf</span><span class="pun">[</span><span class="pln">inpos</span><span class="pun">++]</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">16</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">0x0ff0000</span><span class="pun">;</span><span class="pln">
 &nbsp;  &nbsp;   xR </span><span class="pun">|=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">inbuf</span><span class="pun">[</span><span class="pln">inpos</span><span class="pun">++]</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln">  </span><span class="lit">8</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">0x000ff00</span><span class="pun">;</span><span class="pln">
 &nbsp;  &nbsp;   xR </span><span class="pun">|=</span><span class="pln">  inbuf</span><span class="pun">[</span><span class="pln">inpos</span><span class="pun">++]</span><span class="pln"> &nbsp;  &nbsp;   </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">0x00000ff</span><span class="pun">;</span><span class="pln">

 &nbsp;  &nbsp;   xL </span><span class="pun">=</span><span class="pln"> reverseEndian</span><span class="pun">(</span><span class="pln">xL</span><span class="pun">);</span><span class="pln">
 &nbsp;  &nbsp;   xR </span><span class="pun">=</span><span class="pln"> reverseEndian</span><span class="pun">(</span><span class="pln">xR</span><span class="pun">);</span><span class="pln">
 &nbsp;  &nbsp;  &nbsp;  &nbsp; 
 &nbsp;  &nbsp;   </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">17</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> </span><span class="pun">--</span><span class="pln">i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  
 &nbsp;  &nbsp;  &nbsp;  &nbsp; xL </span><span class="pun">^=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">pbox</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
 &nbsp;  &nbsp;  &nbsp;  &nbsp; xR </span><span class="pun">^=</span><span class="pln"> </span><span class="pun">((((</span><span class="pln">sbox1</span><span class="pun">[</span><span class="pln">xL </span><span class="pun">&gt;&gt;&gt;</span><span class="pln"> </span><span class="lit">24</span><span class="pun">])</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">sbox2</span><span class="pun">[(</span><span class="pln">xL </span><span class="pun">&gt;&gt;&gt;</span><span class="pln"> </span><span class="lit">16</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">0x0FF</span><span class="pun">]))</span><span class="pln">
 &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;   </span><span class="pun">^</span><span class="pln"> </span><span class="pun">(</span><span class="pln">sbox3</span><span class="pun">[(</span><span class="pln">xL </span><span class="pun">&gt;&gt;&gt;</span><span class="pln"> </span><span class="lit">8</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">0x0FF</span><span class="pun">]))</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">sbox4</span><span class="pun">[</span><span class="pln">xL </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">0x0FF</span><span class="pun">]));</span><span class="pln">
 &nbsp;  &nbsp;  &nbsp;  &nbsp;  &nbsp;  
 &nbsp;  &nbsp;  &nbsp;  &nbsp; </span><span class="kwd">int</span><span class="pln"> temp </span><span class="pun">=</span><span class="pln"> xL</span><span class="pun">;</span><span class="pln">
 &nbsp;  &nbsp;  &nbsp;  &nbsp; xL </span><span class="pun">=</span><span class="pln"> xR</span><span class="pun">;</span><span class="pln">
 &nbsp;  &nbsp;  &nbsp;  &nbsp; xR </span><span class="pun">=</span><span class="pln"> temp</span><span class="pun">;</span><span class="pln">
 &nbsp;  &nbsp;   </span><span class="pun">}</span><span class="pln">
 &nbsp;  &nbsp;  &nbsp;  &nbsp; 
 &nbsp;  &nbsp;   xR </span><span class="pun">^=</span><span class="pln"> pbox</span><span class="pun">[</span><span class="lit">0</span><span class="pun">];</span><span class="pln">
 &nbsp;  &nbsp;   xL </span><span class="pun">^=</span><span class="pln"> pbox</span><span class="pun">[</span><span class="lit">1</span><span class="pun">];</span><span class="pln">
 &nbsp;  &nbsp;  &nbsp;  &nbsp; 
 &nbsp;  &nbsp;   xL </span><span class="pun">=</span><span class="pln"> reverseEndian</span><span class="pun">(</span><span class="pln">xL</span><span class="pun">);</span><span class="pln">
 &nbsp;  &nbsp;   xR </span><span class="pun">=</span><span class="pln"> reverseEndian</span><span class="pun">(</span><span class="pln">xR</span><span class="pun">);</span><span class="pln">
 &nbsp;  &nbsp;  &nbsp;  &nbsp; 
 &nbsp;  &nbsp;   outbuf</span><span class="pun">[</span><span class="pln">outpos</span><span class="pun">++]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">byte</span><span class="pun">)(</span><span class="pln">xR </span><span class="pun">&gt;&gt;&gt;</span><span class="pln"> </span><span class="lit">24</span><span class="pun">);</span><span class="pln">
 &nbsp;  &nbsp;   outbuf</span><span class="pun">[</span><span class="pln">outpos</span><span class="pun">++]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">byte</span><span class="pun">)(</span><span class="pln">xR </span><span class="pun">&gt;&gt;&gt;</span><span class="pln"> </span><span class="lit">16</span><span class="pun">);</span><span class="pln">
 &nbsp;  &nbsp;   outbuf</span><span class="pun">[</span><span class="pln">outpos</span><span class="pun">++]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">byte</span><span class="pun">)(</span><span class="pln">xR </span><span class="pun">&gt;&gt;&gt;</span><span class="pln"> </span><span class="lit">8</span><span class="pun">);</span><span class="pln">
 &nbsp;  &nbsp;   outbuf</span><span class="pun">[</span><span class="pln">outpos</span><span class="pun">++]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">byte</span><span class="pun">)</span><span class="pln"> xR</span><span class="pun">;</span><span class="pln">

 &nbsp;  &nbsp;   outbuf</span><span class="pun">[</span><span class="pln">outpos</span><span class="pun">++]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">byte</span><span class="pun">)(</span><span class="pln">xL </span><span class="pun">&gt;&gt;&gt;</span><span class="pln"> </span><span class="lit">24</span><span class="pun">);</span><span class="pln">
 &nbsp;  &nbsp;   outbuf</span><span class="pun">[</span><span class="pln">outpos</span><span class="pun">++]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">byte</span><span class="pun">)(</span><span class="pln">xL </span><span class="pun">&gt;&gt;&gt;</span><span class="pln"> </span><span class="lit">16</span><span class="pun">);</span><span class="pln">
 &nbsp;  &nbsp;   outbuf</span><span class="pun">[</span><span class="pln">outpos</span><span class="pun">++]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">byte</span><span class="pun">)(</span><span class="pln">xL </span><span class="pun">&gt;&gt;&gt;</span><span class="pln"> </span><span class="lit">8</span><span class="pun">);</span><span class="pln">
 &nbsp;  &nbsp;   outbuf</span><span class="pun">[</span><span class="pln">outpos</span><span class="pun">++]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">byte</span><span class="pun">)</span><span class="pln"> xL</span><span class="pun">;</span><span class="pln">
 &nbsp;  </span><span class="pun">}</span><span class="pln">
 &nbsp;  </span><span class="kwd">return</span><span class="pln"> len</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></pre><br>其中reverseEndian()就是为了解决endian不匹配的问题...诶.对应的,initialize()和encrypt()里都需要做同样的reverseEndian操作.<br>要让这个简单的实现变快,思路就是把能展开的循环都展开,然后能不使用数组寻址而使用局部变量的地方就尽量这么做.<div id="alert_871540" style="color: gray; margin-top: 30px; --darkreader-inline-color:#bfb9ac;" data-darkreader-inline-color="">[ 此贴被rednaxela在2006-12-03 20:14重新编辑 ]</div></div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_871540" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2006-11-30 20:28 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 11楼(rednaxela) 的帖子');" data-mx-warn="Empty URL">11 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="873908" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570947647-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>vaststars</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=70471" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570947647-bc3b3631a24154c2d9ba8189508a5212.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_12"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空新生</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570947647-be59bc9a4edb96b6b54ba67c9267b93f.gif"><br>

<span class="user-info2" id="showface_12">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">29</span><br>
学分: <span class="s2 f9">0 点</span><br>
澄空币: <span class="s3 f9">978 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2006-10-24<br>
		最后登录:2014-09-18 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_873908" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=208251&amp;pid=873908&amp;article=12" onclick="return sendurl(this,4,event)" id="quote_873908" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=208251&amp;pid=873908&amp;article=12" id="modify_873908" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=70471" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=208251&amp;pid=873908" onclick="return sendurl(this,8)" id="report_873908" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=208251&amp;uid=70471" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('873908')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_873908" class="fl">&nbsp;</h1>
			

			<div id="p_873908" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_873908">天那，拜一下写文章的</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_873908" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2006-12-02 16:45 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 12楼(vaststars) 的帖子');" data-mx-warn="Empty URL">12 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="878863" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570947647-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>rednaxela</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=9227" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570947647-ce00c7df760cd0b54791980099058989.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_13"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空三年生上学期</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570947647-5fc5bacf4fd91c54a5fe72c4ceff18fa.gif"><br>

<span class="user-info2" id="showface_13">
<span class="user-infoWrap2">


精华:

		<a href="https://bbs.sumisora.net/search.php?authorid=9227&amp;digest=1" target="_blank" class="s4 f9" referrerpolicy="no-referrer" rel="noopener noreferrer">5</a>
<br>
发帖: <span class="s1 f9">375</span><br>
学分: <span class="s2 f9">35 点</span><br>
澄空币: <span class="s3 f9">895 KID</span><br>

		GPA: <span class="s2 f9">7 点</span><br>

		<span class="gray">注册时间:2005-04-15<br>
		最后登录:2016-04-07 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_878863" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=208251&amp;pid=878863&amp;article=13" onclick="return sendurl(this,4,event)" id="quote_878863" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=208251&amp;pid=878863&amp;article=13" id="modify_878863" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=9227" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=208251&amp;pid=878863" onclick="return sendurl(this,8)" id="report_878863" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=208251&amp;uid=9227" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('878863')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_878863" class="fl">&nbsp;</h1>
			

			<div id="p_878863" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_878863">之前有人问FFD里的key...好吧发在这里了.下面可能有点乱,看的话注意一下顺序吧 (偶懒,不想整理了...<br><br>0012FBB4 &nbsp; 00BB6019  |FileName = "H:\minori\ef_FFD\save\sysparams.txt"<br><br>0012FDDC &nbsp; 00BB9868  |FileName = "H:\minori\ef_FFD\save\system.dat"<br><br>0012FDD0 &nbsp; 00BB9868  |FileName = "H:\minori\ef_FFD\save\system.dat"<br><br>004DD5AC  6D 69 6E 6F 72 69 &nbsp;  &nbsp;   minori<br><br>0012FE98 &nbsp; 00BBFF51  |FileName = "H:\minori\ef_FFD\save\test.tst"<br><br>004DB100  9C D4 50 29 8F 0A 0B 33 <br>004DB108  9F 85 E8 D8 AE 59 72 03 <br>004DB110  42 21 5A 25 78 1E 0D 6B <br>004DB118  79 E4 AC D1 22 55 22 F0 <br><br>004DB240  67 71 7C 99 60 31 C8 70 <br>004DB248  98 91 DF A1 4E 8A A5 12 <br>004DB250  19 8A 52 A2 D4 94 09 55 <br>004DB258  17 F0 D5 75 DF 22 B3 55 <br><br>0012FD58 &nbsp; 011735B1  |FileName = "H:\minori\ef_FFD\scr.paz"<br><br>004DB120  AF A7 0C 31 21 35 49 28 <br>004DB128  1C DB DF E8 05 A4 FE F1 <br>004DB130  1C 7E E0 9E 4F B8 40 AA <br>004DB138  8C 16 36 B6 4C 26 24 6A <br><br>004DB260  35 F4 8B 89 9B 42 B1 40 <br>004DB268  E2 5D D3 97 51 B4 F8 8B <br>004DB270  B4 84 60 60 3A 63 FF 2E <br>004DB278  BE 46 52 60 5A DF 53 D8 <br><br>0012FD58 &nbsp; 011738D9  |FileName = "H:\minori\ef_FFD\bg.paz"<br><br>004DB140  AF A7 0C 31 21 35 49 28 <br>004DB148  1C DB DF E8 05 A4 FE F1 <br>004DB150  1C 7E E0 9E 4F B8 40 AA <br>004DB158  8C 16 36 B6 4C 26 24 6A <br><br>004DB280  35 F4 8B 89 9B 42 B1 40 <br>004DB288  E2 5D D3 97 51 B4 F8 8B <br>004DB290  B4 84 60 60 3A 63 FF 2E <br>004DB298  BE 46 52 60 5A DF 53 D8 <br><br>0012FD58 &nbsp; 0117FAA1  |FileName = "H:\minori\ef_FFD\bg.paz"<br><br>004DB160  1D A8 8B 0B E7 C0 70 3A <br>004DB168  AD B0 26 A2 88 E8 30 4B <br>004DB170  A1 16 00 64 E7 0D 51 2F <br>004DB178  3C 2D DE DB E7 20 37 10 <br><br>004DB2A0  EA 00 49 87 55 CF 30 29 <br>004DB2A8  4E 84 84 F4 4B 70 1D EB <br>004DB2B0  86 16 F5 A9 AC 08 7E 48 <br>004DB2B8  0E 5D 5A 45 12 60 2F 02 <br><br>0012FD58 &nbsp; 01189799  |FileName = "H:\minori\ef_FFD\st.paz"<br><br>004DB180  F6 A3 6B E0 6A 0E 57 E9 <br>004DB188  D4 7E 4B 5E 31 36 CD C0 <br>004DB190  C3 15 37 01 A9 DF F4 D8 <br>004DB198  EB 03 13 F5 CC B7 FF EF <br><br>004DB2C0  96 61 53 BC 19 3D 1C AC <br>004DB2C8  5B 81 7F 0F 37 D4 D9 E2 <br>004DB2D0  81 6A 8D 03 94 47 3B 82 <br>004DB2D8  69 0F 5B DC E1 1B EC E1 <br><br>0012FD58 &nbsp; 0118A879  |FileName = "H:\minori\ef_FFD\sys.paz"<br><br>004DB1A0  0C 21 09 97 F5 45 93 74 <br>004DB1A8  D3 83 9B 34 B9 62 5A BE <br>004DB1B0  32 67 C3 BC BE B3 9F 45 <br>004DB1B8  BA 34 03 7C 95 1E E3 D8 <br><br>004DB2E0  0B A3 08 0E 30 AE 08 06 <br>004DB2E8  4C 8F 11 00 CF B2 B2 DF <br>004DB2F0  55 6C 66 B8 1C A3 AC 7C <br>004DB2F8  F1 F8 82 9C 5F 41 F1 47 <br><br>0012FD58 &nbsp; 0118FBB9  |FileName = "H:\minori\ef_FFD\bgm.paz"<br><br>004DB1C0  F1 70 82 D7 8F 47 7A DB <br>004DB1C8  AB B8 25 FB 99 00 1E 76 <br>004DB1D0  61 B6 A1 9B 10 CB 87 D5 <br>004DB1D8  8B 1C 9A A8 9B 49 08 5B <br><br>004DB300  DB 11 84 26 A3 06 4C 38 <br>004DB308  22 AB 48 9D 8B 9E ED 11 <br>004DB310  75 C9 7D CD 2D 60 07 96 <br>004DB318  85 74 BD BD E7 C8 64 C2 <br><br>0012FD58 &nbsp; 0118FCC1  |FileName = "H:\minori\ef_FFD\voice.paz"<br><br>004DB1E0  F6 9B B5 07 04 B7 22 DD <br>004DB1E8  1D DA B5 4A 0C 64 1D D7 <br>004DB1F0  81 6F 90 67 49 2C A3 A8 <br>004DB1F8  FF D7 86 71 F9 EB 54 C6 <br><br>004DB320  57 B7 A6 6B 3C E9 FB 01 <br>004DB328  9E 8F F2 80 A5 EB 90 69 <br>004DB330  12 EB 90 0A 70 82 41 EF <br>004DB338  CA 9F B9 36 92 61 28 A1 <br><br>0012FD58 &nbsp; 0119B2B9  |FileName = "H:\minori\ef_FFD\se.paz"<br><br>004DB200  F6 9B B5 07 04 B7 22 DD <br>004DB208  1D DA B5 4A 0C 64 1D D7 <br>004DB210  81 6F 90 67 49 2C A3 A8 <br>004DB218  FF D7 86 71 F9 EB 54 C6 <br><br>004DB340  57 B7 A6 6B 3C E9 FB 01 <br>004DB348  9E 8F F2 80 A5 EB 90 69 <br>004DB350  12 EB 90 0A 70 82 41 EF <br>004DB358  CA 9F B9 36 92 61 28 A1 <br><br>0012FD58 &nbsp; 0119B3C1  |FileName = "H:\minori\ef_FFD\se.paz"<br><br>004DB220  2D 6D 3E 50 DB F9 5F F9 <br>004DB228  AC 64 D9 7A 0B A1 1E 91 <br>004DB230  83 BC 0B A7 D2 99 A7 9E <br>004DB238  78 3F 35 8D 87 77 6B 2A <br><br>004DB360  91 60 0A 03 84 BA ED E1 <br>004DB368  42 B7 9C FE 17 AE 5F 94 <br>004DB370  1D FD 1C F8 4F CB 0F 66 <br>004DB378  1E 53 E3 C0 3A 81 E4 F5 <br><br>0012FD58 &nbsp; 0119BAB9  |FileName = "H:\minori\ef_FFD\mov.paz"</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_878863" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2006-12-06 10:16 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 13楼(rednaxela) 的帖子');" data-mx-warn="Empty URL">13 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="881891" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570947647-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>朝比奈みくる</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=15346" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570947647-26c3a95d3af382856634a07ee774ce67.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_14"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空二年生下学期</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570947647-14d3050259d6ae6cb4b43275cd83308d.gif"><br>

<span class="user-info2" id="showface_14">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">70</span><br>
学分: <span class="s2 f9">36 点</span><br>
澄空币: <span class="s3 f9">2795 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2005-07-25<br>
		最后登录:2012-02-21 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_881891" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=208251&amp;pid=881891&amp;article=14" onclick="return sendurl(this,4,event)" id="quote_881891" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=208251&amp;pid=881891&amp;article=14" id="modify_881891" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=15346" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=208251&amp;pid=881891" onclick="return sendurl(this,8)" id="report_881891" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=208251&amp;uid=15346" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('881891')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_881891" class="fl">&nbsp;</h1>
			

			<div id="p_881891" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_881891">不错，哈哈，我也要试试看</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_881891" class="c"></div>

		<div><img class="signature" src="assets/1570947647-f23b8ffd0b6b327441aa828c9cd3243d.gif" align="absbottom"></div>
		<div class="signature" style="max-height:380px;maxHeight:380px; overflow:hidden;"><table width="100%"><tbody><tr><td>我是朝比奈みくる~<br><span class="highslide"><img src="assets/1570947647-9086c33e534204a443c5786eae7c446b.gif" border="0" style="max-width: 100%;max-height: 900px;"></span><br>PS2 AVG游戏专家<br>http://spaces.msn.com/members/dansha/</td><td></td></tr></tbody></table></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2006-12-09 01:43 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 14楼(朝比奈みくる) 的帖子');" data-mx-warn="Empty URL">14 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="882549" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570947647-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>朝比奈みくる</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=15346" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570947647-26c3a95d3af382856634a07ee774ce67.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_15"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空二年生下学期</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570947647-14d3050259d6ae6cb4b43275cd83308d.gif"><br>

<span class="user-info2" id="showface_15">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">70</span><br>
学分: <span class="s2 f9">36 点</span><br>
澄空币: <span class="s3 f9">2795 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2005-07-25<br>
		最后登录:2012-02-21 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_882549" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=208251&amp;pid=882549&amp;article=15" onclick="return sendurl(this,4,event)" id="quote_882549" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=208251&amp;pid=882549&amp;article=15" id="modify_882549" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=15346" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=208251&amp;pid=882549" onclick="return sendurl(this,8)" id="report_882549" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=208251&amp;uid=15346" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('882549')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_882549" class="fl">&nbsp;</h1>
			

			<div id="p_882549" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_882549">有没有这方面的破解群，我要加入 <img src="assets/1570947647-001cd37a87dbb11e6e09f6cc26d8ff24.gif"></div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_882549" class="c"></div>

		<div><img class="signature" src="assets/1570947647-f23b8ffd0b6b327441aa828c9cd3243d.gif" align="absbottom"></div>
		<div class="signature" style="max-height:380px;maxHeight:380px; overflow:hidden;"><table width="100%"><tbody><tr><td>我是朝比奈みくる~<br><span class="highslide"><img src="assets/1570947647-9086c33e534204a443c5786eae7c446b.gif" border="0" style="max-width: 100%;max-height: 900px;"></span><br>PS2 AVG游戏专家<br>http://spaces.msn.com/members/dansha/</td><td></td></tr></tbody></table></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2006-12-09 17:33 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 15楼(朝比奈みくる) 的帖子');" data-mx-warn="Empty URL">15 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="909731" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570947647-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>vaststars</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=70471" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570947647-bc3b3631a24154c2d9ba8189508a5212.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_16"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空新生</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570947647-be59bc9a4edb96b6b54ba67c9267b93f.gif"><br>

<span class="user-info2" id="showface_16">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">29</span><br>
学分: <span class="s2 f9">0 点</span><br>
澄空币: <span class="s3 f9">978 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2006-10-24<br>
		最后登录:2014-09-18 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_909731" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=208251&amp;pid=909731&amp;article=16" onclick="return sendurl(this,4,event)" id="quote_909731" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=208251&amp;pid=909731&amp;article=16" id="modify_909731" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=70471" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=208251&amp;pid=909731" onclick="return sendurl(this,8)" id="report_909731" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=208251&amp;uid=70471" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('909731')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_909731" class="fl">&nbsp;</h1>
			

			<div id="p_909731" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_909731">能不能再介绍下中文的显示部分，那样就完美了，拜读</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_909731" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2006-12-31 22:17 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 16楼(vaststars) 的帖子');" data-mx-warn="Empty URL">16 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="1017621" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570947647-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>卡哇伊Q君</b>
<div style="margin:.3em 0 .4em .2em">羊驼的</div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=103875" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570947647-3ebf8fa8eb8dc53c3fbd92710547d42a.jpg" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_17"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空字幕组</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570947647-b16950302a3de790ecbc217fc7e562d5.gif"><br>

<span class="user-info2" id="showface_17">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">112</span><br>
学分: <span class="s2 f9">36 点</span><br>
澄空币: <span class="s3 f9">540 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2007-03-21<br>
		最后登录:2016-09-29 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_1017621" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=208251&amp;pid=1017621&amp;article=17" onclick="return sendurl(this,4,event)" id="quote_1017621" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=208251&amp;pid=1017621&amp;article=17" id="modify_1017621" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=103875" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=208251&amp;pid=1017621" onclick="return sendurl(this,8)" id="report_1017621" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=208251&amp;uid=103875" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('1017621')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_1017621" class="fl">&nbsp;</h1>
			

			<div id="p_1017621" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_1017621">能沉着面对这么大串数字简直是神人了.........</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_1017621" class="c"></div>

		<div><img class="signature" src="assets/1570947647-f23b8ffd0b6b327441aa828c9cd3243d.gif" align="absbottom"></div>
		<div class="signature" style="max-height:380px;maxHeight:380px; overflow:hidden;"><table width="100%"><tbody><tr><td>世の中クソゲーだらけ<br>チーターマン俺ってチーターｗｗ</td><td></td></tr></tbody></table></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2007-03-24 14:29 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 17楼(卡哇伊Q君) 的帖子');" data-mx-warn="Empty URL">17 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="1063334" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570947647-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>junar</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=112211" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570947647-bc3b3631a24154c2d9ba8189508a5212.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_18"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空新生</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570947647-be59bc9a4edb96b6b54ba67c9267b93f.gif"><br>

<span class="user-info2" id="showface_18">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">4</span><br>
学分: <span class="s2 f9">0 点</span><br>
澄空币: <span class="s3 f9">1011 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2007-04-11<br>
		最后登录:2012-07-07 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_1063334" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=208251&amp;pid=1063334&amp;article=18" onclick="return sendurl(this,4,event)" id="quote_1063334" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=208251&amp;pid=1063334&amp;article=18" id="modify_1063334" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=112211" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=208251&amp;pid=1063334" onclick="return sendurl(this,8)" id="report_1063334" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=208251&amp;uid=112211" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('1063334')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_1063334" class="fl">&nbsp;</h1>
			

			<div id="p_1063334" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_1063334">以上的软件可否用于PS2游戏上面</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_1063334" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2007-05-14 05:42 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 18楼(junar) 的帖子');" data-mx-warn="Empty URL">18 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="1063671" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570947647-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>rednaxela</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=9227" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570947647-ce00c7df760cd0b54791980099058989.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_19"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空三年生上学期</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570947647-5fc5bacf4fd91c54a5fe72c4ceff18fa.gif"><br>

<span class="user-info2" id="showface_19">
<span class="user-infoWrap2">


精华:

		<a href="https://bbs.sumisora.net/search.php?authorid=9227&amp;digest=1" target="_blank" class="s4 f9" referrerpolicy="no-referrer" rel="noopener noreferrer">5</a>
<br>
发帖: <span class="s1 f9">375</span><br>
学分: <span class="s2 f9">35 点</span><br>
澄空币: <span class="s3 f9">895 KID</span><br>

		GPA: <span class="s2 f9">7 点</span><br>

		<span class="gray">注册时间:2005-04-15<br>
		最后登录:2016-04-07 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_1063671" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=208251&amp;pid=1063671&amp;article=19" onclick="return sendurl(this,4,event)" id="quote_1063671" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=208251&amp;pid=1063671&amp;article=19" id="modify_1063671" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=9227" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=208251&amp;pid=1063671" onclick="return sendurl(this,8)" id="report_1063671" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=208251&amp;uid=9227" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('1063671')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_1063671" class="fl">&nbsp;</h1>
			

			<div id="p_1063671" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_1063671">十六进制编辑器是通用的.另外那几个是Windows专用.<br>PS2的SDK不是公开的.机器的指令不公开,所以也没有公开的现成的工具来对PS2程序直接调试.</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_1063671" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2007-05-14 15:48 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 19楼(rednaxela) 的帖子');" data-mx-warn="Empty URL">19 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

</form>
<div class="t3" style="margin:initial"><table cellspacing="0" cellpadding="0" width="100%" align="center">
	<tbody><tr><td align="left"><div class="pages"><a href="https://bbs.sumisora.net/read.php?tid=208251&amp;fpage=9&amp;toread=&amp;page=1" style="font-weight:bold" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">«</a><b> 1 </b><a href="https://bbs.sumisora.net/read.php?tid=208251&amp;fpage=9&amp;toread=&amp;page=2" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">2</a><input type="text" size="3" onkeydown="javascript: if(event.keyCode==13){ location='read.php?tid=208251&amp;fpage=9&amp;toread=&amp;page='+this.value+'';return false;}"><a href="https://bbs.sumisora.net/read.php?tid=208251&amp;fpage=9&amp;toread=&amp;page=2" style="font-weight:bold" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">»</a> Pages: ( 1/2 total ) </div></td>
		<td valign="center" align="right">
		<a class="abtn f_two" id="readlog" onclick="sendmsg('pw_ajax.php?action=readlog','',this.id);" data-mx-warn="Empty URL">帖子浏览记录<img src="assets/1570947647-5c8e409588b73ce4284cf5b9bd619e15.gif"></a>
		<select onchange="Fjump(this.options[this.selectedIndex].value)"><option value="" selected="">快速跳至</option>
<option value="1">&gt;&gt; 『澄空学园 办公楼区』</option>
<option value="2"> &nbsp;|- 【校园公告栏】</option>
<option value="5"> &nbsp;|- 【论坛意见箱】</option>
<option value="113">&gt;&gt; 『澄空学园 资讯社』</option>
<option value="47"> &nbsp;|- 【新鲜速报】</option>
<option value="103"> &nbsp;|- 【新作介绍】</option>
<option value="8"> &nbsp; &nbsp;|-  【电子杂志下载区】</option>
<option value="104"> &nbsp;|- 【杂志专题】</option>
<option value="7">&gt;&gt; 『澄空学园 教学楼区』</option>
<option value="62"> &nbsp;|- 【AGE主题学部】</option>
<option value="39"> &nbsp;|- 【Akabeesoft2主题学部】</option>
<option value="100"> &nbsp;|- 【AUGUST主题学部】</option>
<option value="42"> &nbsp;|- 【CIRCUS主题学部】</option>
<option value="40"> &nbsp;|- 【Cotton-Nekoneko主题学部】</option>
<option value="64"> &nbsp;|- 【GIGA主题学部】</option>
<option value="38"> &nbsp;|- 【Key主题学部】</option>
<option value="10"> &nbsp;|- 【KID主题学部】</option>
<option value="37"> &nbsp;|- 【Leaf主题学部】</option>
<option value="70"> &nbsp;|- 【minori主题学部】</option>
<option value="12"> &nbsp;|- 【Navel主题学部】</option>
<option value="65"> &nbsp;|- 【Nitro+主题学部】</option>
<option value="14"> &nbsp;|- 【Type-Moon应援会】</option>
<option value="17"> &nbsp; &nbsp;|-  【TM精华区】</option>
<option value="98"> &nbsp;|- 【Will主题学部】</option>
<option value="116"> &nbsp;|- 【FAVORITE主题学部】</option>
<option value="108"> &nbsp;|- 【ALcot主题学部】</option>
<option value="55"> &nbsp;|- 【GALGAME综合作品讨论室】</option>
<option value="97"> &nbsp; &nbsp;|-  【Light主题学部】</option>
<option value="117"> &nbsp; &nbsp;|-  【CUFFS主题学部】</option>
<option value="15"> &nbsp; &nbsp;|-  【Liar Soft主题学部】</option>
<option value="57"> &nbsp; &nbsp;|-  【Purple 主题学部】</option>
<option value="13"> &nbsp; &nbsp;|-  【工画堂主题学部】</option>
<option value="35"> &nbsp;|- 【GALGAME综合杂谈室】</option>
<option value="99"> &nbsp;|- 【ぱれっと主题学部】</option>
<option value="122"> &nbsp;|- 【SAGA PLANETS研讨室】</option>
<option value="123"> &nbsp;|- 【Lump of Sugar 研讨室】</option>
<option value="86">&gt;&gt; 『澄空学园 图书馆』</option>
<option value="80"> &nbsp;|- 【游戏鉴赏室】</option>
<option value="56"> &nbsp;|- 【GALGAME攻略馆】</option>
<option value="115"> &nbsp;|- 【作品出处问询室】</option>
<option value="63"> &nbsp;|- 【Galgame疑问求助室】</option>
<option value="18">&gt;&gt; 『澄空学园 教辅楼区』</option>
<option value="73"> &nbsp;|- 【同人游戏区】</option>
<option value="60"> &nbsp;|- 【二次元轻小说社】</option>
<option value="20"> &nbsp;|- 【日语自学教室】</option>
<option value="61"> &nbsp; &nbsp;|-  【日语学习资料区】</option>
<option value="118"> &nbsp; &nbsp;|-  【日语参考文章区】</option>
<option value="21"> &nbsp;|- 【一般游戏社团】</option>
<option value="24"> &nbsp;|- 【多媒体课堂】</option>
<option value="88">&gt;&gt; 『澄空学园 原创综合区』</option>
<option value="79"> &nbsp;|- 【原创游戏部】</option>
<option value="36"> &nbsp; &nbsp;|-  【ss-square】</option>
<option value="89"> &nbsp;|- 【MAD研究室】</option>
<option value="91"> &nbsp;|- 【莉可屋 REC ROOM】</option>
<option value="119"> &nbsp; &nbsp;|-  【澄空百合社翻唱作品】</option>
<option value="19"> &nbsp;|- 【澄空文学部】</option>
<option value="120"> &nbsp; &nbsp;|-  【落日余晖】</option>
<option value="23"> &nbsp;|- 【绘画工房】</option>
<option value="69"> &nbsp;|- 【活动投票区】</option>
<option value="74"> &nbsp;|- 【友谊赛投票区】</option>
<option value="58"> &nbsp;|- 【澄空部活室】</option>
<option value="41"> &nbsp;|- 【暑假原创作品活动专区】</option>
<option value="59"> &nbsp;|- 【实物周边交流区】</option>
<option value="85"> &nbsp; &nbsp;|-  【ComicMarket相关资料】</option>
<option value="82"> &nbsp; &nbsp;|-  【新品介绍】</option>
<option value="84"> &nbsp; &nbsp;|-  【综合交流】</option>
<option value="83"> &nbsp; &nbsp;|-  【好物收集】</option>
<option value="81"> &nbsp; &nbsp;|-  【交易求购】</option>
<option value="95"> &nbsp;|- 【澄空放送部】</option>
<option value="111"> &nbsp; &nbsp;|-  【放送策划室】</option>
<option value="27"> &nbsp;|- 【水下乐园LeMU】</option>
<option value="46"> &nbsp; &nbsp;|-  【美工作品收藏室】</option>
<option value="26"> &nbsp; &nbsp;|-  【COS自爆馆】</option>
<option value="90"> &nbsp; &nbsp;|-  【澄空期刊室】</option>
<option value="71"> &nbsp;|- 【澄空演剧部】</option>
<option value="9"> &nbsp; &nbsp;|-  演剧部排练室</option>
<option value="52"> &nbsp;|- 【废帖回收站】</option>
<option value="29">&gt;&gt; 『澄空学园 好物交流站』</option>
<option value="50"> &nbsp;|- 【澄空学园字幕作品】</option>
<option value="51"> &nbsp;|- 【澄空学园漫画作品】</option>
<option value="77"> &nbsp;|- 【游戏汉化交流区】</option>
<option value="28"> &nbsp; &nbsp;|-  【CK-GAL中文化小组】</option>
<option value="106"> &nbsp; &nbsp;|-  【PRO2】</option>
<option value="49"> &nbsp; &nbsp;|-      【桜】</option>
<option value="30"> &nbsp;|- 【资源求助区】</option>
<option value="32"> &nbsp;|- 【澄空音乐厅】</option>
<option value="33"> &nbsp;|- 【澄空美术馆】</option>
<option value="34"> &nbsp;|- 【动漫租售屋】</option>
<option value="44">&gt;&gt; 『澄空学园 课余工作区』</option>
<option value="45"> &nbsp;|- 【澄空漫画汉化组】</option>
<option value="48"> &nbsp;|-  【澄空学园字幕组】</option>
<option value="101"> &nbsp; &nbsp;|-  字幕组资料区</option>
<option value="72"> &nbsp;|- 【澄空学园分流组】</option>
<option value="87"> &nbsp;|- 【澄空学园新闻组】</option>
<option value="96"> &nbsp;|- 【澄空学园文学社】</option>
<option value="75"> &nbsp;|- 【澄空学园百合社】</option>
<option value="112"> &nbsp;|- 【澄空学园编辑部】</option>
<option value="114"> &nbsp;|- 【澄空学园美工部】</option>
<option value="121"> &nbsp;|-  【澄空祭运行委员会】</option>
</select></td>
		
	</tr>
	<tr><td style="padding-top: 12px;text-align: left;"><img src="assets/1570947647-ca4a91079181c2a5cb3514b2e5b5f035.gif" align="absbottom"> <b><a href="https://bbs.sumisora.net/index.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">『澄空学园』</a> » <a href="https://bbs.sumisora.net/thread.php?fid=78&amp;page=9" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">【汉化破解研讨室】</a></b> </td>
	<td style="padding-top: 12px;text-align: right;"><a href="https://bbs.sumisora.net/post.php?action=reply&amp;fid=78&amp;tid=208251" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img src="assets/1570947647-132cb83b134d7ecd9b390389d489bc43.png"></a>

<a href="https://bbs.sumisora.net/post.php?fid=78" style="margin-left:.5em" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img src="assets/1570947647-8cab7ee31ae503cf78e5410d40cec291.png" id="td_post1"></a>
</td>
	</tr>
</tbody></table></div>




<form name="FORM" method="post" action="post.php?" enctype="multipart/form-data" onsubmit="return checkpost(document.FORM);">
<div class="t" style="margin-top:8px"><table cellspacing="0" cellpadding="0" align="center" width="100%">
	<tbody><tr>
		<td class="h" colspan="3"><b>快速发帖</b></td>
	</tr>
	<tr></tr>
	<tr class="tr2"><td colspan="100" style="border-bottom: 0px; --darkreader-inline-border-bottom: initial;" data-darkreader-inline-border-bottom=""></td></tr>
	<tr>
		<td valign="top" width="20%" class="f_one" style="padding:7px">
		<fieldset id="smiliebox" style="border: 1px solid rgb(213, 229, 232); --darkreader-inline-border-top:#354e51; --darkreader-inline-border-right:#354e51; --darkreader-inline-border-bottom:#354e51; --darkreader-inline-border-left:#354e51;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
		<legend>内容</legend>
		<br>
		<input type="checkbox" name="atc_usesign" value="1" checked="">使用签名<br>
		<input type="checkbox" name="atc_convert" value="1" checked="">Wind Code自动转换 <br>
	 	<input type="checkbox" id="atc_autoimg" name="atc_autoimg" value="1" onchange="onAutoImgchange()" checked="" title="此设置会记在浏览器中"><label for="atc_autoimg" title="此设置会记在浏览器中">自动分析img</label><br><br>
	 	
		<input type="checkbox" name="atc_requiresell" value="1" disabled="">出售此帖
		<input class="input" type="text" maxlength="3" size="3" name="atc_money" value="0">
		<br>
		<input type="checkbox" name="atc_requirervrc" value="1">加密此帖
		<input class="input" type="text" maxlength="6" size="3" name="atc_rvrc" value="0">
		<br>
		<br><br><a href="https://bbs.sumisora.net/read.php?tid=10925672" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">如何在帖子中贴图？</a>
		<br><a href="https://bbs.sumisora.net/read.php?tid=10942243" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Wind Code使用教程</a>
		<br><a href="https://bbs.sumisora.net/yume/recover/" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">恢复帖子内容</a>
		</fieldset>
		</td>
		<td width="60%" class="f_one" style="padding:7px">
		<div>


<blockquote style="width: 96%;" class="blockquote">澄空娘：『发帖前不看版规什么的，最讨厌了！
』</blockquote>

		<input type="text" class="input" name="atc_title" value="Re:[原创]以ef - the first tale. / Trial Version中资源文件的加密的解析简单介绍几个工具" size="65">
		

		 认证码: <input class="input" type="text" name="gdcode" size="5" tabindex="6" onfocus="try{opencode('menu_gd',this)}catch(e){}"><br>
		

		</div><div style="padding:.3em 0">
		</div>
		<textarea onkeydown="quickpost(event)" id="atc_content" name="atc_content" rows="8" style="width:96%"></textarea>
		
		
		
		
		
		<div style="margin:5px 0">
		<div style="padding: 4px 10px 0px 0px; float: left; color: rgb(136, 136, 136); --darkreader-inline-color:#bfb9ac;" data-darkreader-inline-color="">按 Ctrl+Enter 直接提交</div>
		<input class="btn" type="submit" name="Submit" value=" 提 交 "></div>
		</td>
		<td width="20%" class="f_one">
		<div style="padding:3px; text-align:center; width:200px;">
		<fieldset id="smiliebox" style="border: 1px solid rgb(213, 229, 232); --darkreader-inline-border-top:#354e51; --darkreader-inline-border-right:#354e51; --darkreader-inline-border-bottom:#354e51; --darkreader-inline-border-left:#354e51;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<legend>表情</legend>
			<div id="menu_show"></div>
<span style="float:right; margin:3px 10px 5px;"><a id="td_face" style="cursor:pointer;" onclick="showDefault();" align="absmiddle" unselectable="on" data-mx-warn="Empty URL">[更多]</a></span>
<span style="float:left; margin:3px 10px 5px;"><a id="td_generalface" style="cursor:pointer;" onclick="showfaces();$('#td_generalface').fadeOut();" align="absmiddle" data-mx-warn="Empty URL">[显示表情]</a></span>
		</fieldset></div>
		
		
		</td>
	</tr>
</tbody></table></div></form>







</div>
<div id="bottom"></div><br>
<center class="gray">
<small><span id="windspend">Total 0.068319(s) query 6, Time is now 10-13 14:13, 
Load is low.
</span> <br>
Powered by <a href="http://www.phpwind.net/" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><b>PHPWind</b></a> <a href="http://www.phpwind.net/" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><b style="color: rgb(255, 153, 0); --darkreader-inline-color:#f7b24b;" data-darkreader-inline-color="">v6.3.2</b></a> Code © 2003-08 <a href="http://www.phpwind.com/" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><b>PHPWind.com</b></a> Corporation</small>
</center><br>
<div id="footer">
	<span class="f12 fl"></span><a href="https://bbs.sumisora.net/sendmail.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Contact us</a>

</div>
</div>
        
      </div>
    </body>
  </html>