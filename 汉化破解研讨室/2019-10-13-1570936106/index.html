
  <!DOCTYPE html>
  <html id="" class="">
    <!-- OriginalSrc: https://bbs.sumisora.net/read.php?tid=10874064&fpage=13 -->
    <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />

      <title>关于ef - the first tale 的破解问题|【汉化破解研讨室】|【游戏汉化交流区】 - 『澄空学园』 GalGame专题网</title>
      

<link rel="stylesheet" type="text/css" href="assets/1570936106-5f21d2d0f0e14c54e3e080ff47c8ec08.css" referrerpolicy="no-referrer">
<link type="text/css" href="assets/1570936106-2f10d407050ab6b2185fb483267feb32.css" rel="stylesheet" referrerpolicy="no-referrer">
<link href="assets/1570936106-6ea61090578ddc8e91dc9b26707cebc8.css" rel="stylesheet" type="text/css" referrerpolicy="no-referrer">
<link rel="stylesheet" type="text/css" href="assets/1570936106-46d427da9cafb653c4ed606490c99b3a.css" referrerpolicy="no-referrer">


<style class="darkreader darkreader--fallback" media="screen"></style>
<style class="darkreader darkreader--text" media="screen"></style>
<style class="darkreader darkreader--invert" media="screen"></style>
<style class="darkreader darkreader--inline" media="screen">[data-darkreader-inline-bgcolor] {
  background-color: var(--darkreader-inline-bgcolor) !important;
}
[data-darkreader-inline-bgimage] {
  background-image: var(--darkreader-inline-bgimage) !important;
}
[data-darkreader-inline-border] {
  border-color: var(--darkreader-inline-border) !important;
}
[data-darkreader-inline-border-bottom] {
  border-bottom-color: var(--darkreader-inline-border-bottom) !important;
}
[data-darkreader-inline-border-left] {
  border-left-color: var(--darkreader-inline-border-left) !important;
}
[data-darkreader-inline-border-right] {
  border-right-color: var(--darkreader-inline-border-right) !important;
}
[data-darkreader-inline-border-top] {
  border-top-color: var(--darkreader-inline-border-top) !important;
}
[data-darkreader-inline-boxshadow] {
  box-shadow: var(--darkreader-inline-boxshadow) !important;
}
[data-darkreader-inline-color] {
  color: var(--darkreader-inline-color) !important;
}
[data-darkreader-inline-fill] {
  fill: var(--darkreader-inline-fill) !important;
}
[data-darkreader-inline-stroke] {
  stroke: var(--darkreader-inline-stroke) !important;
}
[data-darkreader-inline-outline] {
  outline-color: var(--darkreader-inline-outline) !important;
}</style>
<style class="darkreader darkreader--user-agent" media="screen">html {
    background-color: #191a1b !important;
}
html, body, input, textarea, select, button {
    background-color: #191a1b;
}
html, body, input, textarea, select, button {
    border-color: #5a5956;
    color: #f0ebe2;
}
a {
    color: #4791e7;
}
table {
    border-color: #4f4e4c;
}
::placeholder {
    color: #bfb9ac;
}
::selection {
    background-color: #125cb4;
    color: #fffffd;
}
::-moz-selection {
    background-color: #125cb4;
    color: #fffffd;
}
input:-webkit-autofill,
textarea:-webkit-autofill,
select:-webkit-autofill {
    background-color: #565a0f !important;
    color: #f0ebe2 !important;
}
::-webkit-scrollbar {
    background-color: #1d1f1f;
    color: #cbc5b9;
}
::-webkit-scrollbar-thumb {
    background-color: #2c2d2d;
}
::-webkit-scrollbar-thumb:hover {
    background-color: #343636;
}
::-webkit-scrollbar-thumb:active {
    background-color: #404142;
}
::-webkit-scrollbar-corner {
    background-color: #191a1b;
}
* {
    scrollbar-color: #2c2d2d #1d1f1f;
}</style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style type="text/css"> 
.tr3 td,.tr3 th{border-right:1px solid #D5E5E8;}
.y-style{text-align:center;}
.tr1 th{border-right:1px solid #D5E5E8;}
.tr1 td.td1{border-left:0}
 

.signature img { max-height:250px !important; }
</style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style class="darkreader darkreader--override" media="screen">.jfk-bubble {
    background-color: #000000 !important;
}
.vimvixen-hint {
    background-color: #765500 !important;
    border-color: #d5b22e !important;
    color: #f9edcc !important;
}</style>
<style type="text/css">@keyframes fadeInOpacity{0%{opacity:0}to{opacity:1}}:hover>*>.fbvd--wrapper{animation-name:fadeInOpacity;animation-duration:.3s;opacity:1}.fbvd--wrapper{position:absolute;top:10px;left:10px;opacity:0;text-align:center;margin:0;z-index:5}.fbvd--wrapper a{background: url("") no-repeat 3px 4.55px; background-color: #fff; display:inline-block;font:700 14px Helvetica,Arial,sans-serif;color:#4b4f56;text-decoration:none;vertical-align:middle;padding:0px 8px 0px;margin-right:8px;border-radius:2px; line-height: 22px; padding-left:19px; border: 1px solid #e7e7e7; background-size: 13px}.fbvd--wrapper a:last-child{margin-right:0}.fbvd--wrapper a:hover{text-decoration:none}.fbvd--wrapper a:focus{box-shadow:0 0 1px 2px rgba(88,144,255,.75),0 1px 1px rgba(0,0,0,.15);outline:none}.fbvd--wrapper b{font-size:13px;position:relative;top:1px;color:#3b5998;font-weight:400}</style>
<style class="darkreader darkreader--sync" media="screen"></style>

      <style class="mx-wc-style">
        .mx-wc-main img {max-width: 100%;}
        .mx-wc-main{
          box-sizing: content-box;
          background-color: rgb(25, 26, 27) !important;
          margin: 0 auto;
          margin-top: 20px;
          max-width: 1349px;
        }
        @media (min-width: 768px) {
          .mx-wc-main { padding: 15px 15px 80px 15px }
        }
        @media (max-width: 767px) {
          .mx-wc-main { padding: 15px 3px 80px 3px }
        }
  
      </style>
    </head>
    <body style="background-color: #ffffff !important; min-height: 100%; height: auto; position: static !important; overflow: auto !important; padding-bottom: 0px !important;" id="" class="">
      <div class="mx-wc-main">
        <div id="wrapA" class="mx-wc-selected-elem mx-wc-1570936106" style="display: block; float: none !important; position: relative !important; top: 0px !important; left: 0px !important; margin: 0px !important; flex: unset !important; width: 100% !important; max-width: 100% !important; box-sizing: border-box !important;">

<div id="header">
<div class="toptool tar">	<span>
	<a href="https://bbs.sumisora.net/read.php?tid=10874064&amp;fpage=13&amp;skinco=simple" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">手机版</a>

	| <a style="cursor:pointer;" id="td_skin" data-mx-warn="Empty URL">风格切换<img src="assets/1570936106-5c8e409588b73ce4284cf5b9bd619e15.gif"></a>
	| <a href="https://bbs.sumisora.net/read.php?tid=10894912" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">学生手册</a>
	</span>
</div>
<table cellspacing="0" cellpadding="0" align="center" width="100%">
<tbody><tr>
	<td class="banner"><a href="https://bbs.sumisora.net/" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img id="forumlogo" src="assets/1570936106-7ac78a0e1e3ce795251288b0c8bd4b1b.png"></a></td>
	<td class="banner" id="banner" align="right"></td>
</tr>
<tr><td align="center" height="1" colspan="2"></td></tr>
</tbody></table>
<div id="h_guide" class="guide" colspan="2"><span class="s3">»</span>

	<span style="font-weight:bold" class="s3">silasu</span>&nbsp;<a href="https://bbs.sumisora.net/login.php?action=quit&amp;verify=034be2bd" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">退出</a> |
	<a id="td_profile" href="https://bbs.sumisora.net/profile.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">控制面板</a>
	| <a id="td_msg" href="https://bbs.sumisora.net/message.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">

	短消息</a>

	| <a id="td_sort" href="https://bbs.sumisora.net/sort.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">统计排行</a>

	| <a href="https://bbs.sumisora.net/member.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">会员</a>

	| <a href="https://bbs.sumisora.net/search.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">搜索</a>
	| <a style="cursor:pointer;" id="td_hack" data-mx-warn="Empty URL">社区服务<img src="assets/1570936106-5c8e409588b73ce4284cf5b9bd619e15.gif"></a>

	| <a href="https://bbs.sumisora.net/hack.php?H_name=galgamevote" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">GALGAME角色人气投票活动</a>

 | <a href="https://bbs.sumisora.net/yume/polls/" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">近期关注</a><!--[if lte IE 6]>
 | <a href="read.php?tid=10955539" style="color:red">本站已停止支持IE6，请升级或更换浏览器</a>
<![endif]-->
</div>



</div>
<div id="main">




<div class="t3" style="margin-top:8px"><table width="100%" cellspacing="0" cellpadding="0" align="center">
	<tbody><tr><td class="b"><img src="assets/1570936106-ca4a91079181c2a5cb3514b2e5b5f035.gif" align="absmiddle"> <a href="https://bbs.sumisora.net/index.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">『澄空学园』</a> » <a href="https://bbs.sumisora.net/thread.php?fid=77" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">【游戏汉化交流区】</a> » <a href="https://bbs.sumisora.net/thread.php?fid=78&amp;page=13" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">【汉化破解研讨室】</a> » <a href="https://bbs.sumisora.net/read.php?tid=10874064" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">关于ef - the first tale 的破解问题</a> <a href="https://bbs.sumisora.net/rss.php?tid=10874064" target="_blank" title="Rss订阅本帖最新内容" referrerpolicy="no-referrer" rel="noopener noreferrer"><img align="absmiddle" src="assets/1570936106-b4369735f1bfb33ab69477230a8ba635.png"></a></td></tr>
</tbody></table></div>

<!--ads begin-->

<!--ads end-->
<div class="t3"><table width="100%" align="center" cellspacing="0" cellpadding="0">
	<tbody><tr><td align="left"><div class="fl"></div></td><td align="right" style="padding-bottom:.2em"><a href="https://bbs.sumisora.net/post.php?action=reply&amp;fid=78&amp;tid=10874064" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img src="assets/1570936106-132cb83b134d7ecd9b390389d489bc43.png"></a>

<a href="https://bbs.sumisora.net/post.php?fid=78" style="margin-left:.5em" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img src="assets/1570936106-8cab7ee31ae503cf78e5410d40cec291.png" id="td_post"></a>

</td></tr>
</tbody></table></div>



<form name="delatc" method="post">


<div class="t" style="margin-bottom: 0px; border-bottom: 0px; --darkreader-inline-border-bottom: initial;" data-darkreader-inline-border-bottom=""><table cellspacing="0" cellpadding="0" width="100%">
	<tbody><tr><th class="h"><strong class="fl w"><b>本页主题:</b> 关于ef - the first tale 的破解问题</strong>
	<span class="fr w"><a data-mx-warn="Empty URL">&nbsp;</a><a href="https://bbs.sumisora.net/job.php?action=previous&amp;fid=78&amp;tid=10874064&amp;fpage=13&amp;goto=previous" class="fn" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">上一主题</a> | <a href="https://bbs.sumisora.net/job.php?action=previous&amp;fid=78&amp;tid=10874064&amp;fpage=13&amp;goto=next" class="fn" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">下一主题</a> | <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span> </th>
	</tr>
	<tr><td></td></tr>
	<tr class="tr2"><td colspan="2" class="tar">

		<a id="usetool" style="cursor:pointer" onclick="sendmsg('pw_ajax.php?action=usetool','',this.id)" data-mx-warn="Empty URL">[使用道具]</a>

		<br></td>
	</tr>
	<tr><td></td></tr>
</tbody></table></div>

<a name="tpc" data-mx-warn="Empty URL"></a>
<div class="t t2" style="border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top=""><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570936106-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>kkaien</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=98880" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570936106-bc3b3631a24154c2d9ba8189508a5212.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_0"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空一年生下学期</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570936106-0e03c5ece6b57c19681c4186b2d07c62.gif"><br>

<span class="user-info2" id="showface_0">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">159</span><br>
学分: <span class="s2 f9">2 点</span><br>
澄空币: <span class="s3 f9">1129 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2007-03-06<br>
		最后登录:2013-08-10 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_tpc" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10874064&amp;pid=tpc&amp;article=0" onclick="return sendurl(this,4,event)" id="quote_tpc" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10874064&amp;pid=tpc&amp;article=0" id="modify_tpc" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=98880" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10874064&amp;pid=tpc" onclick="return sendurl(this,8)" id="report_tpc" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10874064&amp;uid=98880" title="只看楼主的所有帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('tpc')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_tpc" class="fl"><img src="assets/1570936106-aa90e25d0c0169ac3f62e5ad9d1d3e72.gif" align="left" border="0">&nbsp;关于ef - the first tale 的破解问题</h1>
			

			<div id="p_tpc" class="c"></div>

			<div id="mag_tpc" class="tpc_content"><h6 class="quote"><span class="s3 f12 fn">管理提醒：


			</span></h6><blockquote class="blockquote">本帖被 悠久扬笛 从 【CK-GAL中文化】 移动到本区(2007-12-08)

			</blockquote></div>

<!--
-->

			<div class="tpc_content" id="read_tpc">说起这个游戏，早有耳闻，刚出正式版的时候就曾有朋友传给我，当时我非常的忙，根本没时间去玩，就随手丢在硬盘里，也没引起足够的重视，后来竟然不知所踪了 ＝ ＝ <br>最近看到十月新番的ef动画，才又想起这个来，搜遍硬盘没找到，只好又托朋友们传了一次~ OTL <br><br>这次，意外的得知游戏出了汉化补丁。而且也终于见到了那传说中的OP. <br>说到这个据说是本游戏最值钱OP，真是名不虚传，让人相当有感觉，我一下就被深深吸引住了。一定要把这个OP解出来才行。 <br><br>说干就干，观察一下游戏的文件名： <br>bg.paz <br>bgm.paz <br>scr.paz <br>se.paz <br>voice.paz <br>mov.paz <br>文件名都写的很明显，一看就明白里面都是些什么东东。 <br>OP的话应该就在mov.paz里面。 <br><br>Ultraedit打开，一团糨糊，没有特别的文件头信息，内容里也没有什么零字节，一定经过压缩处理了，麻烦又来了。看看能否偷偷懒吧！ <br><br>PEID查看启动文件 ef_first_v1001.exe: 无壳 VC6.0编写 <br>KANAL查看加密算法，发现还真是不少，BLOWFISH, ZLIB....都有 = = <br><br>BLOWFISH程序中三处调用: <br>BLOWFISH [sbox] :: 000E58B8 :: 004E58B8 <br> Referenced at 00424A35 <br> Referenced at 004252A4 <br> Referenced at 004254FE <br><br>ZLIB一处调用： <br>ZLIB deflate [word] :: 000EBE88 :: 004EBE88 <br> Referenced at 004936DA <br><br>OD加载，跳过去看看代码，估计解密这个OP话，BLOWFISH的可能行比较大。 <br>在上面四处的函数开始处都下断点，OD运行。 <br>很快断了下来。解密代码不想分析，纯粹路过，解密函数出来后，直接来到接下来的几个call上。 <br>我们来到这里。 <br>0045A7F0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  |.&nbsp; E8 ABACFCFF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  call ef_first.004254A0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ;&nbsp; 实现BLOWFISH解密 <br>0045A7F5&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  |.&nbsp; 83C4 08&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  add esp,8 <br>0045A7F8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  |.&nbsp; 84C0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; test al,al <br>0045A7FA&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  |.&nbsp; 74 08&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  je short ef_first.0045A804 <br>0045A7FC&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  |&gt;&nbsp; 8B06&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov eax,dword ptr ds:[esi] <br>0045A7FE&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  |.&nbsp; 53&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push ebx <br>0045A7FF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  |.&nbsp; 8BCE&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov ecx,esi <br>0045A801&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  |.&nbsp; FF50 18&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  call dword ptr ds:[eax+18] <br>0045A804&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  |&gt;&nbsp; 8B4C24 18&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  mov ecx,dword ptr ss:[esp+18]&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;&nbsp; Eax=解密后数据文件的长度，ecx=数据文件的内存地址 <br><br>0045A7F0&nbsp; 的call实现了BLOWFISH解密, 经过0045A801的call得到解密后数据的文件大小，0045A804 得到的是解密后文件存放的内存地址。 <br><br>这时，寄存器里显示的是： <br>EAX 0009A501 <br>ECX 02410020 <br><br>数据窗口中到地址02410020处看到的数据内容如下: <br>02410020&nbsp; 89 50 4E 47 0D 0A 1A 0A 00 00 00 0D 49 48 44 52&nbsp; 塒NG.......IHDR <br>02410030&nbsp; 00 00 03 20 00 00 02 58 08 02 00 00 00 15 14 15&nbsp; .. ..X... <br>02410040&nbsp; 27 00 00 00 04 67 41 4D 41 00 00 AF C8 37 05 8A&nbsp; '...gAMA..?7 <br>02410050&nbsp; E9 00 00 00 19 74 45 58 74 53 6F 66 74 77 61 72&nbsp; ?..tEXtSoftwar <br>02410060&nbsp; 65 00 41 64 6F 62 65 20 49 6D 61 67 65 52 65 61&nbsp; e.Adobe ImageRea <br>02410070&nbsp; 64 79 71 C9 65 3C 00 09 A5 73 49 44 41 54 78 DA&nbsp; dyq蒭&lt;..?IDATx <br><br>50 4E 47 对应ASCII的PNG, 这不正是PNG文件的signature了。 <br>从02410020开始截去内存中的 0009A501 大小的一段数据，保存到硬盘，查看一下，果然是一张PNG图片，就是游戏封面的那张“夕阳晚霞”了。 <br><br>这个文件名是什么呢？因为没有在CreateFile上下断，暂时还不太清楚。不过偷懒的方法还是有的。 <br>既然是游戏中调用了这图，想必调用前文件名信息出现过，应该就在堆栈中不远处才对。向下一拉，马上看到: <br>0013F7AC&nbsp;  004FCFB8&nbsp; ASCII "topmenu2.png" <br>0013F7B0&nbsp;  00000000 <br><br>行了，文件名，大小，地址 都有了，赶快找op吧。 <br><br>为了快一点，我记下0045A801&nbsp; 和 0045A804 这两个地址，把其他断点全部关掉。 <br>游戏运行到op开始的地方，切换到OD中下断点，结果，断下来了。 <br><br>先是弹出了一个窗口，标题是AVI Chunk Viewer = = <br>这玩意儿，游戏的时候可没见有弹出来过，看来还是隐藏的东东。 <br>关掉窗口后。马上又断在那个位置，看堆栈中文件名: <br>0013FAF4&nbsp;  0153F3A1&nbsp; ASCII "ef_first.ogg" <br>0013FAF8&nbsp;  0000000C <br><br>好！发现op的背景音乐，赶快内存中dump出来。初战告捷，得到OP背景音乐一首。 <br>F9继续，接下来 PASS了 ... <br>XD, 没断下OP来。直接开始播放OP了。 <br>真是郁闷啊。本想得到OP的，结果只得到一个OP的背景音乐ef_first.ogg <br>看来要dump出OP来，这个位置下断点不管用的。还要想其他办法。 <br><br>最近耐不下性子跟踪分析，上网找工具好了。<br>搜了一通，发现只有一款日本人编写的叫做ExtractData 1.07 的工具。<br>下载地址: <a href="http://atelibet.s11.xrea.com/side_yuu/tool/ExtractData/ExtractData107.7z" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">http://atelibet.s11.xrea.com/side_yuu/tool/ExtractData/ExtractData107.7z</a> <br>软件说明中声称能解EF的paz归档，介绍如下: <br>[minori] <br>・はるのあしおと …… *.paz (haruoto.exeがpazと同フォルダにないと開けない仕様) <br>・さくらのさくころ …… *.paz (haruotoFD.exeがpazと同フォルダにないと開けない仕様) <br>・ef - First Fan Disc …… *.paz (ef_ffd.exeがpazと同フォルダにないと開けない仕様) <br>・ef - the first tale. 体験版 …… *.paz (ef_trial.exeがpazと同フォルダにないと開けない仕様) <br>・ef - the first tale. …… *.paz (ef_first.exeがpazと同フォルダにないと開けない仕様) <br><br>拿工具试试看，结果根本不管用。什么都没解出来。不知道其他人用过没有，是否管用。有成功的务必回帖子相告，多谢了！ <br><br><br>既然找不到工具，那就问问其他的朋友吧。汉化版都出了，肯定有人解出来了。<br>找了几个朋友，结果悠久扬笛兄有消息了。 <br>悠扬说，他似乎在CK的技术区见到过，建议我爬楼找找看。 <br>于是我爬完了技术区的每一楼，找到了以下两篇相关的内容: <br><br><b>rednaxela 的文章:</b> <br><span style="color: rgb(255, 0, 0); --darkreader-inline-color:#e63f3c;" data-darkreader-inline-color="">以ef - the first tale. / Trial Version中资源文件的加密的解析简单介绍几个工具</span> <br><a href="https://bbs.sumisora.net/read.php?tid=208251&amp;fpage=2" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">http://bbs.sumisora.net/read.php?tid=208251&amp;fpage=2</a> <br><br><b>kid23 的文章:</b> <br>ef - the first tale资源提取器(再次更新)＋简单教程 <br><a href="https://bbs.sumisora.net/read.php?tid=212672&amp;fpage=2" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">http://bbs.sumisora.net/read.php?tid=212672&amp;fpage=2</a> <br><br>根据上面两位的介绍和过程，看来的确是BLOWFISH加密，看他们对解密过程的分析，还真佩服他俩的耐心。 <br>我照着rednaxela和Kid23介绍的汇编地址一看，代码根本不一样，看来版本不对。不知道解密的算法是不是一样的。 <br><br>于是下载kid23上传的解密工具，结果文件失效，不能下载XD.&nbsp; 让人郁闷啊。 <br><br>想了想，还是把自己的过程写下来，在这里发个帖子好了。不敢期望我的拙作能对大家学习汉化破解有所帮助，只希望能引来一些高手和研究过这个游戏破解的朋友过来。帮忙解答如何dump出那个OP来，以及提供相关的工具下载。 <br>这里先多谢大家了。<img src="assets/1570936106-a33fd2c5fb6f9601232d324067eb0e51.gif"> <br><br>kaien</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_tpc" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2007-12-08 13:13 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 楼主(kkaien) 的帖子');" data-mx-warn="Empty URL">[楼 主]</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="1271070" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570936106-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>席尔巴立提</b>
<div style="margin:.3em 0 .4em .2em">喜欢弟控的妹控</div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=145197" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570936106-94ba5a189ba68f83449893814802ea7a.jpg" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_1"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空一年生下学期</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570936106-0e03c5ece6b57c19681c4186b2d07c62.gif"><br>

<span class="user-info2" id="showface_1">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">199</span><br>
学分: <span class="s2 f9">2 点</span><br>
澄空币: <span class="s3 f9">1255 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2007-10-20<br>
		最后登录:2015-09-05 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_1271070" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10874064&amp;pid=1271070&amp;article=1" onclick="return sendurl(this,4,event)" id="quote_1271070" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10874064&amp;pid=1271070&amp;article=1" id="modify_1271070" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=145197" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10874064&amp;pid=1271070" onclick="return sendurl(this,8)" id="report_1271070" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10874064&amp;uid=145197" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('1271070')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_1271070" class="fl">&nbsp;</h1>
			

			<div id="p_1271070" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_1271070">没看懂,但实在是太强了</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_1271070" class="c"></div>

		<div><img class="signature" src="assets/1570936106-f23b8ffd0b6b327441aa828c9cd3243d.gif" align="absbottom"></div>
		<div class="signature" style="max-height:380px;maxHeight:380px; overflow:hidden;"><table width="100%"><tbody><tr><td>感觉文学少女的剧场版的人设怎么有点……</td><td></td></tr></tbody></table></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2007-12-08 13:26 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 1楼(席尔巴立提) 的帖子');" data-mx-warn="Empty URL">1 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="1271130" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570936106-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>arthas_zsy</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=141504" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570936106-bc3b3631a24154c2d9ba8189508a5212.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_2"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空一年生上学期</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570936106-f43195cd588caa26c296fcc61910b3e6.gif"><br>

<span class="user-info2" id="showface_2">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">96</span><br>
学分: <span class="s2 f9">0 点</span><br>
澄空币: <span class="s3 f9">966 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2007-09-23<br>
		最后登录:2018-10-10 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_1271130" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10874064&amp;pid=1271130&amp;article=2" onclick="return sendurl(this,4,event)" id="quote_1271130" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10874064&amp;pid=1271130&amp;article=2" id="modify_1271130" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=141504" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10874064&amp;pid=1271130" onclick="return sendurl(this,8)" id="report_1271130" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10874064&amp;uid=141504" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('1271130')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_1271130" class="fl">&nbsp;</h1>
			

			<div id="p_1271130" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_1271130">...........<br>如果我没记错的话两个月之前网上就把OP的视频和下载放出来了</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_1271130" class="c"></div>

		<div><img class="signature" src="assets/1570936106-f23b8ffd0b6b327441aa828c9cd3243d.gif" align="absbottom"></div>
		<div class="signature" style="max-height:380px;maxHeight:380px; overflow:hidden;"><table width="100%"><tbody><tr><td><span class="highslide"><img src="assets/1570936106-4700367be1bab771c8ba85a00c9533f4.jpg" border="0" style="max-width: 100%;max-height: 900px;"></span></td><td></td></tr></tbody></table></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2007-12-08 15:06 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 2楼(arthas_zsy) 的帖子');" data-mx-warn="Empty URL">2 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="1271143" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570936106-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>kkaien</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=98880" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570936106-bc3b3631a24154c2d9ba8189508a5212.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_3"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空一年生下学期</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570936106-0e03c5ece6b57c19681c4186b2d07c62.gif"><br>

<span class="user-info2" id="showface_3">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">159</span><br>
学分: <span class="s2 f9">2 点</span><br>
澄空币: <span class="s3 f9">1129 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2007-03-06<br>
		最后登录:2013-08-10 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_1271143" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10874064&amp;pid=1271143&amp;article=3" onclick="return sendurl(this,4,event)" id="quote_1271143" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10874064&amp;pid=1271143&amp;article=3" id="modify_1271143" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=98880" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10874064&amp;pid=1271143" onclick="return sendurl(this,8)" id="report_1271143" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10874064&amp;uid=98880" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('1271143')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_1271143" class="fl"><img src="assets/1570936106-aa90e25d0c0169ac3f62e5ad9d1d3e72.gif" align="left" border="0">&nbsp;</h1>
			

			<div id="p_1271143" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_1271143"><h6 class="quote">Quote:</h6><blockquote class="blockquote">引用第2楼arthas_zsy于2007-12-08 15:06发表的&nbsp; :<br>...........<br>如果我没记错的话两个月之前网上就把OP的视频和下载放出来了</blockquote><br><br>这东西要自己解出来才会有成就感。而且过程中说不定也可以接触一些新东西。<br>如果只是要看OP的话，游戏中也可以看的，网上也有下载。</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_1271143" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2007-12-08 15:20 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 3楼(kkaien) 的帖子');" data-mx-warn="Empty URL">3 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="1272613" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570936106-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>ravenex</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=123546" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570936106-bc3b3631a24154c2d9ba8189508a5212.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_4"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空一年生下学期</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570936106-0e03c5ece6b57c19681c4186b2d07c62.gif"><br>

<span class="user-info2" id="showface_4">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">176</span><br>
学分: <span class="s2 f9">1 点</span><br>
澄空币: <span class="s3 f9">1090 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2007-05-18<br>
		最后登录:2012-04-21 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_1272613" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10874064&amp;pid=1272613&amp;article=4" onclick="return sendurl(this,4,event)" id="quote_1272613" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10874064&amp;pid=1272613&amp;article=4" id="modify_1272613" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=123546" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10874064&amp;pid=1272613" onclick="return sendurl(this,8)" id="report_1272613" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10874064&amp;uid=123546" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('1272613')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_1272613" class="fl">&nbsp;</h1>
			

			<div id="p_1272613" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_1272613"><h6 class="quote">Quote:</h6><blockquote class="blockquote">最近耐不下性子跟踪分析，上网找工具好了。<br>搜了一通，发现只有一款日本人编写的叫做ExtractData 1.07 的工具。<br>下载地址: <a href="http://atelibet.s11.xrea.com/side_yuu/tool/ExtractData/ExtractData107.7z" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">http://atelibet.s11.xrea.com/side_yuu/tool/ExtractData/ExtractData107.7z</a> <br>软件说明中声称能解EF的paz归档，介绍如下: <br>[minori] <br>・はるのあしおと …… *.paz (haruoto.exeがpazと同フォルダにないと開けない仕様) <br>・さくらのさくころ …… *.paz (haruotoFD.exeがpazと同フォルダにないと開けない仕様) <br>・ef - First Fan Disc …… *.paz (ef_ffd.exeがpazと同フォルダにないと開けない仕様) <br>・ef - the first tale. 体験版 …… *.paz (ef_trial.exeがpazと同フォルダにないと開けない仕様) <br>・ef - the first tale. …… *.paz (ef_first.exeがpazと同フォルダにないと開けない仕様) <br><br>拿工具试试看，结果根本不管用。什么都没解出来。不知道其他人用过没有，是否管用。有成功的务必回帖子相告，多谢了！</blockquote><br>这个工具可以解出它声称支持的游戏中的数据。minori的几个游戏必须保证paz文件与对应游戏的exe游戏在同一目录才可以正确解出。另外就是游戏必须是那个破解版，序列号是全1的那个。LZ大大看看有没有误操作？<br><br>PNG文件的标识是89 50 4E 47。第一个字节是89是为了避免被文本编辑器误认为是ASCII文件。<br><br><h6 class="quote">Quote:</h6><blockquote class="blockquote">根据上面两位的介绍和过程，看来的确是BLOWFISH加密，看他们对解密过程的分析，还真佩服他俩的耐心。 <br>我照着rednaxela和Kid23介绍的汇编地址一看，代码根本不一样，看来版本不对。不知道解密的算法是不是一样的。</blockquote><br>rednaxela大大的那个是对体验版的，其exe的偏移量跟正式版的不一样。但几个关键偏移量可以很轻松用其中介绍的方法得到。<br>正式版的加密仍然是用Blowfish，前面外加一个简单的异或。<br><a href="http://forums.visualnews.net/showthread.php?t=7802" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">http://forums.visualnews.net/showthread.php?t=7802</a></div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_1272613" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2007-12-09 16:18 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 4楼(ravenex) 的帖子');" data-mx-warn="Empty URL">4 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="1273157" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570936106-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>kkaien</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=98880" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570936106-bc3b3631a24154c2d9ba8189508a5212.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_5"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空一年生下学期</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570936106-0e03c5ece6b57c19681c4186b2d07c62.gif"><br>

<span class="user-info2" id="showface_5">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">159</span><br>
学分: <span class="s2 f9">2 点</span><br>
澄空币: <span class="s3 f9">1129 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2007-03-06<br>
		最后登录:2013-08-10 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_1273157" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10874064&amp;pid=1273157&amp;article=5" onclick="return sendurl(this,4,event)" id="quote_1273157" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10874064&amp;pid=1273157&amp;article=5" id="modify_1273157" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=98880" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10874064&amp;pid=1273157" onclick="return sendurl(this,8)" id="report_1273157" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10874064&amp;uid=98880" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('1273157')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_1273157" class="fl"><img src="assets/1570936106-aa90e25d0c0169ac3f62e5ad9d1d3e72.gif" align="left" border="0">&nbsp;</h1>
			

			<div id="p_1273157" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_1273157"><h6 class="quote">Quote:</h6><blockquote class="blockquote">rednaxela大大的那个是对体验版的，其exe的偏移量跟正式版的不一样。但几个关键偏移量可以很轻松用其中介绍的方法得到。 <br>正式版的加密仍然是用Blowfish，前面外加一个简单的异或。 <br><a href="http://forums.visualnews.net/showthread.php?t=7802" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">http://forums.visualnews.net/showthread.php?t=7802</a></blockquote> <br><br>好吧！也许我上文中没有说明白，我前面说“代码根本不一样，看来版本不对。” <br>这是我简单化了的说法，实际情况比较复杂了。 <br><br>首先，要找到对应的代码很简单了，只要在OD中进行二进制搜索，1秒不到就能定位了。 <br>既然有人问到了，我就来说说具体情况吧。 <br><br>关于rednaxela提到的movie解码段，很快就找到了 <br>&nbsp; <br>这是rednaxela说到的体验版的解码段。 <br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code1'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code1" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="pln"> 
</span><span class="lit">00440178</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="pun">/</span><span class="lit">8B53</span><span class="pln"> </span><span class="lit">08</span><span class="pln"> mov edx</span><span class="pun">,</span><span class="pln">dword ptr ds</span><span class="pun">:[</span><span class="pln">ebx</span><span class="pun">+</span><span class="lit">8</span><span class="pun">]</span><span class="pln"> </span><span class="pun">;</span><span class="pln"> start of decoding movie</span><span class="pun">;</span><span class="pln"> ebx</span><span class="pun">+</span><span class="lit">8</span><span class="pln"> </span><span class="kwd">is</span><span class="pln"> </span><span class="kwd">base</span><span class="pln"> of dictionary 
</span><span class="lit">0044017B</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">33C0</span><span class="pln"> xor eax</span><span class="pun">,</span><span class="pln">eax 
</span><span class="lit">0044017D</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">8A0431</span><span class="pln"> mov al</span><span class="pun">,</span><span class="kwd">byte</span><span class="pln"> ptr ds</span><span class="pun">:[</span><span class="pln">ecx</span><span class="pun">+</span><span class="pln">esi</span><span class="pun">]</span><span class="pln"> 
</span><span class="lit">00440180</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">41</span><span class="pln"> inc ecx 
</span><span class="lit">00440181</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">3BCF</span><span class="pln"> cmp ecx</span><span class="pun">,</span><span class="pln">edi 
</span><span class="lit">00440183</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">8A0410</span><span class="pln"> mov al</span><span class="pun">,</span><span class="kwd">byte</span><span class="pln"> ptr ds</span><span class="pun">:[</span><span class="pln">eax</span><span class="pun">+</span><span class="pln">edx</span><span class="pun">]</span><span class="pln"> 
</span><span class="lit">00440186</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">884431</span><span class="pln"> FF mov </span><span class="kwd">byte</span><span class="pln"> ptr ds</span><span class="pun">:[</span><span class="pln">ecx</span><span class="pun">+</span><span class="pln">esi</span><span class="pun">-</span><span class="lit">1</span><span class="pun">],</span><span class="pln">al 
</span><span class="lit">0044018A</span><span class="pln"> </span><span class="pun">.^</span><span class="pln">\7</span><span class="lit">2</span><span class="pln"> EC jb </span><span class="kwd">short</span><span class="pln"> ef_trial</span><span class="pun">.</span><span class="lit">00440178</span><span class="pln"> </span></pre> <br><br>下面这个是我手头上的正式版的相应代码段。(PS:这个代码断，中出现在一处，我验证过了) <br><br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code2'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code2" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="pln"> 
</span><span class="lit">004876A8</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="pun">/</span><span class="lit">8B53</span><span class="pln"> </span><span class="lit">08</span><span class="pln"> mov edx</span><span class="pun">,</span><span class="pln">dword ptr ds</span><span class="pun">:[</span><span class="pln">ebx</span><span class="pun">+</span><span class="lit">8</span><span class="pun">]</span><span class="pln"> </span><span class="pun">;</span><span class="pln"> </span><span class="pun">开始</span><span class="pln">movie</span><span class="pun">解密</span><span class="pln"> 
</span><span class="lit">004876AB</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">33C0</span><span class="pln"> xor eax</span><span class="pun">,</span><span class="pln">eax 
</span><span class="lit">004876AD</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">8A0431</span><span class="pln"> mov al</span><span class="pun">,</span><span class="kwd">byte</span><span class="pln"> ptr ds</span><span class="pun">:[</span><span class="pln">ecx</span><span class="pun">+</span><span class="pln">esi</span><span class="pun">]</span><span class="pln"> 
</span><span class="lit">004876B0</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">41</span><span class="pln"> inc ecx 
</span><span class="lit">004876B1</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">3BCF</span><span class="pln"> cmp ecx</span><span class="pun">,</span><span class="pln">edi 
</span><span class="lit">004876B3</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">8A0410</span><span class="pln"> mov al</span><span class="pun">,</span><span class="kwd">byte</span><span class="pln"> ptr ds</span><span class="pun">:[</span><span class="pln">eax</span><span class="pun">+</span><span class="pln">edx</span><span class="pun">]</span><span class="pln"> 
</span><span class="lit">004876B6</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">884431</span><span class="pln"> FF mov </span><span class="kwd">byte</span><span class="pln"> ptr ds</span><span class="pun">:[</span><span class="pln">ecx</span><span class="pun">+</span><span class="pln">esi</span><span class="pun">-</span><span class="lit">1</span><span class="pun">],</span><span class="pln">al 
</span><span class="lit">004876BA</span><span class="pln"> </span><span class="pun">.^</span><span class="pln">\7</span><span class="lit">2</span><span class="pln"> EC jb </span><span class="kwd">short</span><span class="pln"> ef_first</span><span class="pun">.</span><span class="lit">004876A8</span><span class="pln"> </span></pre> <br><br>我在004876A8处下过断点的。 <br>然而，实际情况却并不顺利。 <br><br>不知道是否我调试的问题。总之，从程序加载运行开始，到movie播放结束，程序根本没有在那里断下来过。 <br><br>－－－－－－－－－－－－－－－－－－－ <br>至于kid23提到的“替换处理代码” <br><br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code3'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code3" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="pln"> 
</span><span class="pun">替换处理的代码在这个位置：</span><span class="pln"> 

</span><span class="lit">0045A317</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> </span><span class="pun">/</span><span class="lit">8D140E</span><span class="pln"> LEA EDX</span><span class="pun">,</span><span class="pln">DWORD PTR DS</span><span class="pun">:[</span><span class="pln">ESI</span><span class="pun">+</span><span class="pln">ECX</span><span class="pun">]</span><span class="pln"> 
</span><span class="lit">0045A31A</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">33C0</span><span class="pln"> XOR EAX</span><span class="pun">,</span><span class="pln">EAX 
</span><span class="lit">0045A31C</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="pun">|</span><span class="pln">C1EA </span><span class="lit">10</span><span class="pln"> SHR EDX</span><span class="pun">,</span><span class="lit">10</span><span class="pln"> 
</span><span class="lit">0045A31F</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">8AE2</span><span class="pln"> MOV AH</span><span class="pun">,</span><span class="pln">DL 
</span><span class="lit">0045A321</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">33D2</span><span class="pln"> XOR EDX</span><span class="pun">,</span><span class="pln">EDX 
</span><span class="lit">0045A323</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">8A11</span><span class="pln"> MOV DL</span><span class="pun">,</span><span class="pln">BYTE PTR DS</span><span class="pun">:[</span><span class="pln">ECX</span><span class="pun">]</span><span class="pln"> 
</span><span class="lit">0045A325</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">03D0</span><span class="pln"> ADD EDX</span><span class="pun">,</span><span class="pln">EAX 
</span><span class="lit">0045A327</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">41</span><span class="pln"> INC ECX 
</span><span class="lit">0045A328</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">4F</span><span class="pln"> DEC EDI 
</span><span class="lit">0045A329</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">8A042A</span><span class="pln"> MOV AL</span><span class="pun">,</span><span class="pln">BYTE PTR DS</span><span class="pun">:[</span><span class="pln">EDX</span><span class="pun">+</span><span class="pln">EBP</span><span class="pun">]</span><span class="pln"> 
</span><span class="lit">0045A32C</span><span class="pln"> </span><span class="pun">.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">8841</span><span class="pln"> FF MOV BYTE PTR DS</span><span class="pun">:[</span><span class="pln">ECX</span><span class="pun">-</span><span class="lit">1</span><span class="pun">],</span><span class="pln">AL 
</span><span class="lit">0045A32F</span><span class="pln"> </span><span class="pun">.^</span><span class="pln">\7</span><span class="lit">5</span><span class="pln"> E6 JNZ SHORT ef_first</span><span class="pun">.</span><span class="lit">0045A317</span><span class="pln"> </span></pre> <br><br>按他文中的说法，他使用的应该就是正式版了。 <br>然而，我的程序中根本连这段的影子都没有。 <br><br>我这边调试的实际情况，就如我在文中说到的那样。游戏在播放op前断了下来。但是所有的BLOWFISH调用和ZLIB调用似乎都没有处理movie的解码。 <br>拦下的只是movie同步的那个背景音乐ef_first.ogg <br><br>按理说，这个movie应该是和背景音乐前后处理的才对。<br>因为movie.sc解码后得到这么一段游戏调用指令<br><br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code4'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code4" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="pun">.</span><span class="kwd">set</span><span class="pln"> exitFromEvent </span><span class="pun">=</span><span class="pln"> </span><span class="lit">999</span><span class="pln">
</span><span class="pun">.</span><span class="kwd">set</span><span class="pln"> prohibitAutoSave </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
</span><span class="pun">.</span><span class="pln">playBGM </span><span class="pun">*</span><span class="pln">

</span><span class="pun">.</span><span class="pln">movie2 ef_first</span><span class="pun">.</span><span class="pln">avi </span><span class="lit">800</span><span class="pln"> </span><span class="lit">600</span><span class="pln"> ef_first</span><span class="pun">.</span><span class="pln">ogg </span><span class="lit">44100</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> t

</span><span class="pun">.</span><span class="kwd">end</span></pre><br><br>所以，只拦下ef_first.ogg而没有发现那个ef_first.avi不太合理，真是很奇怪呢。所以我才怀疑那个movie解码的处理过程可能位置不一样。<br><br>我曾经说过，事实上我对BLOWFISH或ZLIB怎么实现解密、解压缩的并不感兴趣，我的处理思路和过程都很简单明了，我只要明白哪个函数作了解密工作，并且知道解密数据存放在什么地方就好了。 <br><br>我不需要知道BLOWFISH运算前是否经过xor运算什么的。也不需要明白正式版和体验版的区别在哪里(我手上没有体验版那玩意儿)。我的目的很明确。就是要得到那个op的处理结果。以及如何知道它在内存中的存放位置，和大小。 <br><br>在这个得到之后，如果有时间有兴趣的话，我才会考虑那些细节性的问题。 <br><br>PS：<a href="http://forums.visualnews.net/showthread.php?t=7802" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">http://forums.visualnews.net/showthread.php?t=7802</a> 这个地址给的下载连接又过期了 = = <br><br><h6 class="quote">Quote:</h6><blockquote class="blockquote">这个工具可以解出它声称支持的游戏中的数据。minori的几个游戏必须保证paz文件与对应游戏的exe游戏在同一目录才可以正确解出。另外就是游戏必须是那个破解版，序列号是全1的那个。LZ大大看看有没有误操作？ PNG文件的标识是89 50 4E 47。第一个字节是89是为了避免被文本编辑器误认为是ASCII文件。 </blockquote> <br><br>这个工具需要调用ef_first.exe里的解密代码，我这里的Ef_first_v1000.exe所以没有效果，改成ef_first.exe就好了。这个已经能用了，多谢提醒。 <br><br>至于PNG那个大家都明白怎么回事儿，那个8字节的文件署名，我只是突出了其中更具有说明意义的那3个字节"PNG"而已，又不是在分析PNG文件各式，这个不需要深究。<div id="alert_1273157" style="color: gray; margin-top: 30px; --darkreader-inline-color:#bfb9ac;" data-darkreader-inline-color="">[ 此贴被kkaien在2007-12-10 02:52重新编辑 ]</div></div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_1273157" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2007-12-10 02:25 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 5楼(kkaien) 的帖子');" data-mx-warn="Empty URL">5 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="1273166" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570936106-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>ravenex</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=123546" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570936106-bc3b3631a24154c2d9ba8189508a5212.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_6"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空一年生下学期</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570936106-0e03c5ece6b57c19681c4186b2d07c62.gif"><br>

<span class="user-info2" id="showface_6">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">176</span><br>
学分: <span class="s2 f9">1 点</span><br>
澄空币: <span class="s3 f9">1090 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2007-05-18<br>
		最后登录:2012-04-21 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_1273166" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10874064&amp;pid=1273166&amp;article=6" onclick="return sendurl(this,4,event)" id="quote_1273166" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10874064&amp;pid=1273166&amp;article=6" id="modify_1273166" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=123546" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10874064&amp;pid=1273166" onclick="return sendurl(this,8)" id="report_1273166" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10874064&amp;uid=123546" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('1273166')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_1273166" class="fl">&nbsp;</h1>
			

			<div id="p_1273166" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_1273166">小的前面失礼了，请见谅<br>在op部分的解码代码确实是不一样。体验版用的是一层的查找表，正式版用的是两层。不过原理完全一样，所以只要看反汇编结果就应该能理解。op不是一次就把整个文件解码完，而是一小块一小块的解码。这样就难以直接转储出op的数据。另外op的内容，出于解码速度的需求也没有被Blowfish加密，而是只用了一个两层的解码表。movie.paz是个特殊的文件，其它的paz文件都按照同样的方式经过1次附加的xor和后面的Blowfish解码（ogg内容除外）。</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_1273166" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2007-12-10 02:51 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 6楼(ravenex) 的帖子');" data-mx-warn="Empty URL">6 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="1273175" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570936106-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>kkaien</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=98880" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570936106-bc3b3631a24154c2d9ba8189508a5212.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_7"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空一年生下学期</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570936106-0e03c5ece6b57c19681c4186b2d07c62.gif"><br>

<span class="user-info2" id="showface_7">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">159</span><br>
学分: <span class="s2 f9">2 点</span><br>
澄空币: <span class="s3 f9">1129 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2007-03-06<br>
		最后登录:2013-08-10 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_1273175" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10874064&amp;pid=1273175&amp;article=7" onclick="return sendurl(this,4,event)" id="quote_1273175" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10874064&amp;pid=1273175&amp;article=7" id="modify_1273175" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=98880" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10874064&amp;pid=1273175" onclick="return sendurl(this,8)" id="report_1273175" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10874064&amp;uid=98880" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('1273175')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_1273175" class="fl"><img src="assets/1570936106-aa90e25d0c0169ac3f62e5ad9d1d3e72.gif" align="left" border="0">&nbsp;</h1>
			

			<div id="p_1273175" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_1273175"><h6 class="quote">Quote:</h6><blockquote class="blockquote">引用第6楼ravenex于2007-12-10 02:51发表的&nbsp; :<br>小的前面失礼了，请见谅<br>在op部分的解码代码确实是不一样。体验版用的是一层的查找表，正式版用的是两层。不过原理完全一样，所以只要看反汇编结果就应该能理解。op不是一次就把整个文件解码完，而是一小块一小块的解码。这样就难以直接转储出op的数据。另外op的内容，出于解码速度的需求也没有被Blowfish加密，而是只用了一个两层的解码表。movie.paz是个特殊的文件，其它的paz文件都按照同样的方式经过1次附加的xor和后面的Blowfish解码（ogg内容除外）。</blockquote><br><br>如果真是这样，那直接提取估计无望了。<br>还好用那个工具可以把movie提取出来。<br><br>谁写好了正式版解包的源代码的话，请分享一下，多谢了。<br><br>那个ExtractData据说可以下到源代码的，发布的网页上我怎么就没找到！谁知道哪里能下到源码啊？</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_1273175" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2007-12-10 03:00 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 7楼(kkaien) 的帖子');" data-mx-warn="Empty URL">7 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="1273487" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570936106-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>ravenex</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=123546" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570936106-bc3b3631a24154c2d9ba8189508a5212.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_8"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空一年生下学期</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570936106-0e03c5ece6b57c19681c4186b2d07c62.gif"><br>

<span class="user-info2" id="showface_8">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">176</span><br>
学分: <span class="s2 f9">1 点</span><br>
澄空币: <span class="s3 f9">1090 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2007-05-18<br>
		最后登录:2012-04-21 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_1273487" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10874064&amp;pid=1273487&amp;article=8" onclick="return sendurl(this,4,event)" id="quote_1273487" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10874064&amp;pid=1273487&amp;article=8" id="modify_1273487" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=123546" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10874064&amp;pid=1273487" onclick="return sendurl(this,8)" id="report_1273487" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10874064&amp;uid=123546" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('1273487')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_1273487" class="fl">&nbsp;</h1>
			

			<div id="p_1273487" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_1273487">ExtractData以前确实以GPL开放源代码，但在1.03左右开始就不再公开放出链接。<br>小的可以发出两个相关文件：<br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code5'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code5" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="com">#pragma</span><span class="pln"> once

</span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Cef_first</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">CHaruotoFD</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="kwd">private</span><span class="pun">:</span><span class="pln">
&nbsp; &nbsp; BYTE m_deckey</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; BYTE m_MovieTables</span><span class="pun">[</span><span class="lit">256</span><span class="pun">][</span><span class="lit">256</span><span class="pun">];</span><span class="pln">
&nbsp; &nbsp; DWORD m_MovieTableID</span><span class="pun">;</span><span class="pln">

</span><span class="kwd">public</span><span class="pun">:</span><span class="pln">
&nbsp; &nbsp; BOOL </span><span class="typ">Mount</span><span class="pun">(</span><span class="typ">CArcFile</span><span class="pun">*</span><span class="pln"> pArc</span><span class="pun">);</span><span class="pln">
&nbsp; &nbsp; BOOL </span><span class="typ">Decode</span><span class="pun">(</span><span class="typ">CArcFile</span><span class="pun">*</span><span class="pln"> pArc</span><span class="pun">);</span><span class="pln">

&nbsp; &nbsp; </span><span class="kwd">void</span><span class="pln"> </span><span class="typ">InitMountKey</span><span class="pun">(</span><span class="typ">CArcFile</span><span class="pun">*</span><span class="pln"> pArc</span><span class="pun">);</span><span class="pln">
&nbsp; &nbsp; </span><span class="kwd">void</span><span class="pln"> </span><span class="typ">InitDecodeKey</span><span class="pun">(</span><span class="typ">CArcFile</span><span class="pun">*</span><span class="pln"> pArc</span><span class="pun">);</span><span class="pln">

&nbsp; &nbsp; </span><span class="kwd">void</span><span class="pln"> </span><span class="typ">DecodeKeyTable</span><span class="pun">();</span><span class="pln">

&nbsp; &nbsp; </span><span class="kwd">void</span><span class="pln"> </span><span class="typ">InitMovieTable</span><span class="pun">(</span><span class="pln">LPBYTE</span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">MovTable</span><span class="pun">);</span><span class="pln">
&nbsp; &nbsp; </span><span class="kwd">void</span><span class="pln"> </span><span class="typ">DecodeMovie</span><span class="pun">(</span><span class="pln">LPBYTE data</span><span class="pun">,</span><span class="pln"> DWORD data_size</span><span class="pun">);</span><span class="pln">

&nbsp; &nbsp; </span><span class="kwd">void</span><span class="pln"> </span><span class="typ">Decrypt</span><span class="pun">(</span><span class="pln">LPVOID data</span><span class="pun">,</span><span class="pln"> DWORD data_size</span><span class="pun">);</span><span class="pln">

&nbsp; &nbsp; DWORD </span><span class="typ">GetMovieBufSize</span><span class="pun">(</span><span class="typ">CArcFile</span><span class="pun">*</span><span class="pln"> pArc</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">65536</span><span class="pun">;</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="pun">};</span></pre><br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code6'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code6" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="com">#include</span><span class="pln"> </span><span class="str">"stdafx.h"</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">"Paz.h"</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">"HaruotoFD.h"</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">"ef_first.h"</span><span class="pln">

BOOL </span><span class="typ">Cef_first</span><span class="pun">::</span><span class="typ">Mount</span><span class="pun">(</span><span class="typ">CArcFile</span><span class="pun">*</span><span class="pln"> pArc</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
&nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">pArc</span><span class="pun">-&gt;</span><span class="typ">CheckExe</span><span class="pun">(</span><span class="pln">_T</span><span class="pun">(</span><span class="str">"ef_first.exe"</span><span class="pun">))</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> FALSE</span><span class="pun">)</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">return</span><span class="pln"> FALSE</span><span class="pun">;</span><span class="pln">

&nbsp; &nbsp; </span><span class="kwd">return</span><span class="pln"> </span><span class="typ">CPaz</span><span class="pun">::</span><span class="typ">Mount</span><span class="pun">(</span><span class="pln">pArc</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

BOOL </span><span class="typ">Cef_first</span><span class="pun">::</span><span class="typ">Decode</span><span class="pun">(</span><span class="typ">CArcFile</span><span class="pun">*</span><span class="pln"> pArc</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
&nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">pArc</span><span class="pun">-&gt;</span><span class="typ">CheckExe</span><span class="pun">(</span><span class="pln">_T</span><span class="pun">(</span><span class="str">"ef_first.exe"</span><span class="pun">))</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> FALSE</span><span class="pun">)</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">return</span><span class="pln"> FALSE</span><span class="pun">;</span><span class="pln">

&nbsp; &nbsp; </span><span class="kwd">return</span><span class="pln"> </span><span class="typ">CPaz</span><span class="pun">::</span><span class="typ">Decode</span><span class="pun">(</span><span class="pln">pArc</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> </span><span class="typ">Cef_first</span><span class="pun">::</span><span class="typ">InitMountKey</span><span class="pun">(</span><span class="typ">CArcFile</span><span class="pun">*</span><span class="pln"> pArc</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
&nbsp; &nbsp; pArc</span><span class="pun">-&gt;</span><span class="typ">Seek</span><span class="pun">(</span><span class="lit">8</span><span class="pun">,</span><span class="pln"> FILE_BEGIN</span><span class="pun">);</span><span class="pln">
&nbsp; &nbsp; pArc</span><span class="pun">-&gt;</span><span class="typ">Read</span><span class="pun">(&amp;</span><span class="pln">m_deckey</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
&nbsp; &nbsp; </span><span class="com">// 32バイトスキップしておく</span><span class="pln">
&nbsp; &nbsp; pArc</span><span class="pun">-&gt;</span><span class="typ">Seek</span><span class="pun">(</span><span class="lit">32</span><span class="pun">,</span><span class="pln"> FILE_BEGIN</span><span class="pun">);</span><span class="pln">

&nbsp; &nbsp; KEYINFO </span><span class="typ">KeyInfo</span><span class="pun">[]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln">_T</span><span class="pun">(</span><span class="str">"scr"</span><span class="pun">),</span><span class="pln"> </span><span class="str">"\xEC\xA1\x5A\x7A\xD0\x79\x7A\xFF\x06\xD4\x30\xCF\xB8\x04\x80\x37\x3E\x86\x1E\xB2\x7C\x08\x44\x14\x57\x42\x0B\xC8\x2B\x0C\xF4\xC7"</span><span class="pun">},</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln">_T</span><span class="pun">(</span><span class="str">"bg"</span><span class="pun">),</span><span class="pln"> </span><span class="str">"\x15\xED\xC3\xCA\xC7\x7B\x6D\xD6\x38\xF5\x1A\x91\x50\x3D\x94\x85\x39\x85\xBE\x56\x1E\xA0\xF0\x1B\xA3\x1D\x78\x92\xD1\x0D\xB6\xBD"</span><span class="pun">},</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln">_T</span><span class="pun">(</span><span class="str">"st"</span><span class="pun">),</span><span class="pln"> </span><span class="str">"\x90\x80\x72\xD3\x07\x2E\x3D\xB9\x5C\xC8\x99\xC8\x12\xB5\x58\xA3\xC8\x8E\xB2\xFF\x5A\xC7\x8C\x62\x98\x65\xFA\x84\xD4\x0A\x9E\xFA"</span><span class="pun">},</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln">_T</span><span class="pun">(</span><span class="str">"sys"</span><span class="pun">),</span><span class="pln"> </span><span class="str">"\x13\x29\x55\x49\xBB\x67\x35\x17\xD3\x43\x4F\x47\xEE\x5E\x64\x14\x4E\x03\x8A\x12\x1F\xED\x0E\xBF\x62\x6D\x96\xF7\xCE\xD9\xF0\x30"</span><span class="pun">},</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln">_T</span><span class="pun">(</span><span class="str">"bgm"</span><span class="pun">),</span><span class="pln"> </span><span class="str">"\xF6\x69\xD5\xA1\x0E\x21\xCC\xA0\x18\x63\xC3\xB3\x43\xDF\xCF\x0F\xE3\x14\x27\xC6\x55\x7B\x9F\xD4\x78\xEB\x3C\x5B\x1F\x9F\x6D\xB6"</span><span class="pun">},</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln">_T</span><span class="pun">(</span><span class="str">"voice"</span><span class="pun">),</span><span class="pln"> </span><span class="str">"\x22\xBF\x45\xD9\x43\x0A\xEF\x7D\xBA\x3D\x95\x5D\x42\xAF\x39\x90\x0B\xC2\x4C\x8C\x72\x0D\x08\x81\x08\x5A\x30\x64\xC7\x0B\x8F\x8D"</span><span class="pun">},</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln">_T</span><span class="pun">(</span><span class="str">"se"</span><span class="pun">),</span><span class="pln"> </span><span class="str">"\x73\x9E\xB8\xFD\x20\x1A\x9C\xFC\x1B\x2D\x44\x83\x15\x3C\x06\x65\x79\x88\x8C\xCD\x75\x26\xB3\xE5\x9C\x35\x60\x85\x98\x14\x90\x53"</span><span class="pun">},</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln">_T</span><span class="pun">(</span><span class="str">"mov"</span><span class="pun">),</span><span class="pln"> </span><span class="str">"\x75\xE3\xE5\x40\xC9\x5B\x77\x17\x34\x4A\xD9\xC7\x12\xE3\x5A\xBB\x31\x60\x8D\xDB\x04\x57\xFD\xC2\x95\xC4\x0A\x7A\x14\xB5\xC0\x08"</span><span class="pun">}</span><span class="pln">
&nbsp; &nbsp; </span><span class="pun">};</span><span class="pln">
&nbsp; &nbsp; </span><span class="typ">SetKey</span><span class="pun">(</span><span class="pln">pArc</span><span class="pun">,</span><span class="pln"> </span><span class="typ">KeyInfo</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> </span><span class="typ">Cef_first</span><span class="pun">::</span><span class="typ">InitDecodeKey</span><span class="pun">(</span><span class="typ">CArcFile</span><span class="pun">*</span><span class="pln"> pArc</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
&nbsp; &nbsp; m_MovieTableID </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">

&nbsp; &nbsp; KEYINFO </span><span class="typ">KeyInfo</span><span class="pun">[]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln">_T</span><span class="pun">(</span><span class="str">"scr"</span><span class="pun">),</span><span class="pln"> </span><span class="str">"\x2A\x96\xDA\xE6\xCF\xB3\xD5\x9C\x77\x57\x8E\xE3\x9E\x03\xE4\x2A\x49\x38\x2F\xDD\x12\x83\xBA\x7A\x66\x8A\x03\xF3\xAB\xCA\x8E\xA7"</span><span class="pun">},</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln">_T</span><span class="pun">(</span><span class="str">"bg"</span><span class="pun">),</span><span class="pln"> </span><span class="str">"\xD6\x36\xFD\x61\xEA\xDD\x22\x11\x36\xD0\x10\x94\x67\x85\xF7\x84\x5A\xD6\x5F\x5F\xFD\xC5\xA1\xD2\x72\x7B\xBC\x6A\x81\xF6\x53\xD5"</span><span class="pun">},</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln">_T</span><span class="pun">(</span><span class="str">"st"</span><span class="pun">),</span><span class="pln"> </span><span class="str">"\xBC\x25\x69\x24\x43\x3F\x7B\x23\x82\x26\x3D\x9C\x7B\x5C\xD7\x35\x5F\xC6\x26\xC3\x66\xF6\x48\x14\x37\x6C\x6C\xF8\xEA\x73\x36\x93"</span><span class="pun">},</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln">_T</span><span class="pun">(</span><span class="str">"sys"</span><span class="pun">),</span><span class="pln"> </span><span class="str">"\x6C\xAA\x90\x3D\x57\x25\x57\x99\xEB\x65\xC5\xCF\xB1\xB9\xE2\x27\x7A\xF1\x30\x93\xBD\xEF\xE9\x79\xAF\x5D\xAC\x91\xBE\xD0\x53\x15"</span><span class="pun">},</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln">_T</span><span class="pun">(</span><span class="str">"bgm"</span><span class="pun">),</span><span class="pln"> </span><span class="str">"\x6B\x99\xAD\x59\xCF\xB0\xED\x3D\x3D\x83\xE1\x08\xD7\x8E\xD3\x3C\xA2\x22\x0E\x01\x23\x71\x00\x59\x8B\x83\xCF\x77\x6B\x97\x45\xCE"</span><span class="pun">},</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln">_T</span><span class="pun">(</span><span class="str">"voice"</span><span class="pun">),</span><span class="pln"> </span><span class="str">"\xA1\x3B\xBA\x88\x3A\xA3\xDD\x0C\x30\x92\xA8\xAD\xFE\x25\x80\x14\xCD\x5B\x0D\x57\x9D\x8A\x21\x9C\xED\x2D\xB8\xD6\x82\x32\x0D\x3A"</span><span class="pun">},</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln">_T</span><span class="pun">(</span><span class="str">"se"</span><span class="pun">),</span><span class="pln"> </span><span class="str">"\xCC\x17\x29\x26\x10\xA9\x20\x18\x17\xB8\xDD\xF0\xD2\x62\xCD\x44\x53\xCE\x38\x98\x81\xB6\xB4\x31\x3F\x08\x1C\xA0\xAA\xF3\x86\x6E"</span><span class="pun">},</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln">_T</span><span class="pun">(</span><span class="str">"mov"</span><span class="pun">),</span><span class="pln"> </span><span class="str">"\x40\x28\x70\x54\x8C\x92\xDD\xBF\xF2\xC8\xEC\x43\x2F\x42\x0F\xC9\x54\x0F\x65\x31\xF4\x7B\xE0\xDA\x35\x21\x1C\x8D\x96\x4E\x73\x61"</span><span class="pun">}</span><span class="pln">
&nbsp; &nbsp; </span><span class="pun">};</span><span class="pln">
&nbsp; &nbsp; </span><span class="typ">SetKey</span><span class="pun">(</span><span class="pln">pArc</span><span class="pun">,</span><span class="pln"> </span><span class="typ">KeyInfo</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> </span><span class="typ">Cef_first</span><span class="pun">::</span><span class="typ">DecodeKeyTable</span><span class="pun">()</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
&nbsp; &nbsp; LPDWORD pTable </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GetTable</span><span class="pun">();</span><span class="pln">
&nbsp; &nbsp; LPBYTE pKey </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GetKey</span><span class="pun">();</span><span class="pln">
&nbsp; &nbsp; DWORD p </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">

&nbsp; &nbsp; </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">18</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; DWORD value1 </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">4</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; BYTE value2 </span><span class="pun">=</span><span class="pln"> pKey</span><span class="pun">[</span><span class="pln">p</span><span class="pun">];</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">switch</span><span class="pln"> </span><span class="pun">(</span><span class="pln">p </span><span class="pun">%</span><span class="pln"> </span><span class="lit">6</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">case</span><span class="pln"> </span><span class="lit">0</span><span class="pun">:</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; value2 </span><span class="pun">^=</span><span class="pln"> </span><span class="lit">0x6D</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">case</span><span class="pln"> </span><span class="lit">1</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">case</span><span class="pln"> </span><span class="lit">5</span><span class="pun">:</span><span class="pln">&nbsp; &nbsp; value2 </span><span class="pun">^=</span><span class="pln"> </span><span class="lit">0x69</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">case</span><span class="pln"> </span><span class="lit">2</span><span class="pun">:</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; value2 </span><span class="pun">^=</span><span class="pln"> </span><span class="lit">0x6E</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">case</span><span class="pln"> </span><span class="lit">3</span><span class="pun">:</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; value2 </span><span class="pun">^=</span><span class="pln"> </span><span class="lit">0x6F</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">case</span><span class="pln"> </span><span class="lit">4</span><span class="pun">:</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; value2 </span><span class="pun">^=</span><span class="pln"> </span><span class="lit">0x72</span><span class="pun">;</span><span class="pln"> </span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; value1 </span><span class="pun">&lt;&lt;=</span><span class="pln"> </span><span class="lit">8</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; value1 </span><span class="pun">|=</span><span class="pln"> value2</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p</span><span class="pun">++;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; p </span><span class="pun">&amp;=</span><span class="pln"> </span><span class="lit">31</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; pTable</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">^=</span><span class="pln"> value1</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> </span><span class="typ">Cef_first</span><span class="pun">::</span><span class="typ">InitMovieTable</span><span class="pun">(</span><span class="pln">LPBYTE</span><span class="pun">&amp;</span><span class="pln"> </span><span class="typ">MovTable</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
&nbsp; &nbsp; </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">256</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; LPBYTE pMovieTables </span><span class="pun">=</span><span class="pln"> m_MovieTables</span><span class="pun">[</span><span class="pln">i</span><span class="pun">];</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> j </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">256</span><span class="pun">;</span><span class="pln"> j</span><span class="pun">++)</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pMovieTables</span><span class="pun">[*</span><span class="typ">MovTable</span><span class="pun">++]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> j</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> </span><span class="typ">Cef_first</span><span class="pun">::</span><span class="typ">DecodeMovie</span><span class="pun">(</span><span class="pln">LPBYTE data</span><span class="pun">,</span><span class="pln"> DWORD data_size</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
&nbsp; &nbsp; LPBYTE pMovieTable </span><span class="pun">=</span><span class="pln"> m_MovieTables</span><span class="pun">[</span><span class="pln">m_MovieTableID</span><span class="pun">++];</span><span class="pln">
&nbsp; &nbsp; </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">DWORD i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> data_size</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">*</span><span class="pln">data </span><span class="pun">=</span><span class="pln"> pMovieTable</span><span class="pun">[*</span><span class="pln">data</span><span class="pun">];</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; data</span><span class="pun">++;</span><span class="pln">
&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln">
&nbsp; &nbsp; m_MovieTableID </span><span class="pun">&amp;=</span><span class="pln"> </span><span class="lit">255</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> </span><span class="typ">Cef_first</span><span class="pun">::</span><span class="typ">Decrypt</span><span class="pun">(</span><span class="pln">LPVOID data</span><span class="pun">,</span><span class="pln"> DWORD data_size</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
&nbsp; &nbsp; BYTE deckey </span><span class="pun">=</span><span class="pln"> m_deckey</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; LPBYTE pData </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">LPBYTE</span><span class="pun">)</span><span class="pln">data</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pun">)</span><span class="pln">data_size</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; pData</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">^=</span><span class="pln"> deckey</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></pre></div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_1273487" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2007-12-10 13:02 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 8楼(ravenex) 的帖子');" data-mx-warn="Empty URL">8 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="1273548" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570936106-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>kkaien</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=98880" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570936106-bc3b3631a24154c2d9ba8189508a5212.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_9"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空一年生下学期</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570936106-0e03c5ece6b57c19681c4186b2d07c62.gif"><br>

<span class="user-info2" id="showface_9">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">159</span><br>
学分: <span class="s2 f9">2 点</span><br>
澄空币: <span class="s3 f9">1129 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2007-03-06<br>
		最后登录:2013-08-10 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_1273548" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10874064&amp;pid=1273548&amp;article=9" onclick="return sendurl(this,4,event)" id="quote_1273548" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10874064&amp;pid=1273548&amp;article=9" id="modify_1273548" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=98880" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10874064&amp;pid=1273548" onclick="return sendurl(this,8)" id="report_1273548" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10874064&amp;uid=98880" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('1273548')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_1273548" class="fl">&nbsp;</h1>
			

			<div id="p_1273548" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_1273548">谢谢楼上的，请把ExtractData完整的源代码发给我，已经PM你了。</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_1273548" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2007-12-10 14:05 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 9楼(kkaien) 的帖子');" data-mx-warn="Empty URL">9 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="1273988" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570936106-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>ravenex</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=123546" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570936106-bc3b3631a24154c2d9ba8189508a5212.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_10"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空一年生下学期</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570936106-0e03c5ece6b57c19681c4186b2d07c62.gif"><br>

<span class="user-info2" id="showface_10">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">176</span><br>
学分: <span class="s2 f9">1 点</span><br>
澄空币: <span class="s3 f9">1090 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2007-05-18<br>
		最后登录:2012-04-21 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_1273988" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10874064&amp;pid=1273988&amp;article=10" onclick="return sendurl(this,4,event)" id="quote_1273988" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10874064&amp;pid=1273988&amp;article=10" id="modify_1273988" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=123546" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10874064&amp;pid=1273988" onclick="return sendurl(this,8)" id="report_1273988" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10874064&amp;uid=123546" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('1273988')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_1273988" class="fl">&nbsp;</h1>
			

			<div id="p_1273988" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_1273988"><h6 class="quote">Quote:</h6><blockquote class="blockquote">引用第5楼kkaien于2007-12-10 02:25发表的&nbsp; :<br>这个工具需要调用ef_first.exe里的解密代码，我这里的Ef_first_v1000.exe所以没有效果，改成ef_first.exe就好了。这个已经能用了，多谢提醒。</blockquote><br>其实不需要，只要有叫“ef_first.exe”的文件就行，内容是什么都没影响<br>万分对不住，小的也给不出手上没有的东西。小的也就只有这俩文件。没有必要拿到其它文件也够用<br>kid23大大的文里说的也应该够用，那边已经有提到解码表的问题</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_1273988" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2007-12-10 21:18 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 10楼(ravenex) 的帖子');" data-mx-warn="Empty URL">10 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="1274342" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570936106-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>kkaien</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=98880" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570936106-bc3b3631a24154c2d9ba8189508a5212.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_11"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空一年生下学期</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570936106-0e03c5ece6b57c19681c4186b2d07c62.gif"><br>

<span class="user-info2" id="showface_11">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">159</span><br>
学分: <span class="s2 f9">2 点</span><br>
澄空币: <span class="s3 f9">1129 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2007-03-06<br>
		最后登录:2013-08-10 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_1274342" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10874064&amp;pid=1274342&amp;article=11" onclick="return sendurl(this,4,event)" id="quote_1274342" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10874064&amp;pid=1274342&amp;article=11" id="modify_1274342" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=98880" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10874064&amp;pid=1274342" onclick="return sendurl(this,8)" id="report_1274342" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10874064&amp;uid=98880" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('1274342')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_1274342" class="fl">&nbsp;</h1>
			

			<div id="p_1274342" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_1274342">这样啊，那我再问问其他人好了。<br>我的意思是，既然有ExtracData的源代码，当然是要收集起来了。也可以观察学习其他游戏的破解方法。呵呵！<div id="alert_1274342" style="color: gray; margin-top: 30px; --darkreader-inline-color:#bfb9ac;" data-darkreader-inline-color="">[ 此贴被kkaien在2007-12-11 11:05重新编辑 ]</div></div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_1274342" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2007-12-11 10:56 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 11楼(kkaien) 的帖子');" data-mx-warn="Empty URL">11 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="a" data-mx-warn="Empty URL"></a><a name="1280432" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570936106-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>kid23</b>
<div style="margin:.3em 0 .4em .2em">Nice boat....&amp;</div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=49785" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570936106-b842a1d7465be36c32cba70b8ace1d8d.jpg" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_12"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空の贵宾</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570936106-87bc1a6e935264a57e50e0d513f23aa7.gif"><br>

<span class="user-info2" id="showface_12">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">80</span><br>
学分: <span class="s2 f9">6 点</span><br>
澄空币: <span class="s3 f9">385 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2006-05-02<br>
		最后登录:2019-02-12 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_1280432" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10874064&amp;pid=1280432&amp;article=12" onclick="return sendurl(this,4,event)" id="quote_1280432" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10874064&amp;pid=1280432&amp;article=12" id="modify_1280432" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=49785" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10874064&amp;pid=1280432" onclick="return sendurl(this,8)" id="report_1280432" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10874064&amp;uid=49785" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('1280432')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_1280432" class="fl">&nbsp;</h1>
			

			<div id="p_1280432" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_1280432">orz。。。俺都不记得自己当时咋解的了。。。<br>只记得看了rednaxela的文章后，一时兴起，去弄了正式版。。。。</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_1280432" class="c"></div>

		<div><img class="signature" src="assets/1570936106-f23b8ffd0b6b327441aa828c9cd3243d.gif" align="absbottom"></div>
		<div class="signature" style="max-height:380px;maxHeight:380px; overflow:hidden;"><table width="100%"><tbody><tr><td>和谐中。。。。。。。
<br>I can be both of God and the Devil.<span class="highslide"><img src="assets/1570936106-ad724d48a06e259e9265777a06af3be4.jpg" border="0" style="max-width: 100%;max-height: 900px;"></span>
<br><span class="highslide"><img src="assets/1570936106-c41a8dfefef1beb859b0138d89ff4ba0.jpg" border="0" style="max-width: 100%;max-height: 900px;"></span></td><td></td></tr></tbody></table></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2007-12-16 17:49 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 12楼(kid23) 的帖子');" data-mx-warn="Empty URL">12 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

</form>
<div class="t3" style="margin:initial"><table cellspacing="0" cellpadding="0" width="100%" align="center">
	<tbody><tr><td align="left"></td>
		<td valign="center" align="right">
		<a class="abtn f_two" id="readlog" onclick="sendmsg('pw_ajax.php?action=readlog','',this.id);" data-mx-warn="Empty URL">帖子浏览记录<img src="assets/1570936106-5c8e409588b73ce4284cf5b9bd619e15.gif"></a>
		<select onchange="Fjump(this.options[this.selectedIndex].value)"><option value="" selected="">快速跳至</option>
<option value="1">&gt;&gt; 『澄空学园 办公楼区』</option>
<option value="2"> &nbsp;|- 【校园公告栏】</option>
<option value="5"> &nbsp;|- 【论坛意见箱】</option>
<option value="113">&gt;&gt; 『澄空学园 资讯社』</option>
<option value="47"> &nbsp;|- 【新鲜速报】</option>
<option value="103"> &nbsp;|- 【新作介绍】</option>
<option value="8"> &nbsp; &nbsp;|-  【电子杂志下载区】</option>
<option value="104"> &nbsp;|- 【杂志专题】</option>
<option value="7">&gt;&gt; 『澄空学园 教学楼区』</option>
<option value="62"> &nbsp;|- 【AGE主题学部】</option>
<option value="39"> &nbsp;|- 【Akabeesoft2主题学部】</option>
<option value="100"> &nbsp;|- 【AUGUST主题学部】</option>
<option value="42"> &nbsp;|- 【CIRCUS主题学部】</option>
<option value="40"> &nbsp;|- 【Cotton-Nekoneko主题学部】</option>
<option value="64"> &nbsp;|- 【GIGA主题学部】</option>
<option value="38"> &nbsp;|- 【Key主题学部】</option>
<option value="10"> &nbsp;|- 【KID主题学部】</option>
<option value="37"> &nbsp;|- 【Leaf主题学部】</option>
<option value="70"> &nbsp;|- 【minori主题学部】</option>
<option value="12"> &nbsp;|- 【Navel主题学部】</option>
<option value="65"> &nbsp;|- 【Nitro+主题学部】</option>
<option value="14"> &nbsp;|- 【Type-Moon应援会】</option>
<option value="17"> &nbsp; &nbsp;|-  【TM精华区】</option>
<option value="98"> &nbsp;|- 【Will主题学部】</option>
<option value="116"> &nbsp;|- 【FAVORITE主题学部】</option>
<option value="108"> &nbsp;|- 【ALcot主题学部】</option>
<option value="55"> &nbsp;|- 【GALGAME综合作品讨论室】</option>
<option value="97"> &nbsp; &nbsp;|-  【Light主题学部】</option>
<option value="117"> &nbsp; &nbsp;|-  【CUFFS主题学部】</option>
<option value="15"> &nbsp; &nbsp;|-  【Liar Soft主题学部】</option>
<option value="57"> &nbsp; &nbsp;|-  【Purple 主题学部】</option>
<option value="13"> &nbsp; &nbsp;|-  【工画堂主题学部】</option>
<option value="35"> &nbsp;|- 【GALGAME综合杂谈室】</option>
<option value="99"> &nbsp;|- 【ぱれっと主题学部】</option>
<option value="122"> &nbsp;|- 【SAGA PLANETS研讨室】</option>
<option value="123"> &nbsp;|- 【Lump of Sugar 研讨室】</option>
<option value="86">&gt;&gt; 『澄空学园 图书馆』</option>
<option value="80"> &nbsp;|- 【游戏鉴赏室】</option>
<option value="56"> &nbsp;|- 【GALGAME攻略馆】</option>
<option value="115"> &nbsp;|- 【作品出处问询室】</option>
<option value="63"> &nbsp;|- 【Galgame疑问求助室】</option>
<option value="18">&gt;&gt; 『澄空学园 教辅楼区』</option>
<option value="73"> &nbsp;|- 【同人游戏区】</option>
<option value="60"> &nbsp;|- 【二次元轻小说社】</option>
<option value="20"> &nbsp;|- 【日语自学教室】</option>
<option value="61"> &nbsp; &nbsp;|-  【日语学习资料区】</option>
<option value="118"> &nbsp; &nbsp;|-  【日语参考文章区】</option>
<option value="21"> &nbsp;|- 【一般游戏社团】</option>
<option value="24"> &nbsp;|- 【多媒体课堂】</option>
<option value="88">&gt;&gt; 『澄空学园 原创综合区』</option>
<option value="79"> &nbsp;|- 【原创游戏部】</option>
<option value="36"> &nbsp; &nbsp;|-  【ss-square】</option>
<option value="89"> &nbsp;|- 【MAD研究室】</option>
<option value="91"> &nbsp;|- 【莉可屋 REC ROOM】</option>
<option value="119"> &nbsp; &nbsp;|-  【澄空百合社翻唱作品】</option>
<option value="19"> &nbsp;|- 【澄空文学部】</option>
<option value="120"> &nbsp; &nbsp;|-  【落日余晖】</option>
<option value="23"> &nbsp;|- 【绘画工房】</option>
<option value="69"> &nbsp;|- 【活动投票区】</option>
<option value="74"> &nbsp;|- 【友谊赛投票区】</option>
<option value="58"> &nbsp;|- 【澄空部活室】</option>
<option value="41"> &nbsp;|- 【暑假原创作品活动专区】</option>
<option value="59"> &nbsp;|- 【实物周边交流区】</option>
<option value="85"> &nbsp; &nbsp;|-  【ComicMarket相关资料】</option>
<option value="82"> &nbsp; &nbsp;|-  【新品介绍】</option>
<option value="84"> &nbsp; &nbsp;|-  【综合交流】</option>
<option value="83"> &nbsp; &nbsp;|-  【好物收集】</option>
<option value="81"> &nbsp; &nbsp;|-  【交易求购】</option>
<option value="95"> &nbsp;|- 【澄空放送部】</option>
<option value="111"> &nbsp; &nbsp;|-  【放送策划室】</option>
<option value="27"> &nbsp;|- 【水下乐园LeMU】</option>
<option value="46"> &nbsp; &nbsp;|-  【美工作品收藏室】</option>
<option value="26"> &nbsp; &nbsp;|-  【COS自爆馆】</option>
<option value="90"> &nbsp; &nbsp;|-  【澄空期刊室】</option>
<option value="71"> &nbsp;|- 【澄空演剧部】</option>
<option value="9"> &nbsp; &nbsp;|-  演剧部排练室</option>
<option value="52"> &nbsp;|- 【废帖回收站】</option>
<option value="29">&gt;&gt; 『澄空学园 好物交流站』</option>
<option value="50"> &nbsp;|- 【澄空学园字幕作品】</option>
<option value="51"> &nbsp;|- 【澄空学园漫画作品】</option>
<option value="77"> &nbsp;|- 【游戏汉化交流区】</option>
<option value="28"> &nbsp; &nbsp;|-  【CK-GAL中文化小组】</option>
<option value="106"> &nbsp; &nbsp;|-  【PRO2】</option>
<option value="49"> &nbsp; &nbsp;|-      【桜】</option>
<option value="30"> &nbsp;|- 【资源求助区】</option>
<option value="32"> &nbsp;|- 【澄空音乐厅】</option>
<option value="33"> &nbsp;|- 【澄空美术馆】</option>
<option value="34"> &nbsp;|- 【动漫租售屋】</option>
<option value="44">&gt;&gt; 『澄空学园 课余工作区』</option>
<option value="45"> &nbsp;|- 【澄空漫画汉化组】</option>
<option value="48"> &nbsp;|-  【澄空学园字幕组】</option>
<option value="101"> &nbsp; &nbsp;|-  字幕组资料区</option>
<option value="72"> &nbsp;|- 【澄空学园分流组】</option>
<option value="87"> &nbsp;|- 【澄空学园新闻组】</option>
<option value="96"> &nbsp;|- 【澄空学园文学社】</option>
<option value="75"> &nbsp;|- 【澄空学园百合社】</option>
<option value="112"> &nbsp;|- 【澄空学园编辑部】</option>
<option value="114"> &nbsp;|- 【澄空学园美工部】</option>
<option value="121"> &nbsp;|-  【澄空祭运行委员会】</option>
</select></td>
		
	</tr>
	<tr><td style="padding-top: 12px;text-align: left;"><img src="assets/1570936106-ca4a91079181c2a5cb3514b2e5b5f035.gif" align="absbottom"> <b><a href="https://bbs.sumisora.net/index.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">『澄空学园』</a> » <a href="https://bbs.sumisora.net/thread.php?fid=78&amp;page=13" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">【汉化破解研讨室】</a></b> </td>
	<td style="padding-top: 12px;text-align: right;"><a href="https://bbs.sumisora.net/post.php?action=reply&amp;fid=78&amp;tid=10874064" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img src="assets/1570936106-132cb83b134d7ecd9b390389d489bc43.png"></a>

<a href="https://bbs.sumisora.net/post.php?fid=78" style="margin-left:.5em" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img src="assets/1570936106-8cab7ee31ae503cf78e5410d40cec291.png" id="td_post1"></a>
</td>
	</tr>
</tbody></table></div>




<form name="FORM" method="post" action="post.php?" enctype="multipart/form-data" onsubmit="return checkpost(document.FORM);">
<div class="t" style="margin-top:8px"><table cellspacing="0" cellpadding="0" align="center" width="100%">
	<tbody><tr>
		<td class="h" colspan="3"><b>快速发帖</b></td>
	</tr>
	<tr></tr>
	<tr class="tr2"><td colspan="100" style="border-bottom: 0px; --darkreader-inline-border-bottom: initial;" data-darkreader-inline-border-bottom=""></td></tr>
	<tr>
		<td valign="top" width="20%" class="f_one" style="padding:7px">
		<fieldset id="smiliebox" style="border: 1px solid rgb(213, 229, 232); --darkreader-inline-border-top:#354e51; --darkreader-inline-border-right:#354e51; --darkreader-inline-border-bottom:#354e51; --darkreader-inline-border-left:#354e51;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
		<legend>内容</legend>
		<br>
		<input type="checkbox" name="atc_usesign" value="1" checked="">使用签名<br>
		<input type="checkbox" name="atc_convert" value="1" checked="">Wind Code自动转换 <br>
	 	<input type="checkbox" id="atc_autoimg" name="atc_autoimg" value="1" onchange="onAutoImgchange()" checked="" title="此设置会记在浏览器中"><label for="atc_autoimg" title="此设置会记在浏览器中">自动分析img</label><br><br>
	 	
		<input type="checkbox" name="atc_requiresell" value="1" disabled="">出售此帖
		<input class="input" type="text" maxlength="3" size="3" name="atc_money" value="0">
		<br>
		<input type="checkbox" name="atc_requirervrc" value="1">加密此帖
		<input class="input" type="text" maxlength="6" size="3" name="atc_rvrc" value="0">
		<br>
		<br><br><a href="https://bbs.sumisora.net/read.php?tid=10925672" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">如何在帖子中贴图？</a>
		<br><a href="https://bbs.sumisora.net/read.php?tid=10942243" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Wind Code使用教程</a>
		<br><a href="https://bbs.sumisora.net/yume/recover/" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">恢复帖子内容</a>
		</fieldset>
		</td>
		<td width="60%" class="f_one" style="padding:7px">
		<div>


<blockquote style="width: 96%;" class="blockquote">澄空娘：『如果遇到论坛打不开，不要按F5或者刷新按钮，点击地址栏然后按回车可以更快刷开论坛
』</blockquote>

		<input type="text" class="input" name="atc_title" value="Re:关于ef - the first tale 的破解问题" size="65">
		

		 认证码: <input class="input" type="text" name="gdcode" size="5" tabindex="6" onfocus="try{opencode('menu_gd',this)}catch(e){}"><br>
		

		</div><div style="padding:.3em 0">
		</div>
		<textarea onkeydown="quickpost(event)" id="atc_content" name="atc_content" rows="8" style="width:96%"></textarea>
		
		
		
		
		
		<div style="margin:5px 0">
		<div style="padding: 4px 10px 0px 0px; float: left; color: rgb(136, 136, 136); --darkreader-inline-color:#bfb9ac;" data-darkreader-inline-color="">按 Ctrl+Enter 直接提交</div>
		<input class="btn" type="submit" name="Submit" value=" 提 交 "></div>
		</td>
		<td width="20%" class="f_one">
		<div style="padding:3px; text-align:center; width:200px;">
		<fieldset id="smiliebox" style="border: 1px solid rgb(213, 229, 232); --darkreader-inline-border-top:#354e51; --darkreader-inline-border-right:#354e51; --darkreader-inline-border-bottom:#354e51; --darkreader-inline-border-left:#354e51;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<legend>表情</legend>
			<div id="menu_show"></div>
<span style="float:right; margin:3px 10px 5px;"><a id="td_face" style="cursor:pointer;" onclick="showDefault();" align="absmiddle" unselectable="on" data-mx-warn="Empty URL">[更多]</a></span>
<span style="float:left; margin:3px 10px 5px;"><a id="td_generalface" style="cursor:pointer;" onclick="showfaces();$('#td_generalface').fadeOut();" align="absmiddle" data-mx-warn="Empty URL">[显示表情]</a></span>
		</fieldset></div>
		
		
		</td>
	</tr>
</tbody></table></div></form>







</div>
<div id="bottom"></div><br>
<center class="gray">
<small><span id="windspend">Total 0.049915(s) query 6, Time is now 10-13 11:00, 
Load is low.
</span> <br>
Powered by <a href="http://www.phpwind.net/" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><b>PHPWind</b></a> <a href="http://www.phpwind.net/" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><b style="color: rgb(255, 153, 0); --darkreader-inline-color:#f7b24b;" data-darkreader-inline-color="">v6.3.2</b></a> Code © 2003-08 <a href="http://www.phpwind.com/" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><b>PHPWind.com</b></a> Corporation</small>
</center><br>
<div id="footer">
	<span class="f12 fl"></span><a href="https://bbs.sumisora.net/sendmail.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Contact us</a>

</div>
</div>
        
      </div>
    </body>
  </html>