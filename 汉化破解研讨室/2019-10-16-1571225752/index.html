
  <!DOCTYPE html>
  <html id="" class="">
    <!-- OriginalSrc: https://www.iteye.com/blog/rednaxelafx-180521 -->
    <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />

      <title>BattleMoonWars 归档解压/压缩程序 (Java) - Script Ahead, Code Behind - ITeye博客</title>
      
<link rel="shortcut icon" href="assets/1571225752-1cd7c6fd0de855e9efac8dbe4a274b55.ico" type="image/x-icon" referrerpolicy="no-referrer">


<link href="assets/1571225752-86dfe308f444f6e1aa00f6b28e8b2407.css" media="screen" rel="stylesheet" type="text/css" referrerpolicy="no-referrer">
<link href="assets/1571225752-771d0182f7eae18f5989664d94717b86.css" media="screen" rel="stylesheet" type="text/css" referrerpolicy="no-referrer">
<link href="assets/1571225752-396dd74c56d84598b8a22d8cb10eaf3a.css" media="screen" rel="stylesheet" type="text/css" referrerpolicy="no-referrer">
<link rel="stylesheet" type="text/css" href="assets/1571225752-9aeb703993455cc093fff678a2ad3401.css" referrerpolicy="no-referrer">
<link rel="stylesheet" type="text/css" href="assets/1571225752-05fb66a2c1140728ea8d74162a702c22.css" referrerpolicy="no-referrer">


<style class="darkreader darkreader--fallback" media="screen"></style>
<style class="darkreader darkreader--text" media="screen"></style>
<style class="darkreader darkreader--invert" media="screen"></style>
<style class="darkreader darkreader--inline" media="screen">[data-darkreader-inline-bgcolor] {
  background-color: var(--darkreader-inline-bgcolor) !important;
}
[data-darkreader-inline-bgimage] {
  background-image: var(--darkreader-inline-bgimage) !important;
}
[data-darkreader-inline-border] {
  border-color: var(--darkreader-inline-border) !important;
}
[data-darkreader-inline-border-bottom] {
  border-bottom-color: var(--darkreader-inline-border-bottom) !important;
}
[data-darkreader-inline-border-left] {
  border-left-color: var(--darkreader-inline-border-left) !important;
}
[data-darkreader-inline-border-right] {
  border-right-color: var(--darkreader-inline-border-right) !important;
}
[data-darkreader-inline-border-top] {
  border-top-color: var(--darkreader-inline-border-top) !important;
}
[data-darkreader-inline-boxshadow] {
  box-shadow: var(--darkreader-inline-boxshadow) !important;
}
[data-darkreader-inline-color] {
  color: var(--darkreader-inline-color) !important;
}
[data-darkreader-inline-fill] {
  fill: var(--darkreader-inline-fill) !important;
}
[data-darkreader-inline-stroke] {
  stroke: var(--darkreader-inline-stroke) !important;
}
[data-darkreader-inline-outline] {
  outline-color: var(--darkreader-inline-outline) !important;
}</style>
<style class="darkreader darkreader--user-agent" media="screen">html {
    background-color: #191a1b !important;
}
html, body, input, textarea, select, button {
    background-color: #191a1b;
}
html, body, input, textarea, select, button {
    border-color: #5a5956;
    color: #f0ebe2;
}
a {
    color: #4791e7;
}
table {
    border-color: #4f4e4c;
}
::placeholder {
    color: #bfb9ac;
}
::selection {
    background-color: #125cb4;
    color: #fffffd;
}
::-moz-selection {
    background-color: #125cb4;
    color: #fffffd;
}
input:-webkit-autofill,
textarea:-webkit-autofill,
select:-webkit-autofill {
    background-color: #565a0f !important;
    color: #f0ebe2 !important;
}
::-webkit-scrollbar {
    background-color: #1d1f1f;
    color: #cbc5b9;
}
::-webkit-scrollbar-thumb {
    background-color: #2c2d2d;
}
::-webkit-scrollbar-thumb:hover {
    background-color: #343636;
}
::-webkit-scrollbar-thumb:active {
    background-color: #404142;
}
::-webkit-scrollbar-corner {
    background-color: #191a1b;
}
* {
    scrollbar-color: #2c2d2d #1d1f1f;
}</style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style class="darkreader darkreader--override" media="screen">.jfk-bubble {
    background-color: #000000 !important;
}
.vimvixen-hint {
    background-color: #765500 !important;
    border-color: #d5b22e !important;
    color: #f9edcc !important;
}</style>
<style>
 
.hide-main-content{
    position: relative;
}
.hide-article-box {
    display: none;
    position: absolute;
    z-index: 9999;
    bottom: -1px;
    width: 100%;
    padding-top: 160px;
    background-image: -webkit-gradient(linear,left top, left bottom,from(rgba(255,255,255,0)),color-stop(70%, #fff));
    background-image: linear-gradient(-180deg,rgba(255,255,255,0) 0%,#fff 70%);
}
.hide-article-box #btn-readmore{
    color: #ca0c16;
    border: 1px solid #ca0c16;
    margin: 10px auto;
    padding: 0 8px;
    display: block;
    font-size: 14px;
    border-radius: 4px;
    text-align: center;
    background-color: transparent;
    height: 34px;
    width: 74px;
    line-height: 32px;
    min-width: 72px;
    cursor: pointer;
}
.hide-article-box #btn-readmore:hover{
    background: #ca0c16;
    color:#fff;
    text-decoration: none;
}
</style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style type="text/css">.dp-j .annotation { color: #646464; }.dp-j .number { color: #C00000; }</style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style type="text/css">.dp-j .annotation { color: #646464; }.dp-j .number { color: #C00000; }</style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style type="text/css">.dp-j .annotation { color: #646464; }.dp-j .number { color: #C00000; }</style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style type="text/css">.dp-j .annotation { color: #646464; }.dp-j .number { color: #C00000; }</style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style type="text/css">.dp-j .annotation { color: #646464; }.dp-j .number { color: #C00000; }</style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style class="darkreader darkreader--cors" media="screen">body,dd,div,dl,dt,form,h1,h2,h3,h4,h5,h6,html,input,li,ol,p,select,td,textarea,th,ul{margin:0;padding:0}*{box-sizing:border-box}body,html{min-height:100%}h1,h2,h3,h4,h5,h6{font-weight:400}.recommend-right ul,ol{list-style:none}.recommend-right img{border:none;vertical-align:middle}.recommend-right a{text-decoration:none;color:#232323}.recommend-right table{border-collapse:collapse;table-layout:fixed}.recommend-right input,textarea{outline:0;border:none}.recommend-right textarea{resize:none;overflow:auto}.clearfix:after{content:" ";display:block;height:0;visibility:hidden;clear:both}.recommend{overflow:hidden}.newbox.recommend{overflow:hidden}svg.icon{width:1em;height:1em;vertical-align:-.15em;fill:currentColor;overflow:hidden;margin-right:4px}svg.icon.icon-level{width:3em;height:1em}.recommend-right{float:right;width:300px;margin-left:8px;background-color:#fff;-webkit-box-shadow:0 2px 4px 0 rgba(0,0,0,.05);box-shadow:0 2px 4px 0 rgba(0,0,0,.05)}.recommend-right .recommend-fixed-box{background-color:#fff}.recommend-right .right-item{padding:8px 0;overflow:hidden;word-break:break-all;margin-left:8px;margin-right:8px;border-bottom:1px solid #f5f5f5;box-sizing:border-box}.recommend-right .right-item:hover .content h5{color:#ca0c16}.recommend-right .right-item .content{margin-bottom:4px}.recommend-right .right-item .content img{width:58px;height:36px}.recommend-right .right-item .content h5{display:inline;font-size:14px;color:#5c5c5c;letter-spacing:0;line-height:20px;max-height:44px;overflow:hidden;font-weight:500;margin-right:4px;white-space:nowrap;text-overflow:ellipsis}.recommend-right .right-item .content .h5width{width:76%;margin-left:8px}.recommend-right .right-item .content span{margin-right:8px;font-size:12px;color:#999;letter-spacing:0;line-height:20px}.recommend-right .right-item .content .download_mark{border:1px solid #e3e3e3;padding:2px;margin-right:4px}.recommend-right .right-item .right-item-desc{font-size:12px;color:#999;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}</style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style class="darkreader darkreader--cors" media="screen">.{font-family:""!important;font-size:16px;font-style:normal;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.fanyi:before{content:"\e661"}.shouji:before{content:"\e66f"}.yuedushu:before{content:"\e682"}</style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style type="text/css">@keyframes fadeInOpacity{0%{opacity:0}to{opacity:1}}:hover>*>.fbvd--wrapper{animation-name:fadeInOpacity;animation-duration:.3s;opacity:1}.fbvd--wrapper{position:absolute;top:10px;left:10px;opacity:0;text-align:center;margin:0;z-index:5}.fbvd--wrapper a{background: url("") no-repeat 3px 4.55px; background-color: #fff; display:inline-block;font:700 14px Helvetica,Arial,sans-serif;color:#4b4f56;text-decoration:none;vertical-align:middle;padding:0px 8px 0px;margin-right:8px;border-radius:2px; line-height: 22px; padding-left:19px; border: 1px solid #e7e7e7; background-size: 13px}.fbvd--wrapper a:last-child{margin-right:0}.fbvd--wrapper a:hover{text-decoration:none}.fbvd--wrapper a:focus{box-shadow:0 0 1px 2px rgba(88,144,255,.75),0 1px 1px rgba(0,0,0,.15);outline:none}.fbvd--wrapper b{font-size:13px;position:relative;top:1px;color:#3b5998;font-weight:400}</style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style>
  .userinfo {display: none !important;}
  .persion_article h3{
    background: none !important;
    border-bottom: none!important;
    padding: 0!important;
    margin-bottom: 0!important;
    line-height: 1!important;
  }
  .persion_article .right_box{
    margin-top: 0!important;
  }
  .persion_article .footer_box .feed_new_tit span{
    padding-left: 0!important;
  }
</style>
<style class="darkreader darkreader--sync" media="screen"></style>

      <style class="mx-wc-style">
        .mx-wc-main img {max-width: 100%;}
        .mx-wc-main{
          box-sizing: content-box;
          background-color: rgb(35, 36, 36) !important;
          margin: 0 auto;
          margin-top: 20px;
          max-width: 706px;
        }
        @media (min-width: 768px) {
          .mx-wc-main { padding: 15px 15px 80px 15px }
        }
        @media (max-width: 767px) {
          .mx-wc-main { padding: 15px 3px 80px 3px }
        }
  
      </style>
    </head>
    <body style="background-color: #464646 !important; min-height: 100%; height: auto; position: static !important; overflow: auto !important; padding-bottom: 0px !important;" id="" class="">
      <div class="mx-wc-main">
        <DIV id="page" style="display: block !important;float: none !important;position: relative !important;top: 0 !important;left: 0 !important;border: 0px !important;width: 100% !important;min-width: 100% !important;max-width: 100% !important;height: auto !important;min-height: auto !important;max-height: 100% !important;margin: 0px !important;padding: 0px !important;"><DIV id="content" class="clearfix" style="display: block !important;float: none !important;position: relative !important;top: 0 !important;left: 0 !important;border: 0px !important;width: 100% !important;min-width: 100% !important;max-width: 100% !important;height: auto !important;min-height: auto !important;max-height: 100% !important;margin: 0px !important;padding: 0px !important;"><div id="main" class="mx-wc-selected-elem mx-wc-1571225752" style="display: block; float: none !important; position: relative !important; top: 0px !important; left: 0px !important; margin: 0px !important; flex: unset !important; width: 100% !important; max-width: 100% !important;">
        



        





<div class="blog_main">
  
  <div class="blog_title">
    <h3>
      BattleMoonWars 归档解压/压缩程序 (Java)
      <em class="actions">      </em>
    </h3>
    <ul class="blog_categories"><strong>博客分类：</strong> <li><a href="https://www.iteye.com/category/24338" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Reverse Engineering</a></li> </ul>
        <div class="news_tag"><a href="http://www.iteye.com/blogs/tag/Java" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Java</a><a href="http://www.iteye.com/blogs/tag/DOS" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">DOS</a><a href="http://www.iteye.com/blogs/tag/Ruby" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Ruby</a><a href="http://www.iteye.com/blogs/tag/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">数据结构</a><a href="http://www.iteye.com/blogs/tag/J%23" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">J#</a>&nbsp;</div>
  </div>

  <div id="blog_content" class="hide-main-content">
    
    呼，这个也是一年多之前写的了……当时茶茶说起有没有办法处理BMW里的dat文件，然后我写了这程序，然后我们就真的开工了。真神奇，呵呵。
<br>
<br>当时发给茶茶的聊天记录：
<br><div class="quote_title">引用</div><div class="quote_div">http://www.ahcomic.com/bbs/thread-163398-1-1.html
<br>这是前段时间正好写的关于Fatal/Fake的其中一个archive的解析.BMW的情况看起来跟Fatal/Fake差不多.可以参考下,拿里面的代码来修改.
<br>
<br>http://yanesdkdotnet.sourceforge.jp/
<br>如果我没猜错的话,BMW用的是这个引擎(或相关,yane2k1).但是这不重要,我们不一定需要知道原本的引擎是什么样的.
<br>
<br>========================================================================================================================
<br>
<br>头8个字节,地址0x00-0x07,属于file signature,读进来验证下是不是等于yanepkDx就可以了.
<br>
<br>接着是一个DWORD(也就是32位整型,4个byte),那是文件个数,顺序是little-endian.0x2D意味着这个archive里有是45个文件.
<br>
<br>然后后面接着的所谓的index.你会看到每个index的entry的长度都是固定的,长度为268(=0x10C).其中前面是留给"以\0结束的字符串"的空间,这里当然就是文件名啦.后面有3个little-endian的DWORD,分别是文件的地址/大小/大小.
<br>
<br>提到index的每个entry里末尾的那3个DWORD,在我手上的这个文件里,后两个表示大小的值总是一样的.这意味着其中一个是原始大小而另一个是压缩后大小,只是现在我这文件的内容没有被压缩过而已.你或许会在另外几个dat文件里看到这两个表示大小的值会不一样.那么比较小的那个就是压缩后的大小.
<br>
<br>index后就是文件内容了.把它们分离出来就行."分离"也就是把数据一个一个字节写到一个新文件里就可以了.反正我们也不追求什么速度啊空间啊效率什么的.你在index里得到了3个有用的值(这里我们只用到两个,因为不知道哪个"大小"是指压缩的.假设地址是offset,大小是origFileSize),那么Java就用RandomAccessFile设置文件指针到offset,然后读出origFileSize个字节,按照原本的文件名写出去就可以了...简单吧.
<br>
<br>以后要打包回来的时候,只要反过来做一次事情就行...</div>
<br>嘛，当时也没仔细考察。这BMW很明显用的不是YaneSDK.NET而是更早的版本，是YaneSDK2还是YaneSDK3来着，我又忘了。不管了。
<br>
<br>然后这个程序的使用方法：
<br><div class="quote_title">引用</div><div class="quote_div">Usage: java Archiver [option] filename
<br>
<br>options:
<br>[e]xtract
<br>[a]rchive
<br>
<br>============================================
<br>
<br>example:
<br>Suppose data1.dat is in the same directory where this program is.
<br>
<br>to extract files to current directory:
<br><div class="dp-highlighter" id=""><div class="bar"><div class="tools">Java代码 <embed wmode="transparent" src="/javascripts/syntaxhighlighter/clipboard_new.swf" width="14" height="15" flashvars="clipboard=java%20Archiver%20e%20data1.dat" quality="high" allowscriptaccess="always" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer">&nbsp;<a href="javascript:void()" title="收藏这段代码" onclick="code_favorites_do_favorite(this);return false;" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="star" src="assets/1571225752-bf632ec55a05f69a9359f73417402b26.png" alt="收藏代码"><img class="spinner" src="assets/1571225752-a42df3a5b569bdc98ca473a4a3adfeac.gif" style="display:none"></a></div></div><ol start="1" class="dp-j"><li><span><span>java&nbsp;Archiver&nbsp;e&nbsp;data1.dat&nbsp;&nbsp;</span></span></li></ol></div>
<br>
<br>Suppose the files to be packed are in "data1" directory:
<br><div class="dp-highlighter" id=""><div class="bar"><div class="tools">Java代码 <embed wmode="transparent" src="/javascripts/syntaxhighlighter/clipboard_new.swf" width="14" height="15" flashvars="clipboard=java%20Archiver%20a%20data1%5C" quality="high" allowscriptaccess="always" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer">&nbsp;<a href="javascript:void()" title="收藏这段代码" onclick="code_favorites_do_favorite(this);return false;" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="star" src="assets/1571225752-bf632ec55a05f69a9359f73417402b26.png" alt="收藏代码"><img class="spinner" src="assets/1571225752-a42df3a5b569bdc98ca473a4a3adfeac.gif" style="display:none"></a></div></div><ol start="1" class="dp-j"><li><span><span>java&nbsp;Archiver&nbsp;a&nbsp;data1\&nbsp;&nbsp;</span></span></li></ol></div></div>
<br>
<br>接下来是源代码。跟前面两帖（<a href="http://rednaxelafx.iteye.com/blog/180434" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">这里</a>和<a href="http://rednaxelafx.iteye.com/blog/180447" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">这里</a>）一样，因为用了<a href="http://www.hotpixel.net/software.html" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">BlowfishJ</a>的BinConverter.java，所以以下代码以<a href="http://www.gnu.org/copyleft/lesser.html" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">LGPL</a>许可证发布。
<br>
<br>不过说真的，这连续3帖里的代码都是当时太贪图写起来方便而弄得乱七八糟的……结构太糟糕了。或许还是应该把一些结构自己的IO给封装起来的。叹气。
<br>
<br>Archiver.java:
<br><div class="dp-highlighter" id=""><div class="bar"><div class="tools">Java代码 <embed wmode="transparent" src="/javascripts/syntaxhighlighter/clipboard_new.swf" width="14" height="15" flashvars="clipboard=%2F*%0A%20*%20%40(%23)Archiver.java%20%202007%2F03%2F23%0A%20*%20Written%20by%20rednaxela%20%2F%20FX%0A%20*%2F%0A%0Aimport%20java.io.*%3B%0Aimport%20java.util.*%3B%0A%0A%2F**%0A%20*%20Demonstrating%20archive%20operations%20on%20*.dat%20files%20as%20seen%20in%20BattleMoonWars.%0A%20*%2F%0Apublic%20class%20Archiver%20%7B%0A%20%20%20%20%0A%20%20%20%20static%20final%20byte%5B%5D%20SIGNATURE%20%3D%20%7B%0A%20%20%20%20%20%20%20%20(byte)'y'%2C%20(byte)'a'%2C%20(byte)'n'%2C%20(byte)'e'%2C%0A%20%20%20%20%20%20%20%20(byte)'p'%2C%20(byte)'k'%2C%20(byte)'D'%2C%20(byte)'x'%2C%0A%20%20%20%20%7D%3B%0A%20%20%20%20%0A%20%20%20%20static%20final%20int%20ENTRY_LENGTH%20%3D%20268%3B%0A%20%20%20%20static%20final%20int%20MAX_FILENAME_LENGTH%20%3D%20256%3B%0A%20%20%20%20static%20final%20int%20OFFSET_OFS%20%3D%20256%3B%0A%20%20%20%20static%20final%20int%20LENGTH_OFS%20%3D%20260%3B%0A%20%20%20%20static%20final%20int%20COMPRESSED_LENGTH_OFS%20%3D%20264%3B%20%2F%2F%20%3F%3F%0A%0A%20%20%20%20static%20final%20String%20USAGE%20%3D%20%22Usage%3A%20java%20Archiver%20%5Boption%5D%20filename%5Cn%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2B%20%22options%3A%5Cn%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2B%20%22%5Be%5Dxtract%5Cn%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2B%20%22%5Ba%5Drchive%22%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20the%20application%20entry%20point%0A%20%20%20%20%20*%20%40param%20args%20(command%20line)%20parameters%0A%20%20%20%20%20*%2F%0A%20%20%20%20public%20static%20void%20main(String%20args%5B%5D)%20throws%20Exception%20%7B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20check%20command%20line%20arguments%0A%20%20%20%20%20%20%20%20if%20(args.length%20!%3D%202)%20error(USAGE)%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20if%20(%22e%22.equals(args%5B0%5D.trim()))%20%7B%20%2F%2F%20extract%20files%20from%20archive%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20String%20filename%20%3D%20args%5B1%5D.trim()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(filename.length()%20%3D%3D%200)%20error(%222nd%20argument%20not%20exist.%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20extractFiles(filename)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%7D%20else%20if%20(%22a%22.equals(args%5B0%5D.trim()))%20%7B%20%2F%2F%20pack%20files%20into%20archive%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20String%20dirname%20%3D%20args%5B1%5D.trim()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(dirname.length()%20%3D%3D%200)%20error(%222nd%20argument%20not%20exist.%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20packFiles(dirname)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%7D%20else%20error(USAGE)%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20private%20static%20void%20extractFiles(String%20filename)%20throws%20Exception%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20open%20source%20archive%0A%20%20%20%20%20%20%20%20File%20arc%20%3D%20new%20File(filename)%3B%0A%20%20%20%20%20%20%20%20if%20(!arc.exists())%20error(%22Archive%20%22%20%2B%20filename%20%2B%20%22%20doesn't%20exist%22)%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20long%20contentOfs%20%3D%200L%3B%0A%20%20%20%20%20%20%20%20IndexEntry%5B%5D%20indexEntries%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20FileInputStream%20fis%20%3D%20new%20FileInputStream(arc)%3B%0A%20%20%20%20%20%20%20%20DataInputStream%20dis%20%3D%20new%20DataInputStream(fis)%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20match%20archive%20SIGNATURE%0A%20%20%20%20%20%20%20%20byte%5B%5D%20sig%20%3D%20new%20byte%5B8%5D%3B%0A%20%20%20%20%20%20%20%20dis.read(sig)%3B%0A%20%20%20%20%20%20%20%20if%20(!Arrays.equals(SIGNATURE%2C%20sig))%20error(%22Archive%20file%20not%20supported.%22)%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20get%20file%20count%0A%20%20%20%20%20%20%20%20int%20fileCount%20%3D%20reverseEndian(dis.readInt())%3B%0A%20%20%20%20%20%20%20%20System.out.println(%22Files%20in%20archive%3A%20%22%20%2B%20fileCount)%3B%0A%20%20%20%20%20%20%20%20indexEntries%20%3D%20new%20IndexEntry%5BfileCount%5D%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20read%20index%20entries%0A%20%20%20%20%20%20%20%20byte%5B%5D%20entryBuffer%20%3D%20new%20byte%5BENTRY_LENGTH%5D%3B%0A%20%20%20%20%20%20%20%20for%20(int%20i%20%3D%200%3B%20i%20%3C%20fileCount%3B%20%2B%2Bi)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20IndexEntry%20entry%20%3D%20new%20IndexEntry()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20dis.read(entryBuffer)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20ByteArrayInputStream%20bais%20%3D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20new%20ByteArrayInputStream(entryBuffer)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20String%20name%20%3D%20readCString(bais)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20entry.setFilename(name)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20System.err.print(%22File%20%5C%22%22%20%2B%20entry.getFilename()%20%2B%20%22%5C%22%20%3A%20%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20int%20offset%20%3D%20BinConverter.byteArrayToIntLE(entryBuffer%2C%20OFFSET_OFS)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20entry.setOffset(offset)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20System.err.print(%22%20at%20relative%20offset%200x%22%20%2B%20Integer.toHexString(entry.getOffset()).toUpperCase())%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20int%20length%20%3D%20BinConverter.byteArrayToIntLE(entryBuffer%2C%20LENGTH_OFS)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20entry.setLength(length)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20System.err.print(%22%20size%3A%200x%22%20%2B%20Integer.toHexString(entry.getLength()).toUpperCase())%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20int%20compressedLength%20%3D%20BinConverter.byteArrayToIntLE(entryBuffer%2C%20COMPRESSED_LENGTH_OFS)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20entry.setCompressedLength(compressedLength)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20System.err.println(%22%20csize%3A%200x%22%20%2B%20Integer.toHexString(entry.getCompressedLength()).toUpperCase())%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(length%20%3E%20compressedLength)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20System.err.println(%22possibly%20compressed%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20System.exit(1)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%20(length%20%3C%20compressedLength)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20System.err.println(%22possibly%20compressed%2C%20got%20length%2FcompressedLength%20wrong...%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20System.exit(1)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20indexEntries%5Bi%5D%20%3D%20entry%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20extract%20files%0A%20%20%20%20%20%20%20%20for%20(IndexEntry%20entry%20%3A%20indexEntries)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20data%20correctness%20check%20-%20this%20support%20ordered%20file%20archive%20only.%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20to%20support%20out-of-order%20archives%2C%20use%20RandomAccessFile%20instead.%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(fis.getChannel().position()%20!%3D%20entry.getOffset())%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20error(%22Bad%20file%20content%20order%20at%20%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2B%20entry.getFilename()%20%2B%20%22%200x%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2B%20Integer.toHexString((int)(fis.getChannel().position()%20-%20contentOfs)))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20File%20outfile%20%3D%20new%20File(%22.%2F%22%20%2B%20entry.getFilename())%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20File%20parentDir%20%3D%20outfile.getParentFile()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(!parentDir.exists())%20parentDir.mkdirs()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20BufferedOutputStream%20bos%20%3D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20new%20BufferedOutputStream(new%20FileOutputStream(outfile)%2C%200x7FFFFF)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20int%20remainder%20%3D%200%3B%20%2F%2F%20keep%20track%20of%20the%20amount%20of%20remaining%20bytes%0A%20%20%20%20%20%20%20%20%20%20%20%20int%20length%20%3D%20entry.getLength()%3B%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20while%20(fis.available()%20!%3D%200%20%26%26%20remainder%20!%3D%20length)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20bos.write(fis.read())%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2B%2Bremainder%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20bos.flush()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20bos.close()%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20fis.close()%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20private%20static%20void%20packFiles(String%20dirname)%20throws%20Exception%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20open%20source%20directory%0A%20%20%20%20%20%20%20%20File%20dir%20%3D%20new%20File(dirname)%3B%0A%20%20%20%20%20%20%20%20if%20(!dir.exists())%20error(%22Directory%20%22%20%2B%20dirname%20%2B%20%22%20doesn't%20exist%22)%3B%0A%20%20%20%20%20%20%20%20else%20if%20(!dir.isDirectory())%20error(dirname%20%2B%20%22%20is%20not%20a%20valid%20directory.%22)%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20use%20a%20ArrayList%20to%20store%20the%20index%20entries%0A%20%20%20%20%20%20%20%20ArrayList%3CIndexEntry%3E%20indexEntries%20%3D%20new%20ArrayList%3CIndexEntry%3E()%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20make%20up%20index%20data%0A%20%20%20%20%20%20%20%20buildIndex(dir%2C%20indexEntries%2C%20%22%22)%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20calculate%20the%20offset%20values%20for%20each%20file%20record%0A%20%20%20%20%20%20%20%20int%20runningOfs%20%3D%20SIGNATURE.length%20%2B%204%20%2B%20ENTRY_LENGTH%20*%20indexEntries.size()%3B%0A%20%20%20%20%20%20%20%20for%20(IndexEntry%20entry%20%3A%20indexEntries)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20entry.setOffset(runningOfs)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20runningOfs%20%2B%3D%20entry.getLength()%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20write%20out%20archive%20SIGNATURE%20and%20file%20count%0A%20%20%20%20%20%20%20%20DataOutputStream%20dos%20%3D%0A%20%20%20%20%20%20%20%20%20%20%20%20new%20DataOutputStream(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20new%20BufferedOutputStream(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20new%20FileOutputStream(dir.getName()%20%2B%20%22.dat%22)))%3B%0A%20%20%20%20%20%20%20%20dos.write(SIGNATURE)%3B%0A%20%20%20%20%20%20%20%20dos.writeInt(reverseEndian(indexEntries.size()))%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20write%20out%20the%20file%20index%0A%20%20%20%20%20%20%20%20for%20(IndexEntry%20entry%20%3A%20indexEntries)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20System.err.println(%22Adding%20file%20%22%20%2B%20entry.getFilename()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2B%20%22%20size%3A%200x%22%20%2B%20Integer.toHexString(entry.getLength()).toUpperCase()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2B%20%22%20at%20relative%20offset%3A%200x%22%20%2B%20Integer.toHexString(entry.getOffset()).toUpperCase())%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20int%20zeroCount%20%3D%20MAX_FILENAME_LENGTH%20-%20entry.getFilename().length()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20dos.write(entry.getFilename().getBytes())%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20(int%20i%20%3D%200%3B%20i%20%3C%20zeroCount%3B%20%2B%2Bi)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20dos.write(0)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20dos.writeInt(reverseEndian(entry.getOffset()))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20dos.writeInt(reverseEndian(entry.getLength()))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20dos.writeInt(reverseEndian(entry.getLength()))%3B%20%2F%2F%20NOTE!%20Does%20NOT%20support%20compressed%20files%20at%20current%20time%20being%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20write%20out%20each%20file's%20content%0A%20%20%20%20%20%20%20%20for(IndexEntry%20entry%20%3A%20indexEntries)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20BufferedInputStream%20bis%20%3D%20new%20BufferedInputStream(new%20FileInputStream(dir.getAbsolutePath()%20%2B%20%22%5C%5C%22%20%2B%20entry.getFilename()))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20while%20(bis.available()%20!%3D%200)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20dos.writeByte(bis.read())%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20bis.close()%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20dos.flush()%3B%0A%20%20%20%20%20%20%20%20dos.close()%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20private%20static%20int%20reverseEndian(int%20i)%20%7B%0A%20%20%20%20%20%20%20%20byte%5B%5D%20bytes%20%3D%20new%20byte%5B4%5D%3B%0A%20%20%20%20%20%20%20%20bytes%5B0%5D%20%3D%20(byte)(i%20%3E%3E%3E%2024)%3B%0A%20%20%20%20%20%20%20%20bytes%5B1%5D%20%3D%20(byte)(i%20%3E%3E%3E%2016)%3B%0A%20%20%20%20%20%20%20%20bytes%5B2%5D%20%3D%20(byte)(i%20%3E%3E%3E%208%20)%3B%0A%20%20%20%20%20%20%20%20bytes%5B3%5D%20%3D%20(byte)%20i%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20i%20%20%3D%20%20bytes%5B3%5D%20%3C%3C%2024%3B%0A%20%20%20%20%20%20%20%20i%20%7C%3D%20(bytes%5B2%5D%20%3C%3C%2016%20)%20%26%200x0ff0000%3B%0A%20%20%20%20%20%20%20%20i%20%7C%3D%20(bytes%5B1%5D%20%3C%3C%20%208%20)%20%26%200x000ff00%3B%0A%20%20%20%20%20%20%20%20i%20%7C%3D%20%20bytes%5B0%5D%20%20%20%20%20%20%20%20%26%200x00000ff%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20return%20i%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20private%20static%20int%20reverseEndian(short%20s)%20%7B%0A%20%20%20%20%20%20%20%20byte%5B%5D%20bytes%20%3D%20new%20byte%5B2%5D%3B%0A%20%20%20%20%20%20%20%20bytes%5B0%5D%20%3D%20(byte)(s%20%3E%3E%3E%208%20)%3B%0A%20%20%20%20%20%20%20%20bytes%5B1%5D%20%3D%20(byte)%20s%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20int%20i%20%3D%200%3B%0A%20%20%20%20%20%20%20%20i%20%7C%3D%20(bytes%5B1%5D%20%3C%3C%20%208%20)%20%26%200x000ff00%3B%0A%20%20%20%20%20%20%20%20i%20%7C%3D%20%20bytes%5B0%5D%20%20%20%20%20%20%20%20%20%26%200x00000ff%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20return%20i%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20private%20static%20void%20error(String%20cause)%20%7B%0A%20%20%20%20%20%20%20%20System.err.println(%22Error%20%22%20%2B%20cause)%3B%0A%20%20%20%20%20%20%20%20System.exit(1)%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20private%20static%20String%20readCString(InputStream%20in)%20throws%20IOException%20%7B%0A%20%20%20%20%20%20%20%20ArrayList%3CByte%3E%20str%20%3D%20new%20ArrayList%3CByte%3E()%3B%0A%20%20%20%20%20%20%20%20byte%20current%20%3D%20(byte)in.read()%3B%0A%20%20%20%20%20%20%20%20while%20(current%20!%3D%20(byte)0x00)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20str.add(current)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20current%20%3D%20(byte)in.read()%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20byte%5B%5D%20temp%20%3D%20new%20byte%5Bstr.size()%5D%3B%0A%20%20%20%20%20%20%20%20for%20(int%20i%20%3D%200%3B%20i%20%3C%20temp.length%3B%20%2B%2Bi)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20temp%5Bi%5D%20%3D%20str.get(i)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20return%20new%20String(temp)%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20private%20static%20void%20buildIndex(File%20dir%2C%20ArrayList%3CIndexEntry%3E%20index%2C%20String%20parent)%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20list%20the%20designated%20directory%0A%20%20%20%20%20%20%20%20File%5B%5D%20files%20%3D%20dir.listFiles()%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20traverse%20dir%0A%20%20%20%20%20%20%20%20for%20(int%20i%20%3D%200%3B%20i%20%3C%20files.length%3B%20%2B%2Bi)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(files%5Bi%5D.isDirectory())%20%7B%20%2F%2F%20current%20file%20is%20a%20directory%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20assumes%20that%20subdir%20depth%20doesn't%20exceed%20one%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20buildIndex(files%5Bi%5D%2C%20index%2C%20parent%2Bfiles%5Bi%5D.getName()%2B%22%5C%5C%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%20%2F%2F%20current%20file%20is%20a%20normal%20file%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20IndexEntry%20entry%20%3D%20new%20IndexEntry()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20entry.setFilename(parent%2Bfiles%5Bi%5D.getName())%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20entry.setLength((int)files%5Bi%5D.length())%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20index.add(entry)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%7D" quality="high" allowscriptaccess="always" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer">&nbsp;<a href="javascript:void()" title="收藏这段代码" onclick="code_favorites_do_favorite(this);return false;" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="star" src="assets/1571225752-bf632ec55a05f69a9359f73417402b26.png" alt="收藏代码"><img class="spinner" src="assets/1571225752-a42df3a5b569bdc98ca473a4a3adfeac.gif" style="display:none"></a></div></div><ol start="1" class="dp-j"><li><span><span class="comment">/*</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;*&nbsp;@(#)Archiver.java&nbsp;&nbsp;2007/03/23</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;*&nbsp;Written&nbsp;by&nbsp;rednaxela&nbsp;/&nbsp;FX</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span><span class="keyword">import</span><span>&nbsp;java.io.*;&nbsp;&nbsp;</span></span></li><li><span><span class="keyword">import</span><span>&nbsp;java.util.*;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span><span class="comment">/**</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;*&nbsp;Demonstrating&nbsp;archive&nbsp;operations&nbsp;on&nbsp;*.dat&nbsp;files&nbsp;as&nbsp;seen&nbsp;in&nbsp;BattleMoonWars.</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li><span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">class</span><span>&nbsp;Archiver&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">byte</span><span>[]&nbsp;SIGNATURE&nbsp;=&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="keyword">byte</span><span>)</span><span class="string">'y'</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="string">'a'</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="string">'n'</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="string">'e'</span><span>,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="keyword">byte</span><span>)</span><span class="string">'p'</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="string">'k'</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="string">'D'</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="string">'x'</span><span>,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;};&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;ENTRY_LENGTH&nbsp;=&nbsp;</span><span class="number">268</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;MAX_FILENAME_LENGTH&nbsp;=&nbsp;</span><span class="number">256</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;OFFSET_OFS&nbsp;=&nbsp;</span><span class="number">256</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;LENGTH_OFS&nbsp;=&nbsp;</span><span class="number">260</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;COMPRESSED_LENGTH_OFS&nbsp;=&nbsp;</span><span class="number">264</span><span>;&nbsp;</span><span class="comment">//&nbsp;??</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;String&nbsp;USAGE&nbsp;=&nbsp;</span><span class="string">"Usage:&nbsp;java&nbsp;Archiver&nbsp;[option]&nbsp;filename\n"</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;<span class="string">"options:\n"</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;<span class="string">"[e]xtract\n"</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;<span class="string">"[a]rchive"</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;the&nbsp;application&nbsp;entry&nbsp;point</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;args&nbsp;(command&nbsp;line)&nbsp;parameters</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;main(String&nbsp;args[])&nbsp;</span><span class="keyword">throws</span><span>&nbsp;Exception&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;check&nbsp;command&nbsp;line&nbsp;arguments</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(args.length&nbsp;!=&nbsp;</span><span class="number">2</span><span>)&nbsp;error(USAGE);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(</span><span class="string">"e"</span><span>.equals(args[</span><span class="number">0</span><span>].trim()))&nbsp;{&nbsp;</span><span class="comment">//&nbsp;extract&nbsp;files&nbsp;from&nbsp;archive</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;filename&nbsp;=&nbsp;args[<span class="number">1</span><span>].trim();&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(filename.length()&nbsp;==&nbsp;</span><span class="number">0</span><span>)&nbsp;error(</span><span class="string">"2nd&nbsp;argument&nbsp;not&nbsp;exist."</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;extractFiles(filename);&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<span class="keyword">else</span><span>&nbsp;</span><span class="keyword">if</span><span>&nbsp;(</span><span class="string">"a"</span><span>.equals(args[</span><span class="number">0</span><span>].trim()))&nbsp;{&nbsp;</span><span class="comment">//&nbsp;pack&nbsp;files&nbsp;into&nbsp;archive</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;dirname&nbsp;=&nbsp;args[<span class="number">1</span><span>].trim();&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(dirname.length()&nbsp;==&nbsp;</span><span class="number">0</span><span>)&nbsp;error(</span><span class="string">"2nd&nbsp;argument&nbsp;not&nbsp;exist."</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;packFiles(dirname);&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<span class="keyword">else</span><span>&nbsp;error(USAGE);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;extractFiles(String&nbsp;filename)&nbsp;</span><span class="keyword">throws</span><span>&nbsp;Exception&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;open&nbsp;source&nbsp;archive</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;File&nbsp;arc&nbsp;=&nbsp;<span class="keyword">new</span><span>&nbsp;File(filename);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(!arc.exists())&nbsp;error(</span><span class="string">"Archive&nbsp;"</span><span>&nbsp;+&nbsp;filename&nbsp;+&nbsp;</span><span class="string">"&nbsp;doesn't&nbsp;exist"</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">long</span><span>&nbsp;contentOfs&nbsp;=&nbsp;0L;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IndexEntry[]&nbsp;indexEntries&nbsp;=&nbsp;<span class="keyword">null</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FileInputStream&nbsp;fis&nbsp;=&nbsp;<span class="keyword">new</span><span>&nbsp;FileInputStream(arc);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DataInputStream&nbsp;dis&nbsp;=&nbsp;<span class="keyword">new</span><span>&nbsp;DataInputStream(fis);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;match&nbsp;archive&nbsp;SIGNATURE</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>[]&nbsp;sig&nbsp;=&nbsp;</span><span class="keyword">new</span><span>&nbsp;</span><span class="keyword">byte</span><span>[</span><span class="number">8</span><span>];&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dis.read(sig);&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(!Arrays.equals(SIGNATURE,&nbsp;sig))&nbsp;error(</span><span class="string">"Archive&nbsp;file&nbsp;not&nbsp;supported."</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;get&nbsp;file&nbsp;count</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;fileCount&nbsp;=&nbsp;reverseEndian(dis.readInt());&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.out.println(<span class="string">"Files&nbsp;in&nbsp;archive:&nbsp;"</span><span>&nbsp;+&nbsp;fileCount);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;indexEntries&nbsp;=&nbsp;<span class="keyword">new</span><span>&nbsp;IndexEntry[fileCount];&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;read&nbsp;index&nbsp;entries</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>[]&nbsp;entryBuffer&nbsp;=&nbsp;</span><span class="keyword">new</span><span>&nbsp;</span><span class="keyword">byte</span><span>[ENTRY_LENGTH];&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span><span>&nbsp;(</span><span class="keyword">int</span><span>&nbsp;i&nbsp;=&nbsp;</span><span class="number">0</span><span>;&nbsp;i&nbsp;&lt;&nbsp;fileCount;&nbsp;++i)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IndexEntry&nbsp;entry&nbsp;=&nbsp;<span class="keyword">new</span><span>&nbsp;IndexEntry();&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dis.read(entryBuffer);&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ByteArrayInputStream&nbsp;bais&nbsp;=&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">new</span><span>&nbsp;ByteArrayInputStream(entryBuffer);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;name&nbsp;=&nbsp;readCString(bais);&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entry.setFilename(name);&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.err.print(<span class="string">"File&nbsp;\""</span><span>&nbsp;+&nbsp;entry.getFilename()&nbsp;+&nbsp;</span><span class="string">"\"&nbsp;:&nbsp;"</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;offset&nbsp;=&nbsp;BinConverter.byteArrayToIntLE(entryBuffer,&nbsp;OFFSET_OFS);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entry.setOffset(offset);&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.err.print(<span class="string">"&nbsp;at&nbsp;relative&nbsp;offset&nbsp;0x"</span><span>&nbsp;+&nbsp;Integer.toHexString(entry.getOffset()).toUpperCase());&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;length&nbsp;=&nbsp;BinConverter.byteArrayToIntLE(entryBuffer,&nbsp;LENGTH_OFS);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entry.setLength(length);&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.err.print(<span class="string">"&nbsp;size:&nbsp;0x"</span><span>&nbsp;+&nbsp;Integer.toHexString(entry.getLength()).toUpperCase());&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;compressedLength&nbsp;=&nbsp;BinConverter.byteArrayToIntLE(entryBuffer,&nbsp;COMPRESSED_LENGTH_OFS);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entry.setCompressedLength(compressedLength);&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.err.println(<span class="string">"&nbsp;csize:&nbsp;0x"</span><span>&nbsp;+&nbsp;Integer.toHexString(entry.getCompressedLength()).toUpperCase());&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(length&nbsp;&gt;&nbsp;compressedLength)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.err.println(<span class="string">"possibly&nbsp;compressed"</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.exit(<span class="number">1</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<span class="keyword">else</span><span>&nbsp;</span><span class="keyword">if</span><span>&nbsp;(length&nbsp;&lt;&nbsp;compressedLength)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.err.println(<span class="string">"possibly&nbsp;compressed,&nbsp;got&nbsp;length/compressedLength&nbsp;wrong..."</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.exit(<span class="number">1</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;indexEntries[i]&nbsp;=&nbsp;entry;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;extract&nbsp;files</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span><span>&nbsp;(IndexEntry&nbsp;entry&nbsp;:&nbsp;indexEntries)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;data&nbsp;correctness&nbsp;check&nbsp;-&nbsp;this&nbsp;support&nbsp;ordered&nbsp;file&nbsp;archive&nbsp;only.</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;to&nbsp;support&nbsp;out-of-order&nbsp;archives,&nbsp;use&nbsp;RandomAccessFile&nbsp;instead.</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(fis.getChannel().position()&nbsp;!=&nbsp;entry.getOffset())&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error(<span class="string">"Bad&nbsp;file&nbsp;content&nbsp;order&nbsp;at&nbsp;"</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;entry.getFilename()&nbsp;+&nbsp;<span class="string">"&nbsp;0x"</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;Integer.toHexString((<span class="keyword">int</span><span>)(fis.getChannel().position()&nbsp;-&nbsp;contentOfs)));&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;File&nbsp;outfile&nbsp;=&nbsp;<span class="keyword">new</span><span>&nbsp;File(</span><span class="string">"./"</span><span>&nbsp;+&nbsp;entry.getFilename());&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;File&nbsp;parentDir&nbsp;=&nbsp;outfile.getParentFile();&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(!parentDir.exists())&nbsp;parentDir.mkdirs();&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BufferedOutputStream&nbsp;bos&nbsp;=&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">new</span><span>&nbsp;BufferedOutputStream(</span><span class="keyword">new</span><span>&nbsp;FileOutputStream(outfile),&nbsp;</span><span class="number">0x7FFFFF</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;remainder&nbsp;=&nbsp;</span><span class="number">0</span><span>;&nbsp;</span><span class="comment">//&nbsp;keep&nbsp;track&nbsp;of&nbsp;the&nbsp;amount&nbsp;of&nbsp;remaining&nbsp;bytes</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;length&nbsp;=&nbsp;entry.getLength();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">while</span><span>&nbsp;(fis.available()&nbsp;!=&nbsp;</span><span class="number">0</span><span>&nbsp;&amp;&amp;&nbsp;remainder&nbsp;!=&nbsp;length)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bos.write(fis.read());&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++remainder;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bos.flush();&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bos.close();&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fis.close();&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;packFiles(String&nbsp;dirname)&nbsp;</span><span class="keyword">throws</span><span>&nbsp;Exception&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;open&nbsp;source&nbsp;directory</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;File&nbsp;dir&nbsp;=&nbsp;<span class="keyword">new</span><span>&nbsp;File(dirname);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(!dir.exists())&nbsp;error(</span><span class="string">"Directory&nbsp;"</span><span>&nbsp;+&nbsp;dirname&nbsp;+&nbsp;</span><span class="string">"&nbsp;doesn't&nbsp;exist"</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><span>&nbsp;</span><span class="keyword">if</span><span>&nbsp;(!dir.isDirectory())&nbsp;error(dirname&nbsp;+&nbsp;</span><span class="string">"&nbsp;is&nbsp;not&nbsp;a&nbsp;valid&nbsp;directory."</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;use&nbsp;a&nbsp;ArrayList&nbsp;to&nbsp;store&nbsp;the&nbsp;index&nbsp;entries</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ArrayList&lt;IndexEntry&gt;&nbsp;indexEntries&nbsp;=&nbsp;<span class="keyword">new</span><span>&nbsp;ArrayList&lt;IndexEntry&gt;();&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;make&nbsp;up&nbsp;index&nbsp;data</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buildIndex(dir,&nbsp;indexEntries,&nbsp;<span class="string">""</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;calculate&nbsp;the&nbsp;offset&nbsp;values&nbsp;for&nbsp;each&nbsp;file&nbsp;record</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;runningOfs&nbsp;=&nbsp;SIGNATURE.length&nbsp;+&nbsp;</span><span class="number">4</span><span>&nbsp;+&nbsp;ENTRY_LENGTH&nbsp;*&nbsp;indexEntries.size();&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span><span>&nbsp;(IndexEntry&nbsp;entry&nbsp;:&nbsp;indexEntries)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entry.setOffset(runningOfs);&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;runningOfs&nbsp;+=&nbsp;entry.getLength();&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;write&nbsp;out&nbsp;archive&nbsp;SIGNATURE&nbsp;and&nbsp;file&nbsp;count</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DataOutputStream&nbsp;dos&nbsp;=&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">new</span><span>&nbsp;DataOutputStream(&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">new</span><span>&nbsp;BufferedOutputStream(&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">new</span><span>&nbsp;FileOutputStream(dir.getName()&nbsp;+&nbsp;</span><span class="string">".dat"</span><span>)));&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dos.write(SIGNATURE);&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dos.writeInt(reverseEndian(indexEntries.size()));&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;write&nbsp;out&nbsp;the&nbsp;file&nbsp;index</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span><span>&nbsp;(IndexEntry&nbsp;entry&nbsp;:&nbsp;indexEntries)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.err.println(<span class="string">"Adding&nbsp;file&nbsp;"</span><span>&nbsp;+&nbsp;entry.getFilename()&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;<span class="string">"&nbsp;size:&nbsp;0x"</span><span>&nbsp;+&nbsp;Integer.toHexString(entry.getLength()).toUpperCase()&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;<span class="string">"&nbsp;at&nbsp;relative&nbsp;offset:&nbsp;0x"</span><span>&nbsp;+&nbsp;Integer.toHexString(entry.getOffset()).toUpperCase());&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;zeroCount&nbsp;=&nbsp;MAX_FILENAME_LENGTH&nbsp;-&nbsp;entry.getFilename().length();&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dos.write(entry.getFilename().getBytes());&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span><span>&nbsp;(</span><span class="keyword">int</span><span>&nbsp;i&nbsp;=&nbsp;</span><span class="number">0</span><span>;&nbsp;i&nbsp;&lt;&nbsp;zeroCount;&nbsp;++i)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dos.write(<span class="number">0</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dos.writeInt(reverseEndian(entry.getOffset()));&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dos.writeInt(reverseEndian(entry.getLength()));&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dos.writeInt(reverseEndian(entry.getLength()));&nbsp;<span class="comment">//&nbsp;NOTE!&nbsp;Does&nbsp;NOT&nbsp;support&nbsp;compressed&nbsp;files&nbsp;at&nbsp;current&nbsp;time&nbsp;being</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;write&nbsp;out&nbsp;each&nbsp;file's&nbsp;content</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span><span>(IndexEntry&nbsp;entry&nbsp;:&nbsp;indexEntries)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BufferedInputStream&nbsp;bis&nbsp;=&nbsp;<span class="keyword">new</span><span>&nbsp;BufferedInputStream(</span><span class="keyword">new</span><span>&nbsp;FileInputStream(dir.getAbsolutePath()&nbsp;+&nbsp;</span><span class="string">"\\"</span><span>&nbsp;+&nbsp;entry.getFilename()));&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">while</span><span>&nbsp;(bis.available()&nbsp;!=&nbsp;</span><span class="number">0</span><span>)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dos.writeByte(bis.read());&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bis.close();&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dos.flush();&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dos.close();&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;reverseEndian(</span><span class="keyword">int</span><span>&nbsp;i)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>[]&nbsp;bytes&nbsp;=&nbsp;</span><span class="keyword">new</span><span>&nbsp;</span><span class="keyword">byte</span><span>[</span><span class="number">4</span><span>];&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bytes[<span class="number">0</span><span>]&nbsp;=&nbsp;(</span><span class="keyword">byte</span><span>)(i&nbsp;&gt;&gt;&gt;&nbsp;</span><span class="number">24</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bytes[<span class="number">1</span><span>]&nbsp;=&nbsp;(</span><span class="keyword">byte</span><span>)(i&nbsp;&gt;&gt;&gt;&nbsp;</span><span class="number">16</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bytes[<span class="number">2</span><span>]&nbsp;=&nbsp;(</span><span class="keyword">byte</span><span>)(i&nbsp;&gt;&gt;&gt;&nbsp;</span><span class="number">8</span><span>&nbsp;);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bytes[<span class="number">3</span><span>]&nbsp;=&nbsp;(</span><span class="keyword">byte</span><span>)&nbsp;i;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;&nbsp;=&nbsp;&nbsp;bytes[<span class="number">3</span><span>]&nbsp;&lt;&lt;&nbsp;</span><span class="number">24</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;|=&nbsp;(bytes[<span class="number">2</span><span>]&nbsp;&lt;&lt;&nbsp;</span><span class="number">16</span><span>&nbsp;)&nbsp;&amp;&nbsp;</span><span class="number">0x0ff0000</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;|=&nbsp;(bytes[<span class="number">1</span><span>]&nbsp;&lt;&lt;&nbsp;&nbsp;</span><span class="number">8</span><span>&nbsp;)&nbsp;&amp;&nbsp;</span><span class="number">0x000ff00</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;|=&nbsp;&nbsp;bytes[<span class="number">0</span><span>]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&nbsp;</span><span class="number">0x00000ff</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;i;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;reverseEndian(</span><span class="keyword">short</span><span>&nbsp;s)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>[]&nbsp;bytes&nbsp;=&nbsp;</span><span class="keyword">new</span><span>&nbsp;</span><span class="keyword">byte</span><span>[</span><span class="number">2</span><span>];&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bytes[<span class="number">0</span><span>]&nbsp;=&nbsp;(</span><span class="keyword">byte</span><span>)(s&nbsp;&gt;&gt;&gt;&nbsp;</span><span class="number">8</span><span>&nbsp;);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bytes[<span class="number">1</span><span>]&nbsp;=&nbsp;(</span><span class="keyword">byte</span><span>)&nbsp;s;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;i&nbsp;=&nbsp;</span><span class="number">0</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;|=&nbsp;(bytes[<span class="number">1</span><span>]&nbsp;&lt;&lt;&nbsp;&nbsp;</span><span class="number">8</span><span>&nbsp;)&nbsp;&amp;&nbsp;</span><span class="number">0x000ff00</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;|=&nbsp;&nbsp;bytes[<span class="number">0</span><span>]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&nbsp;</span><span class="number">0x00000ff</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;i;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;error(String&nbsp;cause)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.err.println(<span class="string">"Error&nbsp;"</span><span>&nbsp;+&nbsp;cause);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.exit(<span class="number">1</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;String&nbsp;readCString(InputStream&nbsp;in)&nbsp;</span><span class="keyword">throws</span><span>&nbsp;IOException&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ArrayList&lt;Byte&gt;&nbsp;str&nbsp;=&nbsp;<span class="keyword">new</span><span>&nbsp;ArrayList&lt;Byte&gt;();&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>&nbsp;current&nbsp;=&nbsp;(</span><span class="keyword">byte</span><span>)in.read();&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">while</span><span>&nbsp;(current&nbsp;!=&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0x00</span><span>)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;str.add(current);&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;current&nbsp;=&nbsp;(<span class="keyword">byte</span><span>)in.read();&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>[]&nbsp;temp&nbsp;=&nbsp;</span><span class="keyword">new</span><span>&nbsp;</span><span class="keyword">byte</span><span>[str.size()];&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span><span>&nbsp;(</span><span class="keyword">int</span><span>&nbsp;i&nbsp;=&nbsp;</span><span class="number">0</span><span>;&nbsp;i&nbsp;&lt;&nbsp;temp.length;&nbsp;++i)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp[i]&nbsp;=&nbsp;str.get(i);&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;</span><span class="keyword">new</span><span>&nbsp;String(temp);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;buildIndex(File&nbsp;dir,&nbsp;ArrayList&lt;IndexEntry&gt;&nbsp;index,&nbsp;String&nbsp;parent)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;list&nbsp;the&nbsp;designated&nbsp;directory</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;File[]&nbsp;files&nbsp;=&nbsp;dir.listFiles();&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;traverse&nbsp;dir</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span><span>&nbsp;(</span><span class="keyword">int</span><span>&nbsp;i&nbsp;=&nbsp;</span><span class="number">0</span><span>;&nbsp;i&nbsp;&lt;&nbsp;files.length;&nbsp;++i)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(files[i].isDirectory())&nbsp;{&nbsp;</span><span class="comment">//&nbsp;current&nbsp;file&nbsp;is&nbsp;a&nbsp;directory</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;assumes&nbsp;that&nbsp;subdir&nbsp;depth&nbsp;doesn't&nbsp;exceed&nbsp;one</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buildIndex(files[i],&nbsp;index,&nbsp;parent+files[i].getName()+<span class="string">"\\"</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<span class="keyword">else</span><span>&nbsp;{&nbsp;</span><span class="comment">//&nbsp;current&nbsp;file&nbsp;is&nbsp;a&nbsp;normal&nbsp;file</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IndexEntry&nbsp;entry&nbsp;=&nbsp;<span class="keyword">new</span><span>&nbsp;IndexEntry();&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entry.setFilename(parent+files[i].getName());&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;entry.setLength((<span class="keyword">int</span><span>)files[i].length());&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;index.add(entry);&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>}&nbsp;&nbsp;</span></li></ol></div>
<br>
<br>IndexEntry.java:
<br><div class="dp-highlighter" id=""><div class="bar"><div class="tools">Java代码 <embed wmode="transparent" src="/javascripts/syntaxhighlighter/clipboard_new.swf" width="14" height="15" flashvars="clipboard=%2F*%0A%20*%20%40(%23)IndexEntry.java%20%202007%2F03%2F23%0A%20*%20Written%20by%20rednaxela%20%2F%20FX%0A%20*%2F%0A%0Apublic%20class%20IndexEntry%20%7B%0A%20%20%20%20%0A%20%20%20%20private%20String%20filename%3B%0A%20%20%20%20private%20int%20length%3B%0A%20%20%20%20private%20int%20offset%3B%0A%20%20%20%20private%20int%20compressedLength%3B%20%2F%2F%20TODO%20not%20yet%20implemented%20-%20CHECK!%0A%20%20%20%20%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40return%20the%20filename%0A%20%20%20%20%20*%2F%0A%20%20%20%20public%20String%20getFilename()%20%7B%0A%20%20%20%20%20%20%20%20return%20filename%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40param%20filename%20the%20filename%20to%20set%0A%20%20%20%20%20*%2F%0A%20%20%20%20public%20void%20setFilename(String%20filename)%20%7B%0A%20%20%20%20%20%20%20%20this.filename%20%3D%20filename%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40return%20the%20length%0A%20%20%20%20%20*%2F%0A%20%20%20%20public%20int%20getLength()%20%7B%0A%20%20%20%20%20%20%20%20return%20length%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40param%20length%20the%20length%20to%20set%0A%20%20%20%20%20*%2F%0A%20%20%20%20public%20void%20setLength(int%20length)%20%7B%0A%20%20%20%20%20%20%20%20this.length%20%3D%20length%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40return%20the%20offset%0A%20%20%20%20%20*%2F%0A%20%20%20%20public%20int%20getOffset()%20%7B%0A%20%20%20%20%20%20%20%20return%20offset%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40param%20offset%20the%20offset%20to%20set%0A%20%20%20%20%20*%2F%0A%20%20%20%20public%20void%20setOffset(int%20offset)%20%7B%0A%20%20%20%20%20%20%20%20this.offset%20%3D%20offset%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40return%20the%20compressedLength%0A%20%20%20%20%20*%2F%0A%20%20%20%20public%20int%20getCompressedLength()%20%7B%0A%20%20%20%20%20%20%20%20return%20compressedLength%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20%40param%20offset%20the%20compressedLength%20to%20set%0A%20%20%20%20%20*%2F%0A%20%20%20%20public%20void%20setCompressedLength(int%20compressedLength)%20%7B%0A%20%20%20%20%20%20%20%20this.compressedLength%20%3D%20compressedLength%3B%0A%20%20%20%20%7D%0A%7D" quality="high" allowscriptaccess="always" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer">&nbsp;<a href="javascript:void()" title="收藏这段代码" onclick="code_favorites_do_favorite(this);return false;" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="star" src="assets/1571225752-bf632ec55a05f69a9359f73417402b26.png" alt="收藏代码"><img class="spinner" src="assets/1571225752-a42df3a5b569bdc98ca473a4a3adfeac.gif" style="display:none"></a></div></div><ol start="1" class="dp-j"><li><span><span class="comment">/*</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;*&nbsp;@(#)IndexEntry.java&nbsp;&nbsp;2007/03/23</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;*&nbsp;Written&nbsp;by&nbsp;rednaxela&nbsp;/&nbsp;FX</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">class</span><span>&nbsp;IndexEntry&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;String&nbsp;filename;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;length;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;offset;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;compressedLength;&nbsp;</span><span class="comment">//&nbsp;TODO&nbsp;not&nbsp;yet&nbsp;implemented&nbsp;-&nbsp;CHECK!</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;filename</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;String&nbsp;getFilename()&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;filename;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;filename&nbsp;the&nbsp;filename&nbsp;to&nbsp;set</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;setFilename(String&nbsp;filename)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">this</span><span>.filename&nbsp;=&nbsp;filename;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;length</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;getLength()&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;length;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;length&nbsp;the&nbsp;length&nbsp;to&nbsp;set</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;setLength(</span><span class="keyword">int</span><span>&nbsp;length)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">this</span><span>.length&nbsp;=&nbsp;length;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;offset</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;getOffset()&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;offset;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;offset&nbsp;the&nbsp;offset&nbsp;to&nbsp;set</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;setOffset(</span><span class="keyword">int</span><span>&nbsp;offset)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">this</span><span>.offset&nbsp;=&nbsp;offset;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;compressedLength</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;getCompressedLength()&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;compressedLength;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;offset&nbsp;the&nbsp;compressedLength&nbsp;to&nbsp;set</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;setCompressedLength(</span><span class="keyword">int</span><span>&nbsp;compressedLength)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">this</span><span>.compressedLength&nbsp;=&nbsp;compressedLength;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>}&nbsp;&nbsp;</span></li></ol></div>
<br>
<br>BinConverter.java:
<br><div class="dp-highlighter" id=""><div class="bar"><div class="tools">Java代码 <embed wmode="transparent" src="/javascripts/syntaxhighlighter/clipboard_new.swf" width="14" height="15" flashvars="clipboard=%2F*%0A%20*%20%40(%23)BinConverter.java%0A%20*%2F%0A%0A%2F**%0A%20*%20Some%20helper%20routines%20for%20data%20conversion%2C%20all%20data%20is%20treated%20in%20network%0A%20*%20byte%20order.%0A%20*%2F%0Apublic%20class%20BinConverter%0A%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Gets%20bytes%20from%20an%20array%20into%20an%20integer%2C%20in%20big-endian.%0A%20%20%20%20%20*%20%40param%20buf%20where%20to%20get%20the%20bytes%0A%20%20%20%20%20*%20%40param%20ofs%20index%20from%20where%20to%20read%20the%20data%0A%20%20%20%20%20*%20%40return%20the%2032bit%20integer%0A%20%20%20%20%20*%2F%0A%20%20%20%20public%20final%20static%20int%20byteArrayToIntBE(%0A%20%20%20%20%20%20%20%20byte%5B%5D%20buf%2C%0A%20%20%20%20%20%20%20%20int%20ofs)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%20(buf%5Bofs%20%20%20%20%5D%20%20%20%20%20%20%20%20%20%20%3C%3C%2024)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7C%20((buf%5Bofs%20%2B%201%5D%20%26%200x0ff)%20%3C%3C%2016)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7C%20((buf%5Bofs%20%2B%202%5D%20%26%200x0ff)%20%3C%3C%20%208%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7C%20(%20buf%5Bofs%20%2B%203%5D%20%26%200x0ff)%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Gets%20bytes%20from%20an%20array%20into%20an%20integer%2C%20in%20little-endian.%0A%20%20%20%20%20*%20%40param%20buf%20where%20to%20get%20the%20bytes%0A%20%20%20%20%20*%20%40param%20ofs%20index%20from%20where%20to%20read%20the%20data%0A%20%20%20%20%20*%20%40return%20the%2032bit%20integer%0A%20%20%20%20%20*%2F%0A%20%20%20%20public%20final%20static%20int%20byteArrayToIntLE(%0A%20%20%20%20%20%20%20%20byte%5B%5D%20buf%2C%0A%20%20%20%20%20%20%20%20int%20ofs)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%20(buf%5Bofs%20%2B%203%5D%20%20%20%20%20%20%20%20%20%20%3C%3C%2024)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7C%20((buf%5Bofs%20%2B%202%5D%20%26%200x0ff)%20%3C%3C%2016)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7C%20((buf%5Bofs%20%2B%201%5D%20%26%200x0ff)%20%3C%3C%20%208%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7C%20(%20buf%5Bofs%20%20%20%20%5D%20%26%200x0ff)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Converts%20an%20integer%20to%20bytes%20in%20big-endian%2C%20which%20are%20put%20into%20an%20array.%0A%20%20%20%20%20*%20%40param%20value%20the%2032bit%20integer%20to%20convert%0A%20%20%20%20%20*%20%40param%20buf%20the%20target%20buf%0A%20%20%20%20%20*%20%40param%20ofs%20where%20to%20place%20the%20bytes%20in%20the%20buf%0A%20%20%20%20%20*%2F%0A%20%20%20%20public%20final%20static%20void%20intToByteArrayBE(%0A%20%20%20%20%20%20%20%20int%20value%2C%0A%20%20%20%20%20%20%20%20byte%5B%5D%20buf%2C%0A%20%20%20%20%20%20%20%20int%20ofs)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20buf%5Bofs%20%20%20%20%5D%20%3D%20(byte)((value%20%3E%3E%3E%2024)%20%26%200x0ff)%3B%0A%20%20%20%20%20%20%20%20buf%5Bofs%20%2B%201%5D%20%3D%20(byte)((value%20%3E%3E%3E%2016)%20%26%200x0ff)%3B%0A%20%20%20%20%20%20%20%20buf%5Bofs%20%2B%202%5D%20%3D%20(byte)((value%20%3E%3E%3E%20%208%20)%20%26%200x0ff)%3B%0A%20%20%20%20%20%20%20%20buf%5Bofs%20%2B%203%5D%20%3D%20(byte)%20%20value%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Converts%20an%20integer%20to%20bytes%20in%20little-endian%2C%20which%20are%20put%20into%20an%20array.%0A%20%20%20%20%20*%20%40param%20value%20the%2032bit%20integer%20to%20convert%0A%20%20%20%20%20*%20%40param%20buf%20the%20target%20buf%0A%20%20%20%20%20*%20%40param%20ofs%20where%20to%20place%20the%20bytes%20in%20the%20buf%0A%20%20%20%20%20*%2F%0A%20%20%20%20public%20final%20static%20void%20intToByteArrayLE(%0A%20%20%20%20%20%20%20%20int%20value%2C%0A%20%20%20%20%20%20%20%20byte%5B%5D%20buf%2C%0A%20%20%20%20%20%20%20%20int%20ofs)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20buf%5Bofs%20%2B%203%5D%20%3D%20(byte)((value%20%3E%3E%3E%2024)%20%26%200x0ff)%3B%0A%20%20%20%20%20%20%20%20buf%5Bofs%20%2B%202%5D%20%3D%20(byte)((value%20%3E%3E%3E%2016)%20%26%200x0ff)%3B%0A%20%20%20%20%20%20%20%20buf%5Bofs%20%2B%201%5D%20%3D%20(byte)((value%20%3E%3E%3E%20%208%20)%20%26%200x0ff)%3B%0A%20%20%20%20%20%20%20%20buf%5Bofs%20%20%20%20%5D%20%3D%20(byte)%20%20value%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Gets%20bytes%20from%20an%20array%20into%20a%20long.%0A%20%20%20%20%20*%20%40param%20buf%20where%20to%20get%20the%20bytes%0A%20%20%20%20%20*%20%40param%20ofs%20index%20from%20where%20to%20read%20the%20data%0A%20%20%20%20%20*%20%40return%20the%2064bit%20integer%0A%20%20%20%20%20*%2F%0A%20%20%20%20public%20final%20static%20long%20byteArrayToLong(%0A%20%20%20%20%20%20%20%20byte%5B%5D%20buf%2C%0A%20%20%20%20%20%20%20%20int%20ofs)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20Looks%20more%20complex%20-%20but%20it%20is%20faster%20(at%20least%20on%2032bit%20platforms).%0A%0A%20%20%20%20%20%20%20%20return%0A%20%20%20%20%20%20%20%20%20%20%20%20((long)((%20buf%5Bofs%20%20%20%20%5D%20%20%20%20%20%20%20%20%20%20%3C%3C%2024)%20%7C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20((buf%5Bofs%20%2B%201%5D%20%26%200x0ff)%20%3C%3C%2016)%20%7C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20((buf%5Bofs%20%2B%202%5D%20%26%200x0ff)%20%3C%3C%20%208%20)%20%7C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(%20buf%5Bofs%20%2B%203%5D%20%26%200x0ff%20%20%20%20%20%20%20))%20%3C%3C%2032)%20%7C%0A%20%20%20%20%20%20%20%20%20%20%20%20((long)((%20buf%5Bofs%20%2B%204%5D%20%20%20%20%20%20%20%20%20%20%3C%3C%2024)%20%7C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20((buf%5Bofs%20%2B%205%5D%20%26%200x0ff)%20%3C%3C%2016)%20%7C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20((buf%5Bofs%20%2B%206%5D%20%26%200x0ff)%20%3C%3C%20%208%20)%20%7C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(%20buf%5Bofs%20%2B%207%5D%20%26%200x0ff%20%20%20%20%20%20%20))%20%26%200x0ffffffffL)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Converts%20a%20long%20to%20bytes%2C%20which%20are%20put%20into%20an%20array.%0A%20%20%20%20%20*%20%40param%20value%20the%2064bit%20integer%20to%20convert%0A%20%20%20%20%20*%20%40param%20buf%20the%20target%20buf%0A%20%20%20%20%20*%20%40param%20ofs%20where%20to%20place%20the%20bytes%20in%20the%20buf%0A%20%20%20%20%20*%2F%0A%20%20%20%20public%20final%20static%20void%20longToByteArray(%0A%20%20%20%20%20%20%20%20long%20value%2C%0A%20%20%20%20%20%20%20%20byte%5B%5D%20buf%2C%0A%20%20%20%20%20%20%20%20int%20ofs)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20int%20tmp%20%3D%20(int)(value%20%3E%3E%3E%2032)%3B%0A%0A%20%20%20%20%20%20%20%20buf%5Bofs%20%20%20%20%5D%20%3D%20(byte)%20(tmp%20%3E%3E%3E%2024)%3B%0A%20%20%20%20%20%20%20%20buf%5Bofs%20%2B%201%5D%20%3D%20(byte)((tmp%20%3E%3E%3E%2016)%20%26%200x0ff)%3B%0A%20%20%20%20%20%20%20%20buf%5Bofs%20%2B%202%5D%20%3D%20(byte)((tmp%20%3E%3E%3E%20%208%20)%20%26%200x0ff)%3B%0A%20%20%20%20%20%20%20%20buf%5Bofs%20%2B%203%5D%20%3D%20(byte)%20%20tmp%3B%0A%0A%20%20%20%20%20%20%20%20tmp%20%3D%20(int)value%3B%0A%0A%20%20%20%20%20%20%20%20buf%5Bofs%20%2B%204%5D%20%3D%20(byte)%20(tmp%20%3E%3E%3E%2024)%3B%0A%20%20%20%20%20%20%20%20buf%5Bofs%20%2B%205%5D%20%3D%20(byte)((tmp%20%3E%3E%3E%2016)%20%26%200x0ff)%3B%0A%20%20%20%20%20%20%20%20buf%5Bofs%20%2B%206%5D%20%3D%20(byte)((tmp%20%3E%3E%3E%20%208%20)%20%26%200x0ff)%3B%0A%20%20%20%20%20%20%20%20buf%5Bofs%20%2B%207%5D%20%3D%20(byte)%20%20tmp%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Converts%20values%20from%20an%20integer%20array%20to%20a%20long.%0A%20%20%20%20%20*%20%40param%20buf%20where%20to%20get%20the%20bytes%0A%20%20%20%20%20*%20%40param%20ofs%20index%20from%20where%20to%20read%20the%20data%0A%20%20%20%20%20*%20%40return%20the%2064bit%20integer%0A%20%20%20%20%20*%2F%0A%20%20%20%20public%20final%20static%20long%20intArrayToLong(%0A%20%20%20%20%20%20%20%20int%5B%5D%20buf%2C%0A%20%20%20%20%20%20%20%20int%20ofs)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%20(((long)%20buf%5Bofs%20%20%20%20%5D)%20%3C%3C%2032)%20%7C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(((long)%20buf%5Bofs%20%2B%201%5D)%20%26%200x0ffffffffL)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Converts%20a%20long%20to%20integers%20which%20are%20put%20into%20an%20array.%0A%20%20%20%20%20*%20%40param%20value%20the%2064bit%20integer%20to%20convert%0A%20%20%20%20%20*%20%40param%20buf%20the%20target%20buf%0A%20%20%20%20%20*%20%40param%20ofs%20where%20to%20place%20the%20bytes%20in%20the%20buf%0A%20%20%20%20%20*%2F%0A%20%20%20%20public%20final%20static%20void%20longToIntArray(%0A%20%20%20%20%20%20%20%20long%20value%2C%0A%20%20%20%20%20%20%20%20int%5B%5D%20buf%2C%0A%20%20%20%20%20%20%20%20int%20ofs)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20buf%5Bofs%20%20%20%20%5D%20%3D%20(int)(value%20%3E%3E%3E%2032)%3B%0A%20%20%20%20%20%20%20%20buf%5Bofs%20%2B%201%5D%20%3D%20(int)%20value%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Makes%20a%20long%20from%20two%20integers%20(treated%20unsigned).%0A%20%20%20%20%20*%20%40param%20lo%20lower%2032bits%0A%20%20%20%20%20*%20%40param%20hi%20higher%2032bits%0A%20%20%20%20%20*%20%40return%20the%20built%20long%0A%20%20%20%20%20*%2F%0A%20%20%20%20public%20final%20static%20long%20makeLong(%0A%20%20%20%20%20%20%20%20int%20lo%2C%0A%20%20%20%20%20%20%20%20int%20hi)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%20(((long)%20hi%20%3C%3C%2032)%20%7C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20((long)%20lo%20%26%200x00000000ffffffffL))%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Gets%20the%20lower%2032%20bits%20of%20a%20long.%0A%20%20%20%20%20*%20%40param%20val%20the%20long%20integer%0A%20%20%20%20%20*%20%40return%20lower%2032%20bits%0A%20%20%20%20%20*%2F%0A%20%20%20%20public%20final%20static%20int%20longLo32(%0A%20%20%20%20%20%20%20%20long%20val)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%20(int)val%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Gets%20the%20higher%2032%20bits%20of%20a%20long.%0A%20%20%20%20%20*%20%40param%20val%20the%20long%20integer%0A%20%20%20%20%20*%20%40return%20higher%2032%20bits%0A%20%20%20%20%20*%2F%0A%20%20%20%20public%20final%20static%20int%20longHi32(%0A%20%20%20%20%20%20%20%20long%20val)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%20(int)(val%20%3E%3E%3E%2032)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%0A%0A%20%20%20%20%2F%2F%20our%20table%20for%20hex%20conversion%0A%20%20%20%20final%20static%20char%5B%5D%20HEXTAB%20%3D%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20'0'%2C%20'1'%2C%20'2'%2C%20'3'%2C%20'4'%2C%20'5'%2C%20'6'%2C%20'7'%2C%0A%20%20%20%20%20%20%20%20'8'%2C%20'9'%2C%20'a'%2C%20'b'%2C%20'c'%2C%20'd'%2C%20'e'%2C%20'f'%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Converts%20a%20byte%20array%20to%20a%20hex%20string.%0A%20%20%20%20%20*%20%40param%20data%20the%20byte%20array%0A%20%20%20%20%20*%20%40return%20the%20hex%20string%0A%20%20%20%20%20*%2F%0A%20%20%20%20public%20final%20static%20String%20bytesToHexStr(%0A%20%20%20%20%20%20%20%20byte%5B%5D%20data)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%20bytesToHexStr(data%2C%200%2C%20data.length)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Converts%20a%20byte%20array%20to%20a%20hex%20string.%0A%20%20%20%20%20*%20%40param%20data%20the%20byte%20array%0A%20%20%20%20%20*%20%40param%20ofs%20start%20index%20where%20to%20get%20the%20bytes%0A%20%20%20%20%20*%20%40param%20len%20number%20of%20bytes%20to%20convert%0A%20%20%20%20%20*%20%40return%20the%20hex%20string%0A%20%20%20%20%20*%2F%0A%20%20%20%20public%20final%20static%20String%20bytesToHexStr(%0A%20%20%20%20%20%20%20%20byte%5B%5D%20data%2C%0A%20%20%20%20%20%20%20%20int%20ofs%2C%0A%20%20%20%20%20%20%20%20int%20len)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20int%20pos%2C%20c%3B%0A%20%20%20%20%20%20%20%20StringBuffer%20sbuf%3B%0A%0A%0A%20%20%20%20%20%20%20%20sbuf%20%3D%20new%20StringBuffer()%3B%0A%20%20%20%20%20%20%20%20sbuf.setLength(len%20%3C%3C%201)%3B%0A%0A%20%20%20%20%20%20%20%20pos%20%3D%200%3B%0A%20%20%20%20%20%20%20%20c%20%3D%20ofs%20%2B%20len%3B%0A%0A%20%20%20%20%20%20%20%20while%20(ofs%20%3C%20c)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20sbuf.setCharAt(pos%2B%2B%2C%20HEXTAB%5B(data%5Bofs%20%20%5D%20%3E%3E%204)%20%26%200x0f%5D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20sbuf.setCharAt(pos%2B%2B%2C%20HEXTAB%5B%20data%5Bofs%2B%2B%5D%20%20%20%20%20%20%20%26%200x0f%5D)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20sbuf.toString()%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Converts%20a%20hex%20string%20back%20into%20a%20byte%20array%20(invalid%20codes%20will%20be%0A%20%20%20%20%20*%20skipped).%0A%20%20%20%20%20*%20%40param%20hex%20hex%20string%0A%20%20%20%20%20*%20%40param%20data%20the%20target%20array%0A%20%20%20%20%20*%20%40param%20srcofs%20from%20which%20character%20in%20the%20string%20the%20conversion%20should%0A%20%20%20%20%20*%20begin%2C%20remember%20that%20(nSrcPos%20modulo%202)%20should%20equals%200%20normally%0A%20%20%20%20%20*%20%40param%20dstofs%20to%20store%20the%20bytes%20from%20which%20position%20in%20the%20array%0A%20%20%20%20%20*%20%40param%20len%20number%20of%20bytes%20to%20extract%0A%20%20%20%20%20*%20%40return%20number%20of%20extracted%20bytes%0A%20%20%20%20%20*%2F%0A%20%20%20%20public%20final%20static%20int%20hexStrToBytes(%0A%20%20%20%20%20%20%20%20String%20hex%2C%0A%20%20%20%20%20%20%20%20byte%5B%5D%20data%2C%0A%20%20%20%20%20%20%20%20int%20srcofs%2C%0A%20%20%20%20%20%20%20%20int%20dstofs%2C%0A%20%20%20%20%20%20%20%20int%20len)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20int%20i%2C%20j%2C%20strlen%2C%20avail_bytes%2C%20dstofs_bak%3B%0A%20%20%20%20%20%20%20%20byte%20abyte%3B%0A%20%20%20%20%20%20%20%20boolean%20convertOK%3B%0A%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20check%20for%20correct%20ranges%0A%20%20%20%20%20%20%20%20strlen%20%3D%20hex.length()%3B%0A%0A%20%20%20%20%20%20%20%20avail_bytes%20%3D%20(strlen%20-%20srcofs)%20%3E%3E%201%3B%0A%20%20%20%20%20%20%20%20if%20(avail_bytes%20%3C%20len)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20len%20%3D%20avail_bytes%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20int%20nOutputCapacity%20%3D%20data.length%20-%20dstofs%3B%0A%20%20%20%20%20%20%20%20if%20(len%20%3E%20nOutputCapacity)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20len%20%3D%20nOutputCapacity%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20convert%20now%0A%0A%20%20%20%20%20%20%20%20dstofs_bak%20%3D%20dstofs%3B%0A%0A%20%20%20%20%20%20%20%20for%20(i%20%3D%200%3B%20i%20%3C%20len%3B%20i%2B%2B)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20abyte%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20convertOK%20%3D%20true%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20(j%20%3D%200%3B%20j%20%3C%202%3B%20j%2B%2B)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20abyte%20%3C%3C%3D%204%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20char%20cActChar%20%3D%20hex.charAt(srcofs%2B%2B)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20((cActChar%20%3E%3D%20'a')%20%26%26%20(cActChar%20%3C%3D%20'f'))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20abyte%20%7C%3D%20(byte)%20(cActChar%20-%20'a')%20%2B%2010%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20((cActChar%20%3E%3D%20'0')%20%26%26%20(cActChar%20%3C%3D%20'9'))%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20abyte%20%7C%3D%20(byte)%20(cActChar%20-%20'0')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20convertOK%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(convertOK)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20data%5Bdstofs%2B%2B%5D%20%3D%20abyte%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20return%20(dstofs%20-%20dstofs_bak)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Converts%20a%20byte%20array%20into%20a%20Unicode%20string.%0A%20%20%20%20%20*%20%40param%20data%20the%20byte%20array%0A%20%20%20%20%20*%20%40param%20ofs%20where%20to%20begin%20the%20conversion%0A%20%20%20%20%20*%20%40param%20len%20number%20of%20bytes%20to%20handle%0A%20%20%20%20%20*%20%40return%20the%20string%0A%20%20%20%20%20*%2F%0A%20%20%20%20public%20final%20static%20String%20byteArrayToStr(%0A%20%20%20%20%20%20%20%20byte%5B%5D%20data%2C%0A%20%20%20%20%20%20%20%20int%20ofs%2C%0A%20%20%20%20%20%20%20%20int%20len)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20int%20avail_capacity%2C%20sbuf_pos%3B%0A%20%20%20%20%20%20%20%20StringBuffer%20sbuf%3B%0A%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20we%20need%20two%20bytes%20for%20every%20character%0A%20%20%20%20%20%20%20%20len%20%26%3D%20~1%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20enough%20bytes%20in%20the%20buf%3F%0A%20%20%20%20%20%20%20%20avail_capacity%20%3D%20data.length%20-%20ofs%3B%0A%0A%20%20%20%20%20%20%20%20if%20(avail_capacity%20%3C%20len)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20len%20%3D%20avail_capacity%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20sbuf%20%3D%20new%20StringBuffer()%3B%0A%20%20%20%20%20%20%20%20sbuf.setLength(len%20%3E%3E%201)%3B%0A%0A%20%20%20%20%20%20%20%20sbuf_pos%20%3D%200%3B%0A%0A%20%20%20%20%20%20%20%20while%20(0%20%3C%20len)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20sbuf.setCharAt(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sbuf_pos%2B%2B%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(char)((data%5Bofs%20%20%20%20%5D%20%3C%3C%208%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20%20(data%5Bofs%20%2B%201%5D%20%26%200x0ff)))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20ofs%20%2B%3D%202%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20len%20-%3D%202%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20return%20sbuf.toString()%3B%0A%20%20%20%20%7D%0A%7D" quality="high" allowscriptaccess="always" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer">&nbsp;<a href="javascript:void()" title="收藏这段代码" onclick="code_favorites_do_favorite(this);return false;" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="star" src="assets/1571225752-bf632ec55a05f69a9359f73417402b26.png" alt="收藏代码"><img class="spinner" src="assets/1571225752-a42df3a5b569bdc98ca473a4a3adfeac.gif" style="display:none"></a></div></div><ol start="1" class="dp-j"><li><span><span class="comment">/*</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;*&nbsp;@(#)BinConverter.java</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span><span class="comment">/**</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;*&nbsp;Some&nbsp;helper&nbsp;routines&nbsp;for&nbsp;data&nbsp;conversion,&nbsp;all&nbsp;data&nbsp;is&nbsp;treated&nbsp;in&nbsp;network</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;*&nbsp;byte&nbsp;order.</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li><span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">class</span><span>&nbsp;BinConverter&nbsp;&nbsp;</span></span></li><li><span>{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Gets&nbsp;bytes&nbsp;from&nbsp;an&nbsp;array&nbsp;into&nbsp;an&nbsp;integer,&nbsp;in&nbsp;big-endian.</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;buf&nbsp;where&nbsp;to&nbsp;get&nbsp;the&nbsp;bytes</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;ofs&nbsp;index&nbsp;from&nbsp;where&nbsp;to&nbsp;read&nbsp;the&nbsp;data</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;32bit&nbsp;integer</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;byteArrayToIntBE(&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>[]&nbsp;buf,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;ofs)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;(buf[ofs&nbsp;&nbsp;&nbsp;&nbsp;]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;&nbsp;</span><span class="number">24</span><span>)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;((buf[ofs&nbsp;+&nbsp;<span class="number">1</span><span>]&nbsp;&amp;&nbsp;</span><span class="number">0x0ff</span><span>)&nbsp;&lt;&lt;&nbsp;</span><span class="number">16</span><span>)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;((buf[ofs&nbsp;+&nbsp;<span class="number">2</span><span>]&nbsp;&amp;&nbsp;</span><span class="number">0x0ff</span><span>)&nbsp;&lt;&lt;&nbsp;&nbsp;</span><span class="number">8</span><span>&nbsp;)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;(&nbsp;buf[ofs&nbsp;+&nbsp;<span class="number">3</span><span>]&nbsp;&amp;&nbsp;</span><span class="number">0x0ff</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Gets&nbsp;bytes&nbsp;from&nbsp;an&nbsp;array&nbsp;into&nbsp;an&nbsp;integer,&nbsp;in&nbsp;little-endian.</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;buf&nbsp;where&nbsp;to&nbsp;get&nbsp;the&nbsp;bytes</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;ofs&nbsp;index&nbsp;from&nbsp;where&nbsp;to&nbsp;read&nbsp;the&nbsp;data</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;32bit&nbsp;integer</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;byteArrayToIntLE(&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>[]&nbsp;buf,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;ofs)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;(buf[ofs&nbsp;+&nbsp;</span><span class="number">3</span><span>]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;&nbsp;</span><span class="number">24</span><span>)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;((buf[ofs&nbsp;+&nbsp;<span class="number">2</span><span>]&nbsp;&amp;&nbsp;</span><span class="number">0x0ff</span><span>)&nbsp;&lt;&lt;&nbsp;</span><span class="number">16</span><span>)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;((buf[ofs&nbsp;+&nbsp;<span class="number">1</span><span>]&nbsp;&amp;&nbsp;</span><span class="number">0x0ff</span><span>)&nbsp;&lt;&lt;&nbsp;&nbsp;</span><span class="number">8</span><span>&nbsp;)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;(&nbsp;buf[ofs&nbsp;&nbsp;&nbsp;&nbsp;]&nbsp;&amp;&nbsp;<span class="number">0x0ff</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">///////////////////////////////////////////////////////////////////////////</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Converts&nbsp;an&nbsp;integer&nbsp;to&nbsp;bytes&nbsp;in&nbsp;big-endian,&nbsp;which&nbsp;are&nbsp;put&nbsp;into&nbsp;an&nbsp;array.</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;value&nbsp;the&nbsp;32bit&nbsp;integer&nbsp;to&nbsp;convert</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;buf&nbsp;the&nbsp;target&nbsp;buf</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;ofs&nbsp;where&nbsp;to&nbsp;place&nbsp;the&nbsp;bytes&nbsp;in&nbsp;the&nbsp;buf</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;intToByteArrayBE(&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;value,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>[]&nbsp;buf,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;ofs)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf[ofs&nbsp;&nbsp;&nbsp;&nbsp;]&nbsp;=&nbsp;(<span class="keyword">byte</span><span>)((value&nbsp;&gt;&gt;&gt;&nbsp;</span><span class="number">24</span><span>)&nbsp;&amp;&nbsp;</span><span class="number">0x0ff</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf[ofs&nbsp;+&nbsp;<span class="number">1</span><span>]&nbsp;=&nbsp;(</span><span class="keyword">byte</span><span>)((value&nbsp;&gt;&gt;&gt;&nbsp;</span><span class="number">16</span><span>)&nbsp;&amp;&nbsp;</span><span class="number">0x0ff</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf[ofs&nbsp;+&nbsp;<span class="number">2</span><span>]&nbsp;=&nbsp;(</span><span class="keyword">byte</span><span>)((value&nbsp;&gt;&gt;&gt;&nbsp;&nbsp;</span><span class="number">8</span><span>&nbsp;)&nbsp;&amp;&nbsp;</span><span class="number">0x0ff</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf[ofs&nbsp;+&nbsp;<span class="number">3</span><span>]&nbsp;=&nbsp;(</span><span class="keyword">byte</span><span>)&nbsp;&nbsp;value;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Converts&nbsp;an&nbsp;integer&nbsp;to&nbsp;bytes&nbsp;in&nbsp;little-endian,&nbsp;which&nbsp;are&nbsp;put&nbsp;into&nbsp;an&nbsp;array.</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;value&nbsp;the&nbsp;32bit&nbsp;integer&nbsp;to&nbsp;convert</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;buf&nbsp;the&nbsp;target&nbsp;buf</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;ofs&nbsp;where&nbsp;to&nbsp;place&nbsp;the&nbsp;bytes&nbsp;in&nbsp;the&nbsp;buf</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;intToByteArrayLE(&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;value,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>[]&nbsp;buf,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;ofs)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf[ofs&nbsp;+&nbsp;<span class="number">3</span><span>]&nbsp;=&nbsp;(</span><span class="keyword">byte</span><span>)((value&nbsp;&gt;&gt;&gt;&nbsp;</span><span class="number">24</span><span>)&nbsp;&amp;&nbsp;</span><span class="number">0x0ff</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf[ofs&nbsp;+&nbsp;<span class="number">2</span><span>]&nbsp;=&nbsp;(</span><span class="keyword">byte</span><span>)((value&nbsp;&gt;&gt;&gt;&nbsp;</span><span class="number">16</span><span>)&nbsp;&amp;&nbsp;</span><span class="number">0x0ff</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf[ofs&nbsp;+&nbsp;<span class="number">1</span><span>]&nbsp;=&nbsp;(</span><span class="keyword">byte</span><span>)((value&nbsp;&gt;&gt;&gt;&nbsp;&nbsp;</span><span class="number">8</span><span>&nbsp;)&nbsp;&amp;&nbsp;</span><span class="number">0x0ff</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf[ofs&nbsp;&nbsp;&nbsp;&nbsp;]&nbsp;=&nbsp;(<span class="keyword">byte</span><span>)&nbsp;&nbsp;value;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">///////////////////////////////////////////////////////////////////////////</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Gets&nbsp;bytes&nbsp;from&nbsp;an&nbsp;array&nbsp;into&nbsp;a&nbsp;long.</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;buf&nbsp;where&nbsp;to&nbsp;get&nbsp;the&nbsp;bytes</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;ofs&nbsp;index&nbsp;from&nbsp;where&nbsp;to&nbsp;read&nbsp;the&nbsp;data</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;64bit&nbsp;integer</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">long</span><span>&nbsp;byteArrayToLong(&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>[]&nbsp;buf,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;ofs)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;Looks&nbsp;more&nbsp;complex&nbsp;-&nbsp;but&nbsp;it&nbsp;is&nbsp;faster&nbsp;(at&nbsp;least&nbsp;on&nbsp;32bit&nbsp;platforms).</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="keyword">long</span><span>)((&nbsp;buf[ofs&nbsp;&nbsp;&nbsp;&nbsp;]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;&nbsp;</span><span class="number">24</span><span>)&nbsp;|&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((buf[ofs&nbsp;+&nbsp;<span class="number">1</span><span>]&nbsp;&amp;&nbsp;</span><span class="number">0x0ff</span><span>)&nbsp;&lt;&lt;&nbsp;</span><span class="number">16</span><span>)&nbsp;|&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((buf[ofs&nbsp;+&nbsp;<span class="number">2</span><span>]&nbsp;&amp;&nbsp;</span><span class="number">0x0ff</span><span>)&nbsp;&lt;&lt;&nbsp;&nbsp;</span><span class="number">8</span><span>&nbsp;)&nbsp;|&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;buf[ofs&nbsp;+&nbsp;<span class="number">3</span><span>]&nbsp;&amp;&nbsp;</span><span class="number">0x0ff</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;))&nbsp;&lt;&lt;&nbsp;</span><span class="number">32</span><span>)&nbsp;|&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="keyword">long</span><span>)((&nbsp;buf[ofs&nbsp;+&nbsp;</span><span class="number">4</span><span>]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;&nbsp;</span><span class="number">24</span><span>)&nbsp;|&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((buf[ofs&nbsp;+&nbsp;<span class="number">5</span><span>]&nbsp;&amp;&nbsp;</span><span class="number">0x0ff</span><span>)&nbsp;&lt;&lt;&nbsp;</span><span class="number">16</span><span>)&nbsp;|&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((buf[ofs&nbsp;+&nbsp;<span class="number">6</span><span>]&nbsp;&amp;&nbsp;</span><span class="number">0x0ff</span><span>)&nbsp;&lt;&lt;&nbsp;&nbsp;</span><span class="number">8</span><span>&nbsp;)&nbsp;|&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;buf[ofs&nbsp;+&nbsp;<span class="number">7</span><span>]&nbsp;&amp;&nbsp;</span><span class="number">0x0ff</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;))&nbsp;&amp;&nbsp;0x0ffffffffL);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">///////////////////////////////////////////////////////////////////////////</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Converts&nbsp;a&nbsp;long&nbsp;to&nbsp;bytes,&nbsp;which&nbsp;are&nbsp;put&nbsp;into&nbsp;an&nbsp;array.</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;value&nbsp;the&nbsp;64bit&nbsp;integer&nbsp;to&nbsp;convert</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;buf&nbsp;the&nbsp;target&nbsp;buf</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;ofs&nbsp;where&nbsp;to&nbsp;place&nbsp;the&nbsp;bytes&nbsp;in&nbsp;the&nbsp;buf</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;longToByteArray(&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">long</span><span>&nbsp;value,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>[]&nbsp;buf,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;ofs)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;tmp&nbsp;=&nbsp;(</span><span class="keyword">int</span><span>)(value&nbsp;&gt;&gt;&gt;&nbsp;</span><span class="number">32</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf[ofs&nbsp;&nbsp;&nbsp;&nbsp;]&nbsp;=&nbsp;(<span class="keyword">byte</span><span>)&nbsp;(tmp&nbsp;&gt;&gt;&gt;&nbsp;</span><span class="number">24</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf[ofs&nbsp;+&nbsp;<span class="number">1</span><span>]&nbsp;=&nbsp;(</span><span class="keyword">byte</span><span>)((tmp&nbsp;&gt;&gt;&gt;&nbsp;</span><span class="number">16</span><span>)&nbsp;&amp;&nbsp;</span><span class="number">0x0ff</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf[ofs&nbsp;+&nbsp;<span class="number">2</span><span>]&nbsp;=&nbsp;(</span><span class="keyword">byte</span><span>)((tmp&nbsp;&gt;&gt;&gt;&nbsp;&nbsp;</span><span class="number">8</span><span>&nbsp;)&nbsp;&amp;&nbsp;</span><span class="number">0x0ff</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf[ofs&nbsp;+&nbsp;<span class="number">3</span><span>]&nbsp;=&nbsp;(</span><span class="keyword">byte</span><span>)&nbsp;&nbsp;tmp;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp&nbsp;=&nbsp;(<span class="keyword">int</span><span>)value;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf[ofs&nbsp;+&nbsp;<span class="number">4</span><span>]&nbsp;=&nbsp;(</span><span class="keyword">byte</span><span>)&nbsp;(tmp&nbsp;&gt;&gt;&gt;&nbsp;</span><span class="number">24</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf[ofs&nbsp;+&nbsp;<span class="number">5</span><span>]&nbsp;=&nbsp;(</span><span class="keyword">byte</span><span>)((tmp&nbsp;&gt;&gt;&gt;&nbsp;</span><span class="number">16</span><span>)&nbsp;&amp;&nbsp;</span><span class="number">0x0ff</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf[ofs&nbsp;+&nbsp;<span class="number">6</span><span>]&nbsp;=&nbsp;(</span><span class="keyword">byte</span><span>)((tmp&nbsp;&gt;&gt;&gt;&nbsp;&nbsp;</span><span class="number">8</span><span>&nbsp;)&nbsp;&amp;&nbsp;</span><span class="number">0x0ff</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf[ofs&nbsp;+&nbsp;<span class="number">7</span><span>]&nbsp;=&nbsp;(</span><span class="keyword">byte</span><span>)&nbsp;&nbsp;tmp;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">///////////////////////////////////////////////////////////////////////////</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Converts&nbsp;values&nbsp;from&nbsp;an&nbsp;integer&nbsp;array&nbsp;to&nbsp;a&nbsp;long.</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;buf&nbsp;where&nbsp;to&nbsp;get&nbsp;the&nbsp;bytes</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;ofs&nbsp;index&nbsp;from&nbsp;where&nbsp;to&nbsp;read&nbsp;the&nbsp;data</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;64bit&nbsp;integer</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">long</span><span>&nbsp;intArrayToLong(&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>[]&nbsp;buf,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;ofs)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;(((</span><span class="keyword">long</span><span>)&nbsp;buf[ofs&nbsp;&nbsp;&nbsp;&nbsp;])&nbsp;&lt;&lt;&nbsp;</span><span class="number">32</span><span>)&nbsp;|&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(((<span class="keyword">long</span><span>)&nbsp;buf[ofs&nbsp;+&nbsp;</span><span class="number">1</span><span>])&nbsp;&amp;&nbsp;0x0ffffffffL);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">///////////////////////////////////////////////////////////////////////////</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Converts&nbsp;a&nbsp;long&nbsp;to&nbsp;integers&nbsp;which&nbsp;are&nbsp;put&nbsp;into&nbsp;an&nbsp;array.</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;value&nbsp;the&nbsp;64bit&nbsp;integer&nbsp;to&nbsp;convert</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;buf&nbsp;the&nbsp;target&nbsp;buf</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;ofs&nbsp;where&nbsp;to&nbsp;place&nbsp;the&nbsp;bytes&nbsp;in&nbsp;the&nbsp;buf</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;longToIntArray(&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">long</span><span>&nbsp;value,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>[]&nbsp;buf,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;ofs)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf[ofs&nbsp;&nbsp;&nbsp;&nbsp;]&nbsp;=&nbsp;(<span class="keyword">int</span><span>)(value&nbsp;&gt;&gt;&gt;&nbsp;</span><span class="number">32</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf[ofs&nbsp;+&nbsp;<span class="number">1</span><span>]&nbsp;=&nbsp;(</span><span class="keyword">int</span><span>)&nbsp;value;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">///////////////////////////////////////////////////////////////////////////</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Makes&nbsp;a&nbsp;long&nbsp;from&nbsp;two&nbsp;integers&nbsp;(treated&nbsp;unsigned).</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;lo&nbsp;lower&nbsp;32bits</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;hi&nbsp;higher&nbsp;32bits</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;built&nbsp;long</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">long</span><span>&nbsp;makeLong(&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;lo,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;hi)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;(((</span><span class="keyword">long</span><span>)&nbsp;hi&nbsp;&lt;&lt;&nbsp;</span><span class="number">32</span><span>)&nbsp;|&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="keyword">long</span><span>)&nbsp;lo&nbsp;&amp;&nbsp;0x00000000ffffffffL));&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">///////////////////////////////////////////////////////////////////////////</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Gets&nbsp;the&nbsp;lower&nbsp;32&nbsp;bits&nbsp;of&nbsp;a&nbsp;long.</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;val&nbsp;the&nbsp;long&nbsp;integer</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;lower&nbsp;32&nbsp;bits</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;longLo32(&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">long</span><span>&nbsp;val)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;(</span><span class="keyword">int</span><span>)val;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">///////////////////////////////////////////////////////////////////////////</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Gets&nbsp;the&nbsp;higher&nbsp;32&nbsp;bits&nbsp;of&nbsp;a&nbsp;long.</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;val&nbsp;the&nbsp;long&nbsp;integer</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;higher&nbsp;32&nbsp;bits</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;longHi32(&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">long</span><span>&nbsp;val)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;(</span><span class="keyword">int</span><span>)(val&nbsp;&gt;&gt;&gt;&nbsp;</span><span class="number">32</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">///////////////////////////////////////////////////////////////////////////</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;our&nbsp;table&nbsp;for&nbsp;hex&nbsp;conversion</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">final</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">char</span><span>[]&nbsp;HEXTAB&nbsp;=&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">'0'</span><span>,&nbsp;</span><span class="string">'1'</span><span>,&nbsp;</span><span class="string">'2'</span><span>,&nbsp;</span><span class="string">'3'</span><span>,&nbsp;</span><span class="string">'4'</span><span>,&nbsp;</span><span class="string">'5'</span><span>,&nbsp;</span><span class="string">'6'</span><span>,&nbsp;</span><span class="string">'7'</span><span>,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">'8'</span><span>,&nbsp;</span><span class="string">'9'</span><span>,&nbsp;</span><span class="string">'a'</span><span>,&nbsp;</span><span class="string">'b'</span><span>,&nbsp;</span><span class="string">'c'</span><span>,&nbsp;</span><span class="string">'d'</span><span>,&nbsp;</span><span class="string">'e'</span><span>,&nbsp;</span><span class="string">'f'</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;};&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Converts&nbsp;a&nbsp;byte&nbsp;array&nbsp;to&nbsp;a&nbsp;hex&nbsp;string.</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;data&nbsp;the&nbsp;byte&nbsp;array</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;hex&nbsp;string</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;String&nbsp;bytesToHexStr(&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>[]&nbsp;data)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;bytesToHexStr(data,&nbsp;</span><span class="number">0</span><span>,&nbsp;data.length);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">///////////////////////////////////////////////////////////////////////////</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Converts&nbsp;a&nbsp;byte&nbsp;array&nbsp;to&nbsp;a&nbsp;hex&nbsp;string.</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;data&nbsp;the&nbsp;byte&nbsp;array</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;ofs&nbsp;start&nbsp;index&nbsp;where&nbsp;to&nbsp;get&nbsp;the&nbsp;bytes</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;len&nbsp;number&nbsp;of&nbsp;bytes&nbsp;to&nbsp;convert</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;hex&nbsp;string</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;String&nbsp;bytesToHexStr(&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>[]&nbsp;data,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;ofs,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;len)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;pos,&nbsp;c;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;StringBuffer&nbsp;sbuf;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sbuf&nbsp;=&nbsp;<span class="keyword">new</span><span>&nbsp;StringBuffer();&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sbuf.setLength(len&nbsp;&lt;&lt;&nbsp;<span class="number">1</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pos&nbsp;=&nbsp;<span class="number">0</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;=&nbsp;ofs&nbsp;+&nbsp;len;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">while</span><span>&nbsp;(ofs&nbsp;&lt;&nbsp;c)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sbuf.setCharAt(pos++,&nbsp;HEXTAB[(data[ofs&nbsp;&nbsp;]&nbsp;&gt;&gt;&nbsp;<span class="number">4</span><span>)&nbsp;&amp;&nbsp;</span><span class="number">0x0f</span><span>]);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sbuf.setCharAt(pos++,&nbsp;HEXTAB[&nbsp;data[ofs++]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&nbsp;<span class="number">0x0f</span><span>]);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;sbuf.toString();&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">///////////////////////////////////////////////////////////////////////////</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Converts&nbsp;a&nbsp;hex&nbsp;string&nbsp;back&nbsp;into&nbsp;a&nbsp;byte&nbsp;array&nbsp;(invalid&nbsp;codes&nbsp;will&nbsp;be</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;skipped).</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;hex&nbsp;hex&nbsp;string</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;data&nbsp;the&nbsp;target&nbsp;array</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;srcofs&nbsp;from&nbsp;which&nbsp;character&nbsp;in&nbsp;the&nbsp;string&nbsp;the&nbsp;conversion&nbsp;should</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;begin,&nbsp;remember&nbsp;that&nbsp;(nSrcPos&nbsp;modulo&nbsp;2)&nbsp;should&nbsp;equals&nbsp;0&nbsp;normally</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;dstofs&nbsp;to&nbsp;store&nbsp;the&nbsp;bytes&nbsp;from&nbsp;which&nbsp;position&nbsp;in&nbsp;the&nbsp;array</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;len&nbsp;number&nbsp;of&nbsp;bytes&nbsp;to&nbsp;extract</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;number&nbsp;of&nbsp;extracted&nbsp;bytes</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;hexStrToBytes(&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;hex,&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>[]&nbsp;data,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;srcofs,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;dstofs,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;len)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;i,&nbsp;j,&nbsp;strlen,&nbsp;avail_bytes,&nbsp;dstofs_bak;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>&nbsp;abyte;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">boolean</span><span>&nbsp;convertOK;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;check&nbsp;for&nbsp;correct&nbsp;ranges</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strlen&nbsp;=&nbsp;hex.length();&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;avail_bytes&nbsp;=&nbsp;(strlen&nbsp;-&nbsp;srcofs)&nbsp;&gt;&gt;&nbsp;<span class="number">1</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(avail_bytes&nbsp;&lt;&nbsp;len)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;len&nbsp;=&nbsp;avail_bytes;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;nOutputCapacity&nbsp;=&nbsp;data.length&nbsp;-&nbsp;dstofs;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(len&nbsp;&gt;&nbsp;nOutputCapacity)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;len&nbsp;=&nbsp;nOutputCapacity;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;convert&nbsp;now</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dstofs_bak&nbsp;=&nbsp;dstofs;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span><span>&nbsp;(i&nbsp;=&nbsp;</span><span class="number">0</span><span>;&nbsp;i&nbsp;&lt;&nbsp;len;&nbsp;i++)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;abyte&nbsp;=&nbsp;<span class="number">0</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;convertOK&nbsp;=&nbsp;<span class="keyword">true</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span><span>&nbsp;(j&nbsp;=&nbsp;</span><span class="number">0</span><span>;&nbsp;j&nbsp;&lt;&nbsp;</span><span class="number">2</span><span>;&nbsp;j++)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;abyte&nbsp;&lt;&lt;=&nbsp;<span class="number">4</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">char</span><span>&nbsp;cActChar&nbsp;=&nbsp;hex.charAt(srcofs++);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;((cActChar&nbsp;&gt;=&nbsp;</span><span class="string">'a'</span><span>)&nbsp;&amp;&amp;&nbsp;(cActChar&nbsp;&lt;=&nbsp;</span><span class="string">'f'</span><span>))&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;abyte&nbsp;|=&nbsp;(<span class="keyword">byte</span><span>)&nbsp;(cActChar&nbsp;-&nbsp;</span><span class="string">'a'</span><span>)&nbsp;+&nbsp;</span><span class="number">10</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;((cActChar&nbsp;&gt;=&nbsp;</span><span class="string">'0'</span><span>)&nbsp;&amp;&amp;&nbsp;(cActChar&nbsp;&lt;=&nbsp;</span><span class="string">'9'</span><span>))&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;abyte&nbsp;|=&nbsp;(<span class="keyword">byte</span><span>)&nbsp;(cActChar&nbsp;-&nbsp;</span><span class="string">'0'</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;convertOK&nbsp;=&nbsp;<span class="keyword">false</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(convertOK)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data[dstofs++]&nbsp;=&nbsp;abyte;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;(dstofs&nbsp;-&nbsp;dstofs_bak);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">///////////////////////////////////////////////////////////////////////////</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Converts&nbsp;a&nbsp;byte&nbsp;array&nbsp;into&nbsp;a&nbsp;Unicode&nbsp;string.</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;data&nbsp;the&nbsp;byte&nbsp;array</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;ofs&nbsp;where&nbsp;to&nbsp;begin&nbsp;the&nbsp;conversion</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;len&nbsp;number&nbsp;of&nbsp;bytes&nbsp;to&nbsp;handle</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;string</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;String&nbsp;byteArrayToStr(&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>[]&nbsp;data,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;ofs,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;len)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;avail_capacity,&nbsp;sbuf_pos;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;StringBuffer&nbsp;sbuf;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;we&nbsp;need&nbsp;two&nbsp;bytes&nbsp;for&nbsp;every&nbsp;character</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;len&nbsp;&amp;=&nbsp;~<span class="number">1</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;enough&nbsp;bytes&nbsp;in&nbsp;the&nbsp;buf?</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;avail_capacity&nbsp;=&nbsp;data.length&nbsp;-&nbsp;ofs;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(avail_capacity&nbsp;&lt;&nbsp;len)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;len&nbsp;=&nbsp;avail_capacity;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sbuf&nbsp;=&nbsp;<span class="keyword">new</span><span>&nbsp;StringBuffer();&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sbuf.setLength(len&nbsp;&gt;&gt;&nbsp;<span class="number">1</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sbuf_pos&nbsp;=&nbsp;<span class="number">0</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">while</span><span>&nbsp;(</span><span class="number">0</span><span>&nbsp;&lt;&nbsp;len)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sbuf.setCharAt(&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sbuf_pos++,&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="keyword">char</span><span>)((data[ofs&nbsp;&nbsp;&nbsp;&nbsp;]&nbsp;&lt;&lt;&nbsp;</span><span class="number">8</span><span>&nbsp;)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;(data[ofs&nbsp;+&nbsp;<span class="number">1</span><span>]&nbsp;&amp;&nbsp;</span><span class="number">0x0ff</span><span>)));&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ofs&nbsp;+=&nbsp;<span class="number">2</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;len&nbsp;-=&nbsp;<span class="number">2</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;sbuf.toString();&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>}&nbsp;&nbsp;</span></li></ol></div>

  
  <div class="attachments">
    
      
        <ul>
          <li><a href="http://dl.iteye.com/topics/download/909e1bba-996f-337d-87a4-d70a2d504b37" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">BMW_Archiver_20080817.zip</a> (27.2 KB)</li>
          
          <li>下载次数: 3</li>
        </ul>
      
    
    
  </div>



  <div id="bottoms" class="clearfix">
    
    <div id="share_weibo">分享到：
      <a data-type="sina" href="javascript:;" title="分享到新浪微博" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img src="assets/1571225752-18e900b8666ce6f233d25ec02f95ee59.jpg"></a>
      <a data-type="qq" href="javascript:;" title="分享到腾讯微博" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img src="assets/1571225752-72dd548719f0ace4d5f9bca64e1d7715.jpg"></a>
    </div>
  </div>

  <div class="blog_nav">
    <div class="pre_next">
      <a href="https://www.iteye.com/blog/180532" class="next" title="对Strategy与Template Method模式的区别的一些讨论" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">对Strategy与Template Method模式的区别的 ...</a>
      |
      <a href="https://www.iteye.com/blog/180447" class="pre" title="ケータイ少女 script.arc的解压缩程序 (Java)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">ケータイ少女 script.arc的解压缩程序 (Ja ...</a>
    </div>
  </div>
  <div class="blog_bottom">
    <ul>
      <li>2008-04-08 16:44</li>
      <li>浏览 1970</li>
      <li><a href="#comments">评论(2)</a></li>
      
      
      <li>分类:<a href="https://www.iteye.com/blogs/category/language" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编程语言</a></li>      
      <li class="last"><a href="https://www.iteye.com/wiki/blog/180521" target="_blank" class="more" referrerpolicy="no-referrer" rel="noopener noreferrer">查看更多</a></li>
    </ul>    
  </div>
    
  <div class="blog_comment">
    <h5>评论</h5>
    <a id="comments" name="comments" data-mx-warn="Empty URL"></a>
    <div id="bc511063">
  <div class="comment_title">
    2 楼
    <a href="https://www.iteye.com/blog/user/rednaxelafx" target="_blank" title="RednaxelaFX" referrerpolicy="no-referrer" rel="noopener noreferrer">RednaxelaFX</a>
    2008-04-08&nbsp;&nbsp;
    
    
  </div>
  <div class="comment_content">嗯嗯，如果再有什么类似的东西需要写的话说不定会用Ruby。但是重构就算了……
<br>这可是write-and-throwaway的代码啊……</div>
</div>

<div id="bc510994">
  <div class="comment_title">
    1 楼
    <a href="https://www.iteye.com/blog/user/poweryoung" target="_blank" title="poweryoung" referrerpolicy="no-referrer" rel="noopener noreferrer">poweryoung</a>
    2008-04-08&nbsp;&nbsp;
    
    
  </div>
  <div class="comment_content">今天帖好多...
<br>来，用ruby重构吧...</div>
</div>


    
    
  </div>

  <div class="blog_comment">
    <h5>发表评论</h5>
            <p style="text-align:center; margin-top:30px;margin-bottom:0px;"><a href="https://www.iteye.com/login" style="background-color: white; --darkreader-inline-bgcolor:#191a1b;" data-darkreader-inline-bgcolor="" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"> <img src="assets/1571225752-cf6d69dfbb92d2238c3e50c97eb9e7bf.png" style="vertical-align:middle; margin-right: 10px;"></a><a href="https://www.iteye.com/login" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">  您还没有登录,请您登录后再发表评论 </a></p>
      </div>
  </div>
  <div>
    <div style="" id="_c8ptase33lo"></div>
    <!-- 多条广告如下脚本只需引入一次 -->
    
  </div>
</div>







      </div></DIV></DIV>
        
      </div>
    </body>
  </html>