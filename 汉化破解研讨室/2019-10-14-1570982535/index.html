
  <!DOCTYPE html>
  <html id="" class="">
    <!-- OriginalSrc: https://bbs.sumisora.net/read.php?tid=10930627&fpage=2 -->
    <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />

      <title>To Heart PSE资源提取及程序分析|【汉化破解研讨室】|【游戏汉化交流区】 - 『澄空学园』 GalGame专题网</title>
      

<link rel="stylesheet" type="text/css" href="assets/1570982535-5f21d2d0f0e14c54e3e080ff47c8ec08.css" referrerpolicy="no-referrer">
<link type="text/css" href="assets/1570982535-2f10d407050ab6b2185fb483267feb32.css" rel="stylesheet" referrerpolicy="no-referrer">
<link href="assets/1570982535-6ea61090578ddc8e91dc9b26707cebc8.css" rel="stylesheet" type="text/css" referrerpolicy="no-referrer">
<link rel="stylesheet" type="text/css" href="assets/1570982535-46d427da9cafb653c4ed606490c99b3a.css" referrerpolicy="no-referrer">


<style class="darkreader darkreader--fallback" media="screen"></style>
<style class="darkreader darkreader--text" media="screen"></style>
<style class="darkreader darkreader--invert" media="screen"></style>
<style class="darkreader darkreader--inline" media="screen">[data-darkreader-inline-bgcolor] {
  background-color: var(--darkreader-inline-bgcolor) !important;
}
[data-darkreader-inline-bgimage] {
  background-image: var(--darkreader-inline-bgimage) !important;
}
[data-darkreader-inline-border] {
  border-color: var(--darkreader-inline-border) !important;
}
[data-darkreader-inline-border-bottom] {
  border-bottom-color: var(--darkreader-inline-border-bottom) !important;
}
[data-darkreader-inline-border-left] {
  border-left-color: var(--darkreader-inline-border-left) !important;
}
[data-darkreader-inline-border-right] {
  border-right-color: var(--darkreader-inline-border-right) !important;
}
[data-darkreader-inline-border-top] {
  border-top-color: var(--darkreader-inline-border-top) !important;
}
[data-darkreader-inline-boxshadow] {
  box-shadow: var(--darkreader-inline-boxshadow) !important;
}
[data-darkreader-inline-color] {
  color: var(--darkreader-inline-color) !important;
}
[data-darkreader-inline-fill] {
  fill: var(--darkreader-inline-fill) !important;
}
[data-darkreader-inline-stroke] {
  stroke: var(--darkreader-inline-stroke) !important;
}
[data-darkreader-inline-outline] {
  outline-color: var(--darkreader-inline-outline) !important;
}</style>
<style class="darkreader darkreader--user-agent" media="screen">html {
    background-color: #191a1b !important;
}
html, body, input, textarea, select, button {
    background-color: #191a1b;
}
html, body, input, textarea, select, button {
    border-color: #5a5956;
    color: #f0ebe2;
}
a {
    color: #4791e7;
}
table {
    border-color: #4f4e4c;
}
::placeholder {
    color: #bfb9ac;
}
::selection {
    background-color: #125cb4;
    color: #fffffd;
}
::-moz-selection {
    background-color: #125cb4;
    color: #fffffd;
}
input:-webkit-autofill,
textarea:-webkit-autofill,
select:-webkit-autofill {
    background-color: #565a0f !important;
    color: #f0ebe2 !important;
}
::-webkit-scrollbar {
    background-color: #1d1f1f;
    color: #cbc5b9;
}
::-webkit-scrollbar-thumb {
    background-color: #2c2d2d;
}
::-webkit-scrollbar-thumb:hover {
    background-color: #343636;
}
::-webkit-scrollbar-thumb:active {
    background-color: #404142;
}
::-webkit-scrollbar-corner {
    background-color: #191a1b;
}
* {
    scrollbar-color: #2c2d2d #1d1f1f;
}</style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style type="text/css"> 
.tr3 td,.tr3 th{border-right:1px solid #D5E5E8;}
.y-style{text-align:center;}
.tr1 th{border-right:1px solid #D5E5E8;}
.tr1 td.td1{border-left:0}
 

.signature img { max-height:250px !important; }
</style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style class="darkreader darkreader--override" media="screen">.jfk-bubble {
    background-color: #000000 !important;
}
.vimvixen-hint {
    background-color: #765500 !important;
    border-color: #d5b22e !important;
    color: #f9edcc !important;
}</style>
<style type="text/css">@keyframes fadeInOpacity{0%{opacity:0}to{opacity:1}}:hover>*>.fbvd--wrapper{animation-name:fadeInOpacity;animation-duration:.3s;opacity:1}.fbvd--wrapper{position:absolute;top:10px;left:10px;opacity:0;text-align:center;margin:0;z-index:5}.fbvd--wrapper a{background: url("") no-repeat 3px 4.55px; background-color: #fff; display:inline-block;font:700 14px Helvetica,Arial,sans-serif;color:#4b4f56;text-decoration:none;vertical-align:middle;padding:0px 8px 0px;margin-right:8px;border-radius:2px; line-height: 22px; padding-left:19px; border: 1px solid #e7e7e7; background-size: 13px}.fbvd--wrapper a:last-child{margin-right:0}.fbvd--wrapper a:hover{text-decoration:none}.fbvd--wrapper a:focus{box-shadow:0 0 1px 2px rgba(88,144,255,.75),0 1px 1px rgba(0,0,0,.15);outline:none}.fbvd--wrapper b{font-size:13px;position:relative;top:1px;color:#3b5998;font-weight:400}</style>
<style class="darkreader darkreader--sync" media="screen"></style>

      <style class="mx-wc-style">
        .mx-wc-main img {max-width: 100%;}
        .mx-wc-main{
          box-sizing: content-box;
          background-color: rgb(25, 26, 27) !important;
          margin: 0 auto;
          margin-top: 20px;
          max-width: 1349px;
        }
        @media (min-width: 768px) {
          .mx-wc-main { padding: 15px 15px 80px 15px }
        }
        @media (max-width: 767px) {
          .mx-wc-main { padding: 15px 3px 80px 3px }
        }
  
      </style>
    </head>
    <body style="background-color: #ffffff !important; min-height: 100%; height: auto; position: static !important; overflow: auto !important; padding-bottom: 0px !important;" id="" class="">
      <div class="mx-wc-main">
        <div id="wrapA" class="mx-wc-selected-elem mx-wc-1570982535" style="display: block; float: none !important; position: relative !important; top: 0px !important; left: 0px !important; margin: 0px !important; flex: unset !important; width: 100% !important; max-width: 100% !important; box-sizing: border-box !important;">

<div id="header">
<div class="toptool tar">	<span>
	<a href="https://bbs.sumisora.net/read.php?tid=10930627&amp;fpage=2&amp;skinco=simple" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">手机版</a>

	| <a style="cursor:pointer;" id="td_skin" data-mx-warn="Empty URL">风格切换<img src="assets/1570982535-5c8e409588b73ce4284cf5b9bd619e15.gif"></a>
	| <a href="https://bbs.sumisora.net/read.php?tid=10894912" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">学生手册</a>
	</span>
</div>
<table cellspacing="0" cellpadding="0" align="center" width="100%">
<tbody><tr>
	<td class="banner"><a href="https://bbs.sumisora.net/" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img id="forumlogo" src="assets/1570982535-7ac78a0e1e3ce795251288b0c8bd4b1b.png"></a></td>
	<td class="banner" id="banner" align="right"></td>
</tr>
<tr><td align="center" height="1" colspan="2"></td></tr>
</tbody></table>
<div id="h_guide" class="guide" colspan="2"><span class="s3">»</span>

	<span style="font-weight:bold" class="s3">silasu</span>&nbsp;<a href="https://bbs.sumisora.net/login.php?action=quit&amp;verify=034be2bd" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">退出</a> |
	<a id="td_profile" href="https://bbs.sumisora.net/profile.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">控制面板</a>
	| <a id="td_msg" href="https://bbs.sumisora.net/message.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">

	短消息</a>

	| <a id="td_sort" href="https://bbs.sumisora.net/sort.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">统计排行</a>

	| <a href="https://bbs.sumisora.net/member.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">会员</a>

	| <a href="https://bbs.sumisora.net/search.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">搜索</a>
	| <a style="cursor:pointer;" id="td_hack" data-mx-warn="Empty URL">社区服务<img src="assets/1570982535-5c8e409588b73ce4284cf5b9bd619e15.gif"></a>

	| <a href="https://bbs.sumisora.net/hack.php?H_name=galgamevote" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">GALGAME角色人气投票活动</a>

 | <a href="https://bbs.sumisora.net/yume/polls/" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">近期关注</a><!--[if lte IE 6]>
 | <a href="read.php?tid=10955539" style="color:red">本站已停止支持IE6，请升级或更换浏览器</a>
<![endif]-->
</div>



</div>
<div id="main">




<div class="t3" style="margin-top:8px"><table width="100%" cellspacing="0" cellpadding="0" align="center">
	<tbody><tr><td class="b"><img src="assets/1570982535-ca4a91079181c2a5cb3514b2e5b5f035.gif" align="absmiddle"> <a href="https://bbs.sumisora.net/index.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">『澄空学园』</a> » <a href="https://bbs.sumisora.net/thread.php?fid=77" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">【游戏汉化交流区】</a> » <a href="https://bbs.sumisora.net/thread.php?fid=78&amp;page=2" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">【汉化破解研讨室】</a> » <a href="https://bbs.sumisora.net/read.php?tid=10930627" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">To Heart PSE资源提取及程序分析</a> <a href="https://bbs.sumisora.net/rss.php?tid=10930627" target="_blank" title="Rss订阅本帖最新内容" referrerpolicy="no-referrer" rel="noopener noreferrer"><img align="absmiddle" src="assets/1570982535-b4369735f1bfb33ab69477230a8ba635.png"></a></td></tr>
</tbody></table></div>

<!--ads begin-->

<!--ads end-->
<div class="t3"><table width="100%" align="center" cellspacing="0" cellpadding="0">
	<tbody><tr><td align="left"><div class="fl"></div></td><td align="right" style="padding-bottom:.2em"><a href="https://bbs.sumisora.net/post.php?action=reply&amp;fid=78&amp;tid=10930627" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img src="assets/1570982535-132cb83b134d7ecd9b390389d489bc43.png"></a>

<a href="https://bbs.sumisora.net/post.php?fid=78" style="margin-left:.5em" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img src="assets/1570982535-8cab7ee31ae503cf78e5410d40cec291.png" id="td_post"></a>

</td></tr>
</tbody></table></div>



<form name="delatc" method="post">


<div class="t" style="margin-bottom: 0px; border-bottom: 0px; --darkreader-inline-border-bottom: initial;" data-darkreader-inline-border-bottom=""><table cellspacing="0" cellpadding="0" width="100%">
	<tbody><tr><th class="h"><strong class="fl w"><b>本页主题:</b> To Heart PSE资源提取及程序分析</strong>
	<span class="fr w"><a data-mx-warn="Empty URL">&nbsp;</a><a href="https://bbs.sumisora.net/job.php?action=previous&amp;fid=78&amp;tid=10930627&amp;fpage=2&amp;goto=previous" class="fn" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">上一主题</a> | <a href="https://bbs.sumisora.net/job.php?action=previous&amp;fid=78&amp;tid=10930627&amp;fpage=2&amp;goto=next" class="fn" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">下一主题</a> | <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span> </th>
	</tr>
	<tr><td></td></tr>
	<tr class="tr2"><td colspan="2" class="tar">

		<a id="usetool" style="cursor:pointer" onclick="sendmsg('pw_ajax.php?action=usetool','',this.id)" data-mx-warn="Empty URL">[使用道具]</a>

		<br></td>
	</tr>
	<tr><td></td></tr>
</tbody></table></div>

<a name="tpc" data-mx-warn="Empty URL"></a>
<div class="t t2" style="border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top=""><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570982535-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>夏の幻</b>
<div style="margin:.3em 0 .4em .2em">もう、冬は、ホワイトアルバムの季節じゃない。</div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=131798" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570982535-3e80c861881e4c453757e04fdb5f5b6e.png" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_0"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">学生会副会长</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570982535-35aa8c414aad91387ad565c549e6cd0f.gif"><br>

<span class="user-info2" id="showface_0">
<span class="user-infoWrap2">


精华:

		<a href="https://bbs.sumisora.net/search.php?authorid=131798&amp;digest=1" target="_blank" class="s4 f9" referrerpolicy="no-referrer" rel="noopener noreferrer">1</a>
<br>
发帖: <span class="s1 f9">1818</span><br>
学分: <span class="s2 f9">218 点</span><br>
澄空币: <span class="s3 f9">0 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2007-06-26<br>
		最后登录:2019-08-13 <br><br> 
		<img src="assets/1570982535-196b2da3a42134dc3b0b212d7ed677c2.gif" title="Leaf学部勋章"> <br></span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_tpc" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10930627&amp;pid=tpc&amp;article=0" onclick="return sendurl(this,4,event)" id="quote_tpc" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10930627&amp;pid=tpc&amp;article=0" id="modify_tpc" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=131798" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10930627&amp;pid=tpc" onclick="return sendurl(this,8)" id="report_tpc" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10930627&amp;uid=131798" title="只看楼主的所有帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('tpc')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_tpc" class="fl"><img src="assets/1570982535-d509d5278ef358b08b33767ae621aac1.gif" align="left" border="0">&nbsp;To Heart PSE资源提取及程序分析</h1>
			

			<div id="p_tpc" class="c"></div>

			<div id="mag_tpc" class="tpc_content"><h6 class="quote"><span class="s3 f12 fn">管理提醒：


			</span></h6><blockquote class="blockquote">本帖被 holand 执行加亮操作(2009-09-10)

			</blockquote></div>

<!--
-->

			<div class="tpc_content" id="read_tpc"><span style="font-family:宋体 ">我是来凑热闹顺便误人子弟的（棍） <br>&lt;-这个人十分粗心，所以有些东西可能误很大（特别是汇编部分），请各位前辈帮忙纠正= = <br>=0=主要是提取资源还有格式转换的，后面的就当做是凑字数口胡吧～（拖）</span> <br><span style="font-family:宋体 ">&nbsp; <br><b>一、资源</b> <br>观察游戏的资源文件，mini\Cd\Img中的资源从文件数来看应该没有打包，其余资源的打包格式为pak，用WinHEX打开后发现可以分为两类： </span><br><span style="font-family:宋体 "><br><b><span style="color: rgb(255, 153, 0); --darkreader-inline-color:#f7b24b;" data-darkreader-inline-color="">1、magic为LAC</span></b> <br>　　bgmfile.pak soundds.pak voice.pak mini\Prg\*.pak均为此类，从文件名可以发现都是声音文件，虽然汉化不需要修改声音文件，这里还是分析一下吧。 <br>　　下图为bgmfile.pak的开头部分数据： <br>　　<span class="highslide"><img src="assets/1570982535-d4221cda6c87101ed34f46e7a02931ca.png" border="0" style="max-width: 100%;max-height: 800px;"></span> <br>　　可以看到比较明显的文件结构： <br>　　<i>0x00-0x03</i>：0x4C 0x41 0x43 0x00即"LAC"。 <br>　　<i>0x04-0x07</i>：一开始不知道是什么，全选文件索引部分，共占用0xD70字节，而单个文件索引占用0x28字节，0x56×0x28＝0xD70，所以该部分应该为文件数，分析该类其他pak文件的这个数值表明推测是正确的。 <br>　　从<i>0x08</i>开始，每隔0x28字节会出现类似的数据0xB2 0xAA 0xAC（一般文件名都会类似是XXXX001、XXXX002……这样的结构，名字加上编号），同时又大量的0x00，应该没有压缩，所以从这里开始应该不属于文件头部分，而是文件索引部分了，因此估计一个索引占用0x28字节。 <br>　　索引后面应该是接着文件数据。 <br>　　文件索引的分析： <br>　　有大量的0x00前面或后面跟着的是文件名，后面的明显不是，于是推测文件索引的结构为： <br>　　<span class="highslide"><img src="assets/1570982535-99169a5778242396d5310db309b617ca.png" border="0" style="max-width: 100%;max-height: 800px;"></span> <br>　　橙色部分，占0x20字节。 <br>　　黄色部分，占0x4字节。 <br>　　粉红部分，占0x4字节。 <br>　　橙色部分估计是文件名，但是却看不出明显的名字，估计是部分加密了，可能要用OD，先放一边。（T T我不要调试，调试麻烦[拖走...]） <br>　　接着看黄色部分跟粉红部分，仔细观察可以发现： <br>　　（文件头）0x8＋（文件索引）0xD70＝（第一个粉红部分）0xD78 <br>　　（第一个粉红部分）0xD78＋（第一个黄色部分）0x2123C＝（下一个粉红部分）0x21FB4 <br>　　因此估计粉红部分为文件位置，而黄色部分为文件大小。 <br>　　转到文件的0x7D8： <br>　　<span class="highslide"><img src="assets/1570982535-2fb0347a360549eb729df3efda883e5f.png" border="0" style="max-width: 100%;max-height: 800px;"></span> <br>　　可以看见明显的ogg文件头OggS，说明文件数据应该没有加密或压缩，用WinHEX截取0x2123C字节后保存起来，能正确播放，说明推测的索引结构正确。 <br>　　于是文件结构就出来了： <br>　　<span class="highslide"><img src="assets/1570982535-f60dde37acdf54ab14578351fe7f3e15.png" border="0" style="max-width: 100%;max-height: 800px;"></span> <br>　　回到橙色部分，发现非0x00数据的最后4字节总是0xD1 0xB0 0xB8 0xB8，想既然是文件名的话最后应该是.OGG（0x2E 0x4F 0x47 0x47）。 <br>　　尝试异或这两组数，结果均为0xFF，看来有可能是异或加密，尝试把非0x00部分全部异或0xFF： <br>　　<span class="highslide"><img src="assets/1570982535-2ad860429d345882827d1361fce43183.png" border="0" style="max-width: 100%;max-height: 800px;"></span> <br>　　已经可以理解了，MUS指的是MUSIC，后面的是音乐编号，于是对该类的pak的分析就结束了。 <br>　　刚开始的时候用的是.ogg来分析，结果以为是异或0xDF 0xDF 0xDF 0xFF 0xFF 0xFF串，找其他文件分析验证才发现应该是大写= = <br>　　翻老帖看到KID的<a href="https://bbs.sumisora.net/read.php?tid=205100" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">教程</a>，发现文件名的加密方式一样呢，虽然说法上不同。不过对一个字节来说0xFF－Ｘ、Ｘ xor 0xFF、not Ｘ的效果是一样的呢，真是缘分呐~（粉肠状）[拖很远...] <br>&nbsp; <br><span style="color: rgb(255, 153, 0); --darkreader-inline-color:#f7b24b;" data-darkreader-inline-color=""><b>2、magic为LEAFPACK</b></span> <br>　　bck.pak chr.pak scn.pak sys.pak vis.pak为此类。 <br>　　下图为scn.pak的开头部分数据： <br>　　<span class="highslide"><img src="assets/1570982535-55927d5a4b875bbf3c369948ced130a4.png" border="0" style="max-width: 100%;max-height: 800px;"></span> <br>　　除了LEAFPACK这个magic之外其他数据完全不能识别，看来是经过加密或者压缩了，只能是调试了。（T T泪流满面...） <br>　　ToHeartPSE下有ToHeart.exe psth.exe这两个可执行文件，均没有加壳，也不用检查光盘，直接执行psth.exe不能运行游戏。 <br>　　用OllyDbg简单分析了下发现我们要的内容不在ToHeart.exe里面，ToHeart.exe通过CreateProcessA来启动psth.exe，这时候就要用到OllyDbg的“附加（Attach）”功能。 <br>　　<h6 class="quote">Quote:</h6><blockquote class="blockquote">OllyDbg的一个实用的功能是可以调试正在运行的程序，这个功能称为“附加（Attach）”。其原理是利用DebugActiveProcess函数可以将调试器捆绑到一个正在运行的进程上，如果执行成功，则效果类似于利用CreateProcess创建的新进程。</blockquote> <br>　　因为一般游戏在刚开始的时候就开始解密了，所以我写了个小程序自动获取psth.exe的PID然后使用OllyDbg.exe –p PID来自动附加。 <br>　　接着先用OllyDbg打开psth.exe，对CreateFileA下断，接着退出OllyDbg，于是，预备工作就完成了。（如果不对声音进行相关解析的话最好先把游戏里的声音都关了，虽然不一定有效） <br>　　开始自动附加，启动ToHeart.exe，OllyDbg就自动启动并且载入了psth.exe，停在了一个CreateFileA上。 <br>　　看堆栈区里FileName的值是bck.pak，正是我们需要了，接着给ReadFile下断，按F9继续，停在了另外一个CreateFileA上，但后面有ReadFile，下面用注释说明。 <br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code1'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code1" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="pun">　　</span><span class="lit">00414040</span><span class="pln">&nbsp; </span><span class="pun">/</span><span class="pln">$&nbsp; </span><span class="lit">8B4424</span><span class="pln"> </span><span class="lit">04</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; eax</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="pln">esp</span><span class="pun">+</span><span class="lit">4</span><span class="pun">]</span><span class="pln"> 
　　</span><span class="lit">00414044</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">81EC</span><span class="pln"> </span><span class="lit">10020000</span><span class="pln"> </span><span class="kwd">sub</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp; esp</span><span class="pun">,</span><span class="pln"> </span><span class="lit">210</span><span class="pln"> 
　　</span><span class="lit">0041404A</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8D9424</span><span class="pln"> </span><span class="lit">0C0100</span><span class="pun">&gt;</span><span class="pln">lea&nbsp;&nbsp;&nbsp;&nbsp; edx</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="pln">esp</span><span class="pun">+</span><span class="lit">10C</span><span class="pun">]</span><span class="pln"> 
　　</span><span class="lit">00414051</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">53</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; ebx 
　　</span><span class="lit">00414052</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">55</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; ebp 
　　</span><span class="lit">00414053</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">56</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; esi 
　　</span><span class="lit">00414054</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8D0C40</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lea&nbsp;&nbsp;&nbsp;&nbsp; ecx</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="pln">eax</span><span class="pun">+</span><span class="pln">eax</span><span class="pun">*</span><span class="lit">2</span><span class="pun">]</span><span class="pln"> 
　　</span><span class="lit">00414057</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8B0485</span><span class="pln"> </span><span class="lit">90D044</span><span class="pun">&gt;</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; eax</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="pln">eax</span><span class="pun">*</span><span class="lit">4</span><span class="pun">+</span><span class="lit">44D090</span><span class="pun">]</span><span class="pln"> 
　　</span><span class="lit">0041405E</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">57</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; edi 
　　</span><span class="lit">0041405F</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">52</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; edx 
　　</span><span class="lit">00414060</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">50</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; eax 
　　</span><span class="lit">00414061</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">33FF</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xor&nbsp;&nbsp;&nbsp;&nbsp; edi</span><span class="pun">,</span><span class="pln"> edi 
　　</span><span class="lit">00414063</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8D1C8D</span><span class="pln"> </span><span class="lit">005D49</span><span class="pun">&gt;</span><span class="pln">lea&nbsp;&nbsp;&nbsp;&nbsp; ebx</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="pln">ecx</span><span class="pun">*</span><span class="lit">4</span><span class="pun">+</span><span class="lit">495D00</span><span class="pun">]</span><span class="pln"> 
　　</span><span class="lit">0041406A</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; E8 E1FEFFFF&nbsp;&nbsp; call&nbsp;&nbsp;&nbsp; </span><span class="lit">00413F50</span><span class="pln"> 
　　</span><span class="lit">0041406F</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">83C4</span><span class="pln"> </span><span class="lit">08</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add&nbsp;&nbsp;&nbsp;&nbsp; esp</span><span class="pun">,</span><span class="pln"> </span><span class="lit">8</span><span class="pln"> 
　　</span><span class="lit">00414072</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">85C0</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; test&nbsp;&nbsp;&nbsp; eax</span><span class="pun">,</span><span class="pln"> eax 
　　</span><span class="lit">00414074</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">0F84</span><span class="pln"> CF010000 je&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="lit">00414249</span><span class="pln"> 
　　</span><span class="lit">0041407A</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">57</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; edi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="str">/hTemplateFile 
　　0041407B&nbsp; |.&nbsp; 68 80000000&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; 80&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; |Attributes = NORMAL 
　　00414080&nbsp; |.&nbsp; 6A 03&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; 3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; |Mode = OPEN_EXISTING 
　　00414082&nbsp; |.&nbsp; 57&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; edi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; |pSecurity 
　　00414083&nbsp; |.&nbsp; 6A 01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; |ShareMode = FILE_SHARE_READ 
　　00414085&nbsp; |.&nbsp; 8D8C24 300100&gt;lea&nbsp;&nbsp;&nbsp;&nbsp; ecx, dword ptr [esp+130]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; | 
　　0041408C&nbsp; |.&nbsp; 68 00000080&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; 80000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; |Access = GENERIC_READ 
　　00414091&nbsp; |.&nbsp; 51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; ecx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; |FileName 
　　00414092&nbsp; |.&nbsp; FF15 F8714400 call&nbsp;&nbsp;&nbsp; dword ptr [&lt;&amp;KERNEL32.CreateFile&gt;; \CreateFileA 
　　00414098&nbsp; |.&nbsp; 8BF0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; esi, eax 
　　0041409A&nbsp; |.&nbsp; 83FE FF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cmp&nbsp;&nbsp;&nbsp;&nbsp; esi, -1 
　　0041409D&nbsp; |.&nbsp; 0F84 A6010000 je&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 00414249 
　　004140A3&nbsp; |.&nbsp; 8D5424 10&nbsp;&nbsp;&nbsp;&nbsp; lea&nbsp;&nbsp;&nbsp;&nbsp; edx, dword ptr [esp+10] 
　　004140A7&nbsp; |.&nbsp; 57&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; edi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; /</span><span class="pln">pOverlapped 
　　</span><span class="lit">004140A8</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">52</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; edx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="pln">pBytesRead 
　　</span><span class="lit">004140A9</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8D4424</span><span class="pln"> </span><span class="lit">24</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp; lea&nbsp;&nbsp;&nbsp;&nbsp; eax</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="pln">esp</span><span class="pun">+</span><span class="lit">24</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="pln"> 
　　</span><span class="lit">004140AD</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">6A</span><span class="pln"> </span><span class="lit">08</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; </span><span class="lit">8</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="typ">BytesToRead</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">8</span><span class="pln"> 
　　</span><span class="lit">004140AF</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">50</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="typ">Buffer</span><span class="pln"> 
　　</span><span class="lit">004140B0</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">56</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; esi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="pln">hFile 
　　</span><span class="lit">004140B1</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; FF15 </span><span class="lit">18714400</span><span class="pln"> call&nbsp;&nbsp;&nbsp; dword ptr </span><span class="pun">[&lt;&amp;</span><span class="pln">KERNEL32</span><span class="pun">.</span><span class="typ">ReadFile</span><span class="pun">&gt;]</span><span class="pln"> </span><span class="pun">;</span><span class="pln"> \ReadFile&nbsp; </span><span class="pun">读取文件前</span><span class="lit">8</span><span class="pun">字节</span><span class="pln"> 
　　</span><span class="lit">004140B7</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8B2D</span><span class="pln"> </span><span class="lit">8CD04400</span><span class="pln"> mov&nbsp;&nbsp;&nbsp;&nbsp; ebp</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="lit">44D08C</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; PSTH</span><span class="pun">.</span><span class="lit">0044D0CC</span><span class="pln"> 
　　</span><span class="lit">004140BD</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8D4C24</span><span class="pln"> </span><span class="lit">1C</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp; lea&nbsp;&nbsp;&nbsp;&nbsp; ecx</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="pln">esp</span><span class="pun">+</span><span class="lit">1C</span><span class="pun">]</span><span class="pln"> 
　　</span><span class="lit">004140C1</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">33C0</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xor&nbsp;&nbsp;&nbsp;&nbsp; eax</span><span class="pun">,</span><span class="pln"> eax 
　　</span><span class="lit">004140C3</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">2BE9</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">sub</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp; ebp</span><span class="pun">,</span><span class="pln"> ecx 
　　</span><span class="lit">004140C5</span><span class="pln">&nbsp; </span><span class="pun">|&gt;</span><span class="pln">&nbsp; </span><span class="lit">8D7C04</span><span class="pln"> </span><span class="lit">1C</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">/</span><span class="pln">lea&nbsp;&nbsp;&nbsp;&nbsp; edi</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="pln">esp</span><span class="pun">+</span><span class="pln">eax</span><span class="pun">+</span><span class="lit">1C</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">这个循环用来检查文件前</span><span class="lit">8</span><span class="pun">字节是否为</span><span class="pln">LEAFPACK 
　　</span><span class="lit">004140C9</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">33C9</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">xor&nbsp;&nbsp;&nbsp;&nbsp; ecx</span><span class="pun">,</span><span class="pln"> ecx 
　　</span><span class="lit">004140CB</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">0FBE142F</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">movsx&nbsp;&nbsp; edx</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">edi</span><span class="pun">+</span><span class="pln">ebp</span><span class="pun">]</span><span class="pln"> 
　　</span><span class="lit">004140CF</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8A0F</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; cl</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">edi</span><span class="pun">]</span><span class="pln"> 
　　</span><span class="lit">004140D1</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">3BCA</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">cmp&nbsp;&nbsp;&nbsp;&nbsp; ecx</span><span class="pun">,</span><span class="pln"> edx 
　　</span><span class="lit">004140D3</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">0F85</span><span class="pln"> </span><span class="lit">8C000000</span><span class="pln"> </span><span class="pun">|</span><span class="pln">jnz&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="lit">00414165</span><span class="pln"> 
　　</span><span class="lit">004140D9</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">40</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">inc&nbsp;&nbsp;&nbsp;&nbsp; eax 
　　</span><span class="lit">004140DA</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">83F8</span><span class="pln"> </span><span class="lit">08</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">cmp&nbsp;&nbsp;&nbsp;&nbsp; eax</span><span class="pun">,</span><span class="pln"> </span><span class="lit">8</span><span class="pln"> 
　　</span><span class="lit">004140DD</span><span class="pln">&nbsp; </span><span class="pun">|.^</span><span class="pln"> </span><span class="lit">7C</span><span class="pln"> E6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \jl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">short</span><span class="pln"> </span><span class="lit">004140C5</span><span class="pln"> 
　　</span><span class="lit">004140DF</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">6A</span><span class="pln"> </span><span class="lit">02</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; </span><span class="lit">2</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="str">/Origin = FILE_END 
　　004140E1&nbsp; |.&nbsp; 6A 00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; |pOffsetHi = NULL 
　　004140E3&nbsp; |.&nbsp; 6A FD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; -3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; |OffsetLo = FFFFFFFD (-3.) 
　　004140E5&nbsp; |.&nbsp; 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; esi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; |hFile 
　　004140E6&nbsp; |.&nbsp; FF15 08724400 call&nbsp;&nbsp;&nbsp; dword ptr [&lt;&amp;KERNEL32.SetFilePoi&gt;; \SetFilePointer&nbsp; 设置文件指针到倒数第3字节 
　　004140EC&nbsp; |.&nbsp; 8D5424 10&nbsp;&nbsp;&nbsp;&nbsp; lea&nbsp;&nbsp;&nbsp;&nbsp; edx, dword ptr [esp+10] 
　　004140F0&nbsp; |.&nbsp; 6A 00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; /</span><span class="pln">pOverlapped </span><span class="pun">=</span><span class="pln"> NULL 
　　</span><span class="lit">004140F2</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8D7B</span><span class="pln"> </span><span class="lit">08</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lea&nbsp;&nbsp;&nbsp;&nbsp; edi</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="pln">ebx</span><span class="pun">+</span><span class="lit">8</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="pln"> 
　　</span><span class="lit">004140F5</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">52</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; edx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="pln">pBytesRead 
　　</span><span class="lit">004140F6</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">6A</span><span class="pln"> </span><span class="lit">02</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; </span><span class="lit">2</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="typ">BytesToRead</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> 
　　</span><span class="lit">004140F8</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">57</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; edi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="typ">Buffer</span><span class="pln"> 
　　</span><span class="lit">004140F9</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">56</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; esi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="pln">hFile 
　　</span><span class="lit">004140FA</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">897C24</span><span class="pln"> </span><span class="lit">2C</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; dword ptr </span><span class="pun">[</span><span class="pln">esp</span><span class="pun">+</span><span class="lit">2C</span><span class="pun">],</span><span class="pln"> edi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="pln"> 
　　</span><span class="lit">004140FE</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; FF15 </span><span class="lit">18714400</span><span class="pln"> call&nbsp;&nbsp;&nbsp; dword ptr </span><span class="pun">[&lt;&amp;</span><span class="pln">KERNEL32</span><span class="pun">.</span><span class="typ">ReadFile</span><span class="pun">&gt;]</span><span class="pln"> </span><span class="pun">;</span><span class="pln"> \ReadFile&nbsp; </span><span class="pun">读取</span><span class="lit">2</span><span class="pun">字节（</span><span class="typ">Num</span><span class="pun">）</span><span class="pln">bck</span><span class="pun">.</span><span class="pln">pak</span><span class="pun">中为</span><span class="lit">0x0086</span><span class="pln"> 
　　</span><span class="lit">00414104</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8D4424</span><span class="pln"> </span><span class="lit">10</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp; lea&nbsp;&nbsp;&nbsp;&nbsp; eax</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="pln">esp</span><span class="pun">+</span><span class="lit">10</span><span class="pun">]</span><span class="pln"> 
　　</span><span class="lit">00414108</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">6A</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; </span><span class="lit">0</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="str">/pOverlapped = NULL 
　　0041410A&nbsp; |.&nbsp; 8D6B 0A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lea&nbsp;&nbsp;&nbsp;&nbsp; ebp, dword ptr [ebx+A]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; | 
　　0041410D&nbsp; |.&nbsp; 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; |pBytesRead 
　　0041410E&nbsp; |.&nbsp; 6A 01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; |BytesToRead = 1 
　　00414110&nbsp; |.&nbsp; 55&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; ebp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; |Buffer 
　　00414111&nbsp; |.&nbsp; 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; esi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; |hFile 
　　00414112&nbsp; |.&nbsp; FF15 18714400 call&nbsp;&nbsp;&nbsp; dword ptr [&lt;&amp;KERNEL32.ReadFile&gt;] ; \ReadFile&nbsp; 读取1字节（CodeLen）bck.pak中为0x00A7 
　　00414118&nbsp; |.&nbsp; 33C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xor&nbsp;&nbsp;&nbsp;&nbsp; eax, eax 
　　0041411A&nbsp; |.&nbsp; 68 34D14400&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; 0044D134&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; ASCII "PACK FILE INDEX" 
　　0041411F&nbsp; |.&nbsp; 66:8B07&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; ax, word ptr [edi] 
　　00414122&nbsp; |.&nbsp; 8D3C40&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lea&nbsp;&nbsp;&nbsp;&nbsp; edi, dword ptr [eax+eax*2]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; （Num）[0x0086]低十六位的数值[0x0086]×0x3＝0x192 
　　00414125&nbsp; |.&nbsp; C1E7 03&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; shl&nbsp;&nbsp;&nbsp;&nbsp; edi, 3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 0x192 &lt;&lt; 3＝0x192×0x8＝0xC90（IndexLen） 
　　00414128&nbsp; |.&nbsp; 57&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; edi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 上面实际上就是（Num）[0x0086]×0x18＝0xC90（IndexLen） 
　　00414129&nbsp; |.&nbsp; E8 D20C0000&nbsp;&nbsp; call&nbsp;&nbsp;&nbsp; 00414E00 
　　0041412E&nbsp; |.&nbsp; 83C4 08&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add&nbsp;&nbsp;&nbsp;&nbsp; esp, 8 
　　00414131&nbsp; |.&nbsp; 8903&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; dword ptr [ebx], eax 
　　00414133&nbsp; |.&nbsp; 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; test&nbsp;&nbsp;&nbsp; eax, eax 
　　00414135&nbsp; |.&nbsp; 75 14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jnz&nbsp;&nbsp;&nbsp;&nbsp; short 0041414B 
　　00414137&nbsp; |.&nbsp; 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; esi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; /</span><span class="pln">hObject 
　　</span><span class="lit">00414138</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; FF15 FC714400 call&nbsp;&nbsp;&nbsp; dword ptr </span><span class="pun">[&lt;&amp;</span><span class="pln">KERNEL32</span><span class="pun">.</span><span class="typ">CloseHandl</span><span class="pun">&gt;;</span><span class="pln"> \CloseHandle 
　　</span><span class="lit">0041413E</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">5F</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop&nbsp;&nbsp;&nbsp;&nbsp; edi 
　　</span><span class="lit">0041413F</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">5E</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop&nbsp;&nbsp;&nbsp;&nbsp; esi 
　　</span><span class="lit">00414140</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">5D</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop&nbsp;&nbsp;&nbsp;&nbsp; ebp 
　　</span><span class="lit">00414141</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">33C0</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xor&nbsp;&nbsp;&nbsp;&nbsp; eax</span><span class="pun">,</span><span class="pln"> eax 
　　</span><span class="lit">00414143</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">5B</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop&nbsp;&nbsp;&nbsp;&nbsp; ebx 
　　</span><span class="lit">00414144</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">81C4</span><span class="pln"> </span><span class="lit">10020000</span><span class="pln"> add&nbsp;&nbsp;&nbsp;&nbsp; esp</span><span class="pun">,</span><span class="pln"> </span><span class="lit">210</span><span class="pln"> 
　　</span><span class="lit">0041414A</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; retn 
　　</span><span class="lit">0041414B</span><span class="pln">&nbsp; </span><span class="pun">|&gt;</span><span class="pln">&nbsp; </span><span class="lit">33C9</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xor&nbsp;&nbsp;&nbsp;&nbsp; ecx</span><span class="pun">,</span><span class="pln"> ecx 
　　</span><span class="lit">0041414D</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">68</span><span class="pln"> </span><span class="lit">24D14400</span><span class="pln">&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; </span><span class="lit">0044D124</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; ASCII </span><span class="str">"PACK FILE RAND"</span><span class="pln"> 
　　</span><span class="lit">00414152</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8A4D</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; cl</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">ebp</span><span class="pun">]</span><span class="pln"> 
　　</span><span class="lit">00414155</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">51</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; ecx 
　　</span><span class="lit">00414156</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; E8 A50C0000&nbsp;&nbsp; call&nbsp;&nbsp;&nbsp; </span><span class="lit">00414E00</span><span class="pln"> 
　　</span><span class="lit">0041415B</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">83C4</span><span class="pln"> </span><span class="lit">08</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add&nbsp;&nbsp;&nbsp;&nbsp; esp</span><span class="pun">,</span><span class="pln"> </span><span class="lit">8</span><span class="pln"> 
　　</span><span class="lit">0041415E</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8943</span><span class="pln"> </span><span class="lit">04</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; dword ptr </span><span class="pun">[</span><span class="pln">ebx</span><span class="pun">+</span><span class="lit">4</span><span class="pun">],</span><span class="pln"> eax 
　　</span><span class="lit">00414161</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">85C0</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; test&nbsp;&nbsp;&nbsp; eax</span><span class="pun">,</span><span class="pln"> eax 
　　</span><span class="lit">00414163</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">75</span><span class="pln"> </span><span class="lit">14</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jnz&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">short</span><span class="pln"> </span><span class="lit">00414179</span><span class="pln"> 
　　</span><span class="lit">00414165</span><span class="pln">&nbsp; </span><span class="pun">|&gt;</span><span class="pln">&nbsp; </span><span class="lit">56</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; esi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="str">/hObject 
　　00414166&nbsp; |.&nbsp; FF15 FC714400 call&nbsp;&nbsp;&nbsp; dword ptr [&lt;&amp;KERNEL32.CloseHandl&gt;; \CloseHandle 
　　0041416C&nbsp; |.&nbsp; 5F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop&nbsp;&nbsp;&nbsp;&nbsp; edi 
　　0041416D&nbsp; |.&nbsp; 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop&nbsp;&nbsp;&nbsp;&nbsp; esi 
　　0041416E&nbsp; |.&nbsp; 5D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop&nbsp;&nbsp;&nbsp;&nbsp; ebp 
　　0041416F&nbsp; |.&nbsp; 33C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xor&nbsp;&nbsp;&nbsp;&nbsp; eax, eax 
　　00414171&nbsp; |.&nbsp; 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop&nbsp;&nbsp;&nbsp;&nbsp; ebx 
　　00414172&nbsp; |.&nbsp; 81C4 10020000 add&nbsp;&nbsp;&nbsp;&nbsp; esp, 210 
　　00414178&nbsp; |.&nbsp; C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; retn 
　　00414179&nbsp; |&gt;&nbsp; 8B13&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; edx, dword ptr [ebx] 
　　0041417B&nbsp; |.&nbsp; 52&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; edx 
　　0041417C&nbsp; |.&nbsp; E8 BF0D0000&nbsp;&nbsp; call&nbsp;&nbsp;&nbsp; 00414F40 
　　00414181&nbsp; |.&nbsp; 894424 18&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; dword ptr [esp+18], eax 
　　00414185&nbsp; |.&nbsp; 8B43 04&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; eax, dword ptr [ebx+4] 
　　00414188&nbsp; |.&nbsp; 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; eax 
　　00414189&nbsp; |.&nbsp; E8 B20D0000&nbsp;&nbsp; call&nbsp;&nbsp;&nbsp; 00414F40 
　　0041418E&nbsp; |.&nbsp; 83C4 08&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add&nbsp;&nbsp;&nbsp;&nbsp; esp, 8 
　　00414191&nbsp; |.&nbsp; 8BD8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; ebx, eax 
　　00414193&nbsp; |.&nbsp; 6A 00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; /</span><span class="typ">Origin</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> FILE_BEGIN 
　　</span><span class="lit">00414195</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">6A</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; </span><span class="lit">0</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="pln">pOffsetHi </span><span class="pun">=</span><span class="pln"> NULL 
　　</span><span class="lit">00414197</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">6A</span><span class="pln"> </span><span class="lit">08</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; </span><span class="lit">8</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="typ">OffsetLo</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">8</span><span class="pln"> 
　　</span><span class="lit">00414199</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">56</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; esi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="pln">hFile 
　　</span><span class="lit">0041419A</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; FF15 </span><span class="lit">08724400</span><span class="pln"> call&nbsp;&nbsp;&nbsp; dword ptr </span><span class="pun">[&lt;&amp;</span><span class="pln">KERNEL32</span><span class="pun">.</span><span class="typ">SetFilePoi</span><span class="pun">&gt;;</span><span class="pln"> \SetFilePointer&nbsp; </span><span class="pun">设置文件指针到第</span><span class="lit">9</span><span class="pun">字节</span><span class="pln"> 
　　</span><span class="lit">004141A0</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">33D2</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xor&nbsp;&nbsp;&nbsp;&nbsp; edx</span><span class="pun">,</span><span class="pln"> edx 
　　</span><span class="lit">004141A2</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8D4C24</span><span class="pln"> </span><span class="lit">10</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp; lea&nbsp;&nbsp;&nbsp;&nbsp; ecx</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="pln">esp</span><span class="pun">+</span><span class="lit">10</span><span class="pun">]</span><span class="pln"> 
　　</span><span class="lit">004141A6</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8A55</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; dl</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">ebp</span><span class="pun">]</span><span class="pln"> 
　　</span><span class="lit">004141A9</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">6A</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; </span><span class="lit">0</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="str">/pOverlapped = NULL 
　　004141AB&nbsp; |.&nbsp; 51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; ecx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; |pBytesRead 
　　004141AC&nbsp; |.&nbsp; 52&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; edx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; |BytesToRead 
　　004141AD&nbsp; |.&nbsp; 53&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; ebx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; |Buffer 
　　004141AE&nbsp; |.&nbsp; 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; esi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; |hFile 
　　004141AF&nbsp; |.&nbsp; FF15 18714400 call&nbsp;&nbsp;&nbsp; dword ptr [&lt;&amp;KERNEL32.ReadFile&gt;] ; \ReadFile&nbsp; 读取（CodeLen）[0xA7]字节的数据（Code） 
　　004141B5&nbsp; |.&nbsp; B8 FDFFFFFF&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; eax, -3 
　　004141BA&nbsp; |.&nbsp; 6A 02&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; /</span><span class="typ">Origin</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> FILE_END 
　　</span><span class="lit">004141BC</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">2BC7</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">sub</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp; eax</span><span class="pun">,</span><span class="pln"> edi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="pln"> 
　　</span><span class="lit">004141BE</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">6A</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; </span><span class="lit">0</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="pln">pOffsetHi </span><span class="pun">=</span><span class="pln"> NULL 
　　</span><span class="lit">004141C0</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">50</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="typ">OffsetLo</span><span class="pln"> 
　　</span><span class="lit">004141C1</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">56</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; esi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="pln">hFile 
　　</span><span class="lit">004141C2</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; FF15 </span><span class="lit">08724400</span><span class="pln"> call&nbsp;&nbsp;&nbsp; dword ptr </span><span class="pun">[&lt;&amp;</span><span class="pln">KERNEL32</span><span class="pun">.</span><span class="typ">SetFilePoi</span><span class="pun">&gt;;</span><span class="pln"> \SetFilePointer&nbsp; </span><span class="pun">设置文件指针到倒数第</span><span class="lit">3</span><span class="pun">+（</span><span class="typ">IndexLen</span><span class="pun">）[</span><span class="lit">0x3</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">0xC90</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0xC93</span><span class="pun">]字节</span><span class="pln"> 
　　</span><span class="lit">004141C8</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8B5424</span><span class="pln"> </span><span class="lit">14</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; edx</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="pln">esp</span><span class="pun">+</span><span class="lit">14</span><span class="pun">]</span><span class="pln"> 
　　</span><span class="lit">004141CC</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8D4C24</span><span class="pln"> </span><span class="lit">10</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp; lea&nbsp;&nbsp;&nbsp;&nbsp; ecx</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="pln">esp</span><span class="pun">+</span><span class="lit">10</span><span class="pun">]</span><span class="pln"> 
　　</span><span class="lit">004141D0</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">6A</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; </span><span class="lit">0</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="str">/pOverlapped = NULL 
　　004141D2&nbsp; |.&nbsp; 51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; ecx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; |pBytesRead 
　　004141D3&nbsp; |.&nbsp; 57&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; edi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; |BytesToRead 
　　004141D4&nbsp; |.&nbsp; 52&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; edx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; |Buffer 
　　004141D5&nbsp; |.&nbsp; 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; esi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; |hFile 
　　004141D6&nbsp; |.&nbsp; FF15 18714400 call&nbsp;&nbsp;&nbsp; dword ptr [&lt;&amp;KERNEL32.ReadFile&gt;] ; \ReadFile&nbsp; 读取（IndexLen）[0xC90]字节的数据（Index） 
　　004141DC&nbsp; |.&nbsp; 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; esi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; /</span><span class="pln">hObject 
　　</span><span class="lit">004141DD</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; FF15 FC714400 call&nbsp;&nbsp;&nbsp; dword ptr </span><span class="pun">[&lt;&amp;</span><span class="pln">KERNEL32</span><span class="pun">.</span><span class="typ">CloseHandl</span><span class="pun">&gt;;</span><span class="pln"> \CloseHandle 
　　</span><span class="lit">004141E3</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">33F6</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xor&nbsp;&nbsp;&nbsp;&nbsp; esi</span><span class="pun">,</span><span class="pln"> esi 
　　</span><span class="lit">004141E5</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">85FF</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; test&nbsp;&nbsp;&nbsp; edi</span><span class="pun">,</span><span class="pln"> edi 
　　</span><span class="lit">004141E7</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">7E</span><span class="pln"> </span><span class="lit">1E</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jle&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">short</span><span class="pln"> </span><span class="lit">00414207</span><span class="pln"> 
　　</span><span class="lit">004141E9</span><span class="pln">&nbsp; </span><span class="pun">|&gt;</span><span class="pln">&nbsp; </span><span class="lit">8BC6</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">/</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; eax</span><span class="pun">,</span><span class="pln"> esi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">解密重点</span><span class="pln"> 
　　</span><span class="lit">004141EB</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">33C9</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">xor&nbsp;&nbsp;&nbsp;&nbsp; ecx</span><span class="pun">,</span><span class="pln"> ecx 
　　</span><span class="lit">004141ED</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8A4D</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; cl</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">ebp</span><span class="pun">]</span><span class="pln"> 
　　</span><span class="lit">004141F0</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">99</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">cdq&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">求余，用于循环（</span><span class="typ">Code</span><span class="pun">）</span><span class="pln"> 
　　</span><span class="lit">004141F1</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; F7F9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">idiv&nbsp;&nbsp;&nbsp; ecx 
　　</span><span class="lit">004141F3</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8B4424</span><span class="pln"> </span><span class="lit">14</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; eax</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="pln">esp</span><span class="pun">+</span><span class="lit">14</span><span class="pun">]</span><span class="pln"> 
　　</span><span class="lit">004141F7</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8A0C30</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; cl</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">eax</span><span class="pun">+</span><span class="pln">esi</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">（</span><span class="typ">Index</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]）</span><span class="pln"> 
　　</span><span class="lit">004141FA</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8A141A</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; dl</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">edx</span><span class="pun">+</span><span class="pln">ebx</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">（</span><span class="typ">Code</span><span class="pun">[</span><span class="pln">x </span><span class="pun">%</span><span class="pln"> </span><span class="typ">CodeLen</span><span class="pun">]）</span><span class="pln"> 
　　</span><span class="lit">004141FD</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">2ACA</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="kwd">sub</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp; cl</span><span class="pun">,</span><span class="pln"> dl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">这个循环实际上为：</span><span class="pln"> 
　　</span><span class="lit">004141FF</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">880C30</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">eax</span><span class="pun">+</span><span class="pln">esi</span><span class="pun">],</span><span class="pln"> cl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">（</span><span class="typ">Index</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]）＝（</span><span class="typ">Index</span><span class="pun">[</span><span class="pln">x</span><span class="pun">]）－（</span><span class="typ">Code</span><span class="pun">[</span><span class="pln">x </span><span class="pun">%</span><span class="pln"> </span><span class="typ">CodeLen</span><span class="pun">]）</span><span class="pln"> 
　　</span><span class="lit">00414202</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">46</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">inc&nbsp;&nbsp;&nbsp;&nbsp; esi 
　　</span><span class="lit">00414203</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">3BF7</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">cmp&nbsp;&nbsp;&nbsp;&nbsp; esi</span><span class="pun">,</span><span class="pln"> edi 
　　</span><span class="lit">00414205</span><span class="pln">&nbsp; </span><span class="pun">|.^</span><span class="pln"> </span><span class="lit">7C</span><span class="pln"> E2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \jl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">short</span><span class="pln"> </span><span class="lit">004141E9</span><span class="pln"> 
　　</span><span class="lit">00414207</span><span class="pln">&nbsp; </span><span class="pun">|&gt;</span><span class="pln">&nbsp; </span><span class="lit">8B5424</span><span class="pln"> </span><span class="lit">18</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; edx</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="pln">esp</span><span class="pun">+</span><span class="lit">18</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">此时数据窗口跳到</span><span class="pln">EAX</span><span class="pun">查看，可以发现很有规律的数据，估计解密后的数据就是文件索引了。可以看出一个索引为</span><span class="lit">0x18</span><span class="pun">字节，其中文件名</span><span class="lit">0xC</span><span class="pun">字节，后面跟着</span><span class="lit">3</span><span class="pun">个</span><span class="pln">DWORD</span><span class="pun">共</span><span class="lit">0xC</span><span class="pun">。</span><span class="pln"> 
　　</span><span class="lit">0041420B</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">33C0</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xor&nbsp;&nbsp;&nbsp;&nbsp; eax</span><span class="pun">,</span><span class="pln"> eax 
　　</span><span class="lit">0041420D</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">66</span><span class="pun">:</span><span class="lit">3902</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cmp&nbsp;&nbsp;&nbsp;&nbsp; word ptr </span><span class="pun">[</span><span class="pln">edx</span><span class="pun">],</span><span class="pln"> ax 
　　</span><span class="lit">00414210</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">76</span><span class="pln"> </span><span class="lit">17</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jbe&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">short</span><span class="pln"> </span><span class="lit">00414229</span><span class="pln"> 
　　</span><span class="lit">00414212</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8B4C24</span><span class="pln"> </span><span class="lit">14</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; ecx</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="pln">esp</span><span class="pun">+</span><span class="lit">14</span><span class="pun">]</span><span class="pln"> 
　　</span><span class="lit">00414216</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">83C1</span><span class="pln"> </span><span class="lit">0B</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add&nbsp;&nbsp;&nbsp;&nbsp; ecx</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0B</span><span class="pln"> 
　　</span><span class="lit">00414219</span><span class="pln">&nbsp; </span><span class="pun">|&gt;</span><span class="pln">&nbsp; </span><span class="lit">33F6</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">/</span><span class="pln">xor&nbsp;&nbsp;&nbsp;&nbsp; esi</span><span class="pun">,</span><span class="pln"> esi 
　　</span><span class="lit">0041421B</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; C601 </span><span class="lit">00</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">ecx</span><span class="pun">],</span><span class="pln"> </span><span class="lit">0</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">把文件名最后一个字节改为</span><span class="lit">0x00</span><span class="pun">，大概是防止某些错误吧。</span><span class="pln"> 
　　</span><span class="lit">0041421E</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">66</span><span class="pun">:</span><span class="lit">8B32</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; si</span><span class="pun">,</span><span class="pln"> word ptr </span><span class="pun">[</span><span class="pln">edx</span><span class="pun">]</span><span class="pln"> 
　　</span><span class="lit">00414221</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">40</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">inc&nbsp;&nbsp;&nbsp;&nbsp; eax 
　　</span><span class="lit">00414222</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">83C1</span><span class="pln"> </span><span class="lit">18</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">add&nbsp;&nbsp;&nbsp;&nbsp; ecx</span><span class="pun">,</span><span class="pln"> </span><span class="lit">18</span><span class="pln"> 
　　</span><span class="lit">00414225</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">3BC6</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">cmp&nbsp;&nbsp;&nbsp;&nbsp; eax</span><span class="pun">,</span><span class="pln"> esi 
　　</span><span class="lit">00414227</span><span class="pln">&nbsp; </span><span class="pun">|.^</span><span class="pln"> </span><span class="lit">7C</span><span class="pln"> F0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \jl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">short</span><span class="pln"> </span><span class="lit">00414219</span><span class="pln"> 
　　</span><span class="lit">00414229</span><span class="pln">&nbsp; </span><span class="pun">|&gt;</span><span class="pln">&nbsp; </span><span class="lit">33C0</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xor&nbsp;&nbsp;&nbsp;&nbsp; eax</span><span class="pun">,</span><span class="pln"> eax 
　　</span><span class="lit">0041422B</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8D8C24</span><span class="pln"> </span><span class="lit">1C0100</span><span class="pun">&gt;</span><span class="pln">lea&nbsp;&nbsp;&nbsp;&nbsp; ecx</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="pln">esp</span><span class="pun">+</span><span class="lit">11C</span><span class="pun">]</span><span class="pln"> 
　　</span><span class="lit">00414232</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">66</span><span class="pun">:</span><span class="lit">8B02</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; ax</span><span class="pun">,</span><span class="pln"> word ptr </span><span class="pun">[</span><span class="pln">edx</span><span class="pun">]</span><span class="pln"> 
　　</span><span class="lit">00414235</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">50</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; eax 
　　</span><span class="lit">00414236</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">51</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; ecx 
　　</span><span class="lit">00414237</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">68</span><span class="pln"> </span><span class="lit">18D14400</span><span class="pln">&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; </span><span class="lit">0044D118</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; ASCII </span><span class="str">"%s : %d"</span><span class="pun">,</span><span class="pln">LF 
　　</span><span class="lit">0041423C</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; E8 FF530100&nbsp;&nbsp; call&nbsp;&nbsp;&nbsp; </span><span class="lit">00429640</span><span class="pln"> 
　　</span><span class="lit">00414241</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">83C4</span><span class="pln"> </span><span class="lit">0C</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add&nbsp;&nbsp;&nbsp;&nbsp; esp</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0C</span><span class="pln"> 
　　</span><span class="lit">00414244</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; BF </span><span class="lit">01000000</span><span class="pln">&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; edi</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> 
　　</span><span class="lit">00414249</span><span class="pln">&nbsp; </span><span class="pun">|&gt;</span><span class="pln">&nbsp; </span><span class="lit">8BC7</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; eax</span><span class="pun">,</span><span class="pln"> edi 
　　</span><span class="lit">0041424B</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">5F</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop&nbsp;&nbsp;&nbsp;&nbsp; edi 
　　</span><span class="lit">0041424C</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">5E</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop&nbsp;&nbsp;&nbsp;&nbsp; esi 
　　</span><span class="lit">0041424D</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">5D</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop&nbsp;&nbsp;&nbsp;&nbsp; ebp 
　　</span><span class="lit">0041424E</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">5B</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop&nbsp;&nbsp;&nbsp;&nbsp; ebx 
　　</span><span class="lit">0041424F</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">81C4</span><span class="pln"> </span><span class="lit">10020000</span><span class="pln"> add&nbsp;&nbsp;&nbsp;&nbsp; esp</span><span class="pun">,</span><span class="pln"> </span><span class="lit">210</span><span class="pln"> 
　　</span><span class="lit">00414255</span><span class="pln">&nbsp; \.&nbsp; C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; retn</span></pre> <br>　　后面继续跟踪发现对bck.pak的处理部分已经结束了，开始对下一个pak文件处理，看来现在只是把文件索引解密，方便游戏读取而已。 <br>　　慢慢按F9，看在CreateFileA停下时的FileName，分别为chr.pak vis.pak sys.pak scn.pak sys.pak，这里开始继续跟，因为刚才sys.pak的索引解密完毕了，现在可能是对文件数据的解密。 <br>　　SetFilePointer把设置文件指针到第0x7C10D1字节（OffsetLo＝0x7C10D0） <br>　　ReadFile读取了0x4F1778字节，接着看到了一段有点熟悉的代码 <br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code2'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code2" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="pun">　　</span><span class="lit">004145D0</span><span class="pln">&nbsp; </span><span class="pun">|&gt;</span><span class="pln"> </span><span class="pun">/</span><span class="lit">8B5424</span><span class="pln"> </span><span class="lit">10</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">/</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; edx</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="pln">esp</span><span class="pun">+</span><span class="lit">10</span><span class="pun">]</span><span class="pln"> 
　　</span><span class="lit">004145D4</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">33C9</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">xor&nbsp;&nbsp;&nbsp;&nbsp; ecx</span><span class="pun">,</span><span class="pln"> ecx 
　　</span><span class="lit">004145D6</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">8BC6</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; eax</span><span class="pun">,</span><span class="pln"> esi 
　　</span><span class="lit">004145D8</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">8A4A</span><span class="pln"> </span><span class="lit">0A</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; cl</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">edx</span><span class="pun">+</span><span class="pln">A</span><span class="pun">]</span><span class="pln"> 
　　</span><span class="lit">004145DB</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">99</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">cdq 
　　</span><span class="lit">004145DC</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="pln">F7F9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">idiv&nbsp;&nbsp;&nbsp; ecx 
　　</span><span class="lit">004145DE</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">8B4424</span><span class="pln"> </span><span class="lit">30</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; eax</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="pln">esp</span><span class="pun">+</span><span class="lit">30</span><span class="pun">]</span><span class="pln"> 
　　</span><span class="lit">004145E2</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">8A0C02</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; cl</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">edx</span><span class="pun">+</span><span class="pln">eax</span><span class="pun">]</span><span class="pln"> 
　　</span><span class="lit">004145E5</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">8A1433</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; dl</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">ebx</span><span class="pun">+</span><span class="pln">esi</span><span class="pun">]</span><span class="pln"> 
　　</span><span class="lit">004145E8</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">2AD1</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="kwd">sub</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp; dl</span><span class="pun">,</span><span class="pln"> cl 
　　</span><span class="lit">004145EA</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">881433</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">ebx</span><span class="pun">+</span><span class="pln">esi</span><span class="pun">],</span><span class="pln"> dl 
　　</span><span class="lit">004145ED</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">46</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">inc&nbsp;&nbsp;&nbsp;&nbsp; esi 
　　</span><span class="lit">004145EE</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">3BF5</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">cmp&nbsp;&nbsp;&nbsp;&nbsp; esi</span><span class="pun">,</span><span class="pln"> ebp 
　　</span><span class="lit">004145F0</span><span class="pln">&nbsp; </span><span class="pun">|.^</span><span class="pln">\7C DE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \jl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">short</span><span class="pln"> </span><span class="lit">004145D0</span></pre> <br>　　没错，这就是跟解密索引时的一样循环，单步跟踪发现cl为（Code），dl为刚才读入的0x4F1778字节的数据。 <br>　　因此可以猜测文件数据也是用相同的方法加密的，数据窗口跳到EBX查看，循环结束后可以看到大量的0x00，说明该文件没有经过压缩。 <br>　　接下来先写一段解密索引然后把索引保存起来的程序，然后打开，分别查找0xD0107C00 0x78174F00（如下图）。 <br>　　<span class="highslide"><img src="assets/1570982535-30e11f11b86f5da7d8ba4b3d24d27eba.png" border="0" style="max-width: 100%;max-height: 800px;"></span> <br>　　根据刚才的简略分析，橙色部分是文件名，占0xC字节，最后一字节无论是什么都会被游戏重置成0x00，主名与扩展名之间填充0x20（如果可能）。 <br>　　另外从搜索结果不难发现，粉红部分为文件起始位置，黄色部分为文件大小，而红色部分总是与上一文件的粉红部分相同，且（粉红部分）0x7C10D0＋（黄色部分）0x4F1778＝（红色部分）0xCB2848，所以红色部分应该是文件结束位置（下一个文件起始位置）。（= =貌似是多余的？） <br>根据以上分析写出解包程序，没有发现错误，于是提取资源就到此为止了。提取出来的资源根据所在封包及文件名推测分别为： <br>.OGG（音频：音乐、语音） .WAV（音频：音效） <br>.LFF（图片：ＣＧ、背景） .LCF（图片：立绘+1张LOGO） .DAT（脚本） .FD0（字库） .LDT（图片：Staff） .LFB（图片：系统） <br></span><div id="alert_tpc" style="color: gray; margin-top: 30px; --darkreader-inline-color:#bfb9ac;" data-darkreader-inline-color="">[ 此帖被夏の幻在2009-09-12 23:34重新编辑 ]</div></div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="mark_tpc" class="tips tal" style="word-break:keep-all;word-wrap:no-wrap"><div class="tal s3">本帖最近评分记录：</div><div class="tal"><li>澄空币:+100(jxyy99) 增进讨论</li></div></div>

		<div id="w_tpc" class="c"></div>

		<div><img class="signature" src="assets/1570982535-f23b8ffd0b6b327441aa828c9cd3243d.gif" align="absbottom"></div>
		<div class="signature" style="max-height:380px;maxHeight:380px; overflow:hidden;"><table width="100%"><tbody><tr><td><div align="center"><a href="https://aquaplus.jp/uta/chiri/" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><span class="highslide"><img src="assets/1570982535-b2941f47c7cd8e06555d1301f173a932.jpg" border="0" style="max-width: 100%;max-height: 900px;"></span></a><br></div></td><td></td></tr></tbody></table></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2009-09-10 11:04 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 楼主(夏の幻) 的帖子');" data-mx-warn="Empty URL">[楼 主]</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="2537600" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570982535-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>夏の幻</b>
<div style="margin:.3em 0 .4em .2em">もう、冬は、ホワイトアルバムの季節じゃない。</div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=131798" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570982535-3e80c861881e4c453757e04fdb5f5b6e.png" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_1"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">学生会副会长</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570982535-35aa8c414aad91387ad565c549e6cd0f.gif"><br>

<span class="user-info2" id="showface_1">
<span class="user-infoWrap2">


精华:

		<a href="https://bbs.sumisora.net/search.php?authorid=131798&amp;digest=1" target="_blank" class="s4 f9" referrerpolicy="no-referrer" rel="noopener noreferrer">1</a>
<br>
发帖: <span class="s1 f9">1818</span><br>
学分: <span class="s2 f9">218 点</span><br>
澄空币: <span class="s3 f9">0 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2007-06-26<br>
		最后登录:2019-08-13 <br><br> 
		<img src="assets/1570982535-196b2da3a42134dc3b0b212d7ed677c2.gif" title="Leaf学部勋章"> <br></span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_2537600" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10930627&amp;pid=2537600&amp;article=1" onclick="return sendurl(this,4,event)" id="quote_2537600" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10930627&amp;pid=2537600&amp;article=1" id="modify_2537600" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=131798" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10930627&amp;pid=2537600" onclick="return sendurl(this,8)" id="report_2537600" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10930627&amp;uid=131798" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('2537600')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_2537600" class="fl">&nbsp;</h1>
			

			<div id="p_2537600" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_2537600"><span style="font-family:宋体 "><b>二、图片</b> <br>1、初步分析 <br>　　ToHeartPSE的图片不是常见的图片格式（果然LEAF从以前开始就喜欢干更改图片格式这档事- -），不过实际上应该都是常见的图片格式通过某种算法转化而成的。（个人理解） <br>　　下面先用WinHEX观察一下。 <br>　　<span class="highslide"><img src="assets/1570982535-bea9216a34ca8a699ab202b8aadc1d27.png" border="0" style="max-width: 100%;max-height: 800px;"></span>（S01D.LFF） <br>　　<span class="highslide"><img src="assets/1570982535-e35c7d231ae12e882bbc8656867cf8da.png" border="0" style="max-width: 100%;max-height: 800px;"></span>（C0A0C.LCF） <br>　　<span class="highslide"><img src="assets/1570982535-bdf571cf9d2d5a225b37eb9e29e61164.png" border="0" style="max-width: 100%;max-height: 800px;"></span>（ALB_AKR.LFB） <br>　　LFF和LCF有明显的magic并且文件头结构相似： <br>　　<i>0x00-0x07</i>为magic，分别为LEAFFUL和LEAFCFL。 <br>　　<i>0x08-0x0B</i>未知，LFF的总是0，LCF不固定。 <br>　　<i>0x0C-0x0F</i>乍一看没什么特别的，LFF总是0x80 0x02 0xE0 0x01，LCF不固定。 <br>　　但是既然是研究图片，那就应该要先了解游戏的分辨率，ToHeartPSE的分辨率为640x480，这两个数的十六进制分别为0x280 0x1E0，所以： <br>　　<i>0x0C-0x0D</i>为图片宽度。 <br>　　<i>0x0E-0x0F</i>为图片高度。 <br>　　<i>0x10-0x13</i>未知，LFF的总是0x14，LCF的总是0x18。 <br>2、调试分析 <br>　　用OllyDbg打开psth.exe，把之前的断点全部去掉，查找所有参考文本字串，然后搜索"LEAFFUL"，在它下面能看到检验magic的，于是在这里下断，另外发现了"exfade\exfade07.bmp"这个字符串，由此估计原图片格式可能为BMP，接着退出OllyDbg。 <br>　　开始自动附加，启动ToHeart.exe，OllyDbg就自动启动并且载入了psth.exe，在这里停下了： <br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code3'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code3" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="pun">　　</span><span class="lit">00408630</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">81E9</span><span class="pln"> </span><span class="lit">90C14400</span><span class="pln"> </span><span class="kwd">sub</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp; ecx</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0044C190</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; ASCII </span><span class="str">"LEAFFUL"</span><span class="pln"> 
　　</span><span class="lit">00408636</span><span class="pln">&nbsp; </span><span class="pun">|&gt;</span><span class="pln">&nbsp; </span><span class="lit">0FBE98</span><span class="pln"> </span><span class="lit">90C144</span><span class="pun">&gt;</span><span class="str">/movsx&nbsp;&nbsp; ebx, byte ptr [eax+44C190]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 这里为检测magic的循环。 
　　0040863D&nbsp; |.&nbsp; 33D2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |xor&nbsp;&nbsp;&nbsp;&nbsp; edx, edx 
　　0040863F&nbsp; |.&nbsp; 8A9401 90C144&gt;|mov&nbsp;&nbsp;&nbsp;&nbsp; dl, byte ptr [ecx+eax+44C190] 
　　00408646&nbsp; |.&nbsp; 3BD3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |cmp&nbsp;&nbsp;&nbsp;&nbsp; edx, ebx 
　　00408648&nbsp; |.&nbsp; 75 72&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |jnz&nbsp;&nbsp;&nbsp;&nbsp; short 004086BC 
　　0040864A&nbsp; |.&nbsp; 40&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |inc&nbsp;&nbsp;&nbsp;&nbsp; eax 
　　0040864B&nbsp; |.&nbsp; 83F8 08&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |cmp&nbsp;&nbsp;&nbsp;&nbsp; eax, 8 
　　0040864E&nbsp; |.^ 7C E6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \jl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; short 00408636 
　　00408650&nbsp; |.&nbsp; 33C9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xor&nbsp;&nbsp;&nbsp;&nbsp; ecx, ecx 
　　00408652&nbsp; |.&nbsp; 33D2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xor&nbsp;&nbsp;&nbsp;&nbsp; edx, edx 
　　00408654&nbsp; |.&nbsp; 66:8B4F 0C&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; cx, word ptr [edi+C] 
　　00408658&nbsp; |.&nbsp; 890D D0A04500 mov&nbsp;&nbsp;&nbsp;&nbsp; dword ptr [45A0D0], ecx 
　　0040865E&nbsp; |.&nbsp; 890D B8A04500 mov&nbsp;&nbsp;&nbsp;&nbsp; dword ptr [45A0B8], ecx 
　　00408664&nbsp; |.&nbsp; 66:8B57 0E&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; dx, word ptr [edi+E] 
　　00408668&nbsp; |.&nbsp; 66:81F9 8002&nbsp; cmp&nbsp;&nbsp;&nbsp;&nbsp; cx, 280 
　　0040866D&nbsp; |.&nbsp; 8915 D8A04500 mov&nbsp;&nbsp;&nbsp;&nbsp; dword ptr [45A0D8], edx 
　　00408673&nbsp; |.&nbsp; 8915 BCA04500 mov&nbsp;&nbsp;&nbsp;&nbsp; dword ptr [45A0BC], edx 
　　00408679&nbsp; |.&nbsp; 0F87 CD010000 ja&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0040884C 
　　0040867F&nbsp; |.&nbsp; 66:81FA E001&nbsp; cmp&nbsp;&nbsp;&nbsp;&nbsp; dx, 1E0 
　　00408684&nbsp; |.&nbsp; 0F87 C2010000 ja&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0040884C 
　　0040868A&nbsp; |.&nbsp; 8BC2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; eax, edx 
　　0040868C&nbsp; |.&nbsp; 0FAFC1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; imul&nbsp;&nbsp;&nbsp; eax, ecx 
　　0040868F&nbsp; |.&nbsp; 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; test&nbsp;&nbsp;&nbsp; eax, eax 
　　00408691&nbsp; |.&nbsp; A3 CCA04500&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; dword ptr [45A0CC], eax 
　　00408696&nbsp; |.&nbsp; 0F8E D7010000 jle&nbsp;&nbsp;&nbsp;&nbsp; 00408873 
　　0040869C&nbsp; |.&nbsp; 8B45 20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; eax, dword ptr [ebp+20] 
　　0040869F&nbsp; |.&nbsp; 8B5D 18&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; ebx, dword ptr [ebp+18] 
　　004086A2&nbsp; |.&nbsp; 83F8 01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cmp&nbsp;&nbsp;&nbsp;&nbsp; eax, 1 
　　004086A5&nbsp; |.&nbsp; 75 42&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jnz&nbsp;&nbsp;&nbsp;&nbsp; short 004086E9 
　　004086A7&nbsp; |.&nbsp; 33C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xor&nbsp;&nbsp;&nbsp;&nbsp; eax, eax 
　　004086A9&nbsp; |.&nbsp; 66:8B47 08&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; ax, word ptr [edi+8] 
　　004086AD&nbsp; |.&nbsp; 03D8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add&nbsp;&nbsp;&nbsp;&nbsp; ebx, eax 
　　004086AF&nbsp; |.&nbsp; 33C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xor&nbsp;&nbsp;&nbsp;&nbsp; eax, eax 
　　004086B1&nbsp; |.&nbsp; 66:8B47 0A&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; ax, word ptr [edi+A] 
　　004086B5&nbsp; |.&nbsp; 8B7D 1C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; edi, dword ptr [ebp+1C] 
　　004086B8&nbsp; |.&nbsp; 03F8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add&nbsp;&nbsp;&nbsp;&nbsp; edi, eax 
　　004086BA&nbsp; |.&nbsp; EB 30&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jmp&nbsp;&nbsp;&nbsp;&nbsp; short 004086EC 
　　004086BC&nbsp; |&gt;&nbsp; 8B35 50724400 mov&nbsp;&nbsp;&nbsp;&nbsp; esi, dword ptr [&lt;&amp;USER32.ShowCur&gt;;&nbsp; USER32.ShowCursor 
　　004086C2&nbsp; |.&nbsp; 6A 01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; /Show = TRUE 
　　004086C4&nbsp; |.&nbsp; FFD6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; call&nbsp;&nbsp;&nbsp; esi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; \ShowCursor 
　　004086C6&nbsp; |.&nbsp; A1 94D94500&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; eax, dword ptr [45D994] 
　　004086CB&nbsp; |.&nbsp; 6A 10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; 10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; /</span><span class="typ">Style</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> MB_OK</span><span class="pun">|</span><span class="pln">MB_ICONHAND</span><span class="pun">|</span><span class="pln">MB_APPLMODAL 
　　</span><span class="lit">004086CD</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">68</span><span class="pln"> </span><span class="lit">98C14400</span><span class="pln">&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; </span><span class="lit">0044C198</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="typ">Title</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">""</span><span class="lit">82</span><span class="pun">,</span><span class="str">"k"</span><span class="pun">,</span><span class="lit">82</span><span class="pun">,</span><span class="str">"e"</span><span class="pun">,</span><span class="lit">82</span><span class="pun">,</span><span class="str">"e"</span><span class="pun">,</span><span class="lit">93</span><span class="pun">,</span><span class="str">"W奐"</span><span class="pun">,</span><span class="lit">83</span><span class="pun">,</span><span class="str">"G"</span><span class="pun">,</span><span class="lit">83</span><span class="pun">,</span><span class="str">""</span><span class="pun">,</span><span class="lit">89</span><span class="pun">,</span><span class="str">""</span><span class="pun">,</span><span class="lit">81</span><span class="pun">,</span><span class="str">"["</span><span class="pln"> 
　　</span><span class="lit">004086D2</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">68</span><span class="pln"> C0C14400&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; </span><span class="lit">0044C1C0</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="typ">Text</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">""</span><span class="lit">83</span><span class="pun">,</span><span class="str">"f"</span><span class="pun">,</span><span class="lit">81</span><span class="pun">,</span><span class="str">"["</span><span class="pun">,</span><span class="lit">83</span><span class="pun">,</span><span class="str">"^"</span><span class="pun">,</span><span class="lit">88</span><span class="pun">,</span><span class="str">"購?,82,"</span><span class="pun">?,</span><span class="lit">82</span><span class="pun">,</span><span class="str">""</span><span class="pun">,</span><span class="pln">B7</span><span class="pun">,</span><span class="str">""</span><span class="pln"> 
　　</span><span class="lit">004086D7</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">50</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="pln">hOwner </span><span class="pun">=&gt;</span><span class="pln"> </span><span class="lit">008A0244</span><span class="pln"> </span><span class="pun">(</span><span class="str">'ToHeartPSE'</span><span class="pun">,</span><span class="kwd">class</span><span class="pun">=</span><span class="str">'ToHeartPSE for Windows'</span><span class="pun">)</span><span class="pln"> 
　　</span><span class="lit">004086D8</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; FF15 </span><span class="lit">6C724400</span><span class="pln"> call&nbsp;&nbsp;&nbsp; dword ptr </span><span class="pun">[&lt;&amp;</span><span class="pln">USER32</span><span class="pun">.</span><span class="typ">MessageBoxA</span><span class="pun">&gt;&gt;;</span><span class="pln"> \MessageBoxA 
　　</span><span class="lit">004086DE</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">6A</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; </span><span class="lit">0</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="str">/Show = FALSE 
　　004086E0&nbsp; |.&nbsp; FFD6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; call&nbsp;&nbsp;&nbsp; esi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; \ShowCursor 
　　004086E2&nbsp; |.&nbsp; 33C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xor&nbsp;&nbsp;&nbsp;&nbsp; eax, eax 
　　004086E4&nbsp; |.&nbsp; 5F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop&nbsp;&nbsp;&nbsp;&nbsp; edi 
　　004086E5&nbsp; |.&nbsp; 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop&nbsp;&nbsp;&nbsp;&nbsp; esi 
　　004086E6&nbsp; |.&nbsp; 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop&nbsp;&nbsp;&nbsp;&nbsp; ebx 
　　004086E7&nbsp; |.&nbsp; 5D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop&nbsp;&nbsp;&nbsp;&nbsp; ebp 
　　004086E8&nbsp; |.&nbsp; C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; retn 
　　004086E9&nbsp; |&gt;&nbsp; 8B7D 1C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; edi, dword ptr [ebp+1C] 
　　004086EC&nbsp; |&gt;&nbsp; 85DB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; test&nbsp;&nbsp;&nbsp; ebx, ebx 
　　004086EE&nbsp; |.&nbsp; 7D 02&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jge&nbsp;&nbsp;&nbsp;&nbsp; short 004086F2 
　　004086F0&nbsp; |.&nbsp; 33DB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xor&nbsp;&nbsp;&nbsp;&nbsp; ebx, ebx 
　　004086F2&nbsp; |&gt;&nbsp; 85FF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; test&nbsp;&nbsp;&nbsp; edi, edi 
　　004086F4&nbsp; |.&nbsp; 7D 02&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jge&nbsp;&nbsp;&nbsp;&nbsp; short 004086F8 
　　004086F6&nbsp; |.&nbsp; 33FF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xor&nbsp;&nbsp;&nbsp;&nbsp; edi, edi 
　　004086F8&nbsp; |&gt;&nbsp; 8D0419&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lea&nbsp;&nbsp;&nbsp;&nbsp; eax, dword ptr [ecx+ebx] 
　　004086FB&nbsp; |.&nbsp; 3D 80020000&nbsp;&nbsp; cmp&nbsp;&nbsp;&nbsp;&nbsp; eax, 280 
　　00408700&nbsp; |.&nbsp; 76 07&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jbe&nbsp;&nbsp;&nbsp;&nbsp; short 00408709 
　　00408702&nbsp; |.&nbsp; BB 80020000&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; ebx, 280 
　　00408707&nbsp; |.&nbsp; 2BD9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sub&nbsp;&nbsp;&nbsp;&nbsp; ebx, ecx 
　　00408709&nbsp; |&gt;&nbsp; 8D043A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lea&nbsp;&nbsp;&nbsp;&nbsp; eax, dword ptr [edx+edi] 
　　0040870C&nbsp; |.&nbsp; 3D E0010000&nbsp;&nbsp; cmp&nbsp;&nbsp;&nbsp;&nbsp; eax, 1E0 
　　00408711&nbsp; |.&nbsp; 76 07&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jbe&nbsp;&nbsp;&nbsp;&nbsp; short 0040871A 
　　00408713&nbsp; |.&nbsp; BF E0010000&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; edi, 1E0 
　　00408718&nbsp; |.&nbsp; 2BFA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sub&nbsp;&nbsp;&nbsp;&nbsp; edi, edx 
　　0040871A&nbsp; |&gt;&nbsp; B8 E0010000&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; eax, 1E0 
　　0040871F&nbsp; |.&nbsp; C705 E0A04500&gt;mov&nbsp;&nbsp;&nbsp;&nbsp; dword ptr [45A0E0], 0FEE 
　　00408729&nbsp; |.&nbsp; 2BC2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sub&nbsp;&nbsp;&nbsp;&nbsp; eax, edx 
　　0040872B&nbsp; |.&nbsp; 8B55 08&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; edx, dword ptr [ebp+8] 
　　0040872E&nbsp; |.&nbsp; 2BC7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sub&nbsp;&nbsp;&nbsp;&nbsp; eax, edi 
　　00408730&nbsp; |.&nbsp; BF A0614A00&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; edi, 004A61A0 
　　00408735&nbsp; |.&nbsp; 0FAFC6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; imul&nbsp;&nbsp;&nbsp; eax, esi 
　　00408738&nbsp; |.&nbsp; 03C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add&nbsp;&nbsp;&nbsp;&nbsp; eax, ebx 
　　0040873A&nbsp; |.&nbsp; 2BF1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sub&nbsp;&nbsp;&nbsp;&nbsp; esi, ecx 
　　0040873C&nbsp; |.&nbsp; 8D1442&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lea&nbsp;&nbsp;&nbsp;&nbsp; edx, dword ptr [edx+eax*2] 
　　0040873F&nbsp; |.&nbsp; 03C2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add&nbsp;&nbsp;&nbsp;&nbsp; eax, edx 
　　00408741&nbsp; |.&nbsp; A3 C4A04500&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; dword ptr [45A0C4], eax 
　　00408746&nbsp; |.&nbsp; 8BC6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; eax, esi 
　　00408748&nbsp; |.&nbsp; 8D0440&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lea&nbsp;&nbsp;&nbsp;&nbsp; eax, dword ptr [eax+eax*2] 
　　0040874B&nbsp; |.&nbsp; A3 C0A04500&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; dword ptr [45A0C0], eax 
　　00408750&nbsp; |.&nbsp; A1 CCA04500&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; eax, dword ptr [45A0CC] 
　　00408755&nbsp; |.&nbsp; 8D1440&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lea&nbsp;&nbsp;&nbsp;&nbsp; edx, dword ptr [eax+eax*2] 
　　00408758&nbsp; |.&nbsp; 8D0449&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lea&nbsp;&nbsp;&nbsp;&nbsp; eax, dword ptr [ecx+ecx*2] 
　　0040875B&nbsp; |.&nbsp; A3 B8A04500&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; dword ptr [45A0B8], eax 
　　00408760&nbsp; |.&nbsp; B9 04040000&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; ecx, 404 
　　00408765&nbsp; |.&nbsp; 33C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xor&nbsp;&nbsp;&nbsp;&nbsp; eax, eax 
　　00408767&nbsp; |.&nbsp; 8915 CCA04500 mov&nbsp;&nbsp;&nbsp;&nbsp; dword ptr [45A0CC], edx 
　　0040876D&nbsp; |.&nbsp; F3:AB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rep&nbsp;&nbsp;&nbsp;&nbsp; stos dword ptr es:[edi] 
　　0040876F&nbsp; |.&nbsp; AA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; stos&nbsp;&nbsp;&nbsp; byte ptr es:[edi] 
　　00408770&nbsp; |.&nbsp; 9C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pushfd 
　　00408771&nbsp; |.&nbsp; 60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pushad 
　　00408772&nbsp; |.&nbsp; 55&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;&nbsp; ebp 
　　00408773&nbsp; |.&nbsp; FC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cld 
　　00408774&nbsp; |.&nbsp; 8B3D C4A04500 mov&nbsp;&nbsp;&nbsp;&nbsp; edi, dword ptr [45A0C4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 空白内存地址（0x1790048），用于存放解压后的文件 
　　0040877A&nbsp; |.&nbsp; 8B35 D4A04500 mov&nbsp;&nbsp;&nbsp;&nbsp; esi, dword ptr [45A0D4]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; LFF文件第0x15字节的地址（压缩数据起始位置） 
　　00408780&nbsp; |.&nbsp; 8B15 CCA04500 mov&nbsp;&nbsp;&nbsp;&nbsp; edx, dword ptr [45A0CC]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 0x280×0x1E0×0x3＝0xE1000，图像数据占用字节数，计数用 
　　00408786&nbsp; |.&nbsp; 8B2D E0A04500 mov&nbsp;&nbsp;&nbsp;&nbsp; ebp, dword ptr [45A0E0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 0xFEE（字典位置，0xFEE为起始位置） 
　　0040878C&nbsp; |.&nbsp; 8B0D B8A04500 mov&nbsp;&nbsp;&nbsp;&nbsp; ecx, dword ptr [45A0B8]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 0x280×0x3＝0x780 
　　00408792&nbsp; |&gt;&nbsp; AC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /</span><span class="pln">lods&nbsp;&nbsp;&nbsp; </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">esi</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">读取</span><span class="lit">1</span><span class="pun">字节</span><span class="pln"> 
　　</span><span class="lit">00408793</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; F6D0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="kwd">not</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp; al&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">取反该字节</span><span class="pln"> 
　　</span><span class="lit">00408795</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; B4 FF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; ah</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0FF</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; ax</span><span class="pun">寄存器高位赋值</span><span class="lit">0xFF</span><span class="pln"> 
　　</span><span class="lit">00408797</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">86C4</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">xchg&nbsp;&nbsp;&nbsp; ah</span><span class="pun">,</span><span class="pln"> al&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; ax</span><span class="pun">高位低位互换</span><span class="pln"> 
　　</span><span class="lit">00408799</span><span class="pln">&nbsp; </span><span class="pun">|&gt;</span><span class="pln">&nbsp; </span><span class="lit">66</span><span class="pun">:</span><span class="pln">D1E0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="str">/shl&nbsp;&nbsp;&nbsp;&nbsp; ax, 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 逻辑左移1位 
　　0040879C&nbsp; |.&nbsp; 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ||push&nbsp;&nbsp;&nbsp; eax 
　　0040879D&nbsp; |.&nbsp; 73 38&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ||jnb&nbsp;&nbsp;&nbsp;&nbsp; short 004087D7 
　　0040879F&nbsp; |.&nbsp; AC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ||lods&nbsp;&nbsp;&nbsp; byte ptr [esi] 
　　004087A0&nbsp; |.&nbsp; F6D0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ||not&nbsp;&nbsp;&nbsp;&nbsp; al 
　　004087A2&nbsp; |.&nbsp; 8885 A0614A00 ||mov&nbsp;&nbsp;&nbsp;&nbsp; byte ptr [ebp+4A61A0], al&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 写入字典（0x4A61A0为字典所在基址） 
　　004087A8&nbsp; |.&nbsp; AA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ||stos&nbsp;&nbsp;&nbsp; byte ptr es:[edi]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 写入解压文件 
　　004087A9&nbsp; |.&nbsp; 45&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ||inc&nbsp;&nbsp;&nbsp;&nbsp; ebp 
　　004087AA&nbsp; |.&nbsp; 81E5 FF0F0000 ||and&nbsp;&nbsp;&nbsp;&nbsp; ebp, 0FFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 0x1000（字典占用空间） 
　　004087B0&nbsp; |.&nbsp; 4A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ||dec&nbsp;&nbsp;&nbsp;&nbsp; edx 
　　004087B1&nbsp; |.&nbsp; 0F84 87000000 ||je&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0040883E 
　　004087B7&nbsp; |.&nbsp; 49&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ||dec&nbsp;&nbsp;&nbsp;&nbsp; ecx 
　　004087B8&nbsp; |.&nbsp; 75 70&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ||jnz&nbsp;&nbsp;&nbsp;&nbsp; short 0040882A 
　　004087BA&nbsp; |.&nbsp; 033D C0A04500 ||add&nbsp;&nbsp;&nbsp;&nbsp; edi, dword ptr [45A0C0]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; [45A0C0]总是为0？ 
　　004087C0&nbsp; |.&nbsp; 8B0D D8A04500 ||mov&nbsp;&nbsp;&nbsp;&nbsp; ecx, dword ptr [45A0D8]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; [45A0D8]初始值为0x1E0，跟[45A0B8]似乎也是计数用的 
　　004087C6&nbsp; |.&nbsp; 49&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ||dec&nbsp;&nbsp;&nbsp;&nbsp; ecx 
　　004087C7&nbsp; |.&nbsp; 74 75&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ||je&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; short 0040883E 
　　004087C9&nbsp; |.&nbsp; 890D D8A04500 ||mov&nbsp;&nbsp;&nbsp;&nbsp; dword ptr [45A0D8], ecx 
　　004087CF&nbsp; |.&nbsp; 8B0D B8A04500 ||mov&nbsp;&nbsp;&nbsp;&nbsp; ecx, dword ptr [45A0B8] 
　　004087D5&nbsp; |.&nbsp; EB 53&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ||jmp&nbsp;&nbsp;&nbsp;&nbsp; short 0040882A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 上面是当ax逻辑左移前最高位为1时同时写入字典和文件 
　　004087D7&nbsp; |&gt;&nbsp; 66:AD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ||lods&nbsp;&nbsp;&nbsp; word ptr [esi]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 这里是当ax逻辑左移前最高位为0时从字典中读取n个字节写入字典另一位置及解压文件 
　　004087D9&nbsp; |.&nbsp; 66:F7D0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ||not&nbsp;&nbsp;&nbsp;&nbsp; ax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; n由下面几行计算出来 
　　004087DC&nbsp; |.&nbsp; 0FB7D8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ||movzx&nbsp;&nbsp; ebx, ax 
　　004087DF&nbsp; |.&nbsp; C1EB 04&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ||shr&nbsp;&nbsp;&nbsp;&nbsp; ebx, 4 
　　004087E2&nbsp; |.&nbsp; 24 0F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ||and&nbsp;&nbsp;&nbsp;&nbsp; al, 0F 
　　004087E4&nbsp; |.&nbsp; 04 03&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ||add&nbsp;&nbsp;&nbsp;&nbsp; al, 3 
　　004087E6&nbsp; |&gt;&nbsp; 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ||/</span><span class="pln">push&nbsp;&nbsp;&nbsp; eax 
　　</span><span class="lit">004087E7</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8A83</span><span class="pln"> A0614A00 </span><span class="pun">|||</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; al</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">ebx</span><span class="pun">+</span><span class="lit">4A61A0</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">读取指定位置的字典</span><span class="pln"> 
　　</span><span class="lit">004087ED</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8885</span><span class="pln"> A0614A00 </span><span class="pun">|||</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">ebp</span><span class="pun">+</span><span class="lit">4A61A0</span><span class="pun">],</span><span class="pln"> al&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">写入字典</span><span class="pln"> 
　　</span><span class="lit">004087F3</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">43</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|||</span><span class="pln">inc&nbsp;&nbsp;&nbsp;&nbsp; ebx 
　　</span><span class="lit">004087F4</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">45</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|||</span><span class="pln">inc&nbsp;&nbsp;&nbsp;&nbsp; ebp 
　　</span><span class="lit">004087F5</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">81E3</span><span class="pln"> FF0F0000 </span><span class="pun">|||</span><span class="kwd">and</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp; ebx</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0FFF</span><span class="pln"> 
　　</span><span class="lit">004087FB</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">81E5</span><span class="pln"> FF0F0000 </span><span class="pun">|||</span><span class="kwd">and</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp; ebp</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0FFF</span><span class="pln"> 
　　</span><span class="lit">00408801</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8807</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|||</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">edi</span><span class="pun">],</span><span class="pln"> al&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">写入解压文件</span><span class="pln"> 
　　</span><span class="lit">00408803</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">4A</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|||</span><span class="pln">dec&nbsp;&nbsp;&nbsp;&nbsp; edx 
　　</span><span class="lit">00408804</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">74</span><span class="pln"> </span><span class="lit">37</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|||</span><span class="pln">je&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">short</span><span class="pln"> </span><span class="lit">0040883D</span><span class="pln"> 
　　</span><span class="lit">00408806</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">47</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|||</span><span class="pln">inc&nbsp;&nbsp;&nbsp;&nbsp; edi 
　　</span><span class="lit">00408807</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">49</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|||</span><span class="pln">dec&nbsp;&nbsp;&nbsp;&nbsp; ecx 
　　</span><span class="lit">00408808</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">75</span><span class="pln"> </span><span class="lit">1B</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|||</span><span class="pln">jnz&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">short</span><span class="pln"> </span><span class="lit">00408825</span><span class="pln"> 
　　</span><span class="lit">0040880A</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">033D</span><span class="pln"> C0A04500 </span><span class="pun">|||</span><span class="pln">add&nbsp;&nbsp;&nbsp;&nbsp; edi</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="lit">45A0C0</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">[</span><span class="lit">45A0C0</span><span class="pun">]总是为</span><span class="lit">0</span><span class="pun">？</span><span class="pln"> 
　　</span><span class="lit">00408810</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8B0D</span><span class="pln"> D8A04500 </span><span class="pun">|||</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; ecx</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="lit">45A0D8</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">[</span><span class="lit">45A0D8</span><span class="pun">]初始值为</span><span class="lit">0x1E0</span><span class="pln"> 
　　</span><span class="lit">00408816</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">49</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|||</span><span class="pln">dec&nbsp;&nbsp;&nbsp;&nbsp; ecx 
　　</span><span class="lit">00408817</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">74</span><span class="pln"> </span><span class="lit">24</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|||</span><span class="pln">je&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">short</span><span class="pln"> </span><span class="lit">0040883D</span><span class="pln"> 
　　</span><span class="lit">00408819</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">890D</span><span class="pln"> D8A04500 </span><span class="pun">|||</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; dword ptr </span><span class="pun">[</span><span class="lit">45A0D8</span><span class="pun">],</span><span class="pln"> ecx 
　　</span><span class="lit">0040881F</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8B0D</span><span class="pln"> B8A04500 </span><span class="pun">|||</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; ecx</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="lit">45A0B8</span><span class="pun">]</span><span class="pln"> 
　　</span><span class="lit">00408825</span><span class="pln">&nbsp; </span><span class="pun">|&gt;</span><span class="pln">&nbsp; </span><span class="lit">58</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|||</span><span class="pln">pop&nbsp;&nbsp;&nbsp;&nbsp; eax 
　　</span><span class="lit">00408826</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; FEC8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|||</span><span class="pln">dec&nbsp;&nbsp;&nbsp;&nbsp; al 
　　</span><span class="lit">00408828</span><span class="pln">&nbsp; </span><span class="pun">|.^</span><span class="pln"> </span><span class="lit">75</span><span class="pln"> BC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">\jnz&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">short</span><span class="pln"> </span><span class="lit">004087E6</span><span class="pln"> 
　　</span><span class="lit">0040882A</span><span class="pln">&nbsp; </span><span class="pun">|&gt;</span><span class="pln">&nbsp; </span><span class="lit">58</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">pop&nbsp;&nbsp;&nbsp;&nbsp; eax 
　　</span><span class="lit">0040882B</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">83FA</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">cmp&nbsp;&nbsp;&nbsp;&nbsp; edx</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> 
　　</span><span class="lit">0040882E</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">7E</span><span class="pln"> </span><span class="lit">0F</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">jle&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">short</span><span class="pln"> </span><span class="lit">0040883F</span><span class="pln"> 
　　</span><span class="lit">00408830</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">0AC0</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="kwd">or</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; al</span><span class="pun">,</span><span class="pln"> al 
　　</span><span class="lit">00408832</span><span class="pln">&nbsp; </span><span class="pun">|.^</span><span class="pln"> </span><span class="lit">0F85</span><span class="pln"> </span><span class="lit">61FFFFFF</span><span class="pln"> </span><span class="pun">|</span><span class="pln">\jnz&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="lit">00408799</span><span class="pln"> 
　　</span><span class="lit">00408838</span><span class="pln">&nbsp; </span><span class="pun">|.^</span><span class="pln"> E9 </span><span class="lit">55FFFFFF</span><span class="pln">&nbsp;&nbsp; \jmp&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="lit">00408792</span><span class="pln"> 
　　</span><span class="lit">0040883D</span><span class="pln">&nbsp; </span><span class="pun">|&gt;</span><span class="pln">&nbsp; </span><span class="lit">58</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop&nbsp;&nbsp;&nbsp;&nbsp; eax 
　　</span><span class="lit">0040883E</span><span class="pln">&nbsp; </span><span class="pun">|&gt;</span><span class="pln">&nbsp; </span><span class="lit">58</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop&nbsp;&nbsp;&nbsp;&nbsp; eax 
　　</span><span class="lit">0040883F</span><span class="pln">&nbsp; </span><span class="pun">|&gt;</span><span class="pln">&nbsp; </span><span class="lit">5D</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop&nbsp;&nbsp;&nbsp;&nbsp; ebp 
　　</span><span class="lit">00408840</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">61</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; popad 
　　</span><span class="lit">00408841</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">9D</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; popfd 
　　</span><span class="lit">00408842</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; B8 </span><span class="lit">01000000</span><span class="pln">&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; eax</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> 
　　</span><span class="lit">00408847</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">5F</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop&nbsp;&nbsp;&nbsp;&nbsp; edi 
　　</span><span class="lit">00408848</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">5E</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop&nbsp;&nbsp;&nbsp;&nbsp; esi 
　　</span><span class="lit">00408849</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">5B</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop&nbsp;&nbsp;&nbsp;&nbsp; ebx 
　　</span><span class="lit">0040884A</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">5D</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop&nbsp;&nbsp;&nbsp;&nbsp; ebp 
　　</span><span class="lit">0040884B</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; retn</span></pre> <br>　　通过分析，大致的解压方式已经了解了，如果熟悉压缩算法的话不难发现这个是LZSS的压缩算法，0x1000字节的字典，还有0xFEE。 <br>　　现在给0040883D 0040883E 0040883F，按F9继续，程序停在0040883D。然后在数据窗口跟随1790048（[45A0C4]的初始值），如图： <br>　　<span class="highslide"><img src="assets/1570982535-0adfffac1a85974df05556751f619e6f.png" border="0" style="max-width: 100%;max-height: 800px;"></span> <br>　　右键→备份→保存数据到文件，把该区域的数据保存为_01790000.mem <br>　　<span class="highslide"><img src="assets/1570982535-f9ebcc1e3f33bcc4d49cca37951f5654.png" border="0" style="max-width: 100%;max-height: 800px;"></span> <br>　　发现文件大小比0xE1000多了0x1000，观察可以发现文件头多了0x48字节数据，文件末尾多了0xFB8字节的0x00。 <br>　　<span class="highslide"><img src="assets/1570982535-71e6b41ee0fda88031de181f10507ab0.png" border="0" style="max-width: 100%;max-height: 800px;"></span> <br>　　之前猜测图片原格式有可能是BMP，观察发现0x20-0x47的数据恰好满足位图信息头。 <br>　　<h6 class="quote">Quote:</h6><blockquote class="blockquote">typedef struct tagBITMAPINFOHEADER <br>　　{ <br>　　 DWORD biSize; <br>　　 LONG biWidth; <br>　　 LONG biHeight; <br>　　 WORD biPlanes; <br>　　 WORD biBitCount; <br>　　 DWORD biCompression; <br>　　 DWORD biSizeImage; <br>　　 LONG biXPelsPerMeter; <br>　　 LONG biYPelsPerMeter; <br>　　 DWORD biClrUsed; <br>　　 DWORD biClrImportant; <br>　　} BITMAPINFOHEADER, FAR *LPBITMAPINFOHEADER, *PBITMAPINFOHEADER;</blockquote> <br>　　<span class="highslide"><img src="assets/1570982535-70f5d1b1d9c7ba91b886e9f90162843a.png" border="0" style="max-width: 100%;max-height: 800px;"></span> <br>　　前面0x20字节估计是游戏需要用的的一些数值，比如0xE2000为这个就是刚才那块内存的大小。 <br>　　于是我们把多余的数据删除，再加上位图文件头，如图： <br>　　<span class="highslide"><img src="assets/1570982535-d5d20b0f9b941b0c84259afb96e52c0e.png" border="0" style="max-width: 100%;max-height: 800px;"></span> <br>　　把扩展名mem改成BMP，图片正常显示，说明推测没错。 <br>　　<span class="highslide"><img src="assets/1570982535-2746bc11d83997f652956d2402c9238a.jpg" border="0" style="max-width: 100%;max-height: 800px;"></span>（被BP转成JPG了囧） <br>　　 <br>　　 <br>　　接下来是.LCF跟.LFB的算法了，由于一个没搜索到magic、一个没有magic，所以在"c%04x.lcf"和"%s.lfb"的字符串上下断（事实上不一定能有用，姑且一试）。 <br>　　到有人物出现的时候停下了，"c%04x.lcf"的断点有效，给CreateFileA、ReadFile下断，F9继续。 <br>　　到ReadFile后开始单步，从堆栈区可以看出是在读"C0101 LCF"，经过Code解密后来到这里： <br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code4'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code4" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="pun">　　</span><span class="lit">004082BB</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8B3D</span><span class="pln"> B4A04500 mov&nbsp;&nbsp;&nbsp;&nbsp; edi</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="lit">45A0B4</span><span class="pun">]</span><span class="pln"> 
　　</span><span class="lit">004082C1</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8B35</span><span class="pln"> B0A04500 mov&nbsp;&nbsp;&nbsp;&nbsp; esi</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="lit">45A0B0</span><span class="pun">]</span><span class="pln"> 
　　</span><span class="lit">004082C7</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8B15</span><span class="pln"> A8A04500 mov&nbsp;&nbsp;&nbsp;&nbsp; edx</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="lit">45A0A8</span><span class="pun">]</span><span class="pln"> 
　　</span><span class="lit">004082CD</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8B2D</span><span class="pln"> ACA04500 mov&nbsp;&nbsp;&nbsp;&nbsp; ebp</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="lit">45A0AC</span><span class="pun">]</span><span class="pln"> 
　　</span><span class="lit">004082D3</span><span class="pln">&nbsp; </span><span class="pun">|&gt;</span><span class="pln">&nbsp; AC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">/</span><span class="pln">lods&nbsp;&nbsp;&nbsp; </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">esi</span><span class="pun">]</span><span class="pln"> 
　　</span><span class="lit">004082D4</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; B4 FF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; ah</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0FF</span><span class="pln"> 
　　</span><span class="lit">004082D6</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">86C4</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">xchg&nbsp;&nbsp;&nbsp; ah</span><span class="pun">,</span><span class="pln"> al 
　　</span><span class="lit">004082D8</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">66</span><span class="pun">:</span><span class="lit">8BC8</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; cx</span><span class="pun">,</span><span class="pln"> ax 
　　</span><span class="lit">004082DB</span><span class="pln">&nbsp; </span><span class="pun">|&gt;</span><span class="pln">&nbsp; </span><span class="lit">66</span><span class="pun">:</span><span class="pln">D1E1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="str">/shl&nbsp;&nbsp;&nbsp;&nbsp; cx, 1 
　　004082DE&nbsp; |.&nbsp; 72 16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ||jb&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; short 004082F6 
　　004082E0&nbsp; |.&nbsp; AC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ||lods&nbsp;&nbsp;&nbsp; byte ptr [esi] 
　　004082E1&nbsp; |.&nbsp; F6D0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ||not&nbsp;&nbsp;&nbsp;&nbsp; al 
　　004082E3&nbsp; |.&nbsp; 8885 C0714A00 ||mov&nbsp;&nbsp;&nbsp;&nbsp; byte ptr [ebp+4A71C0], al 
　　004082E9&nbsp; |.&nbsp; 45&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ||inc&nbsp;&nbsp;&nbsp;&nbsp; ebp 
　　004082EA&nbsp; |.&nbsp; 81E5 FF0F0000 ||and&nbsp;&nbsp;&nbsp;&nbsp; ebp, 0FFF 
　　004082F0&nbsp; |.&nbsp; AA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ||stos&nbsp;&nbsp;&nbsp; byte ptr es:[edi] 
　　004082F1&nbsp; |.&nbsp; 4A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ||dec&nbsp;&nbsp;&nbsp;&nbsp; edx 
　　004082F2&nbsp; |.&nbsp; 74 41&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ||je&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; short 00408335 
　　004082F4&nbsp; |.&nbsp; EB 33&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ||jmp&nbsp;&nbsp;&nbsp;&nbsp; short 00408329 
　　004082F6&nbsp; |&gt;&nbsp; 66:AD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ||lods&nbsp;&nbsp;&nbsp; word ptr [esi] 
　　004082F8&nbsp; |.&nbsp; 66:F7D0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ||not&nbsp;&nbsp;&nbsp;&nbsp; ax 
　　004082FB&nbsp; |.&nbsp; 0FB7D8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ||movzx&nbsp;&nbsp; ebx, ax 
　　004082FE&nbsp; |.&nbsp; C1EB 04&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ||shr&nbsp;&nbsp;&nbsp;&nbsp; ebx, 4 
　　00408301&nbsp; |.&nbsp; 24 0F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ||and&nbsp;&nbsp;&nbsp;&nbsp; al, 0F 
　　00408303&nbsp; |.&nbsp; 04 03&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ||add&nbsp;&nbsp;&nbsp;&nbsp; al, 3 
　　00408305&nbsp; |&gt;&nbsp; 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ||/</span><span class="pln">push&nbsp;&nbsp;&nbsp; eax 
　　</span><span class="lit">00408306</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8A83</span><span class="pln"> C0714A00 </span><span class="pun">|||</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; al</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">ebx</span><span class="pun">+</span><span class="lit">4A71C0</span><span class="pun">]</span><span class="pln"> 
　　</span><span class="lit">0040830C</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8885</span><span class="pln"> C0714A00 </span><span class="pun">|||</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">ebp</span><span class="pun">+</span><span class="lit">4A71C0</span><span class="pun">],</span><span class="pln"> al 
　　</span><span class="lit">00408312</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">43</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|||</span><span class="pln">inc&nbsp;&nbsp;&nbsp;&nbsp; ebx 
　　</span><span class="lit">00408313</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">45</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|||</span><span class="pln">inc&nbsp;&nbsp;&nbsp;&nbsp; ebp 
　　</span><span class="lit">00408314</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">81E3</span><span class="pln"> FF0F0000 </span><span class="pun">|||</span><span class="kwd">and</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp; ebx</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0FFF</span><span class="pln"> 
　　</span><span class="lit">0040831A</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">81E5</span><span class="pln"> FF0F0000 </span><span class="pun">|||</span><span class="kwd">and</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp; ebp</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0FFF</span><span class="pln"> 
　　</span><span class="lit">00408320</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; AA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|||</span><span class="pln">stos&nbsp;&nbsp;&nbsp; </span><span class="kwd">byte</span><span class="pln"> ptr es</span><span class="pun">:[</span><span class="pln">edi</span><span class="pun">]</span><span class="pln"> 
　　</span><span class="lit">00408321</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">4A</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|||</span><span class="pln">dec&nbsp;&nbsp;&nbsp;&nbsp; edx 
　　</span><span class="lit">00408322</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">74</span><span class="pln"> </span><span class="lit">10</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|||</span><span class="pln">je&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">short</span><span class="pln"> </span><span class="lit">00408334</span><span class="pln"> 
　　</span><span class="lit">00408324</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">58</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|||</span><span class="pln">pop&nbsp;&nbsp;&nbsp;&nbsp; eax 
　　</span><span class="lit">00408325</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; FEC8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|||</span><span class="pln">dec&nbsp;&nbsp;&nbsp;&nbsp; al 
　　</span><span class="lit">00408327</span><span class="pln">&nbsp; </span><span class="pun">|.^</span><span class="pln"> </span><span class="lit">75</span><span class="pln"> DC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">\jnz&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">short</span><span class="pln"> </span><span class="lit">00408305</span><span class="pln"> 
　　</span><span class="lit">00408329</span><span class="pln">&nbsp; </span><span class="pun">|&gt;</span><span class="pln">&nbsp; </span><span class="lit">0AC9</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="kwd">or</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cl</span><span class="pun">,</span><span class="pln"> cl 
　　</span><span class="lit">0040832B</span><span class="pln">&nbsp; </span><span class="pun">|.^</span><span class="pln"> </span><span class="lit">75</span><span class="pln"> AE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">\jnz&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">short</span><span class="pln"> </span><span class="lit">004082DB</span><span class="pln"> 
　　</span><span class="lit">0040832D</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">83FA</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">cmp&nbsp;&nbsp;&nbsp;&nbsp; edx</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> 
　　</span><span class="lit">00408330</span><span class="pln">&nbsp; </span><span class="pun">|.^</span><span class="pln"> </span><span class="lit">7F</span><span class="pln"> A1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \jg&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">short</span><span class="pln"> </span><span class="lit">004082D3</span></pre> <br>　　可以看出依旧是LZSS算法，不同的是没有了另外一组计数，记下解压数据的起始位置，保存该区域的数据，然后用WinHEX截取出解压数据（保存的文件名为内存区域的地址，相减即可得相对于该文件的位置）。 <br>　　尝试加上BMP文件头后发现图片有问题，于是继续跟踪。 <br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code5'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code5" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="pun">　　</span><span class="lit">004084D0</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8B75</span><span class="pln"> E8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; esi</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="pln">ebp</span><span class="pun">-</span><span class="lit">18</span><span class="pun">]</span><span class="pln"> 
　　</span><span class="lit">004084D3</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8B7D</span><span class="pln"> FC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; edi</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="pln">ebp</span><span class="pun">-</span><span class="lit">4</span><span class="pun">]</span><span class="pln"> 
　　</span><span class="lit">004084D6</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8B5D</span><span class="pln"> F4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; ebx</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="pln">ebp</span><span class="pun">-</span><span class="pln">C</span><span class="pun">]</span><span class="pln"> 
　　</span><span class="lit">004084D9</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">0BDB</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">or</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ebx</span><span class="pun">,</span><span class="pln"> ebx 
　　</span><span class="lit">004084DB</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">74</span><span class="pln"> </span><span class="lit">16</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; je&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">short</span><span class="pln"> </span><span class="lit">004084F3</span><span class="pln"> 
　　</span><span class="lit">004084DD</span><span class="pln">&nbsp; </span><span class="pun">|&gt;</span><span class="pln">&nbsp; </span><span class="lit">8B4D</span><span class="pln"> F8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">/</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; ecx</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="pln">ebp</span><span class="pun">-</span><span class="lit">8</span><span class="pun">]</span><span class="pln"> 
　　</span><span class="lit">004084E0</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">034D</span><span class="pln"> EC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">add&nbsp;&nbsp;&nbsp;&nbsp; ecx</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="pln">ebp</span><span class="pun">-</span><span class="lit">14</span><span class="pun">]</span><span class="pln"> 
　　</span><span class="lit">004084E3</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">034D</span><span class="pln"> </span><span class="lit">18</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">add&nbsp;&nbsp;&nbsp;&nbsp; ecx</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="pln">ebp</span><span class="pun">+</span><span class="lit">18</span><span class="pun">]</span><span class="pln"> 
　　</span><span class="lit">004084E6</span><span class="pln">&nbsp; </span><span class="pun">|&gt;</span><span class="pln">&nbsp; AC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="str">/lods&nbsp;&nbsp;&nbsp; byte ptr [esi] 
　　004084E7&nbsp; |.&nbsp; 0AC0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ||or&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; al, al 
　　004084E9&nbsp; |.&nbsp; 74 03&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ||je&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; short 004084EE 
　　004084EB&nbsp; |.&nbsp; 83C6 03&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ||add&nbsp;&nbsp;&nbsp;&nbsp; esi, 3 
　　004084EE&nbsp; |&gt;^ E2 F6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |\loopd&nbsp;&nbsp; short 004084E6 
　　004084F0&nbsp; |.&nbsp; 4B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |dec&nbsp;&nbsp;&nbsp;&nbsp; ebx 
　　004084F1&nbsp; |.^ 75 EA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \jnz&nbsp;&nbsp;&nbsp;&nbsp; short 004084DD 
　　004084F3&nbsp; |&gt;&nbsp; 8B5D F0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;&nbsp; ebx, dword ptr [ebp-10]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 开始合成，ebx初始值为立绘高度，计数用 
　　004084F6&nbsp; |&gt;&nbsp; 53&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /</span><span class="pln">push&nbsp;&nbsp;&nbsp; ebx 
　　</span><span class="lit">004084F7</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8B4D</span><span class="pln"> F8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; ecx</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="pln">ebp</span><span class="pun">-</span><span class="lit">8</span><span class="pun">]</span><span class="pln"> 
　　</span><span class="lit">004084FA</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">0BC9</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="kwd">or</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ecx</span><span class="pun">,</span><span class="pln"> ecx 
　　</span><span class="lit">004084FC</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">74</span><span class="pln"> </span><span class="lit">0A</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">je&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">short</span><span class="pln"> </span><span class="lit">00408508</span><span class="pln"> 
　　</span><span class="lit">004084FE</span><span class="pln">&nbsp; </span><span class="pun">|&gt;</span><span class="pln">&nbsp; AC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="str">/lods&nbsp;&nbsp;&nbsp; byte ptr [esi]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; 同时有两个人的话会执行这个。 
　　004084FF&nbsp; |.&nbsp; 0AC0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ||or&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; al, al 
　　00408501&nbsp; |.&nbsp; 74 03&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ||je&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; short 00408506 
　　00408503&nbsp; |.&nbsp; 83C6 03&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ||add&nbsp;&nbsp;&nbsp;&nbsp; esi, 3 
　　00408506&nbsp; |&gt;^ E2 F6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |\loopd&nbsp;&nbsp; short 004084FE 
　　00408508&nbsp; |&gt;&nbsp; 8B4D EC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |mov&nbsp;&nbsp;&nbsp;&nbsp; ecx, dword ptr [ebp-14]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp; ecx初始值为立绘宽度，计数用 
　　0040850B&nbsp; |&gt;&nbsp; AC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |/</span><span class="pln">lods&nbsp;&nbsp;&nbsp; </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">esi</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">读取</span><span class="lit">1</span><span class="pun">字节解压后的数据</span><span class="pln"> 
　　</span><span class="lit">0040850C</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">0AC0</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="kwd">or</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; al</span><span class="pun">,</span><span class="pln"> al&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">检查是否为</span><span class="lit">0</span><span class="pun">（透明）</span><span class="pln"> 
　　</span><span class="lit">0040850E</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">74</span><span class="pln"> </span><span class="lit">41</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">je&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">short</span><span class="pln"> </span><span class="lit">00408551</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">是则跳转</span><span class="pln"> 
　　</span><span class="lit">00408510</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">3C</span><span class="pln"> FF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">cmp&nbsp;&nbsp;&nbsp;&nbsp; al</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0FF</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">检查是否为</span><span class="lit">0xFF</span><span class="pun">（不透明）</span><span class="pln"> 
　　</span><span class="lit">00408512</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">74</span><span class="pln"> </span><span class="lit">35</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">je&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">short</span><span class="pln"> </span><span class="lit">00408549</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">是则跳转</span><span class="pln"> 
　　</span><span class="lit">00408514</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8AD0</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; dl</span><span class="pun">,</span><span class="pln"> al&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">（半透明）</span><span class="pln"> 
　　</span><span class="lit">00408516</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8AF0</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; dh</span><span class="pun">,</span><span class="pln"> al 
　　</span><span class="lit">00408518</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; F6D6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="kwd">not</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp; dh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">下面分别对</span><span class="pln">RBG</span><span class="pun">做半透明处理并与半透明处理后的背景合成</span><span class="pln"> 
　　</span><span class="lit">0040851A</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; AC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">lods&nbsp;&nbsp;&nbsp; </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">esi</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">读取</span><span class="lit">1</span><span class="pun">字节解压后的数据</span><span class="pln"> 
　　</span><span class="lit">0040851B</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; F6E2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">mul&nbsp;&nbsp;&nbsp;&nbsp; dl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; ax</span><span class="pun">=</span><span class="pln">al</span><span class="pun">*</span><span class="pln">dl 
　　</span><span class="lit">0040851D</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8ADC</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; bl</span><span class="pun">,</span><span class="pln"> ah&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; bl</span><span class="pun">=</span><span class="pln">ah 
　　</span><span class="lit">0040851F</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8A07</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; al</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">edi</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">读取背景</span><span class="pln"> 
　　</span><span class="lit">00408521</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; F6E6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">mul&nbsp;&nbsp;&nbsp;&nbsp; dh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; ax</span><span class="pun">=</span><span class="pln">al</span><span class="pun">*</span><span class="pln">dh 
　　</span><span class="lit">00408523</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">02E3</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">add&nbsp;&nbsp;&nbsp;&nbsp; ah</span><span class="pun">,</span><span class="pln"> bl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; ah</span><span class="pun">=</span><span class="pln">ah</span><span class="pun">+</span><span class="pln">bl 
　　</span><span class="lit">00408525</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8827</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">edi</span><span class="pun">],</span><span class="pln"> ah&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">写入背景</span><span class="pln"> 
　　</span><span class="lit">00408527</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">47</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">inc&nbsp;&nbsp;&nbsp;&nbsp; edi 
　　</span><span class="lit">00408528</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; AC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">lods&nbsp;&nbsp;&nbsp; </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">esi</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">读取</span><span class="lit">1</span><span class="pun">字节解压后的数据</span><span class="pln"> 
　　</span><span class="lit">00408529</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; F6E2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">mul&nbsp;&nbsp;&nbsp;&nbsp; dl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; ax</span><span class="pun">=</span><span class="pln">al</span><span class="pun">*</span><span class="pln">dl 
　　</span><span class="lit">0040852B</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8ADC</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; bl</span><span class="pun">,</span><span class="pln"> ah&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; bl</span><span class="pun">=</span><span class="pln">ah 
　　</span><span class="lit">0040852D</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8A07</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; al</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">edi</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">读取背景</span><span class="pln"> 
　　</span><span class="lit">0040852F</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; F6E6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">mul&nbsp;&nbsp;&nbsp;&nbsp; dh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; ax</span><span class="pun">=</span><span class="pln">al</span><span class="pun">*</span><span class="pln">dh 
　　</span><span class="lit">00408531</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">02E3</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">add&nbsp;&nbsp;&nbsp;&nbsp; ah</span><span class="pun">,</span><span class="pln"> bl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; ah</span><span class="pun">=</span><span class="pln">ah</span><span class="pun">+</span><span class="pln">bl 
　　</span><span class="lit">00408533</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8827</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">edi</span><span class="pun">],</span><span class="pln"> ah&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">写入背景</span><span class="pln"> 
　　</span><span class="lit">00408535</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">47</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">inc&nbsp;&nbsp;&nbsp;&nbsp; edi 
　　</span><span class="lit">00408536</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; AC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">lods&nbsp;&nbsp;&nbsp; </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">esi</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">读取</span><span class="lit">1</span><span class="pun">字节解压后的数据</span><span class="pln"> 
　　</span><span class="lit">00408537</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; F6E2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">mul&nbsp;&nbsp;&nbsp;&nbsp; dl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; ax</span><span class="pun">=</span><span class="pln">al</span><span class="pun">*</span><span class="pln">dl 
　　</span><span class="lit">00408539</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8ADC</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; bl</span><span class="pun">,</span><span class="pln"> ah&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; bl</span><span class="pun">=</span><span class="pln">ah 
　　</span><span class="lit">0040853B</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8A07</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; al</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">edi</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">读取背景</span><span class="pln"> 
　　</span><span class="lit">0040853D</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; F6E6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">mul&nbsp;&nbsp;&nbsp;&nbsp; dh&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; ax</span><span class="pun">=</span><span class="pln">al</span><span class="pun">*</span><span class="pln">dh 
　　</span><span class="lit">0040853F</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">02E3</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">add&nbsp;&nbsp;&nbsp;&nbsp; ah</span><span class="pun">,</span><span class="pln"> bl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; ah</span><span class="pun">=</span><span class="pln">ah</span><span class="pun">+</span><span class="pln">bl 
　　</span><span class="lit">00408541</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8827</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">edi</span><span class="pun">],</span><span class="pln"> ah&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">写入背景</span><span class="pln"> 
　　</span><span class="lit">00408543</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">47</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">inc&nbsp;&nbsp;&nbsp;&nbsp; edi 
　　</span><span class="lit">00408544</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">49</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">dec&nbsp;&nbsp;&nbsp;&nbsp; ecx 
　　</span><span class="lit">00408545</span><span class="pln">&nbsp; </span><span class="pun">|.^</span><span class="pln"> </span><span class="lit">75</span><span class="pln"> C4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">jnz&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">short</span><span class="pln"> </span><span class="lit">0040850B</span><span class="pln"> 
　　</span><span class="lit">00408547</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; EB </span><span class="lit">0E</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">jmp&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">short</span><span class="pln"> </span><span class="lit">00408557</span><span class="pln"> 
　　</span><span class="lit">00408549</span><span class="pln">&nbsp; </span><span class="pun">|&gt;</span><span class="pln">&nbsp; </span><span class="lit">66</span><span class="pun">:</span><span class="pln">A5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">movs&nbsp;&nbsp;&nbsp; word ptr es</span><span class="pun">:[</span><span class="pln">edi</span><span class="pun">],</span><span class="pln"> word ptr </span><span class="pun">[</span><span class="pln">esi</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">写入</span><span class="lit">2</span><span class="pun">字节（不透明）</span><span class="pln"> 
　　</span><span class="lit">0040854B</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; A4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">movs&nbsp;&nbsp;&nbsp; </span><span class="kwd">byte</span><span class="pln"> ptr es</span><span class="pun">:[</span><span class="pln">edi</span><span class="pun">],</span><span class="pln"> </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">esi</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">写入</span><span class="lit">1</span><span class="pun">字节</span><span class="pln"> 
　　</span><span class="lit">0040854C</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">49</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">dec&nbsp;&nbsp;&nbsp;&nbsp; ecx 
　　</span><span class="lit">0040854D</span><span class="pln">&nbsp; </span><span class="pun">|.^</span><span class="pln"> </span><span class="lit">75</span><span class="pln"> BC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">jnz&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">short</span><span class="pln"> </span><span class="lit">0040850B</span><span class="pln"> 
　　</span><span class="lit">0040854F</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; EB </span><span class="lit">06</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">jmp&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">short</span><span class="pln"> </span><span class="lit">00408557</span><span class="pln"> 
　　</span><span class="lit">00408551</span><span class="pln">&nbsp; </span><span class="pun">|&gt;</span><span class="pln">&nbsp; </span><span class="lit">83C7</span><span class="pln"> </span><span class="lit">03</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">add&nbsp;&nbsp;&nbsp;&nbsp; edi</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">不改变该像素（透明）</span><span class="pln"> 
　　</span><span class="lit">00408554</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">49</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">dec&nbsp;&nbsp;&nbsp;&nbsp; ecx 
　　</span><span class="lit">00408555</span><span class="pln">&nbsp; </span><span class="pun">|.^</span><span class="pln"> </span><span class="lit">75</span><span class="pln"> B4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">\jnz&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">short</span><span class="pln"> </span><span class="lit">0040850B</span><span class="pln"> 
　　</span><span class="lit">00408557</span><span class="pln">&nbsp; </span><span class="pun">|&gt;</span><span class="pln">&nbsp; </span><span class="lit">8B4D</span><span class="pln"> </span><span class="lit">18</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; ecx</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="pln">ebp</span><span class="pun">+</span><span class="lit">18</span><span class="pun">]</span><span class="pln"> 
　　</span><span class="lit">0040855A</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">0BC9</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="kwd">or</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ecx</span><span class="pun">,</span><span class="pln"> ecx 
　　</span><span class="lit">0040855C</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">74</span><span class="pln"> </span><span class="lit">0A</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">je&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">short</span><span class="pln"> </span><span class="lit">00408568</span><span class="pln"> 
　　</span><span class="lit">0040855E</span><span class="pln">&nbsp; </span><span class="pun">|&gt;</span><span class="pln">&nbsp; AC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|/</span><span class="pln">lods&nbsp;&nbsp;&nbsp; </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">esi</span><span class="pun">]</span><span class="pln"> 
　　</span><span class="lit">0040855F</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">0AC0</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="kwd">or</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; al</span><span class="pun">,</span><span class="pln"> al 
　　</span><span class="lit">00408561</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">74</span><span class="pln"> </span><span class="lit">03</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">je&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">short</span><span class="pln"> </span><span class="lit">00408566</span><span class="pln"> 
　　</span><span class="lit">00408563</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">83C6</span><span class="pln"> </span><span class="lit">03</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">add&nbsp;&nbsp;&nbsp;&nbsp; esi</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3</span><span class="pln"> 
　　</span><span class="lit">00408566</span><span class="pln">&nbsp; </span><span class="pun">|&gt;^</span><span class="pln"> E2 F6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">\loopd&nbsp;&nbsp; </span><span class="kwd">short</span><span class="pln"> </span><span class="lit">0040855E</span><span class="pln"> 
　　</span><span class="lit">00408568</span><span class="pln">&nbsp; </span><span class="pun">|&gt;</span><span class="pln">&nbsp; </span><span class="lit">037D</span><span class="pln"> </span><span class="lit">14</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">add&nbsp;&nbsp;&nbsp;&nbsp; edi</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="pln">ebp</span><span class="pun">+</span><span class="lit">14</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">指向下一个位置</span><span class="pln"> 
　　</span><span class="lit">0040856B</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">5B</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">pop&nbsp;&nbsp;&nbsp;&nbsp; ebx 
　　</span><span class="lit">0040856C</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">4B</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">dec&nbsp;&nbsp;&nbsp;&nbsp; ebx 
　　</span><span class="lit">0040856D</span><span class="pln">&nbsp; </span><span class="pun">|.^</span><span class="pln"> </span><span class="lit">75</span><span class="pln"> </span><span class="lit">87</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \jnz&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">short</span><span class="pln"> </span><span class="lit">004084F6</span></pre> <br>　　根据上面的分析，LCF文件中<i>0x08-0x09</i> <i>0x0A-0x0B</i>为立绘位置相关，由于汉化不必导入立绘，所以就不深入分析了。 <br>　　同时也能发现<i>0x10-0x13</i>为文件头大小，LCF中<i>0x14-0x17</i>为解压后的大小，于是LFF的总是0x14，LCF的总是0x18。 <br>　　写出将解压后的数据变成32位的BMP的代码，然后尝试对刚才从内存中保存的解压数据进行处理，结果无误，于是LCF文件应该就到这里了。 <br>　　<span class="highslide"><img src="assets/1570982535-3a73ae68bdc9813c22f20be412ddaca0.png" border="0" style="max-width: 100%;max-height: 800px;"></span>（左上角部分非程序出错，本身就有） <br>　　<span class="highslide"><img src="assets/1570982535-44c0d78732c13d969527dc3178eb2344.png" border="0" style="max-width: 100%;max-height: 800px;"></span> <br>　　 <br>　　 <br>　　去掉LCF相关断点，继续发现之前下的"%s.lfb"断点没用，于是换另外的，给"sakura.lfb"下断，重新启动后成功断下。 <br>　　跟踪后发现依然是LZSS，LFB文件头4字节为解压后的大小，跟之前一样先试着把解压的数据保存起来，发现解压后的数据包含了BMP的文件头，打开发现樱花形状正常，但是颜色却不对，继续跟踪也没发现对解压数据的处理，大概是显示的时候才做处理吧。 <br>　　用PS打开，发现蓝色通道大部分为0x00和0xFF，大概是交换通道了，蓝色通道应该是Alpha通道，尝试交换通道。 <br>　　<span class="highslide"><img src="assets/1570982535-969ca6ab40da8feaf8c3509070f394d5.png" border="0" style="max-width: 100%;max-height: 800px;"></span> <br>　　蓝色→Alpha，Alpha→红色，红色→绿色，绿色→蓝色，感觉差不多的样子。 <br>　　<span class="highslide"><img src="assets/1570982535-8c2b4dd6d4a80966668b97e80fca2b8e.png" border="0" style="max-width: 100%;max-height: 800px;"></span> <br>　　对比游戏里截出来的花瓣，取中间相同位置没有透明的颜色，发现一样，应该没有错了。（其实反过来先取花瓣的颜色来分析通道交换会比较快） <br>　　<span class="highslide"><img src="assets/1570982535-e539d9a43cf671b4a7943cc7a1d3c3d8.png" border="0" style="max-width: 100%;max-height: 800px;"></span> <br>　　于是写出程序，发现很有问题，很多图片的颜色不对，但是游戏后面没办法继续单步了（貌似不少地方都是单步着然后就没办法继续了，求解= =），不知道输出前是怎么于是处理的，于是用笨方法，先不交换通道输出直接观察，发现大致可以分为4类： <br>　　<span class="highslide"><img src="assets/1570982535-6471142dd4037b606d51441f3db810de.png" border="0" style="max-width: 100%;max-height: 800px;"></span> <br>　　16位的图像理论上应该是没有调色板的，但是却有调色板（占0x400字节），而且那些图应该会有Alpha通道，却用的是16位。8位的调色板、16位的标识、32位的图……囧，尝试转成32位。 <br>　　（数据是图片宽度×高度的两倍，可能①一个像素两个字节，一个字节引用调色板，另一个字节为Alpha通道；②一半为引用调色板，另一半为Alpha通道；③其他） <br>　　从调试结果来看，事实上就是第一种情况，前面一个字节为Alpha通道，后面一个字节引用调色板。 <br>　　另外biXPelsPerMeter biYPelsPerMeter不知道是如何设定的，未做导入测试，暂时未知置零有没有影响。 <br>　　写程序导出的时候把bhSize biSizeImage重新算了，因为有个的bhSize不对，很多biSizeImage都是0。 <br>　　没有发现新的问题，LFB文件结束，下面到LDT文件了。 <br>　　 <br>　　 <br>　　LDT文件只有一个ED.LDT，刚开始没发觉这个是图片文件，后来分析才补上这个的，从名字来看是ED相关的。ToHeartPSE的ED是由 CG+滚动Staff+音乐 组成的，从大小来看应该不是视频文件，于是猜测这个文件应该是Staff的图片，用类似立绘合成到背景的方法显示。 <br>　　搜索到的"ed.lfb"字符串在ED出现后能很顺利的断下，文件还是用LZSS压缩，结构跟LFB一样，前4字节是解后的大小。继续游戏，Staff滚动的时候在OllyDbg按<span style="font-family:宋体 ">暂停</span>，顺利地到了相关的函数： <br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code6'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code6" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="pun">　　</span><span class="lit">0040B6C9</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="lit">8BC8</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov ecx</span><span class="pun">,</span><span class="pln"> eax 
　　</span><span class="lit">0040B6CB</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="lit">83C4</span><span class="pln"> </span><span class="lit">08</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add esp</span><span class="pun">,</span><span class="pln"> </span><span class="lit">8</span><span class="pln"> 
　　</span><span class="lit">0040B6CE</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="lit">894D</span><span class="pln"> </span><span class="lit">08</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov dword ptr </span><span class="pun">[</span><span class="pln">ebp</span><span class="pun">+</span><span class="lit">8</span><span class="pun">],</span><span class="pln"> ecx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">解压后的数据开头地址。</span><span class="pln"> 
　　</span><span class="lit">0040B6D1</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="lit">8B41</span><span class="pln"> </span><span class="lit">08</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov eax</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="pln">ecx</span><span class="pun">+</span><span class="lit">8</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">解压后的数据</span><span class="lit">0x8</span><span class="pun">-</span><span class="lit">0xB</span><span class="pun">（应该是图片的高度）</span><span class="pln"> 
　　</span><span class="lit">0040B6D4</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="lit">8D51</span><span class="pln"> </span><span class="lit">10</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lea edx</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="pln">ecx</span><span class="pun">+</span><span class="lit">10</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">指向解压后的数据第</span><span class="lit">17</span><span class="pun">字节</span><span class="pln"> 
　　</span><span class="lit">0040B6D7</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="lit">2D</span><span class="pln"> E0010000&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">sub</span><span class="pln"> eax</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1E0</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">减去</span><span class="lit">0x1E0</span><span class="pln"> 
　　</span><span class="lit">0040B6DC</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="lit">8955</span><span class="pln"> </span><span class="lit">0C</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov dword ptr </span><span class="pun">[</span><span class="pln">ebp</span><span class="pun">+</span><span class="pln">C</span><span class="pun">],</span><span class="pln"> edx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">保存地址</span><span class="pln"> 
　　</span><span class="lit">0040B6DF</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="lit">0FAFC7</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; imul eax</span><span class="pun">,</span><span class="pln"> edi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">定位相关</span><span class="pln"> 
　　</span><span class="lit">0040B6E2</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="lit">33D2</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xor edx</span><span class="pun">,</span><span class="pln"> edx 
　　</span><span class="lit">0040B6E4</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> F7F3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; div ebx 
　　</span><span class="lit">0040B6E6</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="lit">8B59</span><span class="pln"> </span><span class="lit">04</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov ebx</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="pln">ecx</span><span class="pun">+</span><span class="lit">4</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">解压后的数据</span><span class="lit">0x5</span><span class="pun">-</span><span class="lit">0x7</span><span class="pun">（应该是图片的宽度）</span><span class="pln"> 
　　</span><span class="lit">0040B6E9</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="lit">8D84C1</span><span class="pln"> </span><span class="lit">100400</span><span class="pun">&gt;</span><span class="pln">&nbsp; lea eax</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="pln">ecx</span><span class="pun">+</span><span class="pln">eax</span><span class="pun">*</span><span class="lit">8</span><span class="pun">+</span><span class="lit">410</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">定位。</span><span class="lit">0x410</span><span class="pun">应该是</span><span class="lit">0x10</span><span class="pun">字节的文件头和</span><span class="lit">0x400</span><span class="pun">字节的“调色板”（不确定）。</span><span class="pln"> 
　　</span><span class="lit">0040B6F0</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="lit">8945</span><span class="pln"> FC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov dword ptr </span><span class="pun">[</span><span class="pln">ebp</span><span class="pun">-</span><span class="lit">4</span><span class="pun">],</span><span class="pln"> eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">保存地址，下面定位略。</span><span class="pln"> 
　　</span><span class="lit">0040B6F3</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> B8 </span><span class="lit">80020000</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp; mov eax</span><span class="pun">,</span><span class="pln"> </span><span class="lit">280</span><span class="pln"> 
　　</span><span class="lit">0040B6F8</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="lit">2BC3</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">sub</span><span class="pln"> eax</span><span class="pun">,</span><span class="pln"> ebx 
　　</span><span class="lit">0040B6FA</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="lit">99</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cdq 
　　</span><span class="lit">0040B6FB</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="lit">2BC2</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">sub</span><span class="pln"> eax</span><span class="pun">,</span><span class="pln"> edx 
　　</span><span class="lit">0040B6FD</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> D1F8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sar eax</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> 
　　</span><span class="lit">0040B6FF</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="lit">05</span><span class="pln"> </span><span class="lit">80AD0400</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp; add eax</span><span class="pun">,</span><span class="pln"> </span><span class="lit">4AD80</span><span class="pln"> 
　　</span><span class="lit">0040B704</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="lit">8D0C46</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lea ecx</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="pln">esi</span><span class="pun">+</span><span class="pln">eax</span><span class="pun">*</span><span class="lit">2</span><span class="pun">]</span><span class="pln"> 
　　</span><span class="lit">0040B707</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="lit">03C1</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add eax</span><span class="pun">,</span><span class="pln"> ecx 
　　</span><span class="lit">0040B709</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="lit">8945</span><span class="pln"> F8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov dword ptr </span><span class="pun">[</span><span class="pln">ebp</span><span class="pun">-</span><span class="lit">8</span><span class="pun">],</span><span class="pln"> eax 
　　</span><span class="lit">0040B70C</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="lit">9C</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pushfd 
　　</span><span class="lit">0040B70D</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="lit">60</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pushad 
　　</span><span class="lit">0040B70E</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> FC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cld 
　　</span><span class="lit">0040B70F</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="lit">8B7D</span><span class="pln"> F8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov edi</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="pln">ebp</span><span class="pun">-</span><span class="lit">8</span><span class="pun">]</span><span class="pln"> 
　　</span><span class="lit">0040B712</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="lit">8B5D</span><span class="pln"> FC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov ebx</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="pln">ebp</span><span class="pun">-</span><span class="lit">4</span><span class="pun">]</span><span class="pln"> 
　　</span><span class="lit">0040B715</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> B9 E0010000&nbsp;&nbsp;&nbsp;&nbsp; mov ecx</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1E0</span><span class="pln"> 
　　</span><span class="lit">0040B71A</span><span class="pln"> </span><span class="pun">|&gt;</span><span class="pln"> </span><span class="pun">/</span><span class="lit">53</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">/</span><span class="pln">push ebx </span><span class="pun">;</span><span class="pln"> </span><span class="pun">这部分才是合成。</span><span class="pln"> 
　　</span><span class="lit">0040B71B</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">8B55</span><span class="pln"> </span><span class="lit">08</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">mov edx</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="pln">ebp</span><span class="pun">+</span><span class="lit">8</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> edx</span><span class="pun">为解压后的数据位置</span><span class="lit">1</span><span class="pun">。（开头）</span><span class="pln"> 
　　</span><span class="lit">0040B71E</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">8B03</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">mov eax</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="pln">ebx</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">读取</span><span class="pln">ebx4</span><span class="pun">字节解压后的数据（</span><span class="typ">Offset</span><span class="pun">）。</span><span class="pln">ebx</span><span class="pun">为解压后的数据位置</span><span class="lit">2</span><span class="pun">。（初始位置</span><span class="lit">0x410</span><span class="pun">）</span><span class="pln"> 
　　</span><span class="lit">0040B720</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">0BC0</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="kwd">or</span><span class="pln"> eax</span><span class="pun">,</span><span class="pln"> eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">检查是否为</span><span class="lit">0</span><span class="pln"> 
　　</span><span class="lit">0040B722</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">74</span><span class="pln"> </span><span class="lit">72</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">je </span><span class="kwd">short</span><span class="pln"> </span><span class="lit">0040B796</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">则跳转（</span><span class="typ">Offset</span><span class="pun">为</span><span class="lit">0</span><span class="pun">时表示当前行为空，继续下一行，</span><span class="typ">Offset</span><span class="pun">后面接</span><span class="lit">2</span><span class="pun">个</span><span class="pln">WORD</span><span class="pun">，第一个为当前行离边缘的</span><span class="typ">Left</span><span class="pun">，第二个为当前行有颜色的像素数</span><span class="typ">Width</span><span class="pun">。）</span><span class="pln"> 
　　</span><span class="lit">0040B724</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">51</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">push ecx 
　　</span><span class="lit">0040B725</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">57</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">push edi 
　　</span><span class="lit">0040B726</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">03D0</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">add edx</span><span class="pun">,</span><span class="pln"> eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">设置位置</span><span class="pln"> 
　　</span><span class="lit">0040B728</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">0FB743</span><span class="pln"> </span><span class="lit">04</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">movzx eax</span><span class="pun">,</span><span class="pln"> word ptr </span><span class="pun">[</span><span class="pln">ebx</span><span class="pun">+</span><span class="lit">4</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">读取</span><span class="pln">ebx2</span><span class="pun">字节解压后的数据。</span><span class="pln"> 
　　</span><span class="lit">0040B72C</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">03F8</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">add edi</span><span class="pun">,</span><span class="pln"> eax 
　　</span><span class="lit">0040B72E</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">03F8</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">add edi</span><span class="pun">,</span><span class="pln"> eax 
　　</span><span class="lit">0040B730</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">03F8</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">add edi</span><span class="pun">,</span><span class="pln"> eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">设置位置（</span><span class="pln">eax</span><span class="pun">为与边界的像素距离？）</span><span class="pln"> 
　　</span><span class="lit">0040B732</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">0FB74B</span><span class="pln"> </span><span class="lit">06</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">movzx ecx</span><span class="pun">,</span><span class="pln"> word ptr </span><span class="pun">[</span><span class="pln">ebx</span><span class="pun">+</span><span class="lit">6</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">读取</span><span class="pln">ebx2</span><span class="pun">字节解压后的数据。</span><span class="pln"> 
　　</span><span class="lit">0040B736</span><span class="pln"> </span><span class="pun">|&gt;</span><span class="pln"> </span><span class="pun">|</span><span class="lit">0FB71A</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|/</span><span class="pln">movzx ebx</span><span class="pun">,</span><span class="pln"> word ptr </span><span class="pun">[</span><span class="pln">edx</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">读取</span><span class="pln">edx2</span><span class="pun">字节解压后的数据。</span><span class="pln"> 
　　</span><span class="lit">0040B739</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">83C2</span><span class="pln"> </span><span class="lit">02</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">add edx</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">移动指针。</span><span class="pln"> 
　　</span><span class="lit">0040B73C</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">66</span><span class="pun">:</span><span class="lit">0BDB</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="kwd">or</span><span class="pln"> bx</span><span class="pun">,</span><span class="pln"> bx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">检测是否为</span><span class="lit">0</span><span class="pln"> 
　　</span><span class="lit">0040B73F</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">75</span><span class="pln"> </span><span class="lit">08</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">jnz </span><span class="kwd">short</span><span class="pln"> </span><span class="lit">0040B749</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">否则跳转</span><span class="pln"> 
　　</span><span class="lit">0040B741</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">83C7</span><span class="pln"> </span><span class="lit">03</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">add edi</span><span class="pun">,</span><span class="pln"> </span><span class="lit">3</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">保持当前像素</span><span class="pln"> 
　　</span><span class="lit">0040B744</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">49</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">dec ecx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">当前行剩余像素</span><span class="pln"> 
　　</span><span class="lit">0040B745</span><span class="pln"> </span><span class="pun">|.^|</span><span class="lit">75</span><span class="pln"> EF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">jnz </span><span class="kwd">short</span><span class="pln"> </span><span class="lit">0040B736</span><span class="pln"> 
　　</span><span class="lit">0040B747</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="pln">EB </span><span class="lit">4B</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">jmp </span><span class="kwd">short</span><span class="pln"> </span><span class="lit">0040B794</span><span class="pln"> 
　　</span><span class="lit">0040B749</span><span class="pln"> </span><span class="pun">|&gt;</span><span class="pln"> </span><span class="pun">|</span><span class="lit">52</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">push edx 
　　</span><span class="lit">0040B74A</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">0FB6D3</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">movzx edx</span><span class="pun">,</span><span class="pln"> bl 
　　</span><span class="lit">0040B74D</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="pln">F6D2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="kwd">not</span><span class="pln"> dl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">取反</span><span class="pln"> 
　　</span><span class="lit">0040B74F</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">0FB6C7</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">movzx eax</span><span class="pun">,</span><span class="pln"> bh 
　　</span><span class="lit">0040B752</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="pln">C1E0 </span><span class="lit">02</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">shl eax</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">逻辑左移</span><span class="lit">2</span><span class="pun">位</span><span class="pln"> 
　　</span><span class="lit">0040B755</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">8B75</span><span class="pln"> </span><span class="lit">0C</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">mov esi</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="pln">ebp</span><span class="pun">+</span><span class="pln">C</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">[</span><span class="pln">ebp</span><span class="pun">+</span><span class="pln">C</span><span class="pun">]为为解压后的数据第</span><span class="lit">17</span><span class="pun">字节的地址。</span><span class="pln"> 
　　</span><span class="lit">0040B758</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">03F0</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">add esi</span><span class="pun">,</span><span class="pln"> eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> eax</span><span class="pun">相应的调色板地址。</span><span class="pln"> 
　　</span><span class="lit">0040B75A</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">8A3E</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">mov bh</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">esi</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">获取</span><span class="typ">Blue</span><span class="pln"> 
　　</span><span class="lit">0040B75C</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">46</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">inc esi 
　　</span><span class="lit">0040B75D</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">8A83</span><span class="pln"> A0604900&nbsp; </span><span class="pun">||</span><span class="pln">mov al</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">ebx</span><span class="pun">+</span><span class="lit">4960A0</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">读取（未知表）内的数据</span><span class="pln"> 
　　</span><span class="lit">0040B763</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">8A37</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">mov dh</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">edi</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">读取</span><span class="pln">CG</span><span class="pun">当前像素的</span><span class="typ">Blue</span><span class="pln"> 
　　</span><span class="lit">0040B765</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">0282</span><span class="pln"> A0604900&nbsp; </span><span class="pun">||</span><span class="pln">add al</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">edx</span><span class="pun">+</span><span class="lit">4960A0</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">读取（未知表）内的数据，并合成</span><span class="pln"> 
　　</span><span class="lit">0040B76B</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="pln">AA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">stos </span><span class="kwd">byte</span><span class="pln"> ptr es</span><span class="pun">:[</span><span class="pln">edi</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">写入</span><span class="lit">1</span><span class="pun">字节</span><span class="pln"> 
　　</span><span class="lit">0040B76C</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">8A3E</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">mov bh</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">esi</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">获取</span><span class="typ">Green</span><span class="pln"> 
　　</span><span class="lit">0040B76E</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">46</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">inc esi 
　　</span><span class="lit">0040B76F</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">8A83</span><span class="pln"> A0604900&nbsp; </span><span class="pun">||</span><span class="pln">mov al</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">ebx</span><span class="pun">+</span><span class="lit">4960A0</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">读取（未知表）内的数据</span><span class="pln"> 
　　</span><span class="lit">0040B775</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">8A37</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">mov dh</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">edi</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">读取</span><span class="pln">CG</span><span class="pun">当前像素的</span><span class="typ">Green</span><span class="pln"> 
　　</span><span class="lit">0040B777</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">0282</span><span class="pln"> A0604900&nbsp; </span><span class="pun">||</span><span class="pln">add al</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">edx</span><span class="pun">+</span><span class="lit">4960A0</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">读取（未知表）内的数据，并合成</span><span class="pln"> 
　　</span><span class="lit">0040B77D</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="pln">AA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">stos </span><span class="kwd">byte</span><span class="pln"> ptr es</span><span class="pun">:[</span><span class="pln">edi</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">写入</span><span class="lit">1</span><span class="pun">字节</span><span class="pln"> 
　　</span><span class="lit">0040B77E</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">8A3E</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">mov bh</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">esi</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">获取</span><span class="typ">Red</span><span class="pln"> 
　　</span><span class="lit">0040B780</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">46</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">inc esi 
　　</span><span class="lit">0040B781</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">8A83</span><span class="pln"> A0604900&nbsp; </span><span class="pun">||</span><span class="pln">mov al</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">ebx</span><span class="pun">+</span><span class="lit">4960A0</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">读取（未知表）内的数据</span><span class="pln"> 
　　</span><span class="lit">0040B787</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">8A37</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">mov dh</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">edi</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">读取</span><span class="pln">CG</span><span class="pun">当前像素的</span><span class="typ">Red</span><span class="pln"> 
　　</span><span class="lit">0040B789</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">0282</span><span class="pln"> A0604900&nbsp; </span><span class="pun">||</span><span class="pln">add al</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">edx</span><span class="pun">+</span><span class="lit">4960A0</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">读取（未知表）内的数据，并合成</span><span class="pln"> 
　　</span><span class="lit">0040B78F</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="pln">AA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">stos </span><span class="kwd">byte</span><span class="pln"> ptr es</span><span class="pun">:[</span><span class="pln">edi</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">写入</span><span class="lit">1</span><span class="pun">字节</span><span class="pln"> 
　　</span><span class="lit">0040B790</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">5A</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">pop edx 
　　</span><span class="lit">0040B791</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">49</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln">dec ecx 
　　</span><span class="lit">0040B792</span><span class="pln"> </span><span class="pun">|.^|</span><span class="lit">75</span><span class="pln"> A2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">\jnz </span><span class="kwd">short</span><span class="pln"> </span><span class="lit">0040B736</span><span class="pln"> 
　　</span><span class="lit">0040B794</span><span class="pln"> </span><span class="pun">|&gt;</span><span class="pln"> </span><span class="pun">|</span><span class="lit">5F</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">pop edi 
　　</span><span class="lit">0040B795</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">59</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">pop ecx 
　　</span><span class="lit">0040B796</span><span class="pln"> </span><span class="pun">|&gt;</span><span class="pln"> </span><span class="pun">|</span><span class="lit">5B</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">pop ebx 
　　</span><span class="lit">0040B797</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">81EF</span><span class="pln"> </span><span class="lit">80070000</span><span class="pln">&nbsp; </span><span class="pun">|</span><span class="kwd">sub</span><span class="pln"> edi</span><span class="pun">,</span><span class="pln"> </span><span class="lit">780</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">当前行完毕，到下一行。</span><span class="pln"> 
　　</span><span class="lit">0040B79D</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">83C3</span><span class="pln"> </span><span class="lit">08</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">add ebx</span><span class="pun">,</span><span class="pln"> </span><span class="lit">8</span><span class="pln"> 
　　</span><span class="lit">0040B7A0</span><span class="pln"> </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">49</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">dec ecx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">高（列）计数。</span><span class="pln"> 
　　</span><span class="lit">0040B7A1</span><span class="pln"> </span><span class="pun">|.^</span><span class="pln">\0F85 </span><span class="lit">73FFFFFF</span><span class="pln">&nbsp; \jnz </span><span class="lit">0040B71A</span></pre> <br>　　未知表可以这样找到生成方法 <br>　　<span class="highslide"><img src="assets/1570982535-49a38654809d36a86b5b30db1e957134.png" border="0" style="max-width: 100%;max-height: 800px;"></span> 　　<span class="highslide"><img src="assets/1570982535-46925ebb74f4aff11885090b1ce8c126.png" border="0" style="max-width: 100%;max-height: 800px;"></span> <br>　　<span class="highslide"><img src="assets/1570982535-b260a9bcc42382cc2654e59177d2d92a.png" border="0" style="max-width: 100%;max-height: 800px;"></span>&nbsp; <br>　　按照这个写出程序，先不管未知表，尝试用猜测的“调色板”输出。从结果来看没有问题，于是未知表就可以扔一边不管了。 <br>　　 <br>至此，全部图片已经转化成常见的BMP格式，稍微有些疑问的是那些Alpha通道貌似都反了，需要小小的处理，另外BMP文件大小好像要补成4的倍数（我偷懒没补）[拖...]。 </span><div id="alert_2537600" style="color: gray; margin-top: 30px; --darkreader-inline-color:#bfb9ac;" data-darkreader-inline-color="">[ 此帖被夏の幻在2009-09-19 05:27重新编辑 ]</div></div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_2537600" class="c"></div>

		<div><img class="signature" src="assets/1570982535-f23b8ffd0b6b327441aa828c9cd3243d.gif" align="absbottom"></div>
		<div class="signature" style="max-height:380px;maxHeight:380px; overflow:hidden;"><table width="100%"><tbody><tr><td><div align="center"><a href="https://aquaplus.jp/uta/chiri/" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><span class="highslide"><img src="assets/1570982535-b2941f47c7cd8e06555d1301f173a932.jpg" border="0" style="max-width: 100%;max-height: 900px;"></span></a><br></div></td><td></td></tr></tbody></table></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2009-09-10 11:04 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 1楼(夏の幻) 的帖子');" data-mx-warn="Empty URL">1 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="2537606" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570982535-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>夏の幻</b>
<div style="margin:.3em 0 .4em .2em">もう、冬は、ホワイトアルバムの季節じゃない。</div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=131798" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570982535-3e80c861881e4c453757e04fdb5f5b6e.png" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_2"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">学生会副会长</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570982535-35aa8c414aad91387ad565c549e6cd0f.gif"><br>

<span class="user-info2" id="showface_2">
<span class="user-infoWrap2">


精华:

		<a href="https://bbs.sumisora.net/search.php?authorid=131798&amp;digest=1" target="_blank" class="s4 f9" referrerpolicy="no-referrer" rel="noopener noreferrer">1</a>
<br>
发帖: <span class="s1 f9">1818</span><br>
学分: <span class="s2 f9">218 点</span><br>
澄空币: <span class="s3 f9">0 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2007-06-26<br>
		最后登录:2019-08-13 <br><br> 
		<img src="assets/1570982535-196b2da3a42134dc3b0b212d7ed677c2.gif" title="Leaf学部勋章"> <br></span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_2537606" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10930627&amp;pid=2537606&amp;article=2" onclick="return sendurl(this,4,event)" id="quote_2537606" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10930627&amp;pid=2537606&amp;article=2" id="modify_2537606" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=131798" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10930627&amp;pid=2537606" onclick="return sendurl(this,8)" id="report_2537606" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10930627&amp;uid=131798" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('2537606')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_2537606" class="fl">&nbsp;</h1>
			

			<div id="p_2537606" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_2537606"><span style="font-family:宋体 "><b>三、字库</b> <br>以下内容口胡倾向严重，跳过吧～（拖） <br>字库其实也可以算是图片（？）吧，不过字库有其特殊性，于是单独来说。 <br>ToHeartPSE的字库文件有两个： <br>　　FONTEX08.FD0(861,872 字节) <br>　　FONTEX24.FD0(5,183,352 字节) <br>懒得看代码，于是直接用WinHEX打开，能看见大量的00，应该没有再压缩了。 <br>&lt;-懒人 <br>最简单的字库的话貌似可以用1位来记录一个像素，稍微复杂些的用一个或多个字节来记录一个像素的灰度、透明度之类的。 <br>而一个字大小一般有：宽高相等且固定、宽高不等但固定、宽高不等且不固定…… <br>从数据来看，大量的00意味着是用一个或多个字节来记录的，先尝试方形的： <br><span class="highslide"><img src="assets/1570982535-95ee900c04545cd6761e092766ca94d9.png" border="0" style="max-width: 100%;max-height: 800px;"></span>（FONTEX24.FD0，24×24，空白部分的0x00用白色填充，方便区别边缘） <br>啥也看不出来，考虑到有用到边缘效果，慢慢地加宽高，于是有： <br><span class="highslide"><img src="assets/1570982535-026c90d7c9c30ca2be2969170c93522d.png" border="0" style="max-width: 100%;max-height: 800px;"></span>（FONTEX24.FD0，27×27） <br>貌似比较像样了，继续读后面的字符没有发现问题： <br><span class="highslide"><img src="assets/1570982535-cb6062a3e9e54d349f472d4b03988c1e.png" border="0" style="max-width: 100%;max-height: 800px;"></span> <br>同理得到FONTEX08.FD0的字大小为11×11： <br><span class="highslide"><img src="assets/1570982535-6bf82bfd2c4fc172e3e4bbd3393c0025.png" border="0" style="max-width: 100%;max-height: 800px;"></span> <br>但是两个FD0文件大小都不能被一个字的大小整除，后面大概还有什么。 <br>查看后发现第7023个字后都是看不出字形的，改变宽度后发现后面是半角字符，于是有： <br>　　　　　全角字符　　　半角字符　　 字节数 <br>　　　　7023×11×11＋157× 7×11＝ 861872 <br>　　　　7023×27×27＋157×15×27＝5183352 <br>满足文件大小。 <br>接下来跟游戏的比较，除了中间的白色部分外，其余部分或多或少地都有些不同： <br><span class="highslide"><img src="assets/1570982535-bae38ddc5c3b2c25a685083ee7cedd4c.png" border="0" style="max-width: 100%;max-height: 800px;"></span> <br>取游戏标题“め”中的点跟文件里的对比： <br>文件 游戏 背景 <br>FF &lt;-&gt; FF FF FF XX XX XX <br>EF &lt;-&gt; EE EE EE XX XX XX <br>BF &lt;-&gt; BB BB BB XX XX XX <br>0F &lt;-&gt; 00 00 00 XX XX XX <br>0E &lt;-&gt; 10 0F 10 F4 EA F1 <br>0D &lt;-&gt; 18 1B 1C B7 D0 D3 <br>05 &lt;-&gt; A2 9A 9E F5 E8 EF <br>发现文件里大多都是0xXF，统计结果也说明了这一点： <br><span class="highslide"><img src="assets/1570982535-6365eeeceeecad48211fee7a0ad23b79.png" border="0" style="max-width: 100%;max-height: 800px;"></span> <span class="highslide"><img src="assets/1570982535-7943c216f161892986391fb900d979cc.png" border="0" style="max-width: 100%;max-height: 800px;"></span> <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; （FONTEX24.FD0）&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; （FONTEX08.FD0，0xD比0xF多，但总体还是0xXF多） <br>突然想到低4位的数值是不是跟透明度有关，通过一些计算后发现： <br>XF -&gt; XX 如：<span style="color: rgb(255, 0, 0); --darkreader-inline-color:#e63f3c;" data-darkreader-inline-color="">B</span>F &lt;-&gt; BB BB BB <br>XY -&gt; （F－Y）×11×（背景）的高8位 如： <br>0E &lt;-&gt; 10 0F 10 F4 EA F1 <br>1×11×F4＝<span style="color: rgb(255, 0, 0); --darkreader-inline-color:#e63f3c;" data-darkreader-inline-color="">10</span>34 <br>1×11×EA＝<span style="color: rgb(255, 0, 0); --darkreader-inline-color:#e63f3c;" data-darkreader-inline-color="">0F</span>8A <br>1×11×F1＝<span style="color: rgb(255, 0, 0); --darkreader-inline-color:#e63f3c;" data-darkreader-inline-color="">10</span>01 <br>&lt;-不要问我为什么，纯粹突发奇想（棍） <br>于是推测有： <br>字库中XY <br>X×Y×11＋（F－Y）×11×（背景）＝游戏显示（Y≠F） <br>字库中XF <br>XX＝游戏显示 <br>00为完全透明部分。 <br>不过这个结论并不完全，在游戏里面却完全不一样，比如： <br>0E &lt;-&gt; 48 59 5A 88 A8 AB <br>虽然不满足上面的推测，不过也有： <br>88×88＝<span style="color: rgb(255, 0, 0); --darkreader-inline-color:#e63f3c;" data-darkreader-inline-color="">48</span>40 <br>88×A8＝<span style="color: rgb(255, 0, 0); --darkreader-inline-color:#e63f3c;" data-darkreader-inline-color="">59</span>40 <br>88×AB＝<span style="color: rgb(255, 0, 0); --darkreader-inline-color:#e63f3c;" data-darkreader-inline-color="">5A</span>D8 <br>应该是游戏在某个地方做了处理吧，这个就不用管了，我们只要制作出合理的字库让游戏能识别出来就够了。（当然制作出来的字库可能表面上没有问题，却藏有隐患，所以有精力的童鞋最好是看程序吧。） <br>在ToHeartPSE中没有发现另外的码表文件，估计是在程序里判断的，于是留到程序部分再说。 <br>重复一遍，以上内容口胡倾向严重，跳过吧～啥，看完了……那忘记吧～（拖很远） <br>&lt;-顺带一提，做出来的字库很糟糕，因为是用于测试的所以就将就用了（= =其实是不会跟踪字库部分，求教学） </span><br><span style="font-family:宋体 ">&nbsp;<br><b>四、脚本</b> <br>脚本可以说是汉化中比较重要的一部分，一般都是经过编译的二进制脚本文件，也有少部分是直接用纯文本作为脚本。 <br>一般脚本里面的文本会使用Shift-JIS编码，但是如果是游戏自带字库的话也不排除会使用自定义的编码来储存。 <br><h6 class="quote">Quote:</h6><blockquote class="blockquote">以下字符在Shift-JIS使用一个字节来表示。 <br>ASCII字符 (0x20-0x7E)，但“\”被“￥”取代 <br>ASCII控制字符（0x00-0x1F、0x7F） <br>JIS X 0201标准内的半角标点及片假名（0xA1-0xDF） <br>在部分操作系统中，0xA0用来放置“不换行空格”。 <br>以下字符在Shift-JIS使用两个字节来表示。 <br>JIS X 0208字集的所有字符 <br>“第一位字节”使用0x81-0x9F、0xE0-0xEF（共47个） <br>“第二位字节”使用0x40-0x7E、0x80-0xFC（共188个） <br>使用者定义区 <br>“第一位字节”使用0xF0-0xFC（共13个） <br>“第二位字节”使用0x40-0x7E、0x80-0xFC（共188个） <br>在Shift-JIS编码表中，并未使用0xFD、0xFE及0xFF。 <br>在微软及IBM的日语电脑系统中，在0xFA、0xFB及0xFC的两字节区域，加入了388个JIS X 0208没有收录的符号和汉字。 <br></blockquote> <br>用APP打开WinHEX然后再打开一个脚本文件看看（貌似可以不用APP的，不过我这里好像不行= =）： <br><span class="highslide"><img src="assets/1570982535-29d53091b91ea9f5ae8c574a741fa40b.png" border="0" style="max-width: 100%;max-height: 800px;"></span> <br>开头2字节的02 00貌似是固定的，文本嵌入在脚本里面，中间虽然看起来有一些日文，但是意义不明，观察左边的字节部分，发现高位跟低位貌似交换了，选中疑似文本的区域，CTRL+T，然后选16-bit byte swap，OK： <br><span class="highslide"><img src="assets/1570982535-da036cad3d148d65666825679fe80a5f.png" border="0" style="max-width: 100%;max-height: 800px;"></span> <br><span class="highslide"><img src="assets/1570982535-8473c99157af770e99912fff69e08f57.png" border="0" style="max-width: 100%;max-height: 800px;"></span> <br>很好，明文出来了，先根据这个把大部分文本导出来，方便查找游戏中对应的文本，然后开始对着游戏初步分析脚本文件。 <br><span class="highslide"><img src="assets/1570982535-dc0394f00fd84497fb0ed7388196e45a.png" border="0" style="max-width: 100%;max-height: 800px;"></span> <br>【ピピピピ、ピピピピ、ピピピピ…。】为游戏开始第一句话，从效果来看， <br>F0 03 01 00 00 00 14 00应该是延迟的指令，假设为\tX（X为延迟时间，可能存在）。 <br>EA 03 00 00 E8 03 00 00这两个应该一个是\k（等待按键），另一个是\n（换行）。 <br>【　布団の中から手を伸ばし、目覚まし時計のスイッチをオフにする。】后面是EC 03 00 00应该是\p（翻页，同时也有等待按键的功能）。 <br>于是输出的文本就可以类似这样： <br>【　ピピピピ、\tピピピピ、\tピピピピ…。\k\n　カチッ。\k\n　布団の中から手を伸ばし、目覚まし時計のスイッチをオフにする。\p】 <br>当然这些符号都是自己定的，定这些符号的同时也要留意原来的文本中是否含有类似的控制符，以免造成混乱。 <br>另外ToHeartPSE能自定主角的名字，所以也要留意定义些名字的转义符，还有“·”“—”、音符等在编码转过来的时候会变成“?”，最好也是定义些转义符，或临时的。 <br>&lt;-突然发现之前没有考虑到名字，控制符也没（懒）分析完全，于是把没有控制符的文本给别人了，于是就有“「ちゃん」”这样的……虽然说的是无意开坑，不过还是很囧啊，抱头&gt;_&lt; <br>接下来建议是跟踪程序，毕竟脚本文件相对其他来说会比较严格，错一个字节都有可能跳出游戏。用已知的信息（如搜索常量3EA）来找到解析脚本的大致位置： <br><span class="highslide"><img src="assets/1570982535-c36f4fdb2fd3c6e84859e629b09bbe9d.png" border="0" style="max-width: 100%;max-height: 800px;"></span> <br>由于过程比较繁琐，这里就不写出来了，下面是初步分析后的一些结论和推测： <br>游戏每次读取一个WORD来判断，所以文字是被当作数字所以才会高低逆位，大于0x8000则作为文字输出。（不完全准确） <br>推测没有单字节字符（一般游戏里的半角字符都是作为控制符的，控制语音、背景、换行等等，遇到英文则用全角英文表示）。 <br>.DAT文件结构（以0A3A.DAT为例，文字部分处理了方便查看）： <br><span class="highslide"><img src="assets/1570982535-ee59d066a28d162e90d1e0b6bed27cad.png" border="0" style="max-width: 100%;max-height: 800px;"></span> <br>把6个颜色的区域分别叫A、B、C1、C2、D、E（不知道怎么取名= =），下面说到的“个数”为2字节。 <br>从程序中看，A、B是一定会有的，A为C的占用个数（至少为2，所以C1和C2也是必有的）；B为D、E占用的个数。 <br>C1不明，统计结果都为0；C2为D占用的个数，这部分如果有文字的话不直接出现在游戏中，估计是标识啥的。C3和之后的跟选择支及地图选项有关。 <br>&lt;-看代码和对着游戏分析得泪流满面的，貌似到现在都还没弄好一半，脱力……继续放着先…… <br></span><div id="alert_2537606" style="color: gray; margin-top: 30px; --darkreader-inline-color:#bfb9ac;" data-darkreader-inline-color="">[ 此帖被夏の幻在2009-09-10 11:44重新编辑 ]</div></div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_2537606" class="c"></div>

		<div><img class="signature" src="assets/1570982535-f23b8ffd0b6b327441aa828c9cd3243d.gif" align="absbottom"></div>
		<div class="signature" style="max-height:380px;maxHeight:380px; overflow:hidden;"><table width="100%"><tbody><tr><td><div align="center"><a href="https://aquaplus.jp/uta/chiri/" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><span class="highslide"><img src="assets/1570982535-b2941f47c7cd8e06555d1301f173a932.jpg" border="0" style="max-width: 100%;max-height: 900px;"></span></a><br></div></td><td></td></tr></tbody></table></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2009-09-10 11:06 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 2楼(夏の幻) 的帖子');" data-mx-warn="Empty URL">2 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="2537608" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570982535-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>夏の幻</b>
<div style="margin:.3em 0 .4em .2em">もう、冬は、ホワイトアルバムの季節じゃない。</div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=131798" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570982535-3e80c861881e4c453757e04fdb5f5b6e.png" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_3"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">学生会副会长</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570982535-35aa8c414aad91387ad565c549e6cd0f.gif"><br>

<span class="user-info2" id="showface_3">
<span class="user-infoWrap2">


精华:

		<a href="https://bbs.sumisora.net/search.php?authorid=131798&amp;digest=1" target="_blank" class="s4 f9" referrerpolicy="no-referrer" rel="noopener noreferrer">1</a>
<br>
发帖: <span class="s1 f9">1818</span><br>
学分: <span class="s2 f9">218 点</span><br>
澄空币: <span class="s3 f9">0 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2007-06-26<br>
		最后登录:2019-08-13 <br><br> 
		<img src="assets/1570982535-196b2da3a42134dc3b0b212d7ed677c2.gif" title="Leaf学部勋章"> <br></span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_2537608" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10930627&amp;pid=2537608&amp;article=3" onclick="return sendurl(this,4,event)" id="quote_2537608" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10930627&amp;pid=2537608&amp;article=3" id="modify_2537608" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=131798" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10930627&amp;pid=2537608" onclick="return sendurl(this,8)" id="report_2537608" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10930627&amp;uid=131798" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('2537608')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_2537608" class="fl">&nbsp;</h1>
			

			<div id="p_2537608" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_2537608"><span style="font-family:宋体 "><b>五、程序</b> <br>程序的话主要的是修改字符集，窗口界面汉化，中日共存，补丁形式等。 <br>先说补丁形式好了，现在的游戏基本上都会有升级系统，升级系统就是读取的时候先读升级文件里的，如果没有再读原游戏的文件。 <br>有升级系统的做补丁很方便，只要将修改了的文件打包，然后改成升级补丁的名字即可。 <br>如果要中日共存的话也很容易，把程序里升级文件的字符串改掉就可以了（比如ToHeart2、帕露菲和青空等就是改成了ck-gal）。 <br>（另：中日共存的话可能会产生存档不兼容的情况。） <br>没有升级系统会比较麻烦，因为封包的时候要将其他没有修改的文件也塞进去，这样就会或多或少地增大体积了。如果体积可以接受的话就正常地发布，如果很大就用<a href="https://bbs.sumisora.net/read.php?tid=212871" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">特殊打补丁模式</a>（比如CPDCE和传颂之物）。 <br>ToHeartPSE貌似没发现升级系统，必要修改的文件有scn.pak和sys.pak，总大小是20多MB，也算是可以接受的范围内。于是可以用第一种方法，要中日共存就把相应文件的名字改掉就行了。 <br>另外如果想要在游戏标题界面里加上自己的LOGO的话就要考虑用第二种方法了，因为LOGO的文件在100多MB的chr.pak里。 <br>窗口界面汉化用ResHacker、ResScope等对在资源的字符串、菜单进行修改，如果不在资源的话就用WinHEX、UltraEdit等进行修改。于是共存版的补丁文件就出来了： <br><span class="highslide"><img src="assets/1570982535-fd4ea0d221039117c18988ae0cc849a9.png" border="0" style="max-width: 100%;max-height: 800px;"></span> <br>ToHeart_CHS.exe为ToHeart.exe改名，修改了里面PSTH.EXE为CNTH.EXE，TOHEARTP.EXE为THP_CHS.EXE。 <br>cnth.exe为psth.exe改名，修改了里面的相关文字和scn.pak改为cn1.pak，sys.pak改为cn2.pak。 <br>cn1.pak、cn2.pak对应修改后的scn.pak和sys.pak <br>修改上面的时候发现游戏中的字符串“初めから”、“続きから”等也在psth.exe中，于是顺手改了。成果如图： <br><span class="highslide"><img src="assets/1570982535-aea598806c65c5807d3d73ad614bf20d.png" border="0" style="max-width: 100%;max-height: 800px;"></span> <br>（无视字的美观度还有翻译质量[拖...]）跟预料中的一样文字显示错误，接下来就要修改字符集了。 <br>修改字符集一般是把CreateFont或CreateFontIndirect中的CharSet由0x80改为0x86。 <br>ToHeartPSE的程序中没有发现CreateFont，唯一的CreateFontIndirect也是没有关系的，不过自带字库的话，没有这个也算是正常吧，用自己的编码（之前已确认是使用Shift-JIS）来计算相应字所在的位置。 <br>&lt;-字库方面初学者，唯一能想到的是在OllyDBG里找检查边界。 <br>查找到常量0xA0找到两个cmp的： <br><span class="highslide"><img src="assets/1570982535-d967569bb02b9fb77b9da5da72be7bab.png" border="0" style="max-width: 100%;max-height: 800px;"></span> <br>两段检查边界的代码基本上一样，不过一个貌似没被调用到，先从确认有调用到的入手。 <br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code7'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code7" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="lit">004280BC</span><span class="pln">&nbsp; </span><span class="pun">|&gt;</span><span class="pln"> </span><span class="pun">/</span><span class="lit">33C0</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">/</span><span class="pln">xor&nbsp;&nbsp;&nbsp;&nbsp; eax</span><span class="pun">,</span><span class="pln"> eax 
</span><span class="lit">004280BE</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">8A03</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; al</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">ebx</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">高字节</span><span class="pln"> 
</span><span class="lit">004280C0</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">43</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">inc&nbsp;&nbsp;&nbsp;&nbsp; ebx 
</span><span class="lit">004280C1</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">83F8</span><span class="pln"> </span><span class="lit">24</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">cmp&nbsp;&nbsp;&nbsp;&nbsp; eax</span><span class="pun">,</span><span class="pln"> </span><span class="lit">24</span><span class="pln"> 
</span><span class="lit">004280C4</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">0F84</span><span class="pln"> BB000000 </span><span class="pun">|</span><span class="pln">je&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="lit">00428185</span><span class="pln"> 
</span><span class="lit">004280CA</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">85C0</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">test&nbsp;&nbsp;&nbsp; eax</span><span class="pun">,</span><span class="pln"> eax 
</span><span class="lit">004280CC</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">0F84</span><span class="pln"> B3000000 </span><span class="pun">|</span><span class="pln">je&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="lit">00428185</span><span class="pln"> 
</span><span class="lit">004280D2</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">3D</span><span class="pln"> </span><span class="lit">80000000</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">cmp&nbsp;&nbsp;&nbsp;&nbsp; eax</span><span class="pun">,</span><span class="pln"> </span><span class="lit">80</span><span class="pln"> 
</span><span class="lit">004280D7</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">7C</span><span class="pln"> </span><span class="lit">07</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">jl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">short</span><span class="pln"> </span><span class="lit">004280E0</span><span class="pln"> 
</span><span class="lit">004280D9</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="lit">3D</span><span class="pln"> FF000000&nbsp;&nbsp; cmp&nbsp;&nbsp;&nbsp;&nbsp; eax</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0FF</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">字符边界判断，</span><span class="pln">A0</span><span class="pun">-&gt;</span><span class="pln">FF 
</span><span class="lit">004280DE</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">7C</span><span class="pln"> </span><span class="lit">07</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">jl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">short</span><span class="pln"> </span><span class="lit">004280E7</span><span class="pln"> 
</span><span class="lit">004280E0</span><span class="pln">&nbsp; </span><span class="pun">|&gt;</span><span class="pln"> </span><span class="pun">|</span><span class="lit">3D</span><span class="pln"> E0000000&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">cmp&nbsp;&nbsp;&nbsp;&nbsp; eax</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0E0</span><span class="pln"> 
</span><span class="lit">004280E5</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">7C</span><span class="pln"> </span><span class="lit">4C</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">jl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">short</span><span class="pln"> </span><span class="lit">00428133</span><span class="pln"> 
</span><span class="lit">004280E7</span><span class="pln">&nbsp; </span><span class="pun">|&gt;</span><span class="pln"> </span><span class="pun">|</span><span class="lit">8B5424</span><span class="pln"> </span><span class="lit">24</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; edx</span><span class="pun">,</span><span class="pln"> dword ptr </span><span class="pun">[</span><span class="pln">esp</span><span class="pun">+</span><span class="lit">24</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">总是</span><span class="pln">FFFFFF</span><span class="pun">？</span><span class="pln"> 
</span><span class="lit">004280EB</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">33C9</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">xor&nbsp;&nbsp;&nbsp;&nbsp; ecx</span><span class="pun">,</span><span class="pln"> ecx 
</span><span class="lit">004280ED</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">8A0B</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; cl</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">byte</span><span class="pln"> ptr </span><span class="pun">[</span><span class="pln">ebx</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">低字节</span><span class="pln"> 
</span><span class="lit">004280EF</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">55</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">push&nbsp;&nbsp;&nbsp; ebp 
</span><span class="lit">004280F0</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="pln">C1E0 </span><span class="lit">08</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">shl&nbsp;&nbsp;&nbsp;&nbsp; eax</span><span class="pun">,</span><span class="pln"> </span><span class="lit">8</span><span class="pln"> 
</span><span class="lit">004280F3</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">03C1</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">add&nbsp;&nbsp;&nbsp;&nbsp; eax</span><span class="pun">,</span><span class="pln"> ecx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">合成</span></pre> <br>首先修改边界判断，然后继续跟踪（代码比较多，于是只贴重点好了）： <br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code8'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code8" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="lit">00414815</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="lit">81FF</span><span class="pln"> A1A10000 cmp&nbsp;&nbsp;&nbsp;&nbsp; edi</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0A1A1</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">比较是否全角空格，</span><span class="lit">8140</span><span class="pun">改成</span><span class="pln">A1A1 
</span><span class="lit">0041481B</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">0F84</span><span class="pln"> D8030000 je&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="lit">00414BF9</span><span class="pln"> 
</span><span class="lit">00414821</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">83FF</span><span class="pln"> </span><span class="lit">20</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cmp&nbsp;&nbsp;&nbsp;&nbsp; edi</span><span class="pun">,</span><span class="pln"> </span><span class="lit">20</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">比较是否半角空格</span><span class="pln"> 
</span><span class="lit">00414824</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">0F86</span><span class="pln"> CF030000 jbe&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="lit">00414BF9</span></pre> <br>&nbsp; <br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code9'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code9" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="lit">004148B0</span><span class="pln">&nbsp; </span><span class="pun">|&gt;</span><span class="pln">&nbsp; </span><span class="lit">33C9</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">/</span><span class="pln">xor&nbsp;&nbsp;&nbsp;&nbsp; ecx</span><span class="pun">,</span><span class="pln"> ecx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">双字节字符部分（字库定位）</span><span class="pln"> 
</span><span class="lit">004148B2</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="lit">66</span><span class="pun">:</span><span class="lit">8B0CC5</span><span class="pln"> </span><span class="lit">889</span><span class="pun">&gt;</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; cx</span><span class="pun">,</span><span class="pln"> word ptr </span><span class="pun">[</span><span class="pln">eax</span><span class="pun">*</span><span class="lit">8</span><span class="pun">+</span><span class="lit">449D88</span><span class="pun">]</span><span class="pln"> 
</span><span class="lit">004148BA</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">3BCF</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">cmp&nbsp;&nbsp;&nbsp;&nbsp; ecx</span><span class="pun">,</span><span class="pln"> edi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">比较当前字符是否在区间内</span><span class="pln"> 
</span><span class="lit">004148BC</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">77</span><span class="pln"> </span><span class="lit">0E</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">ja&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">short</span><span class="pln"> </span><span class="lit">004148CC</span><span class="pln"> 
</span><span class="lit">004148BE</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">33D2</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">xor&nbsp;&nbsp;&nbsp;&nbsp; edx</span><span class="pun">,</span><span class="pln"> edx 
</span><span class="lit">004148C0</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="lit">66</span><span class="pun">:</span><span class="lit">8B14C5</span><span class="pln"> </span><span class="lit">8A9</span><span class="pun">&gt;</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; dx</span><span class="pun">,</span><span class="pln"> word ptr </span><span class="pun">[</span><span class="pln">eax</span><span class="pun">*</span><span class="lit">8</span><span class="pun">+</span><span class="lit">449D8A</span><span class="pun">]</span><span class="pln"> 
</span><span class="lit">004148C8</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">3BFA</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">cmp&nbsp;&nbsp;&nbsp;&nbsp; edi</span><span class="pun">,</span><span class="pln"> edx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">比较当前字符是否在区间内</span><span class="pln"> 
</span><span class="lit">004148CA</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln"> </span><span class="pun">|</span><span class="lit">76</span><span class="pln"> </span><span class="lit">08</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">jbe&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">short</span><span class="pln"> </span><span class="lit">004148D4</span><span class="pln"> 
</span><span class="lit">004148CC</span><span class="pln">&nbsp; </span><span class="pun">|&gt;</span><span class="pln"> </span><span class="pun">|</span><span class="lit">40</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">inc&nbsp;&nbsp;&nbsp;&nbsp; eax 
</span><span class="lit">004148CD</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="lit">83F8</span><span class="pln"> </span><span class="lit">4D</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cmp&nbsp;&nbsp;&nbsp;&nbsp; eax</span><span class="pun">,</span><span class="pln"> </span><span class="lit">4D</span><span class="pln"> 
</span><span class="lit">004148D0</span><span class="pln">&nbsp; </span><span class="pun">|.^</span><span class="pln">\7C DE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \jl&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">short</span><span class="pln"> </span><span class="lit">004148B0</span></pre> </span><br><span style="font-family:宋体 "><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code10'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code10" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="lit">00414C87</span><span class="pln">&nbsp; </span><span class="pun">|&gt;</span><span class="pln"> \8</span><span class="lit">1FF</span><span class="pln"> </span><span class="lit">5C810000</span><span class="pln"> cmp&nbsp;&nbsp;&nbsp;&nbsp; edi</span><span class="pun">,</span><span class="pln"> </span><span class="lit">815C</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">―</span><span class="pln"> 
</span><span class="lit">00414C8D</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; C705 </span><span class="lit">10B34500</span><span class="pun">&gt;</span><span class="pln">mov&nbsp;&nbsp;&nbsp;&nbsp; dword ptr </span><span class="pun">[</span><span class="lit">45B310</span><span class="pun">],</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> 
</span><span class="lit">00414C97</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">74</span><span class="pln"> </span><span class="lit">08</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; je&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">short</span><span class="pln"> </span><span class="lit">00414CA1</span><span class="pln"> 
</span><span class="lit">00414C99</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">81FF</span><span class="pln"> </span><span class="lit">9F840000</span><span class="pln"> cmp&nbsp;&nbsp;&nbsp;&nbsp; edi</span><span class="pun">,</span><span class="pln"> </span><span class="lit">849F</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp; </span><span class="pun">─</span><span class="pln"> 
</span><span class="lit">00414C9F</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">75</span><span class="pln"> </span><span class="lit">1A</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jnz&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="kwd">short</span><span class="pln"> </span><span class="lit">00414CBB</span></pre></span> <br><span style="font-family:宋体 ">通过上面的可以知道游戏是通过一张区间表来确定文字在字库中的位置，下面为区间表，一个区间分为3部分： <br>begin 0x2 开始 <br>end 0x2 结束 <br>count 0x4 end字符在字库中的位置 0 和 -1 分别为全角空格和半角空格。 <br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code11'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code11" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="lit">0044D20C</span><span class="pln"> </span><span class="lit">41</span><span class="pln"> </span><span class="lit">81</span><span class="pln"> AC </span><span class="lit">81</span><span class="pln"> </span><span class="lit">6C</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> B8 </span><span class="lit">81</span><span class="pln"> BF </span><span class="lit">81</span><span class="pln"> </span><span class="lit">74</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> A</span><span class="pun">伂乴...竵縼</span><span class="pln">t</span><span class="pun">...</span><span class="pln"> 
</span><span class="lit">0044D21C</span><span class="pln"> C8 </span><span class="lit">81</span><span class="pln"> CE </span><span class="lit">81</span><span class="pln"> </span><span class="lit">7B</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> DA </span><span class="lit">81</span><span class="pln"> FC </span><span class="lit">81</span><span class="pln"> </span><span class="lit">9E</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="pun">葋蝸{...趤鼇?..</span><span class="pln"> 
</span><span class="lit">0044D22C</span><span class="pln"> </span><span class="lit">4F</span><span class="pln"> </span><span class="lit">82</span><span class="pln"> </span><span class="lit">58</span><span class="pln"> </span><span class="lit">82</span><span class="pln"> A8 </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">60</span><span class="pln"> </span><span class="lit">82</span><span class="pln"> </span><span class="lit">79</span><span class="pln"> </span><span class="lit">82</span><span class="pln"> C2 </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> O</span><span class="pun">俋偍...</span><span class="str">`倅偮... 
0044D23C 81 82 9A 82 DC 00 00 00 9F 82 F1 82 2F 01 00 00 亗殏?..焸駛/.. 
0044D24C 40 83 96 83 86 01 00 00 9F 83 B6 83 9E 01 00 00 @儢儐..焹秲?.. 
0044D25C BF 83 D6 83 B6 01 00 00 40 84 60 84 D7 01 00 00 績謨</span><span class="str">?..@</span><span class="str">刞勛.. 
0044D26C 70 84 91 84 F9 01 00 00 9F 84 BE 84 19 02 00 00 p剳匇..焺緞.. 
0044D27C 40 87 99 87 73 02 00 00 9F 88 FC 88 D1 02 00 00 @嚈噑..焾鼒?.. 
0044D28C 40 89 FC 89 8E 03 00 00 40 8A FC 8A 4B 04 00 00 @夵墡</span><span class="str">..@</span><span class="str">婞奒.. 
0044D29C 40 8B FC 8B 08 05 00 00 40 8C FC 8C C5 05 00 00 @孅</span><span class="str">?..@</span><span class="str">岦屌.. 
0044D2AC 40 8D FC 8D 82 06 00 00 40 8E FC 8E 3F 07 00 00 @嶞崅</span><span class="str">..@</span><span class="str">廃?.. 
0044D2BC 40 8F FC 8F FC 07 00 00 40 90 FC 90 B9 08 00 00 @忺忺</span><span class="str">..@</span><span class="str">慄惞.. 
0044D2CC 40 91 FC 91 76 09 00 00 40 92 FC 92 33 0A 00 00 @扅�</span><span class="str">v...@</span><span class="str">掽?... 
0044D2DC 40 93 FC 93 F0 0A 00 00 40 94 FC 94 AD 0B 00 00 @擖擆</span><span class="str">...@</span><span class="str">旤敪 .. 
0044D2EC 40 95 FC 95 6A 0C 00 00 40 96 FC 96 27 0D 00 00 @朁�</span><span class="str">j...@</span><span class="str">桙?... 
0044D2FC 40 97 FC 97 E4 0D 00 00 40 98 72 98 17 0E 00 00 @楛椾</span><span class="str">...@</span><span class="str">榬?.. 
0044D30C 9F 98 FC 98 75 0E 00 00 40 99 FC 99 32 0F 00 00 煒鼧</span><span class="str">u..@</span><span class="str">欬?.. 
0044D31C 40 9A FC 9A EF 0F 00 00 40 9B FC 9B AC 10 00 00 @汓氾</span><span class="str">..@</span><span class="str">淈洭.. 
0044D32C 40 9C FC 9C 69 11 00 00 40 9D FC 9D 26 12 00 00 @滭�</span><span class="str">i..@</span><span class="str">濣?.. 
0044D33C 40 9E FC 9E E3 12 00 00 40 9F FC 9F A0 13 00 00 @烖炪</span><span class="str">..@</span><span class="str">燑煚.. 
0044D34C 40 E0 FC E0 5D 14 00 00 40 E1 FC E1 1A 15 00 00 @帱郵</span><span class="str">..@</span><span class="str">狳?.. 
0044D35C 40 E2 FC E2 D7 15 00 00 40 E3 FC E3 94 16 00 00 @恻庾</span><span class="str">..@</span><span class="str">泓銛.. 
0044D36C 40 E4 FC E4 51 17 00 00 40 E5 FC E5 0E 18 00 00 @潼�</span><span class="str">Q..@</span><span class="str">妩?.. 
0044D37C 40 E6 FC E6 CB 18 00 00 40 E7 FC E7 88 19 00 00 @纥嫠</span><span class="str">..@</span><span class="str">琰鐖.. 
0044D38C 40 E8 FC E8 45 1A 00 00 40 E9 FC E9 02 1B 00 00 @椟�</span><span class="str">E..@</span><span class="str">辄?.. 
0044D39C 40 EA A4 EA 67 1B 00 00 40 F0 47 F0 6F 1B 00 00 @辘�</span><span class="str">g..@</span><span class="str">餑餺.. 
0044D3AC 40 81 40 81 00 00 00 00 21 00 7E 00 5E 00 00 00 @丂?...!.~.^... 
0044D3BC A1 FF DF FF 9D 00 00 00 20 00 20 00 FF FF FF FF ???.. . .&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></pre> <br>观察可知区间表只有0x38个，其中3个为单字节字符的，对于GBK来说是不够的，于是想到两种解决方案： <br>①像一些字库无法扩容的游戏一样，不改变区间表和字库大小，把字库里的字替换掉，然后再导入文本的时候处理一下就行了，不过这个方法要看原字库的容量是否足够。 <br>粗略统计了一下ToHeart2和天使不在的12月这两个游戏汉化使用的字符数都是3000多，之前看字库容纳有7023个双字节字符，可以说是很充足了，把GB2312的汉字全部塞下去也够。 <br>②扩容字库（废话）。直接在区间表的地方改是比较困难的，于是打算在.rdata段的空白区写自己被区间表，首先找到.rdata段的位置： <br><span class="highslide"><img src="assets/1570982535-e5726d3d02689c00f1184323cbd7a340.png" border="0" style="max-width: 100%;max-height: 800px;"></span>&nbsp;</span>&nbsp; <br><span style="font-family:宋体 ">&nbsp;</span> <br><br><span class="highslide"><img src="assets/1570982535-ba99d2035fdac023348a985276e9fe54.png" border="0" style="max-width: 100%;max-height: 800px;"></span> <br>然后在尾部00部分加入自己的区间表： <br><span class="highslide"><img src="assets/1570982535-3a7e3440299ab1c36841758337c71cda.png" border="0" style="max-width: 100%;max-height: 800px;"></span> <br>（PS：生成字库用的是holand前辈在ToHeart2字库生成工具中的GBK.tbl） <br>然后再用OllyDBG把程序中的相关内容改掉： <br><span class="highslide"><img src="assets/1570982535-3800ffffb1f3f487051d980e74f09833.png" border="0" style="max-width: 100%;max-height: 800px;"></span> <br>（另：还有前面的边界检查等。） <br>然后最终效果： <br><span class="highslide"><img src="assets/1570982535-67856721c166a7dc376b2bc2973ec2de.png" border="0" style="max-width: 100%;max-height: 800px;"></span> <br>（继续无视字的美观度还有翻译质量[拖...]） <br>选.rdata段是因为该段的只读的，我想游戏没这么DT从这里的尾部读取0x00吧。 <br>&lt;-在这之前试了在.data段写码表结果一下子就错误退出了。 <br>另一个cmp eax,A0估计是用字库FONTEX08.FD0时的，用于注音的，虽然汉化用不上，最好还是改掉检查。 <br>另外在查表后面一段代码看起来是处理字库数据的，可以分析这段代码来制作更好的字库。 <br>&lt;-不要学这个家伙懒XD <br>这样程序就基本上能够使用了，剩下一些小问题比如主角名字那里做了边界检查，修改方法还是搜索边界的常量，还有转码后主角名字没有语音等问题、小游戏方面的分析和修改，这里就不多说了。 <br><br><b>后记（牢骚）</b> <br>很久之前就想把ToHeartPSE的东西提取出来了，无奈的第二种pak文件一直都没有找到方法提取，于是自己开始学着调试来解包、解密。 <br>后来稍微懒惰了，把这个放在一边很久，想着哪天等crass、ExtractData支持了再收下就算了，直到不久前。 <br>汉公隐退了，crass中止开发。另外不知道什么时候ExtractData的主页关闭了，到现在还没恢复。于是就只能靠自己了。 <br>说起汉公，他人很不错，而且很强大，虽然跟他交流得很少（仅仅是两封Email而已，而且还是向他伸手要某还没发布源代码的cui的源代码orz）。 <br>他的隐退无疑是一种巨大的损失，不过做crass确实很辛苦，解析完这个游戏后就能感同身受了。 <br>一个人做这些的话实在是太辛苦了，而且不是每个游戏的算法都是简单的，所以他的隐退还是可以理解的。 <br>crass在提取gal资源来说算是处于顶峰的吧，希望汉公在工作上也能达到顶峰。 <br><br><span style="font-family:宋体 ">这里总结一下自己的想法吧（大概有些东西有问题[拖...]） <br>解包的话，如果幸运遇到没有压缩加密的话直接分析文件就可以了，具体的可以参照holand前辈的<a href="https://bbs.sumisora.net/read.php?tid=206511" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">《ONE ～輝く季節へ FullVoice 汉化实战篇[完]》</a> <br>本区里的很多文章也很有营养。另外</span><a href="http://book.csdn.net/bookfiles/943/10094329490.shtml" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><span style="font-family:宋体 ">《揭秘数据解密的关键技术》</span></a><span style="font-family:宋体 ">这个对于初学者来说还是很有营养的，至少我从这里知道了LZSS还有其他压缩方式的特征及分析方法。 <br>十六进制编辑器的话WinHEX很方便，自带各种对数据的操作[Ctrl+T]，另外对zlib的压缩数据分析也是比较方便的： <br><span class="highslide"><img src="assets/1570982535-06d12881bc856516214b3b78fa678692.png" border="0" style="max-width: 100%;max-height: 800px;"></span>（疑似使用zlib压缩，用转换功能[Ctrl+R]） <br><span class="highslide"><img src="assets/1570982535-d82bc6d608994db25829387546557d8c.png" border="0" style="max-width: 100%;max-height: 800px;"></span>（选zlib inflate (32 KB target)） <br><span class="highslide"><img src="assets/1570982535-bcbcde81e0c817b0284cc485976f2f22.png" border="0" style="max-width: 100%;max-height: 800px;"></span>（可以初步判断是zlib压缩的，有错误因为只能解压32KB的数据= =） <br>本来是想打算写成cui来配合crass使用的，可惜偶C++学的不咋样的，看那一堆CALLBACK的东西看到晕头转向泪流满面的，而且接口也不清楚，所以还是自己另外写一个程序了。 <br><span class="highslide"><img src="assets/1570982535-e5a26837f99e9a5abc6e0cea2804cfe3.png" border="0" style="max-width: 100%;max-height: 800px;"></span></span> <br><span style="font-family:宋体 ">（这个cui是给自己YY用的..实际上只是写了cui信息而已..完全没解包能力[拖很远...]） <br>&lt;-写出来的提取器效率低下，不好意思放出来……orz <br>于是直接扔图片素材好了，有爱就下吧=，=（不包含小游戏，Alpha通道没有处理） <br><a href="http://www.jsharer.com/blog/279475.htm" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">http://www.jsharer.com/blog/279475.htm</a> </span><br><br><span style="font-family:宋体 "><br><span class="highslide"><img src="assets/1570982535-a9ebd6554e821fbe75ffa872261cf045.jpg" border="0" style="max-width: 100%;max-height: 800px;"></span> <br><span class="highslide"><img src="assets/1570982535-b33ca70d10725f7ac4c4ea930af9669e.jpg" border="0" style="max-width: 100%;max-height: 800px;"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="highslide"><img src="assets/1570982535-be7eb38e1d75dd9fb9e69007e625140b.jpg" border="0" style="max-width: 100%;max-height: 800px;"></span> <br></span><div id="alert_2537608" style="color: gray; margin-top: 30px; --darkreader-inline-color:#bfb9ac;" data-darkreader-inline-color="">[ 此帖被夏の幻在2009-09-12 23:50重新编辑 ]</div></div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_2537608" class="c"></div>

		<div><img class="signature" src="assets/1570982535-f23b8ffd0b6b327441aa828c9cd3243d.gif" align="absbottom"></div>
		<div class="signature" style="max-height:380px;maxHeight:380px; overflow:hidden;"><table width="100%"><tbody><tr><td><div align="center"><a href="https://aquaplus.jp/uta/chiri/" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><span class="highslide"><img src="assets/1570982535-b2941f47c7cd8e06555d1301f173a932.jpg" border="0" style="max-width: 100%;max-height: 900px;"></span></a><br></div></td><td></td></tr></tbody></table></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2009-09-10 11:06 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 3楼(夏の幻) 的帖子');" data-mx-warn="Empty URL">3 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="2538851" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570982535-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>微光</b>
<div style="margin:.3em 0 .4em .2em">我，在这里……</div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=180712" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570982535-df9e2a68e029ec47329c0fb502605bf9.jpg" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_4"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">学生会干事</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570982535-87bc1a6e935264a57e50e0d513f23aa7.gif"><br>

<span class="user-info2" id="showface_4">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">905</span><br>
学分: <span class="s2 f9">260 点</span><br>
澄空币: <span class="s3 f9">2020 KID</span><br>

		GPA: <span class="s2 f9">2 点</span><br>

		<span class="gray">注册时间:2008-02-21<br>
		最后登录:2019-10-10 <br><br> 
		<img src="assets/1570982535-15d1bc1d25f42561ca9cc0656ca081b3.gif" title="初雪樱汉化纪念勋章"> <br></span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_2538851" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10930627&amp;pid=2538851&amp;article=4" onclick="return sendurl(this,4,event)" id="quote_2538851" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10930627&amp;pid=2538851&amp;article=4" id="modify_2538851" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=180712" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10930627&amp;pid=2538851" onclick="return sendurl(this,8)" id="report_2538851" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10930627&amp;uid=180712" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('2538851')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_2538851" class="fl">&nbsp;</h1>
			

			<div id="p_2538851" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_2538851">看到这个老物也有人研究真的泪流满面啊，不知道toheart能不能在此刻再战江湖呢……</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_2538851" class="c"></div>

		<div><img src="assets/1570982535-ee75bbe39bae3a2e6fc29b9593dde416.png" align="absbottom"></div>
		<div class="card" style="overflow:hidden;">
			<table width="100%">
				<tbody><tr>
					<td id="ck_card_container_2538851">
					<img src="assets/1570982535-f1e54fa913d31d74d1193dc7c7831a13.png" width="224" border="0"> <img src="assets/1570982535-884218cbb54e7a007fa8d6e897ad2165.png" width="224" border="0"> <img src="assets/1570982535-f9e4bc89825a60fa263d7ac13b3c9684.png" width="224" border="0"> </td><td>
				</td></tr>
				
			</tbody></table>
		</div>


		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2009-09-10 22:03 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 4楼(微光) 的帖子');" data-mx-warn="Empty URL">4 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="2539007" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570982535-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>乙津夢</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=144048" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570982535-8d34d9f9280e4a12cd0f1fb4e54564d7.png" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_5"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">学生会干事</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570982535-87bc1a6e935264a57e50e0d513f23aa7.gif"><br>

<span class="user-info2" id="showface_5">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">2499</span><br>
学分: <span class="s2 f9">367 点</span><br>
澄空币: <span class="s3 f9">3062 KID</span><br>

		GPA: <span class="s2 f9">3 点</span><br>

		<span class="gray">注册时间:2007-10-11<br>
		最后登录:2019-10-13 <br><br> 
		<img src="assets/1570982535-d611e1ea09787be6459421daf5675717.png" title="星空的记忆汉化纪念勋章"> <img src="assets/1570982535-fc551661c6b14e66c09220c9e87cd6cd.png" title="星空的记忆EH汉化纪念勋章"> <img src="assets/1570982535-5c64e06b8133c772ea454d51a3a0a974.png" title="展望台の彼女"> <img src="assets/1570982535-2b7944623c26c12d2fd8f65e65d66f7a.gif" title="Favorite学部勋章"> <img src="assets/1570982535-b4ca2062fca1889e2ad39ccbcad77e2d.gif" title="乙津夢"> <img src="assets/1570982535-09974d1b907945d7b1563acb3052bcba.gif" title="10号フェイバリット10周年纪念章"> <br></span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_2539007" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10930627&amp;pid=2539007&amp;article=5" onclick="return sendurl(this,4,event)" id="quote_2539007" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10930627&amp;pid=2539007&amp;article=5" id="modify_2539007" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=144048" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10930627&amp;pid=2539007" onclick="return sendurl(this,8)" id="report_2539007" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10930627&amp;uid=144048" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('2539007')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_2539007" class="fl">&nbsp;</h1>
			

			<div id="p_2539007" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_2539007">感谢幻大大深夜发片<br><br>幻大大来教我图像格式吧TAT</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_2539007" class="c"></div>

		<div><img src="assets/1570982535-ee75bbe39bae3a2e6fc29b9593dde416.png" align="absbottom"></div>
		<div class="card" style="overflow:hidden;">
			<table width="100%">
				<tbody><tr>
					<td id="ck_card_container_2539007">
					<img src="assets/1570982535-250f699f9aa5f5d0803c05fca6bcaed2.png" width="224" border="0"> <img src="assets/1570982535-fadd7a20b74566145c6531b9145eb5f5.png" width="224" border="0"> <img src="assets/1570982535-f0294700c58a296cc96d12613cd4238a.png" width="224" border="0"> </td><td>
				</td></tr>
				
			</tbody></table>
		</div>


		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2009-09-10 23:10 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 5楼(乙津夢) 的帖子');" data-mx-warn="Empty URL">5 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="2541784" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570982535-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>夏の幻</b>
<div style="margin:.3em 0 .4em .2em">もう、冬は、ホワイトアルバムの季節じゃない。</div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=131798" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570982535-3e80c861881e4c453757e04fdb5f5b6e.png" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_6"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">学生会副会长</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570982535-35aa8c414aad91387ad565c549e6cd0f.gif"><br>

<span class="user-info2" id="showface_6">
<span class="user-infoWrap2">


精华:

		<a href="https://bbs.sumisora.net/search.php?authorid=131798&amp;digest=1" target="_blank" class="s4 f9" referrerpolicy="no-referrer" rel="noopener noreferrer">1</a>
<br>
发帖: <span class="s1 f9">1818</span><br>
学分: <span class="s2 f9">218 点</span><br>
澄空币: <span class="s3 f9">0 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2007-06-26<br>
		最后登录:2019-08-13 <br><br> 
		<img src="assets/1570982535-196b2da3a42134dc3b0b212d7ed677c2.gif" title="Leaf学部勋章"> <br></span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_2541784" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10930627&amp;pid=2541784&amp;article=6" onclick="return sendurl(this,4,event)" id="quote_2541784" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10930627&amp;pid=2541784&amp;article=6" id="modify_2541784" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=131798" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10930627&amp;pid=2541784" onclick="return sendurl(this,8)" id="report_2541784" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10930627&amp;uid=131798" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('2541784')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_2541784" class="fl">&nbsp;</h1>
			

			<div id="p_2541784" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_2541784">= =居然加精了...感觉还有不少地方要修改....慢慢改好了... <br><br><h6 class="quote">Quote:</h6><blockquote class="blockquote">引用第4楼微光于2009-09-10 22:03发表的 : <br>看到这个老物也有人研究真的泪流满面啊，不知道toheart能不能在此刻再战江湖呢……</blockquote> <br>嘛嘛..等某个大大填坑..XSK <br><br><h6 class="quote">Quote:</h6><blockquote class="blockquote">引用第5楼谁解怨妇心于2009-09-10 23:10发表的 : <br>感谢幻大大深夜发片 <br><br>幻大大来教我图像格式吧TAT</blockquote> <br>一 一哪里是深夜了..你明明会..为求简洁没写而已...咱的不简洁哦耶 <br><br><h6 class="quote">Quote:</h6><blockquote class="blockquote">引用第7楼amaranthf于2009-09-14 00:22发表的 : <br>真长啊…… <br>确实很惊异汉公一个人搞游戏解包的能力……我的话光研究一个游戏就要好几天，而他的crass已经有一百多个cui了…… <br>找汉公要一下接口说明什么的就可以了吧，毕竟开发cui的话可以省下很多其他的工作，他都弄好了。</blockquote> <br><img src="assets/1570982535-02448956beafd1abb2e987768d4e17be.gif">&nbsp;汉公很强大...<br>Crass的SDK貌似没有公布...不过大概有人会有吧...<div id="alert_2541784" style="color: gray; margin-top: 30px; --darkreader-inline-color:#bfb9ac;" data-darkreader-inline-color="">[ 此帖被夏の幻在2009-09-19 05:40重新编辑 ]</div></div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_2541784" class="c"></div>

		<div><img class="signature" src="assets/1570982535-f23b8ffd0b6b327441aa828c9cd3243d.gif" align="absbottom"></div>
		<div class="signature" style="max-height:380px;maxHeight:380px; overflow:hidden;"><table width="100%"><tbody><tr><td><div align="center"><a href="https://aquaplus.jp/uta/chiri/" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><span class="highslide"><img src="assets/1570982535-b2941f47c7cd8e06555d1301f173a932.jpg" border="0" style="max-width: 100%;max-height: 900px;"></span></a><br></div></td><td></td></tr></tbody></table></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2009-09-12 12:24 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 6楼(夏の幻) 的帖子');" data-mx-warn="Empty URL">6 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="2545030" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570982535-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>amaranthf</b>
<div style="margin:.3em 0 .4em .2em">はい、変態です。</div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=247562" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570982535-1355eb712976ba923dc6d00960493aea.jpg" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_7"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空三年生上学期</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570982535-5fc5bacf4fd91c54a5fe72c4ceff18fa.gif"><br>

<span class="user-info2" id="showface_7">
<span class="user-infoWrap2">


精华:

		<a href="https://bbs.sumisora.net/search.php?authorid=247562&amp;digest=1" target="_blank" class="s4 f9" referrerpolicy="no-referrer" rel="noopener noreferrer">1</a>
<br>
发帖: <span class="s1 f9">302</span><br>
学分: <span class="s2 f9">159 点</span><br>
澄空币: <span class="s3 f9">914 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2008-11-23<br>
		最后登录:2019-08-30 <br><br> 
		<img src="assets/1570982535-bd1b51324558fe7f970dc337a22ab44d.gif" title="杏子御津爱护同好会勋章"> <img src="assets/1570982535-f464946ff600e13a1efb7655381816b9.gif" title="きっと、澄みわたる朝色よりも汉化纪念勋章"> <img src="assets/1570982535-e4c06c69f2782e34fc77312ea6e838be.gif" title="Gift汉化纪念勋章"> <img src="assets/1570982535-15e89d0b08be5c8eefbdfacf3bb9dffd.gif" title="天神乱漫汉化纪念勋章"> <img src="assets/1570982535-b0c0c9209b189d3c6e4a2f1ce27e06da.gif" title="纯白交响曲汉化纪念勋章"> <img src="assets/1570982535-fc10b14705a44f23e82b183dd9d03d74.gif" title="muv-luv alternative汉化纪念勋章"> <br></span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_2545030" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10930627&amp;pid=2545030&amp;article=7" onclick="return sendurl(this,4,event)" id="quote_2545030" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10930627&amp;pid=2545030&amp;article=7" id="modify_2545030" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=247562" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10930627&amp;pid=2545030" onclick="return sendurl(this,8)" id="report_2545030" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10930627&amp;uid=247562" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('2545030')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_2545030" class="fl">&nbsp;</h1>
			

			<div id="p_2545030" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_2545030">真长啊……<br>确实很惊异汉公一个人搞游戏解包的能力……我的话光研究一个游戏就要好几天，而他的crass已经有一百多个cui了……<br>找汉公要一下接口说明什么的就可以了吧，毕竟开发cui的话可以省下很多其他的工作，他都弄好了。</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_2545030" class="c"></div>

		<div><img src="assets/1570982535-ee75bbe39bae3a2e6fc29b9593dde416.png" align="absbottom"></div>
		<div class="card" style="overflow:hidden;">
			<table width="100%">
				<tbody><tr>
					<td id="ck_card_container_2545030">
					<img src="assets/1570982535-3e2b863b5e623887b192ec599f8824b1.png" width="224" border="0"> <img src="assets/1570982535-b9097c442aecbdab3af0001b460f5744.png" width="224" border="0"> <img src="assets/1570982535-681af903addce100446352ebfb1ea230.png" width="224" border="0"> </td><td>
				</td></tr>
				
			</tbody></table>
		</div>


		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2009-09-14 00:22 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 7楼(amaranthf) 的帖子');" data-mx-warn="Empty URL">7 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="2549980" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570982535-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>sakuragundam</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=30660" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570982535-bc3b3631a24154c2d9ba8189508a5212.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_8"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空新生</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570982535-be59bc9a4edb96b6b54ba67c9267b93f.gif"><br>

<span class="user-info2" id="showface_8">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">9</span><br>
学分: <span class="s2 f9">0 点</span><br>
澄空币: <span class="s3 f9">1337 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2005-12-15<br>
		最后登录:2009-09-17 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_2549980" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10930627&amp;pid=2549980&amp;article=8" onclick="return sendurl(this,4,event)" id="quote_2549980" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10930627&amp;pid=2549980&amp;article=8" id="modify_2549980" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=30660" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10930627&amp;pid=2549980" onclick="return sendurl(this,8)" id="report_2549980" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10930627&amp;uid=30660" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('2549980')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_2549980" class="fl">&nbsp;</h1>
			

			<div id="p_2549980" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_2549980">如此老物+神物竟然研究到了这种地步，希望有大大来开坑。</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_2549980" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2009-09-17 00:51 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 8楼(sakuragundam) 的帖子');" data-mx-warn="Empty URL">8 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="2660231" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570982535-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>foresee</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=334589" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570982535-bc3b3631a24154c2d9ba8189508a5212.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_9"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">新注册会员</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570982535-be59bc9a4edb96b6b54ba67c9267b93f.gif"><br>

<span class="user-info2" id="showface_9">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">1</span><br>
学分: <span class="s2 f9">0 点</span><br>
澄空币: <span class="s3 f9">754 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2009-11-26<br>
		最后登录:2009-11-26 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_2660231" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10930627&amp;pid=2660231&amp;article=9" onclick="return sendurl(this,4,event)" id="quote_2660231" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10930627&amp;pid=2660231&amp;article=9" id="modify_2660231" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=334589" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10930627&amp;pid=2660231" onclick="return sendurl(this,8)" id="report_2660231" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10930627&amp;uid=334589" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('2660231')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_2660231" class="fl">&nbsp;</h1>
			

			<div id="p_2660231" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_2660231">这么优秀的贴子不顶对不起自己</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_2660231" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2009-11-26 00:59 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 9楼(foresee) 的帖子');" data-mx-warn="Empty URL">9 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="2701779" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570982535-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>ulti-killer</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=272361" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570982535-ed4c258afc4564b5b306963bc4350019.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_10"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空一年生下学期</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570982535-0e03c5ece6b57c19681c4186b2d07c62.gif"><br>

<span class="user-info2" id="showface_10">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">254</span><br>
学分: <span class="s2 f9">0 点</span><br>
澄空币: <span class="s3 f9">671 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2009-03-08<br>
		最后登录:2019-09-29 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_2701779" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10930627&amp;pid=2701779&amp;article=10" onclick="return sendurl(this,4,event)" id="quote_2701779" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10930627&amp;pid=2701779&amp;article=10" id="modify_2701779" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=272361" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10930627&amp;pid=2701779" onclick="return sendurl(this,8)" id="report_2701779" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10930627&amp;uid=272361" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('2701779')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_2701779" class="fl">&nbsp;</h1>
			

			<div id="p_2701779" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_2701779">请问下PSE是不是Playstation Emulator?</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_2701779" class="c"></div>

		<div><img class="signature" src="assets/1570982535-f23b8ffd0b6b327441aa828c9cd3243d.gif" align="absbottom"></div>
		<div class="signature" style="max-height:380px;maxHeight:380px; overflow:hidden;"><table width="100%"><tbody><tr><td><span class="highslide"><img src="assets/1570982535-93d3e28e4b70464001652b4d2078c8a6.jpg" border="0" style="max-width: 100%;max-height: 900px;"></span></td><td></td></tr></tbody></table></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2009-12-20 20:43 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 10楼(ulti-killer) 的帖子');" data-mx-warn="Empty URL">10 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="2703882" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570982535-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>kkaien</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=98880" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570982535-bc3b3631a24154c2d9ba8189508a5212.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_11"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空一年生下学期</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570982535-0e03c5ece6b57c19681c4186b2d07c62.gif"><br>

<span class="user-info2" id="showface_11">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">159</span><br>
学分: <span class="s2 f9">2 点</span><br>
澄空币: <span class="s3 f9">1129 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2007-03-06<br>
		最后登录:2013-08-10 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_2703882" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10930627&amp;pid=2703882&amp;article=11" onclick="return sendurl(this,4,event)" id="quote_2703882" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10930627&amp;pid=2703882&amp;article=11" id="modify_2703882" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=98880" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10930627&amp;pid=2703882" onclick="return sendurl(this,8)" id="report_2703882" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10930627&amp;uid=98880" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('2703882')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_2703882" class="fl">&nbsp;</h1>
			

			<div id="p_2703882" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_2703882">楼主写的很辛苦，要好好表扬+支持。<br>我们搞汉化破解的时候，很少会想着去写这么详细的一篇介绍的。都是随手记几个自己才看得懂的手记~</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_2703882" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2009-12-22 00:21 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 11楼(kkaien) 的帖子');" data-mx-warn="Empty URL">11 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="2712209" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570982535-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>ulti-killer</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=272361" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570982535-ed4c258afc4564b5b306963bc4350019.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_12"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空一年生下学期</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570982535-0e03c5ece6b57c19681c4186b2d07c62.gif"><br>

<span class="user-info2" id="showface_12">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">254</span><br>
学分: <span class="s2 f9">0 点</span><br>
澄空币: <span class="s3 f9">671 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2009-03-08<br>
		最后登录:2019-09-29 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_2712209" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10930627&amp;pid=2712209&amp;article=12" onclick="return sendurl(this,4,event)" id="quote_2712209" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10930627&amp;pid=2712209&amp;article=12" id="modify_2712209" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=272361" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10930627&amp;pid=2712209" onclick="return sendurl(this,8)" id="report_2712209" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10930627&amp;uid=272361" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('2712209')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_2712209" class="fl">&nbsp;</h1>
			

			<div id="p_2712209" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_2712209">PSE是什么来的？？？？？</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_2712209" class="c"></div>

		<div><img class="signature" src="assets/1570982535-f23b8ffd0b6b327441aa828c9cd3243d.gif" align="absbottom"></div>
		<div class="signature" style="max-height:380px;maxHeight:380px; overflow:hidden;"><table width="100%"><tbody><tr><td><span class="highslide"><img src="assets/1570982535-93d3e28e4b70464001652b4d2078c8a6.jpg" border="0" style="max-width: 100%;max-height: 900px;"></span></td><td></td></tr></tbody></table></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2009-12-26 02:11 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 12楼(ulti-killer) 的帖子');" data-mx-warn="Empty URL">12 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="3975546" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570982535-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>xiayuanzhong</b>
<div style="margin:.3em 0 .4em .2em">CROSS†CHANNEL完整汉化补丁已经发布！</div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=455755" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570982535-61d230ead156bb08581da82035c0cd3f.png" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_13"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空一年生上学期</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570982535-f43195cd588caa26c296fcc61910b3e6.gif"><br>

<span class="user-info2" id="showface_13">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">121</span><br>
学分: <span class="s2 f9">0 点</span><br>
澄空币: <span class="s3 f9">419 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2010-07-05<br>
		最后登录:2019-04-20 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_3975546" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10930627&amp;pid=3975546&amp;article=13" onclick="return sendurl(this,4,event)" id="quote_3975546" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10930627&amp;pid=3975546&amp;article=13" id="modify_3975546" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=455755" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10930627&amp;pid=3975546" onclick="return sendurl(this,8)" id="report_3975546" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10930627&amp;uid=455755" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('3975546')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_3975546" class="fl">&nbsp;</h1>
			

			<div id="p_3975546" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_3975546">好贴！<br>3Q分享！</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_3975546" class="c"></div>

		<div><img class="signature" src="assets/1570982535-f23b8ffd0b6b327441aa828c9cd3243d.gif" align="absbottom"></div>
		<div class="signature" style="max-height:380px;maxHeight:380px; overflow:hidden;"><table width="100%"><tbody><tr><td>CROSS†CHANNEL 原版 &amp; 复刻版 汉化 项目：<br>汉化组博客：crosschannel.cn<br>欢迎大家关注！~《少女们向荒野进发》同样欢迎大家~~</td><td></td></tr></tbody></table></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2011-04-29 15:36 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 13楼(xiayuanzhong) 的帖子');" data-mx-warn="Empty URL">13 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="4298315" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570982535-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>夏目梓鱼</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=295439" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570982535-f6a58505023fd6b4d2c0c6d32cdbc8e5.png" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_14"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空一年生上学期</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570982535-f43195cd588caa26c296fcc61910b3e6.gif"><br>

<span class="user-info2" id="showface_14">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">55</span><br>
学分: <span class="s2 f9">0 点</span><br>
澄空币: <span class="s3 f9">646 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2009-06-23<br>
		最后登录:2013-01-20 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_4298315" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10930627&amp;pid=4298315&amp;article=14" onclick="return sendurl(this,4,event)" id="quote_4298315" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10930627&amp;pid=4298315&amp;article=14" id="modify_4298315" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=295439" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10930627&amp;pid=4298315" onclick="return sendurl(this,8)" id="report_4298315" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10930627&amp;uid=295439" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('4298315')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_4298315" class="fl">&nbsp;</h1>
			

			<div id="p_4298315" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_4298315">感谢大大发教程</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_4298315" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2011-07-19 16:24 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 14楼(夏目梓鱼) 的帖子');" data-mx-warn="Empty URL">14 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="4875918" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570982535-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>zb_126</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=682838" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570982535-bc3b3631a24154c2d9ba8189508a5212.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_15"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空新生</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570982535-be59bc9a4edb96b6b54ba67c9267b93f.gif"><br>

<span class="user-info2" id="showface_15">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">5</span><br>
学分: <span class="s2 f9">0 点</span><br>
澄空币: <span class="s3 f9">656 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2011-10-20<br>
		最后登录:2017-01-24 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_4875918" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10930627&amp;pid=4875918&amp;article=15" onclick="return sendurl(this,4,event)" id="quote_4875918" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10930627&amp;pid=4875918&amp;article=15" id="modify_4875918" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=682838" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10930627&amp;pid=4875918" onclick="return sendurl(this,8)" id="report_4875918" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10930627&amp;uid=682838" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('4875918')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_4875918" class="fl">&nbsp;</h1>
			

			<div id="p_4875918" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_4875918">经典的游戏汉化教程！太感谢了！<img src="assets/1570982535-001cd37a87dbb11e6e09f6cc26d8ff24.gif"><img src="assets/1570982535-001cd37a87dbb11e6e09f6cc26d8ff24.gif"><img src="assets/1570982535-001cd37a87dbb11e6e09f6cc26d8ff24.gif"></div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_4875918" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2012-05-28 19:59 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 15楼(zb_126) 的帖子');" data-mx-warn="Empty URL">15 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="5193168" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570982535-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>zb_126</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=682838" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570982535-bc3b3631a24154c2d9ba8189508a5212.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_16"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空新生</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570982535-be59bc9a4edb96b6b54ba67c9267b93f.gif"><br>

<span class="user-info2" id="showface_16">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">5</span><br>
学分: <span class="s2 f9">0 点</span><br>
澄空币: <span class="s3 f9">656 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2011-10-20<br>
		最后登录:2017-01-24 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_5193168" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10930627&amp;pid=5193168&amp;article=16" onclick="return sendurl(this,4,event)" id="quote_5193168" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10930627&amp;pid=5193168&amp;article=16" id="modify_5193168" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=682838" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10930627&amp;pid=5193168" onclick="return sendurl(this,8)" id="report_5193168" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10930627&amp;uid=682838" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('5193168')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_5193168" class="fl">&nbsp;</h1>
			

			<div id="p_5193168" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_5193168">字库分析完全不知道怎么分析的，谁能说的在详细一点呢！</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_5193168" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2012-07-26 19:40 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 16楼(zb_126) 的帖子');" data-mx-warn="Empty URL">16 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="5389519" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570982535-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>zb_126</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=682838" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570982535-bc3b3631a24154c2d9ba8189508a5212.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_17"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空新生</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570982535-be59bc9a4edb96b6b54ba67c9267b93f.gif"><br>

<span class="user-info2" id="showface_17">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">5</span><br>
学分: <span class="s2 f9">0 点</span><br>
澄空币: <span class="s3 f9">656 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2011-10-20<br>
		最后登录:2017-01-24 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_5389519" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10930627&amp;pid=5389519&amp;article=17" onclick="return sendurl(this,4,event)" id="quote_5389519" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10930627&amp;pid=5389519&amp;article=17" id="modify_5389519" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=682838" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10930627&amp;pid=5389519" onclick="return sendurl(this,8)" id="report_5389519" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10930627&amp;uid=682838" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('5389519')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_5389519" class="fl">&nbsp;</h1>
			

			<div id="p_5389519" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_5389519">继续来看看，其他都看的明白了，一直卡在字库，谁能说得再具体一点啊！</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_5389519" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2012-09-16 22:27 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 17楼(zb_126) 的帖子');" data-mx-warn="Empty URL">17 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="a" data-mx-warn="Empty URL"></a><a name="5949957" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570982535-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>heqingran</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=976636" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570982535-bc3b3631a24154c2d9ba8189508a5212.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_18"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">新注册会员</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570982535-be59bc9a4edb96b6b54ba67c9267b93f.gif"><br>

<span class="user-info2" id="showface_18">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">2</span><br>
学分: <span class="s2 f9">0 点</span><br>
澄空币: <span class="s3 f9">556 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2014-06-16<br>
		最后登录:2015-01-03 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_5949957" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10930627&amp;pid=5949957&amp;article=18" onclick="return sendurl(this,4,event)" id="quote_5949957" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10930627&amp;pid=5949957&amp;article=18" id="modify_5949957" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=976636" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10930627&amp;pid=5949957" onclick="return sendurl(this,8)" id="report_5949957" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10930627&amp;uid=976636" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('5949957')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_5949957" class="fl">&nbsp;</h1>
			

			<div id="p_5949957" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_5949957">从贴吧，转移到这个帖子的，<br>感谢分享经验，我也希望我可以学会拆包和封包。</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_5949957" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2014-06-17 19:11 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 18楼(heqingran) 的帖子');" data-mx-warn="Empty URL">18 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

</form>
<div class="t3" style="margin:initial"><table cellspacing="0" cellpadding="0" width="100%" align="center">
	<tbody><tr><td align="left"></td>
		<td valign="center" align="right">
		<a class="abtn f_two" id="readlog" onclick="sendmsg('pw_ajax.php?action=readlog','',this.id);" data-mx-warn="Empty URL">帖子浏览记录<img src="assets/1570982535-5c8e409588b73ce4284cf5b9bd619e15.gif"></a>
		<select onchange="Fjump(this.options[this.selectedIndex].value)"><option value="" selected="">快速跳至</option>
<option value="1">&gt;&gt; 『澄空学园 办公楼区』</option>
<option value="2"> &nbsp;|- 【校园公告栏】</option>
<option value="5"> &nbsp;|- 【论坛意见箱】</option>
<option value="113">&gt;&gt; 『澄空学园 资讯社』</option>
<option value="47"> &nbsp;|- 【新鲜速报】</option>
<option value="103"> &nbsp;|- 【新作介绍】</option>
<option value="8"> &nbsp; &nbsp;|-  【电子杂志下载区】</option>
<option value="104"> &nbsp;|- 【杂志专题】</option>
<option value="7">&gt;&gt; 『澄空学园 教学楼区』</option>
<option value="62"> &nbsp;|- 【AGE主题学部】</option>
<option value="39"> &nbsp;|- 【Akabeesoft2主题学部】</option>
<option value="100"> &nbsp;|- 【AUGUST主题学部】</option>
<option value="42"> &nbsp;|- 【CIRCUS主题学部】</option>
<option value="40"> &nbsp;|- 【Cotton-Nekoneko主题学部】</option>
<option value="64"> &nbsp;|- 【GIGA主题学部】</option>
<option value="38"> &nbsp;|- 【Key主题学部】</option>
<option value="10"> &nbsp;|- 【KID主题学部】</option>
<option value="37"> &nbsp;|- 【Leaf主题学部】</option>
<option value="70"> &nbsp;|- 【minori主题学部】</option>
<option value="12"> &nbsp;|- 【Navel主题学部】</option>
<option value="65"> &nbsp;|- 【Nitro+主题学部】</option>
<option value="14"> &nbsp;|- 【Type-Moon应援会】</option>
<option value="17"> &nbsp; &nbsp;|-  【TM精华区】</option>
<option value="98"> &nbsp;|- 【Will主题学部】</option>
<option value="116"> &nbsp;|- 【FAVORITE主题学部】</option>
<option value="108"> &nbsp;|- 【ALcot主题学部】</option>
<option value="55"> &nbsp;|- 【GALGAME综合作品讨论室】</option>
<option value="97"> &nbsp; &nbsp;|-  【Light主题学部】</option>
<option value="117"> &nbsp; &nbsp;|-  【CUFFS主题学部】</option>
<option value="15"> &nbsp; &nbsp;|-  【Liar Soft主题学部】</option>
<option value="57"> &nbsp; &nbsp;|-  【Purple 主题学部】</option>
<option value="13"> &nbsp; &nbsp;|-  【工画堂主题学部】</option>
<option value="35"> &nbsp;|- 【GALGAME综合杂谈室】</option>
<option value="99"> &nbsp;|- 【ぱれっと主题学部】</option>
<option value="122"> &nbsp;|- 【SAGA PLANETS研讨室】</option>
<option value="123"> &nbsp;|- 【Lump of Sugar 研讨室】</option>
<option value="86">&gt;&gt; 『澄空学园 图书馆』</option>
<option value="80"> &nbsp;|- 【游戏鉴赏室】</option>
<option value="56"> &nbsp;|- 【GALGAME攻略馆】</option>
<option value="115"> &nbsp;|- 【作品出处问询室】</option>
<option value="63"> &nbsp;|- 【Galgame疑问求助室】</option>
<option value="18">&gt;&gt; 『澄空学园 教辅楼区』</option>
<option value="73"> &nbsp;|- 【同人游戏区】</option>
<option value="60"> &nbsp;|- 【二次元轻小说社】</option>
<option value="20"> &nbsp;|- 【日语自学教室】</option>
<option value="61"> &nbsp; &nbsp;|-  【日语学习资料区】</option>
<option value="118"> &nbsp; &nbsp;|-  【日语参考文章区】</option>
<option value="21"> &nbsp;|- 【一般游戏社团】</option>
<option value="24"> &nbsp;|- 【多媒体课堂】</option>
<option value="88">&gt;&gt; 『澄空学园 原创综合区』</option>
<option value="79"> &nbsp;|- 【原创游戏部】</option>
<option value="36"> &nbsp; &nbsp;|-  【ss-square】</option>
<option value="89"> &nbsp;|- 【MAD研究室】</option>
<option value="91"> &nbsp;|- 【莉可屋 REC ROOM】</option>
<option value="119"> &nbsp; &nbsp;|-  【澄空百合社翻唱作品】</option>
<option value="19"> &nbsp;|- 【澄空文学部】</option>
<option value="120"> &nbsp; &nbsp;|-  【落日余晖】</option>
<option value="23"> &nbsp;|- 【绘画工房】</option>
<option value="69"> &nbsp;|- 【活动投票区】</option>
<option value="74"> &nbsp;|- 【友谊赛投票区】</option>
<option value="58"> &nbsp;|- 【澄空部活室】</option>
<option value="41"> &nbsp;|- 【暑假原创作品活动专区】</option>
<option value="59"> &nbsp;|- 【实物周边交流区】</option>
<option value="85"> &nbsp; &nbsp;|-  【ComicMarket相关资料】</option>
<option value="82"> &nbsp; &nbsp;|-  【新品介绍】</option>
<option value="84"> &nbsp; &nbsp;|-  【综合交流】</option>
<option value="83"> &nbsp; &nbsp;|-  【好物收集】</option>
<option value="81"> &nbsp; &nbsp;|-  【交易求购】</option>
<option value="95"> &nbsp;|- 【澄空放送部】</option>
<option value="111"> &nbsp; &nbsp;|-  【放送策划室】</option>
<option value="27"> &nbsp;|- 【水下乐园LeMU】</option>
<option value="46"> &nbsp; &nbsp;|-  【美工作品收藏室】</option>
<option value="26"> &nbsp; &nbsp;|-  【COS自爆馆】</option>
<option value="90"> &nbsp; &nbsp;|-  【澄空期刊室】</option>
<option value="71"> &nbsp;|- 【澄空演剧部】</option>
<option value="9"> &nbsp; &nbsp;|-  演剧部排练室</option>
<option value="52"> &nbsp;|- 【废帖回收站】</option>
<option value="29">&gt;&gt; 『澄空学园 好物交流站』</option>
<option value="50"> &nbsp;|- 【澄空学园字幕作品】</option>
<option value="51"> &nbsp;|- 【澄空学园漫画作品】</option>
<option value="77"> &nbsp;|- 【游戏汉化交流区】</option>
<option value="28"> &nbsp; &nbsp;|-  【CK-GAL中文化小组】</option>
<option value="106"> &nbsp; &nbsp;|-  【PRO2】</option>
<option value="49"> &nbsp; &nbsp;|-      【桜】</option>
<option value="30"> &nbsp;|- 【资源求助区】</option>
<option value="32"> &nbsp;|- 【澄空音乐厅】</option>
<option value="33"> &nbsp;|- 【澄空美术馆】</option>
<option value="34"> &nbsp;|- 【动漫租售屋】</option>
<option value="44">&gt;&gt; 『澄空学园 课余工作区』</option>
<option value="45"> &nbsp;|- 【澄空漫画汉化组】</option>
<option value="48"> &nbsp;|-  【澄空学园字幕组】</option>
<option value="101"> &nbsp; &nbsp;|-  字幕组资料区</option>
<option value="72"> &nbsp;|- 【澄空学园分流组】</option>
<option value="87"> &nbsp;|- 【澄空学园新闻组】</option>
<option value="96"> &nbsp;|- 【澄空学园文学社】</option>
<option value="75"> &nbsp;|- 【澄空学园百合社】</option>
<option value="112"> &nbsp;|- 【澄空学园编辑部】</option>
<option value="114"> &nbsp;|- 【澄空学园美工部】</option>
<option value="121"> &nbsp;|-  【澄空祭运行委员会】</option>
</select></td>
		
	</tr>
	<tr><td style="padding-top: 12px;text-align: left;"><img src="assets/1570982535-ca4a91079181c2a5cb3514b2e5b5f035.gif" align="absbottom"> <b><a href="https://bbs.sumisora.net/index.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">『澄空学园』</a> » <a href="https://bbs.sumisora.net/thread.php?fid=78&amp;page=2" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">【汉化破解研讨室】</a></b> </td>
	<td style="padding-top: 12px;text-align: right;"><a href="https://bbs.sumisora.net/post.php?action=reply&amp;fid=78&amp;tid=10930627" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img src="assets/1570982535-132cb83b134d7ecd9b390389d489bc43.png"></a>

<a href="https://bbs.sumisora.net/post.php?fid=78" style="margin-left:.5em" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img src="assets/1570982535-8cab7ee31ae503cf78e5410d40cec291.png" id="td_post1"></a>
</td>
	</tr>
</tbody></table></div>




<form name="FORM" method="post" action="post.php?" enctype="multipart/form-data" onsubmit="return checkpost(document.FORM);">
<div class="t" style="margin-top:8px"><table cellspacing="0" cellpadding="0" align="center" width="100%">
	<tbody><tr>
		<td class="h" colspan="3"><b>快速发帖</b></td>
	</tr>
	<tr></tr>
	<tr class="tr2"><td colspan="100" style="border-bottom: 0px; --darkreader-inline-border-bottom: initial;" data-darkreader-inline-border-bottom=""></td></tr>
	<tr>
		<td valign="top" width="20%" class="f_one" style="padding:7px">
		<fieldset id="smiliebox" style="border: 1px solid rgb(213, 229, 232); --darkreader-inline-border-top:#354e51; --darkreader-inline-border-right:#354e51; --darkreader-inline-border-bottom:#354e51; --darkreader-inline-border-left:#354e51;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
		<legend>内容</legend>
		<br>
		<input type="checkbox" name="atc_usesign" value="1" checked="">使用签名<br>
		<input type="checkbox" name="atc_convert" value="1" checked="">Wind Code自动转换 <br>
	 	<input type="checkbox" id="atc_autoimg" name="atc_autoimg" value="1" onchange="onAutoImgchange()" checked="" title="此设置会记在浏览器中"><label for="atc_autoimg" title="此设置会记在浏览器中">自动分析img</label><br><br>
	 	
		<input type="checkbox" name="atc_requiresell" value="1" disabled="">出售此帖
		<input class="input" type="text" maxlength="3" size="3" name="atc_money" value="0">
		<br>
		<input type="checkbox" name="atc_requirervrc" value="1">加密此帖
		<input class="input" type="text" maxlength="6" size="3" name="atc_rvrc" value="0">
		<br>
		<br><br><a href="https://bbs.sumisora.net/read.php?tid=10925672" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">如何在帖子中贴图？</a>
		<br><a href="https://bbs.sumisora.net/read.php?tid=10942243" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Wind Code使用教程</a>
		<br><a href="https://bbs.sumisora.net/yume/recover/" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">恢复帖子内容</a>
		</fieldset>
		</td>
		<td width="60%" class="f_one" style="padding:7px">
		<div>


<blockquote style="width: 96%;" class="blockquote">澄空娘：『在手机上使用受姬版可以节省流量
』</blockquote>

		<input type="text" class="input" name="atc_title" value="Re:To Heart PSE资源提取及程序分析" size="65">
		

		 认证码: <input class="input" type="text" name="gdcode" size="5" tabindex="6" onfocus="try{opencode('menu_gd',this)}catch(e){}"><br>
		

		</div><div style="padding:.3em 0">
		</div>
		<textarea onkeydown="quickpost(event)" id="atc_content" name="atc_content" rows="8" style="width:96%"></textarea>
		
		
		
		
		
		<div style="margin:5px 0">
		<div style="padding: 4px 10px 0px 0px; float: left; color: rgb(136, 136, 136); --darkreader-inline-color:#bfb9ac;" data-darkreader-inline-color="">按 Ctrl+Enter 直接提交</div>
		<input class="btn" type="submit" name="Submit" value=" 提 交 "></div>
		</td>
		<td width="20%" class="f_one">
		<div style="padding:3px; text-align:center; width:200px;">
		<fieldset id="smiliebox" style="border: 1px solid rgb(213, 229, 232); --darkreader-inline-border-top:#354e51; --darkreader-inline-border-right:#354e51; --darkreader-inline-border-bottom:#354e51; --darkreader-inline-border-left:#354e51;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<legend>表情</legend>
			<div id="menu_show"></div>
<span style="float:right; margin:3px 10px 5px;"><a id="td_face" style="cursor:pointer;" onclick="showDefault();" align="absmiddle" unselectable="on" data-mx-warn="Empty URL">[更多]</a></span>
<span style="float:left; margin:3px 10px 5px;"><a id="td_generalface" style="cursor:pointer;" onclick="showfaces();$('#td_generalface').fadeOut();" align="absmiddle" data-mx-warn="Empty URL">[显示表情]</a></span>
		</fieldset></div>
		
		
		</td>
	</tr>
</tbody></table></div></form>







</div>
<div id="bottom"></div><br>
<center class="gray">
<small><span id="windspend">Total 0.079545(s) query 6, Time is now 10-13 23:49, 
Load is low.
</span> <br>
Powered by <a href="http://www.phpwind.net/" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><b>PHPWind</b></a> <a href="http://www.phpwind.net/" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><b style="color: rgb(255, 153, 0); --darkreader-inline-color:#f7b24b;" data-darkreader-inline-color="">v6.3.2</b></a> Code © 2003-08 <a href="http://www.phpwind.com/" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><b>PHPWind.com</b></a> Corporation</small>
</center><br>
<div id="footer">
	<span class="f12 fl"></span><a href="https://bbs.sumisora.net/sendmail.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Contact us</a>

</div>
</div>
        
      </div>
    </body>
  </html>