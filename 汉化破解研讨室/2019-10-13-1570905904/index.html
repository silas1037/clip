
  <!DOCTYPE html>
  <html id="" class="">
    <!-- OriginalSrc: https://bbs.sumisora.net/read.php?tid=11010868&fpage=5 -->
    <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />

      <title>明日の君と逢うために分析|【汉化破解研讨室】|【游戏汉化交流区】 - 『澄空学园』 GalGame专题网</title>
      

<link rel="stylesheet" type="text/css" href="assets/1570905904-5f21d2d0f0e14c54e3e080ff47c8ec08.css" referrerpolicy="no-referrer">
<link type="text/css" href="assets/1570905904-2f10d407050ab6b2185fb483267feb32.css" rel="stylesheet" referrerpolicy="no-referrer">
<link href="assets/1570905904-6ea61090578ddc8e91dc9b26707cebc8.css" rel="stylesheet" type="text/css" referrerpolicy="no-referrer">
<link rel="stylesheet" type="text/css" href="assets/1570905904-46d427da9cafb653c4ed606490c99b3a.css" referrerpolicy="no-referrer">


<style class="darkreader darkreader--fallback" media="screen"></style>
<style class="darkreader darkreader--text" media="screen"></style>
<style class="darkreader darkreader--invert" media="screen"></style>
<style class="darkreader darkreader--inline" media="screen">[data-darkreader-inline-bgcolor] {
  background-color: var(--darkreader-inline-bgcolor) !important;
}
[data-darkreader-inline-bgimage] {
  background-image: var(--darkreader-inline-bgimage) !important;
}
[data-darkreader-inline-border] {
  border-color: var(--darkreader-inline-border) !important;
}
[data-darkreader-inline-border-bottom] {
  border-bottom-color: var(--darkreader-inline-border-bottom) !important;
}
[data-darkreader-inline-border-left] {
  border-left-color: var(--darkreader-inline-border-left) !important;
}
[data-darkreader-inline-border-right] {
  border-right-color: var(--darkreader-inline-border-right) !important;
}
[data-darkreader-inline-border-top] {
  border-top-color: var(--darkreader-inline-border-top) !important;
}
[data-darkreader-inline-boxshadow] {
  box-shadow: var(--darkreader-inline-boxshadow) !important;
}
[data-darkreader-inline-color] {
  color: var(--darkreader-inline-color) !important;
}
[data-darkreader-inline-fill] {
  fill: var(--darkreader-inline-fill) !important;
}
[data-darkreader-inline-stroke] {
  stroke: var(--darkreader-inline-stroke) !important;
}
[data-darkreader-inline-outline] {
  outline-color: var(--darkreader-inline-outline) !important;
}</style>
<style class="darkreader darkreader--user-agent" media="screen">html {
    background-color: #191a1b !important;
}
html, body, input, textarea, select, button {
    background-color: #191a1b;
}
html, body, input, textarea, select, button {
    border-color: #5a5956;
    color: #f0ebe2;
}
a {
    color: #4791e7;
}
table {
    border-color: #4f4e4c;
}
::placeholder {
    color: #bfb9ac;
}
::selection {
    background-color: #125cb4;
    color: #fffffd;
}
::-moz-selection {
    background-color: #125cb4;
    color: #fffffd;
}
input:-webkit-autofill,
textarea:-webkit-autofill,
select:-webkit-autofill {
    background-color: #565a0f !important;
    color: #f0ebe2 !important;
}
::-webkit-scrollbar {
    background-color: #1d1f1f;
    color: #cbc5b9;
}
::-webkit-scrollbar-thumb {
    background-color: #2c2d2d;
}
::-webkit-scrollbar-thumb:hover {
    background-color: #343636;
}
::-webkit-scrollbar-thumb:active {
    background-color: #404142;
}
::-webkit-scrollbar-corner {
    background-color: #191a1b;
}
* {
    scrollbar-color: #2c2d2d #1d1f1f;
}</style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style type="text/css"> 
.tr3 td,.tr3 th{border-right:1px solid #D5E5E8;}
.y-style{text-align:center;}
.tr1 th{border-right:1px solid #D5E5E8;}
.tr1 td.td1{border-left:0}
 

.signature img { max-height:250px !important; }
</style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style class="darkreader darkreader--override" media="screen">.jfk-bubble {
    background-color: #000000 !important;
}
.vimvixen-hint {
    background-color: #765500 !important;
    border-color: #d5b22e !important;
    color: #f9edcc !important;
}</style>
<style type="text/css">@keyframes fadeInOpacity{0%{opacity:0}to{opacity:1}}:hover>*>.fbvd--wrapper{animation-name:fadeInOpacity;animation-duration:.3s;opacity:1}.fbvd--wrapper{position:absolute;top:10px;left:10px;opacity:0;text-align:center;margin:0;z-index:5}.fbvd--wrapper a{background: url("") no-repeat 3px 4.55px; background-color: #fff; display:inline-block;font:700 14px Helvetica,Arial,sans-serif;color:#4b4f56;text-decoration:none;vertical-align:middle;padding:0px 8px 0px;margin-right:8px;border-radius:2px; line-height: 22px; padding-left:19px; border: 1px solid #e7e7e7; background-size: 13px}.fbvd--wrapper a:last-child{margin-right:0}.fbvd--wrapper a:hover{text-decoration:none}.fbvd--wrapper a:focus{box-shadow:0 0 1px 2px rgba(88,144,255,.75),0 1px 1px rgba(0,0,0,.15);outline:none}.fbvd--wrapper b{font-size:13px;position:relative;top:1px;color:#3b5998;font-weight:400}</style>
<style class="darkreader darkreader--sync" media="screen"></style>

      <style class="mx-wc-style">
        .mx-wc-main img {max-width: 100%;}
        .mx-wc-main{
          box-sizing: content-box;
          background-color: rgb(25, 26, 27) !important;
          margin: 0 auto;
          margin-top: 20px;
          max-width: 1349px;
        }
        @media (min-width: 768px) {
          .mx-wc-main { padding: 15px 15px 80px 15px }
        }
        @media (max-width: 767px) {
          .mx-wc-main { padding: 15px 3px 80px 3px }
        }
  
      </style>
    </head>
    <body style="background-color: #ffffff !important; min-height: 100%; height: auto; position: static !important; overflow: auto !important; padding-bottom: 0px !important;" id="" class="">
      <div class="mx-wc-main">
        <div id="wrapA" class="mx-wc-selected-elem mx-wc-1570905904" style="display: block; float: none !important; position: relative !important; top: 0px !important; left: 0px !important; margin: 0px !important; flex: unset !important; width: 100% !important; max-width: 100% !important; box-sizing: border-box !important;">

<div id="header">
<div class="toptool tar">	<span>
	<a href="https://bbs.sumisora.net/read.php?tid=11010868&amp;fpage=5&amp;skinco=simple" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">手机版</a>

	| <a style="cursor:pointer;" id="td_skin" data-mx-warn="Empty URL">风格切换<img src="assets/1570905904-5c8e409588b73ce4284cf5b9bd619e15.gif"></a>
	| <a href="https://bbs.sumisora.net/read.php?tid=10894912" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">学生手册</a>
	</span>
</div>
<table cellspacing="0" cellpadding="0" align="center" width="100%">
<tbody><tr>
	<td class="banner"><a href="https://bbs.sumisora.net/" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img id="forumlogo" src="assets/1570905904-7ac78a0e1e3ce795251288b0c8bd4b1b.png"></a></td>
	<td class="banner" id="banner" align="right"></td>
</tr>
<tr><td align="center" height="1" colspan="2"></td></tr>
</tbody></table>
<div id="h_guide" class="guide" colspan="2"><span class="s3">»</span>

	<span style="font-weight:bold" class="s3">silasu</span>&nbsp;<a href="https://bbs.sumisora.net/login.php?action=quit&amp;verify=034be2bd" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">退出</a> |
	<a id="td_profile" href="https://bbs.sumisora.net/profile.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">控制面板</a>
	| <a id="td_msg" href="https://bbs.sumisora.net/message.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">

	短消息</a>

	| <a id="td_sort" href="https://bbs.sumisora.net/sort.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">统计排行</a>

	| <a href="https://bbs.sumisora.net/member.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">会员</a>

	| <a href="https://bbs.sumisora.net/search.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">搜索</a>
	| <a style="cursor:pointer;" id="td_hack" data-mx-warn="Empty URL">社区服务<img src="assets/1570905904-5c8e409588b73ce4284cf5b9bd619e15.gif"></a>

	| <a href="https://bbs.sumisora.net/hack.php?H_name=galgamevote" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">GALGAME角色人气投票活动</a>

 | <a href="https://bbs.sumisora.net/yume/polls/" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">近期关注</a><!--[if lte IE 6]>
 | <a href="read.php?tid=10955539" style="color:red">本站已停止支持IE6，请升级或更换浏览器</a>
<![endif]-->
</div>



</div>
<div id="main">




<div class="t3" style="margin-top:8px"><table width="100%" cellspacing="0" cellpadding="0" align="center">
	<tbody><tr><td class="b"><img src="assets/1570905904-ca4a91079181c2a5cb3514b2e5b5f035.gif" align="absmiddle"> <a href="https://bbs.sumisora.net/index.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">『澄空学园』</a> » <a href="https://bbs.sumisora.net/thread.php?fid=77" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">【游戏汉化交流区】</a> » <a href="https://bbs.sumisora.net/thread.php?fid=78&amp;page=5" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">【汉化破解研讨室】</a> » <a href="https://bbs.sumisora.net/read.php?tid=11010868" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">明日の君と逢うために分析</a> <a href="https://bbs.sumisora.net/rss.php?tid=11010868" target="_blank" title="Rss订阅本帖最新内容" referrerpolicy="no-referrer" rel="noopener noreferrer"><img align="absmiddle" src="assets/1570905904-b4369735f1bfb33ab69477230a8ba635.png"></a></td></tr>
</tbody></table></div>

<!--ads begin-->

<!--ads end-->
<div class="t3"><table width="100%" align="center" cellspacing="0" cellpadding="0">
	<tbody><tr><td align="left"><div class="fl"></div></td><td align="right" style="padding-bottom:.2em"><a href="https://bbs.sumisora.net/post.php?action=reply&amp;fid=78&amp;tid=11010868" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img src="assets/1570905904-132cb83b134d7ecd9b390389d489bc43.png"></a>

<a href="https://bbs.sumisora.net/post.php?fid=78" style="margin-left:.5em" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img src="assets/1570905904-8cab7ee31ae503cf78e5410d40cec291.png" id="td_post"></a>

</td></tr>
</tbody></table></div>



<form name="delatc" method="post">


<div class="t" style="margin-bottom: 0px; border-bottom: 0px; --darkreader-inline-border-bottom: initial;" data-darkreader-inline-border-bottom=""><table cellspacing="0" cellpadding="0" width="100%">
	<tbody><tr><th class="h"><strong class="fl w"><b>本页主题:</b> 明日の君と逢うために分析</strong>
	<span class="fr w"><a data-mx-warn="Empty URL">&nbsp;</a><a href="https://bbs.sumisora.net/job.php?action=previous&amp;fid=78&amp;tid=11010868&amp;fpage=5&amp;goto=previous" class="fn" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">上一主题</a> | <a href="https://bbs.sumisora.net/job.php?action=previous&amp;fid=78&amp;tid=11010868&amp;fpage=5&amp;goto=next" class="fn" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">下一主题</a> | <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span> </th>
	</tr>
	<tr><td></td></tr>
	<tr class="tr2"><td colspan="2" class="tar">

		<a id="usetool" style="cursor:pointer" onclick="sendmsg('pw_ajax.php?action=usetool','',this.id)" data-mx-warn="Empty URL">[使用道具]</a>

		<br></td>
	</tr>
	<tr><td></td></tr>
</tbody></table></div>

<a name="tpc" data-mx-warn="Empty URL"></a>
<div class="t t2" style="border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top=""><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570905904-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>clowwindy</b>
<div style="margin:.3em 0 .4em .2em">绊</div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=139948" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570905904-4935856da31d5e163a1f3b6c1a3e6f55.jpg" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_0"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空の贵宾</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570905904-87bc1a6e935264a57e50e0d513f23aa7.gif"><br>

<span class="user-info2" id="showface_0">
<span class="user-infoWrap2">


精华:

		<a href="https://bbs.sumisora.net/search.php?authorid=139948&amp;digest=1" target="_blank" class="s4 f9" referrerpolicy="no-referrer" rel="noopener noreferrer">1</a>
<br>
发帖: <span class="s1 f9">4467</span><br>
学分: <span class="s2 f9">439 点</span><br>
澄空币: <span class="s3 f9">1601 KID</span><br>

		GPA: <span class="s2 f9">1 点</span><br>

		<span class="gray">注册时间:2007-09-10<br>
		最后登录:2017-12-27 <br><br> 
		<img src="assets/1570905904-fc551661c6b14e66c09220c9e87cd6cd.png" title="星空的记忆EH汉化纪念勋章"> <img src="assets/1570905904-2b7944623c26c12d2fd8f65e65d66f7a.gif" title="Favorite学部勋章"> <br></span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_tpc" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=11010868&amp;pid=tpc&amp;article=0" onclick="return sendurl(this,4,event)" id="quote_tpc" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=11010868&amp;pid=tpc&amp;article=0" id="modify_tpc" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=139948" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=11010868&amp;pid=tpc" onclick="return sendurl(this,8)" id="report_tpc" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=11010868&amp;uid=139948" title="只看楼主的所有帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('tpc')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_tpc" class="fl">&nbsp;明日の君と逢うために分析</h1>
			

			<div id="p_tpc" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_tpc">游戏资源用了cpz3封包，脚本则是ps2格式。文件头和内容经过了加密，ps2的内容经过了压缩。<br><br>首先看script.cpz，在CreateFileA下个断点一路跟下去，直到这段：<br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code1'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code1" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="pun">;</span><span class="lit">0</span><span class="pun">,</span><span class="lit">4</span><span class="pun">,</span><span class="pln">C</span><span class="pun">处分别与</span><span class="lit">5E9C4F37</span><span class="pun">，</span><span class="pln">F32AED17</span><span class="pun">，</span><span class="pln">DDDDDDDD</span><span class="pun">异或</span><span class="pln">

</span><span class="lit">0043978E</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">817424</span><span class="pln"> </span><span class="lit">10</span><span class="pln"> </span><span class="lit">374F</span><span class="pun">&gt;</span><span class="pln">XOR DWORD PTR SS</span><span class="pun">:[</span><span class="pln">ESP</span><span class="pun">+</span><span class="lit">10</span><span class="pun">],</span><span class="lit">5E9C4F37</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;deal </span><span class="kwd">with</span><span class="pln"> cpz3 header
</span><span class="lit">00439796</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">817424</span><span class="pln"> </span><span class="lit">14</span><span class="pln"> </span><span class="lit">17ED</span><span class="pun">&gt;</span><span class="pln">XOR DWORD PTR SS</span><span class="pun">:[</span><span class="pln">ESP</span><span class="pun">+</span><span class="lit">14</span><span class="pun">],</span><span class="pln">F32AED17
</span><span class="lit">0043979E</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">817424</span><span class="pln"> </span><span class="lit">1C</span><span class="pln"> DDDD</span><span class="pun">&gt;</span><span class="pln">XOR DWORD PTR SS</span><span class="pun">:[</span><span class="pln">ESP</span><span class="pun">+</span><span class="lit">1C</span><span class="pun">],</span><span class="pln">DDDDDDDD

</span><span class="pun">;第二项是索引大小</span><span class="pln">
</span><span class="pun">;这里是</span><span class="pln">AC </span><span class="lit">27</span><span class="pln">

</span><span class="lit">00439814</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">8B7C24</span><span class="pln"> </span><span class="lit">18</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOV EDI</span><span class="pun">,</span><span class="pln">DWORD PTR SS</span><span class="pun">:[</span><span class="pln">ESP</span><span class="pun">+</span><span class="lit">18</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;size of index
</span><span class="lit">00439818</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">83C7</span><span class="pln"> </span><span class="lit">14</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADD EDI</span><span class="pun">,</span><span class="lit">14</span><span class="pln">
</span><span class="lit">0043981B</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">57</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH EDI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="str">/Size
0043981C&nbsp;&nbsp; . 6A 00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PUSH 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; |Flags = LMEM_FIXED
0043981E&nbsp;&nbsp; . FFD5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CALL EBP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; \LocalAlloc

;cpz3 header索引项的0x14和C7F5DA63 XOR后得到一个MASK
00439A90&nbsp;&nbsp; . E8 D5C10A00&nbsp;&nbsp;&nbsp;&nbsp;CALL cmvs.004E5C6A
00439A95&nbsp;&nbsp; &gt; 8B4E 14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOV ECX,DWORD PTR DS:[ESI+14]
00439A98&nbsp;&nbsp; . 81F1 63DAF5C7&nbsp;&nbsp;XOR ECX,C7F5DA63
00439A9E&nbsp;&nbsp; . 51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH ECX
00439A9F&nbsp;&nbsp; . 53&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH EBX
00439AA0&nbsp;&nbsp; . 57&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH EDI
00439AA1&nbsp;&nbsp; . 8BCD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV ECX,EBP
00439AA3&nbsp;&nbsp; . E8 E8FAFFFF&nbsp;&nbsp;&nbsp;&nbsp;CALL cmvs.00439590

;计算密钥
004395AA&nbsp;&nbsp;|. 8D9B 00000000&nbsp;&nbsp;LEA EBX,DWORD PTR DS:[EBX]
004395B0&nbsp;&nbsp;|&gt; 8B3E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /</span><span class="pln">MOV EDI</span><span class="pun">,</span><span class="pln">DWORD PTR DS</span><span class="pun">:[</span><span class="pln">ESI</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;</span><span class="typ">CalculateKey</span><span class="pln">
</span><span class="lit">004395B2</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">03F9</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">ADD EDI</span><span class="pun">,</span><span class="pln">ECX
</span><span class="lit">004395B4</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">893C95</span><span class="pln"> A07A530</span><span class="pun">&gt;|</span><span class="pln">MOV DWORD PTR DS</span><span class="pun">:[</span><span class="pln">EDX</span><span class="pun">*</span><span class="lit">4</span><span class="pun">+</span><span class="lit">537AA0</span><span class="pun">],</span><span class="pln">EDI
</span><span class="lit">004395BB</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">83C2</span><span class="pln"> </span><span class="lit">01</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">|</span><span class="pln">ADD EDX</span><span class="pun">,</span><span class="lit">1</span><span class="pln">
</span><span class="lit">004395BE</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">83C6</span><span class="pln"> </span><span class="lit">04</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">|</span><span class="pln">ADD ESI</span><span class="pun">,</span><span class="lit">4</span><span class="pln">
</span><span class="lit">004395C1</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">3BD0</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">CMP EDX</span><span class="pun">,</span><span class="pln">EAX
</span><span class="lit">004395C3</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.^</span><span class="lit">72</span><span class="pln"> EB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\JB SHORT cmvs</span><span class="pun">.</span><span class="lit">004395B0</span><span class="pln">


</span><span class="pun">;计算后面解密时</span><span class="pln">ROL</span><span class="pun">的</span><span class="pln">CL
</span><span class="lit">004395C5</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|&gt;</span><span class="pln"> </span><span class="lit">8BC1</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV EAX</span><span class="pun">,</span><span class="pln">ECX
</span><span class="lit">004395C7</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> C1E8 </span><span class="lit">04</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHR EAX</span><span class="pun">,</span><span class="lit">4</span><span class="pln">
</span><span class="lit">004395CA</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">33C1</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; XOR EAX</span><span class="pun">,</span><span class="pln">ECX
</span><span class="lit">004395CC</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> C1E8 </span><span class="lit">04</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHR EAX</span><span class="pun">,</span><span class="lit">4</span><span class="pln">
</span><span class="lit">004395CF</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">33C1</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; XOR EAX</span><span class="pun">,</span><span class="pln">ECX
</span><span class="lit">004395D1</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> C1E8 </span><span class="lit">04</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHR EAX</span><span class="pun">,</span><span class="lit">4</span><span class="pln">
</span><span class="lit">004395D4</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">33C1</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; XOR EAX</span><span class="pun">,</span><span class="pln">ECX
</span><span class="lit">004395D6</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> C1E8 </span><span class="lit">04</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHR EAX</span><span class="pun">,</span><span class="lit">4</span><span class="pln">
</span><span class="lit">004395D9</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">8B5424</span><span class="pln"> </span><span class="lit">0C</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOV EDX</span><span class="pun">,</span><span class="pln">DWORD PTR SS</span><span class="pun">:[</span><span class="pln">ESP</span><span class="pun">+</span><span class="pln">C</span><span class="pun">]</span><span class="pln">
</span><span class="lit">004395DD</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">33C1</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; XOR EAX</span><span class="pun">,</span><span class="pln">ECX
</span><span class="lit">004395DF</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> C1E8 </span><span class="lit">04</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHR EAX</span><span class="pun">,</span><span class="lit">4</span><span class="pln">
</span><span class="lit">004395E2</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">33C1</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; XOR EAX</span><span class="pun">,</span><span class="pln">ECX
</span><span class="lit">004395E4</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> C1E8 </span><span class="lit">04</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHR EAX</span><span class="pun">,</span><span class="lit">4</span><span class="pln">
</span><span class="lit">004395E7</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">33C1</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; XOR EAX</span><span class="pun">,</span><span class="pln">ECX
</span><span class="lit">004395E9</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> C1E8 </span><span class="lit">04</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHR EAX</span><span class="pun">,</span><span class="lit">4</span><span class="pln">
</span><span class="lit">004395EC</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">33C1</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; XOR EAX</span><span class="pun">,</span><span class="pln">ECX
</span><span class="lit">004395EE</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">83F0</span><span class="pln"> FD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;XOR EAX</span><span class="pun">,</span><span class="pln">FFFFFFFD
</span><span class="lit">004395F1</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">53</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH EBX
</span><span class="lit">004395F2</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">8B5C24</span><span class="pln"> </span><span class="lit">14</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOV EBX</span><span class="pun">,</span><span class="pln">DWORD PTR SS</span><span class="pun">:[</span><span class="pln">ESP</span><span class="pun">+</span><span class="lit">14</span><span class="pun">]</span><span class="pln">
</span><span class="lit">004395F6</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">83E0</span><span class="pln"> </span><span class="lit">0F</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND EAX</span><span class="pun">,</span><span class="lit">0F</span><span class="pln">
</span><span class="lit">004395F9</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">8BFB</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV EDI</span><span class="pun">,</span><span class="pln">EBX
</span><span class="lit">004395FB</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">83C0</span><span class="pln"> </span><span class="lit">08</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADD EAX</span><span class="pun">,</span><span class="lit">8</span><span class="pln">



</span><span class="pun">;解密：</span><span class="pln">
</span><span class="lit">00439610</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|&gt;</span><span class="pln"> </span><span class="lit">8B2CB5</span><span class="pln"> A07A530</span><span class="pun">&gt;</span><span class="str">/MOV EBP,DWORD PTR DS:[ESI*4+537AA0]&nbsp;&nbsp;&nbsp;&nbsp; ;&nbsp;&nbsp;Decrypt
00439617&nbsp;&nbsp;|. 332A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |XOR EBP,DWORD PTR DS:[EDX]
00439619&nbsp;&nbsp;|. 8AC8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |MOV CL,AL
0043961B&nbsp;&nbsp;|. 81C5 C2A5586E&nbsp;&nbsp;|ADD EBP,6E58A5C2
00439621&nbsp;&nbsp;|. D3C5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |ROL EBP,CL
00439623&nbsp;&nbsp;|. 83C6 01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|ADD ESI,1
00439626&nbsp;&nbsp;|. 83C2 04&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|ADD EDX,4
00439629&nbsp;&nbsp;|. 83E6 0F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|AND ESI,0F
0043962C&nbsp;&nbsp;|. 83EF 01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|SUB EDI,1
0043962F&nbsp;&nbsp;|. 896A FC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|MOV DWORD PTR DS:[EDX-4],EBP
00439632&nbsp;&nbsp;|.^75 DC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\JNZ SHORT cmvs.00439610
00439634&nbsp;&nbsp;|. 5D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; POP EBP
00439635&nbsp;&nbsp;|&gt; 8BFB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV EDI,EBX
00439637&nbsp;&nbsp;|. 83E7 03&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND EDI,3
0043963A&nbsp;&nbsp;|. 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; POP EBX
0043963B&nbsp;&nbsp;|. 74 29&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JE SHORT cmvs.00439666
0043963D&nbsp;&nbsp;|. 8D49 00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEA ECX,DWORD PTR DS:[ECX]
00439640&nbsp;&nbsp;|&gt; 8B04B5 A07A530&gt;/</span><span class="pln">MOV EAX</span><span class="pun">,</span><span class="pln">DWORD PTR DS</span><span class="pun">:[</span><span class="pln">ESI</span><span class="pun">*</span><span class="lit">4</span><span class="pun">+</span><span class="lit">537AA0</span><span class="pun">]</span><span class="pln">
</span><span class="lit">00439647</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">8D0CBD</span><span class="pln"> </span><span class="lit">0000000</span><span class="pun">&gt;|</span><span class="pln">LEA ECX</span><span class="pun">,</span><span class="pln">DWORD PTR DS</span><span class="pun">:[</span><span class="pln">EDI</span><span class="pun">*</span><span class="lit">4</span><span class="pun">]</span><span class="pln">
</span><span class="lit">0043964E</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> D3E8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">SHR EAX</span><span class="pun">,</span><span class="pln">CL
</span><span class="lit">00439650</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">83C6</span><span class="pln"> </span><span class="lit">01</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">|</span><span class="pln">ADD ESI</span><span class="pun">,</span><span class="lit">1</span><span class="pln">
</span><span class="lit">00439653</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">83C2</span><span class="pln"> </span><span class="lit">01</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">|</span><span class="pln">ADD EDX</span><span class="pun">,</span><span class="lit">1</span><span class="pln">
</span><span class="lit">00439656</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">83E6</span><span class="pln"> </span><span class="lit">0F</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">|</span><span class="pln">AND ESI</span><span class="pun">,</span><span class="lit">0F</span><span class="pln">
</span><span class="lit">00439659</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">3242</span><span class="pln"> FF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">|</span><span class="pln">XOR AL</span><span class="pun">,</span><span class="pln">BYTE PTR DS</span><span class="pun">:[</span><span class="pln">EDX</span><span class="pun">-</span><span class="lit">1</span><span class="pun">]</span><span class="pln">
</span><span class="lit">0043965C</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">04</span><span class="pln"> </span><span class="lit">52</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">|</span><span class="pln">ADD AL</span><span class="pun">,</span><span class="lit">52</span><span class="pln">
</span><span class="lit">0043965E</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">83EF</span><span class="pln"> </span><span class="lit">01</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">|</span><span class="pln">SUB EDI</span><span class="pun">,</span><span class="lit">1</span><span class="pln">
</span><span class="lit">00439661</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">8842</span><span class="pln"> FF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">|</span><span class="pln">MOV BYTE PTR DS</span><span class="pun">:[</span><span class="pln">EDX</span><span class="pun">-</span><span class="lit">1</span><span class="pun">],</span><span class="pln">AL
</span><span class="lit">00439664</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.^</span><span class="lit">75</span><span class="pln"> DA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\JNZ SHORT cmvs</span><span class="pun">.</span><span class="lit">00439640</span></pre><br><br>看看解密以后的索引部分是什么样：<br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code2'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code2" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="pun">;解密后，一个索引项：</span><span class="pln">
</span><span class="typ">Offset</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="lit">0</span><span class="pln">&nbsp;&nbsp;</span><span class="lit">1</span><span class="pln">&nbsp;&nbsp;</span><span class="lit">2</span><span class="pln">&nbsp;&nbsp;</span><span class="lit">3</span><span class="pln">&nbsp;&nbsp;</span><span class="lit">4</span><span class="pln">&nbsp;&nbsp;</span><span class="lit">5</span><span class="pln">&nbsp;&nbsp;</span><span class="lit">6</span><span class="pln">&nbsp;&nbsp;</span><span class="lit">7</span><span class="pln">&nbsp;&nbsp; </span><span class="lit">8</span><span class="pln">&nbsp;&nbsp;</span><span class="lit">9</span><span class="pln">&nbsp;&nbsp;A&nbsp;&nbsp;B&nbsp;&nbsp;C&nbsp;&nbsp;D&nbsp;&nbsp;E&nbsp;&nbsp;F

</span><span class="lit">00000010</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="lit">24</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp;&nbsp;D4 A6 </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $</span><span class="pun">...驭......</span><span class="pln">
</span><span class="lit">00000020</span><span class="pln">&nbsp;&nbsp; </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">74</span><span class="pln"> D8 D0 </span><span class="lit">6B</span><span class="pln">&nbsp;&nbsp;</span><span class="lit">2A</span><span class="pln"> CD D6 AE </span><span class="lit">73</span><span class="pln"> </span><span class="lit">6E</span><span class="pln"> </span><span class="lit">73</span><span class="pln"> </span><span class="lit">79</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">....</span><span class="pln">t</span><span class="pun">匦</span><span class="pln">k</span><span class="pun">*椭畇</span><span class="pln">nsy
</span><span class="lit">00000030</span><span class="pln">&nbsp;&nbsp; </span><span class="lit">31</span><span class="pln"> </span><span class="lit">34</span><span class="pln"> </span><span class="lit">2E</span><span class="pln"> </span><span class="lit">70</span><span class="pln"> </span><span class="lit">73</span><span class="pln"> </span><span class="lit">32</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="lit">14.ps2.</span><span class="pun">.</span><span class="pln">

</span><span class="typ">Offset</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="lit">0</span><span class="pln">&nbsp;&nbsp;</span><span class="lit">1</span><span class="pln">&nbsp;&nbsp;</span><span class="lit">2</span><span class="pln">&nbsp;&nbsp;</span><span class="lit">3</span><span class="pln">&nbsp;&nbsp;</span><span class="lit">4</span><span class="pln">&nbsp;&nbsp;</span><span class="lit">5</span><span class="pln">&nbsp;&nbsp;</span><span class="lit">6</span><span class="pln">&nbsp;&nbsp;</span><span class="lit">7</span><span class="pln">&nbsp;&nbsp; </span><span class="lit">8</span><span class="pln">&nbsp;&nbsp;</span><span class="lit">9</span><span class="pln">&nbsp;&nbsp;A&nbsp;&nbsp;B&nbsp;&nbsp;C&nbsp;&nbsp;D&nbsp;&nbsp;E&nbsp;&nbsp;F

</span><span class="lit">00000030</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="lit">24</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> CE E4 </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $</span><span class="pun">...武..</span><span class="pln">
</span><span class="lit">00000040</span><span class="pln">&nbsp;&nbsp; D4 A6 </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp;&nbsp;</span><span class="lit">38</span><span class="pln"> </span><span class="lit">2A</span><span class="pln"> </span><span class="lit">56</span><span class="pln"> C4 DF </span><span class="lit">64</span><span class="pln"> F9 </span><span class="lit">95</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">驭......</span><span class="lit">8</span><span class="pun">*</span><span class="pln">V</span><span class="pun">倪</span><span class="pln">d</span><span class="pun">鶗</span><span class="pln">
</span><span class="lit">00000050</span><span class="pln">&nbsp;&nbsp; </span><span class="lit">73</span><span class="pln"> </span><span class="lit">6E</span><span class="pln"> </span><span class="lit">73</span><span class="pln"> </span><span class="lit">79</span><span class="pln"> </span><span class="lit">31</span><span class="pln"> </span><span class="lit">35</span><span class="pln"> </span><span class="lit">61</span><span class="pln"> </span><span class="lit">2E</span><span class="pln">&nbsp;&nbsp;</span><span class="lit">70</span><span class="pln"> </span><span class="lit">73</span><span class="pln"> </span><span class="lit">32</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; snsy15a</span><span class="pun">.</span><span class="pln">ps2</span><span class="pun">.</span><span class="pln">

</span><span class="pun">分析：</span><span class="pln">
</span><span class="lit">0</span><span class="pun">-</span><span class="lit">3</span><span class="pun">:</span><span class="pln">int16</span><span class="pun">是本索引项的长度</span><span class="pln">
</span><span class="lit">4</span><span class="pun">-</span><span class="lit">7</span><span class="pun">:</span><span class="pln">int16</span><span class="pun">是文件长度</span><span class="pln">
</span><span class="lit">8</span><span class="pun">-</span><span class="pln">F</span><span class="pun">:</span><span class="pln">int32</span><span class="pun">是文件偏移</span><span class="pln">
</span><span class="lit">10</span><span class="pun">-</span><span class="lit">13</span><span class="pun">:不明</span><span class="pln">
</span><span class="lit">14</span><span class="pun">-</span><span class="lit">17</span><span class="pun">:</span><span class="pln">mask
</span><span class="pun">后面是文件名，</span><span class="lit">32bit</span><span class="pun">对齐</span></pre><br><br>这样我们就可以把cpz文件解开了。<br>首先是解密函数，代码写得比较土，就是把汇编“直译”了下：<br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code3'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code3" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="kwd">from</span><span class="pln"> </span><span class="kwd">struct</span><span class="pln"> </span><span class="kwd">import</span><span class="pln"> unpack</span><span class="pun">,</span><span class="pln"> pack
</span><span class="kwd">from</span><span class="pln"> array </span><span class="kwd">import</span><span class="pln"> array
&nbsp;&nbsp;&nbsp;&nbsp;
originalKey </span><span class="pun">=</span><span class="pln"> array</span><span class="pun">(</span><span class="str">'B'</span><span class="pun">)</span><span class="pln">
originalKeyTuple </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="lit">0x5E</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0x4A</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0x0D</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0x4D</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0xE1</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0xF3</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0xAB</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0xB3</span><span class="pln"> </span><span class="pun">,</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="lit">0x6D</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0x33</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0x37</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0x3C</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0xF3</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0xF5</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0xC3</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0x86</span><span class="pun">,</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="lit">0x89</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0x9B</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0x4F</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0x7D</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0x11</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0xDE</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0xD7</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0x58</span><span class="pln"> </span><span class="pun">,</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="lit">0x8D</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0x77</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0x67</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0x63</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0x29</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0x46</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0xF3</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0xA5</span><span class="pln"> </span><span class="pun">,</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="lit">0xB5</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0xA4</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0x7F</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0x06</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0x42</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0xE7</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0x0A</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0xED</span><span class="pln"> </span><span class="pun">,</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="lit">0xCC</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0x50</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0x94</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0xB1</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0x5A</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0x4A</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0x20</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0xE7</span><span class="pln"> </span><span class="pun">,</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="lit">0xF5</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0x04</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0xAF</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0xD9</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0x7F</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0x68</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0x3B</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0x5D</span><span class="pln"> </span><span class="pun">,</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="lit">0xFD</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0xA6</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0xC7</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0xC1</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0x89</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0x22</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0x50</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> </span><span class="lit">0xFC</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">for</span><span class="pln"> </span><span class="kwd">byte</span><span class="pln"> </span><span class="kwd">in</span><span class="pln"> originalKeyTuple</span><span class="pun">:</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;originalKey</span><span class="pun">.</span><span class="pln">append</span><span class="pun">(</span><span class="kwd">byte</span><span class="pun">)</span><span class="pln">
</span><span class="kwd">del</span><span class="pln"> originalKeyTuple

</span><span class="kwd">def</span><span class="pln"> decrypt</span><span class="pun">(</span><span class="pln">buf</span><span class="pun">,</span><span class="pln"> offset</span><span class="pun">,</span><span class="pln"> length</span><span class="pun">,</span><span class="pln"> delta</span><span class="pun">,</span><span class="pln"> keyMask</span><span class="pun">):</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;key </span><span class="pun">=</span><span class="pln"> array</span><span class="pun">(</span><span class="str">'B'</span><span class="pun">)</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;padding </span><span class="pun">=</span><span class="pln"> length </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">0x03</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">16</span><span class="pun">):</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp </span><span class="pun">=</span><span class="pln"> unpack</span><span class="pun">(</span><span class="str">'L'</span><span class="pun">,</span><span class="pln"> originalKey</span><span class="pun">[</span><span class="pln">i </span><span class="pun">*</span><span class="pln"> </span><span class="lit">4</span><span class="pun">:</span><span class="pln">i </span><span class="pun">*</span><span class="pln"> </span><span class="lit">4</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">4</span><span class="pun">])[</span><span class="lit">0</span><span class="pun">]</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">tmp </span><span class="pun">+</span><span class="pln"> keyMask</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">0xFFFFFFFF</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;key</span><span class="pun">.</span><span class="pln">fromstring</span><span class="pun">(</span><span class="pln">array</span><span class="pun">(</span><span class="str">'B'</span><span class="pun">,</span><span class="pln"> pack</span><span class="pun">(</span><span class="str">'L'</span><span class="pun">,</span><span class="pln"> tmp</span><span class="pun">)).</span><span class="pln">tostring</span><span class="pun">())</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;eax </span><span class="pun">=</span><span class="pln"> keyMask
&nbsp;&nbsp;&nbsp;&nbsp;eax </span><span class="pun">=</span><span class="pln"> eax </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">4</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;eax </span><span class="pun">=</span><span class="pln"> eax </span><span class="pun">^</span><span class="pln"> keyMask
&nbsp;&nbsp;&nbsp;&nbsp;eax </span><span class="pun">=</span><span class="pln"> eax </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">4</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;eax </span><span class="pun">=</span><span class="pln"> eax </span><span class="pun">^</span><span class="pln"> keyMask
&nbsp;&nbsp;&nbsp;&nbsp;eax </span><span class="pun">=</span><span class="pln"> eax </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">4</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;eax </span><span class="pun">=</span><span class="pln"> eax </span><span class="pun">^</span><span class="pln"> keyMask
&nbsp;&nbsp;&nbsp;&nbsp;eax </span><span class="pun">=</span><span class="pln"> eax </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">4</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;eax </span><span class="pun">=</span><span class="pln"> eax </span><span class="pun">^</span><span class="pln"> keyMask
&nbsp;&nbsp;&nbsp;&nbsp;eax </span><span class="pun">=</span><span class="pln"> eax </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">4</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;eax </span><span class="pun">=</span><span class="pln"> eax </span><span class="pun">^</span><span class="pln"> keyMask
&nbsp;&nbsp;&nbsp;&nbsp;eax </span><span class="pun">=</span><span class="pln"> eax </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">4</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;eax </span><span class="pun">=</span><span class="pln"> eax </span><span class="pun">^</span><span class="pln"> keyMask
&nbsp;&nbsp;&nbsp;&nbsp;eax </span><span class="pun">=</span><span class="pln"> eax </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">4</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;eax </span><span class="pun">=</span><span class="pln"> eax </span><span class="pun">^</span><span class="pln"> keyMask
&nbsp;&nbsp;&nbsp;&nbsp;eax </span><span class="pun">=</span><span class="pln"> eax </span><span class="pun">^</span><span class="pln"> </span><span class="lit">0xFFFFFFFD</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;eax </span><span class="pun">=</span><span class="pln"> eax </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">0x0F</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;rolcl </span><span class="pun">=</span><span class="pln"> eax </span><span class="pun">+</span><span class="pln"> </span><span class="lit">8</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;i </span><span class="pun">=</span><span class="pln"> offset
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">while</span><span class="pun">(</span><span class="lit">1</span><span class="pun">):</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keyIndex </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> delta</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">0x3F</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ebp </span><span class="pun">=</span><span class="pln"> unpack</span><span class="pun">(</span><span class="str">'L'</span><span class="pun">,</span><span class="pln"> buf</span><span class="pun">[</span><span class="pln">i</span><span class="pun">:</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">4</span><span class="pun">])[</span><span class="lit">0</span><span class="pun">]</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ebp </span><span class="pun">=</span><span class="pln"> ebp </span><span class="pun">^</span><span class="pln"> unpack</span><span class="pun">(</span><span class="str">'L'</span><span class="pun">,</span><span class="pln"> key</span><span class="pun">[</span><span class="pln">keyIndex</span><span class="pun">:</span><span class="pln">keyIndex </span><span class="pun">+</span><span class="pln"> </span><span class="lit">4</span><span class="pun">])[</span><span class="lit">0</span><span class="pun">]</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ebp </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">0x6E58A5C2</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ebp </span><span class="pun">=</span><span class="pln"> ebp </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">0xFFFFFFFF</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ebp </span><span class="pun">=</span><span class="pln"> rol32</span><span class="pun">(</span><span class="pln">ebp</span><span class="pun">,</span><span class="pln"> rolcl</span><span class="pun">)</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf</span><span class="pun">[</span><span class="pln">i</span><span class="pun">:</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">4</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> array</span><span class="pun">(</span><span class="str">'B'</span><span class="pun">,</span><span class="pln"> pack</span><span class="pun">(</span><span class="str">'L'</span><span class="pun">,</span><span class="pln"> ebp</span><span class="pun">))</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i </span><span class="pun">=</span><span class="pln"> i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">4</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> i </span><span class="pun">&gt;=</span><span class="pln"> length </span><span class="pun">-</span><span class="pln"> </span><span class="lit">3</span><span class="pun">:</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">break</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">#处理尾部</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;j </span><span class="pun">=</span><span class="pln"> i
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">while</span><span class="pln"> padding </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">:</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keyIndex </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">j </span><span class="pun">+</span><span class="pln"> delta</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">0x3F</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eax </span><span class="pun">=</span><span class="pln"> unpack</span><span class="pun">(</span><span class="str">'L'</span><span class="pun">,</span><span class="pln"> key</span><span class="pun">[</span><span class="pln">keyIndex</span><span class="pun">:</span><span class="pln">keyIndex </span><span class="pun">+</span><span class="pln"> </span><span class="lit">4</span><span class="pun">])[</span><span class="lit">0</span><span class="pun">]</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ecx </span><span class="pun">=</span><span class="pln"> padding </span><span class="pun">*</span><span class="pln"> </span><span class="lit">4</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eax </span><span class="pun">=</span><span class="pln"> eax </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ecx </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">0x0f</span><span class="pun">)</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j </span><span class="pun">=</span><span class="pln"> j </span><span class="pun">+</span><span class="pln"> </span><span class="lit">4</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i </span><span class="pun">=</span><span class="pln"> i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;al </span><span class="pun">=</span><span class="pln"> eax </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">0x0ff</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;al </span><span class="pun">=</span><span class="pln"> al </span><span class="pun">^</span><span class="pln"> buf</span><span class="pun">[</span><span class="pln">i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;al </span><span class="pun">=</span><span class="pln"> al </span><span class="pun">+</span><span class="pln"> </span><span class="lit">0x52</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;al </span><span class="pun">=</span><span class="pln"> al </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">0x0ff</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;padding </span><span class="pun">=</span><span class="pln"> padding </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf</span><span class="pun">[</span><span class="pln">i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> al</span></pre><br>然后是解包<br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code4'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code4" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="kwd">from</span><span class="pln"> </span><span class="kwd">struct</span><span class="pln"> </span><span class="kwd">import</span><span class="pln"> unpack</span><span class="pun">,</span><span class="pln"> pack
</span><span class="kwd">from</span><span class="pln"> array </span><span class="kwd">import</span><span class="pln"> array
</span><span class="kwd">from</span><span class="pln"> decrypt </span><span class="kwd">import</span><span class="pln"> decrypt</span><span class="pun">,</span><span class="pln"> decryptPs2</span><span class="pun">,</span><span class="pln"> decryptPb3
</span><span class="kwd">from</span><span class="pln"> lzss </span><span class="kwd">import</span><span class="pln"> decode

cpzFilename </span><span class="pun">=</span><span class="pln"> ur</span><span class="str">"D:\eroge\明日の君と逢うために\data\pack\script.cpz"</span><span class="pln">
newFilename </span><span class="pun">=</span><span class="pln"> ur</span><span class="str">"D:\eroge\明日の君と逢うために\data\pack\script2.header"</span><span class="pln">
outputFolder </span><span class="pun">=</span><span class="pln"> ur</span><span class="str">"D:\eroge\明日の君と逢うために\data\pack\script2\\"</span><span class="pln">

</span><span class="com">#解密文件头</span><span class="pln">
</span><span class="kwd">with</span><span class="pln"> open</span><span class="pun">(</span><span class="pln">cpzFilename</span><span class="pun">,</span><span class="pln"> </span><span class="str">'rb'</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">as</span><span class="pln"> cpz</span><span class="pun">:</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;header </span><span class="pun">=</span><span class="pln"> array</span><span class="pun">(</span><span class="str">'B'</span><span class="pun">)</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;header</span><span class="pun">.</span><span class="pln">fromfile</span><span class="pun">(</span><span class="pln">cpz</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0x18</span><span class="pun">)</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;indexCount </span><span class="pun">=</span><span class="pln"> unpack</span><span class="pun">(</span><span class="str">'L'</span><span class="pun">,</span><span class="pln"> header</span><span class="pun">[</span><span class="lit">4</span><span class="pun">:</span><span class="lit">8</span><span class="pun">])[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">^</span><span class="pln"> </span><span class="lit">0x5E9C4F37</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;header</span><span class="pun">[</span><span class="lit">4</span><span class="pun">:</span><span class="lit">8</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> array</span><span class="pun">(</span><span class="str">'B'</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> pack</span><span class="pun">(</span><span class="str">'L'</span><span class="pun">,</span><span class="pln"> indexCount</span><span class="pun">))</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;indexLength </span><span class="pun">=</span><span class="pln"> unpack</span><span class="pun">(</span><span class="str">'L'</span><span class="pun">,</span><span class="pln"> header</span><span class="pun">[</span><span class="lit">0x8</span><span class="pun">:</span><span class="lit">0xC</span><span class="pun">])[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">^</span><span class="pln"> </span><span class="lit">0xF32AED17</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;header</span><span class="pun">[</span><span class="lit">0x8</span><span class="pun">:</span><span class="lit">0xC</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> array</span><span class="pun">(</span><span class="str">'B'</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> pack</span><span class="pun">(</span><span class="str">'L'</span><span class="pun">,</span><span class="pln"> indexLength</span><span class="pun">))</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;keyMask </span><span class="pun">=</span><span class="pln"> unpack</span><span class="pun">(</span><span class="str">'L'</span><span class="pun">,</span><span class="pln"> header</span><span class="pun">[</span><span class="lit">0x10</span><span class="pun">:</span><span class="lit">0x14</span><span class="pun">])[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">^</span><span class="pln"> </span><span class="lit">0xDDDDDDDD</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;header</span><span class="pun">[</span><span class="lit">0x10</span><span class="pun">:</span><span class="lit">0x14</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> array</span><span class="pun">(</span><span class="str">'B'</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> pack</span><span class="pun">(</span><span class="str">'L'</span><span class="pun">,</span><span class="pln"> keyMask</span><span class="pun">))</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class="kwd">with</span><span class="pln"> open</span><span class="pun">(</span><span class="pln">cpzFilename</span><span class="pun">,</span><span class="pln"> </span><span class="str">'rb'</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">as</span><span class="pln"> cpz</span><span class="pun">:</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;fullHeader </span><span class="pun">=</span><span class="pln"> array</span><span class="pun">(</span><span class="str">'B'</span><span class="pun">)</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;fullHeader</span><span class="pun">.</span><span class="pln">fromfile</span><span class="pun">(</span><span class="pln">cpz</span><span class="pun">,</span><span class="pln"> indexLength </span><span class="pun">+</span><span class="pln"> </span><span class="lit">4</span><span class="pun">)</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;fullHeader</span><span class="pun">[</span><span class="lit">4</span><span class="pun">:</span><span class="lit">8</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> array</span><span class="pun">(</span><span class="str">'B'</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> pack</span><span class="pun">(</span><span class="str">'L'</span><span class="pun">,</span><span class="pln"> indexCount</span><span class="pun">))</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;fullHeader</span><span class="pun">[</span><span class="lit">0x8</span><span class="pun">:</span><span class="lit">0xC</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> array</span><span class="pun">(</span><span class="str">'B'</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> pack</span><span class="pun">(</span><span class="str">'L'</span><span class="pun">,</span><span class="pln"> indexLength</span><span class="pun">))</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;fullHeader</span><span class="pun">[</span><span class="lit">0x10</span><span class="pun">:</span><span class="lit">0x14</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> array</span><span class="pun">(</span><span class="str">'B'</span><span class="pln"> </span><span class="pun">,</span><span class="pln"> pack</span><span class="pun">(</span><span class="str">'L'</span><span class="pun">,</span><span class="pln"> keyMask</span><span class="pun">))</span><span class="pln">

keyMask </span><span class="pun">=</span><span class="pln"> keyMask </span><span class="pun">^</span><span class="pln"> </span><span class="lit">0x7BF4A539</span><span class="pln">
</span><span class="com">#解密index</span><span class="pln">
delta </span><span class="pun">=</span><span class="pln"> </span><span class="lit">12</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">20</span><span class="pln">

decrypt</span><span class="pun">(</span><span class="pln">fullHeader</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0x14</span><span class="pun">,</span><span class="pln"> indexLength </span><span class="pun">+</span><span class="pln"> </span><span class="lit">4</span><span class="pun">,</span><span class="pln"> delta</span><span class="pun">,</span><span class="pln"> keyMask</span><span class="pun">)</span><span class="pln">

</span><span class="com">#循环提取文件</span><span class="pln">

i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
pos </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0x14</span><span class="pln">
</span><span class="kwd">while</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> indexCount</span><span class="pun">:</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;itemIndexLength </span><span class="pun">=</span><span class="pln"> unpack</span><span class="pun">(</span><span class="str">'L'</span><span class="pun">,</span><span class="pln"> fullHeader</span><span class="pun">[</span><span class="pln">pos</span><span class="pun">:</span><span class="pln">pos </span><span class="pun">+</span><span class="pln"> </span><span class="lit">4</span><span class="pun">])[</span><span class="lit">0</span><span class="pun">]</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;itemLength </span><span class="pun">=</span><span class="pln"> unpack</span><span class="pun">(</span><span class="str">'L'</span><span class="pun">,</span><span class="pln"> fullHeader</span><span class="pun">[</span><span class="pln">pos </span><span class="pun">+</span><span class="pln"> </span><span class="lit">4</span><span class="pun">:</span><span class="pln">pos </span><span class="pun">+</span><span class="pln"> </span><span class="lit">8</span><span class="pun">])[</span><span class="lit">0</span><span class="pun">]</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;itemOffset </span><span class="pun">=</span><span class="pln"> unpack</span><span class="pun">(</span><span class="str">'L'</span><span class="pun">,</span><span class="pln"> fullHeader</span><span class="pun">[</span><span class="pln">pos </span><span class="pun">+</span><span class="pln"> </span><span class="lit">8</span><span class="pun">:</span><span class="pln">pos </span><span class="pun">+</span><span class="pln"> </span><span class="lit">0x0C</span><span class="pun">])[</span><span class="lit">0</span><span class="pun">]</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;itemFilename </span><span class="pun">=</span><span class="pln"> fullHeader</span><span class="pun">[</span><span class="pln">pos </span><span class="pun">+</span><span class="pln"> </span><span class="lit">0x18</span><span class="pun">:</span><span class="pln">pos </span><span class="pun">+</span><span class="pln"> itemIndexLength</span><span class="pun">].</span><span class="pln">tostring</span><span class="pun">().</span><span class="pln">strip</span><span class="pun">(</span><span class="str">'\0'</span><span class="pun">)</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;itemKeyMask </span><span class="pun">=</span><span class="pln"> unpack</span><span class="pun">(</span><span class="str">'L'</span><span class="pun">,</span><span class="pln"> fullHeader</span><span class="pun">[</span><span class="pln">pos </span><span class="pun">+</span><span class="pln"> </span><span class="lit">0x14</span><span class="pun">:</span><span class="pln">pos </span><span class="pun">+</span><span class="pln"> </span><span class="lit">0x18</span><span class="pun">])[</span><span class="lit">0</span><span class="pun">]</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;itemKeyMask </span><span class="pun">=</span><span class="pln"> itemKeyMask </span><span class="pun">^</span><span class="pln"> </span><span class="lit">0xC7F5DA63</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">with</span><span class="pln"> open</span><span class="pun">(</span><span class="pln">cpzFilename</span><span class="pun">,</span><span class="pln"> </span><span class="str">'rb'</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">as</span><span class="pln"> cpz</span><span class="pun">:</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cpz</span><span class="pun">.</span><span class="pln">seek</span><span class="pun">(</span><span class="pln">itemOffset </span><span class="pun">+</span><span class="pln"> indexLength </span><span class="pun">+</span><span class="pln"> </span><span class="lit">0x14</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item </span><span class="pun">=</span><span class="pln"> array</span><span class="pun">(</span><span class="str">'B'</span><span class="pun">)</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item</span><span class="pun">.</span><span class="pln">fromfile</span><span class="pun">(</span><span class="pln">cpz</span><span class="pun">,</span><span class="pln"> itemLength</span><span class="pun">)</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">#item = cpz.read(itemLength)</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decrypt</span><span class="pun">(</span><span class="pln">item</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> itemLength</span><span class="pun">,</span><span class="pln"> </span><span class="lit">12</span><span class="pun">,</span><span class="pln"> itemKeyMask</span><span class="pun">)</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">with</span><span class="pln"> open</span><span class="pun">(</span><span class="pln">outputFolder </span><span class="pun">+</span><span class="pln"> itemFilename</span><span class="pun">,</span><span class="pln"> </span><span class="str">'wb'</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">as</span><span class="pln"> outputFile</span><span class="pun">:</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">#TODO: 再解密&amp;解压ps2</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;pos </span><span class="pun">+=</span><span class="pln"> itemIndexLength
&nbsp;&nbsp;&nbsp;&nbsp;i </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span></pre><br>接下来是解开的ps2文件，继续分析：<br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code5'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code5" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="typ">Offset</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="lit">0</span><span class="pln">&nbsp;&nbsp;</span><span class="lit">1</span><span class="pln">&nbsp;&nbsp;</span><span class="lit">2</span><span class="pln">&nbsp;&nbsp;</span><span class="lit">3</span><span class="pln">&nbsp;&nbsp;</span><span class="lit">4</span><span class="pln">&nbsp;&nbsp;</span><span class="lit">5</span><span class="pln">&nbsp;&nbsp;</span><span class="lit">6</span><span class="pln">&nbsp;&nbsp;</span><span class="lit">7</span><span class="pln">&nbsp;&nbsp; </span><span class="lit">8</span><span class="pln">&nbsp;&nbsp;</span><span class="lit">9</span><span class="pln">&nbsp;&nbsp;A&nbsp;&nbsp;B&nbsp;&nbsp;C&nbsp;&nbsp;D&nbsp;&nbsp;E&nbsp;&nbsp;F

</span><span class="lit">00000000</span><span class="pln">&nbsp;&nbsp; </span><span class="lit">50</span><span class="pln"> </span><span class="lit">53</span><span class="pln"> </span><span class="lit">32</span><span class="pln"> </span><span class="lit">41</span><span class="pln"> </span><span class="lit">30</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp;&nbsp;CC </span><span class="lit">67</span><span class="pln"> </span><span class="lit">66</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">4E</span><span class="pln"> </span><span class="lit">20</span><span class="pln"> </span><span class="lit">4F</span><span class="pln"> </span><span class="lit">35</span><span class="pln">&nbsp;&nbsp; PS2A0</span><span class="pun">...蘥</span><span class="pln">f</span><span class="pun">.</span><span class="pln">N O5
</span><span class="lit">00000010</span><span class="pln">&nbsp;&nbsp; </span><span class="lit">91</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">9C</span><span class="pln"> </span><span class="lit">43</span><span class="pln"> </span><span class="lit">04</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp;&nbsp;</span><span class="lit">9C</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">77</span><span class="pln"> </span><span class="lit">0F</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">?..淐..?..</span><span class="pln">w</span><span class="pun">...</span><span class="pln">
</span><span class="lit">00000020</span><span class="pln">&nbsp;&nbsp; </span><span class="lit">30</span><span class="pln"> BA </span><span class="lit">01</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> A6 C3 </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp;&nbsp;F3 </span><span class="lit">55</span><span class="pln"> </span><span class="lit">04</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp;&nbsp; </span><span class="lit">0</span><span class="pun">?.γ..骍......</span><span class="pln">

</span><span class="lit">0x04</span><span class="pun">-</span><span class="lit">0x07</span><span class="pun">:文件头长度</span><span class="pln">
</span><span class="lit">0x08</span><span class="pun">-</span><span class="lit">0x0B</span><span class="pun">:解密前的</span><span class="pln">checksum</span><span class="pun">(</span><span class="lit">64bit</span><span class="pun">)</span><span class="pln">
</span><span class="lit">0x0C</span><span class="pun">-</span><span class="lit">0x0F</span><span class="pun">:解密用的</span><span class="pln">key
</span><span class="lit">0x1C</span><span class="pun">-</span><span class="lit">0x1F</span><span class="pun">:解压后尾部的文本长度</span><span class="pln">
</span><span class="lit">0x24</span><span class="pun">-</span><span class="lit">0x27</span><span class="pun">:解压前大小，不包含头</span><span class="pln">
</span><span class="lit">0x28</span><span class="pun">-</span><span class="lit">0x2B</span><span class="pun">:解压后大小，不包含头</span><span class="pln">

</span><span class="lit">0x10</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="lit">4</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">0x04</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">0x10</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">文本开始地址</span><span class="pln">


</span><span class="pun">;计算后面解密用的</span><span class="pln">AL</span><span class="pun">和</span><span class="pln">CL
</span><span class="lit">00439CAE</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|&gt;</span><span class="pln"> </span><span class="lit">8B4D</span><span class="pln"> </span><span class="lit">0C</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOV ECX</span><span class="pun">,[</span><span class="pln">ARG</span><span class="pun">.</span><span class="lit">2</span><span class="pun">]</span><span class="pln">
</span><span class="lit">00439CB1</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">8BC1</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV EAX</span><span class="pun">,</span><span class="pln">ECX
</span><span class="lit">00439CB3</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> C1E8 </span><span class="lit">14</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHR EAX</span><span class="pun">,</span><span class="lit">14</span><span class="pln">
</span><span class="lit">00439CB6</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">33D2</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; XOR EDX</span><span class="pun">,</span><span class="pln">EDX
</span><span class="lit">00439CB8</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> BB </span><span class="lit">05000000</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;MOV EBX</span><span class="pun">,</span><span class="lit">5</span><span class="pln">
</span><span class="lit">00439CBD</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> F7F3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DIV EBX
</span><span class="lit">00439CBF</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">8B7C24</span><span class="pln"> </span><span class="lit">10</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOV EDI</span><span class="pun">,</span><span class="pln">DWORD PTR SS</span><span class="pun">:[</span><span class="pln">ESP</span><span class="pun">+</span><span class="lit">10</span><span class="pun">]</span><span class="pln">
</span><span class="lit">00439CC3</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">8BC1</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV EAX</span><span class="pun">,</span><span class="pln">ECX
</span><span class="lit">00439CC5</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> C1E8 </span><span class="lit">18</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHR EAX</span><span class="pun">,</span><span class="lit">18</span><span class="pln">
</span><span class="lit">00439CC8</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> C1E9 </span><span class="lit">03</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHR ECX</span><span class="pun">,</span><span class="lit">3</span><span class="pln">
</span><span class="lit">00439CCB</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">83C7</span><span class="pln"> D0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADD EDI</span><span class="pun">,-</span><span class="lit">30</span><span class="pln">
</span><span class="lit">00439CCE</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">02C1</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ADD AL</span><span class="pun">,</span><span class="pln">CL
</span><span class="lit">00439CD0</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">8D75</span><span class="pln"> </span><span class="lit">30</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEA ESI</span><span class="pun">,[</span><span class="pln">ARG</span><span class="pun">.</span><span class="lit">11</span><span class="pun">]</span><span class="pln">
</span><span class="lit">00439CD3</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">80C2</span><span class="pln"> </span><span class="lit">01</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADD DL</span><span class="pun">,</span><span class="lit">1</span><span class="pln">
</span><span class="lit">00439CD6</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">85FF</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TEST EDI</span><span class="pun">,</span><span class="pln">EDI
</span><span class="lit">00439CD8</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">76</span><span class="pln"> </span><span class="lit">1C</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JBE SHORT cmvs</span><span class="pun">.</span><span class="lit">00439CF6</span><span class="pln">
</span><span class="lit">00439CDA</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">0FB6CA</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOVZX ECX</span><span class="pun">,</span><span class="pln">DL
</span><span class="lit">00439CDD</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">8D49</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEA ECX</span><span class="pun">,</span><span class="pln">DWORD PTR DS</span><span class="pun">:[</span><span class="pln">ECX</span><span class="pun">]</span><span class="pln">




</span><span class="pun">从</span><span class="lit">0x30</span><span class="pun">开始解密</span><span class="pln">

</span><span class="lit">00439CE0</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|&gt;</span><span class="pln"> </span><span class="lit">8A16</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">/</span><span class="pln">MOV DL</span><span class="pun">,</span><span class="pln">BYTE PTR DS</span><span class="pun">:[</span><span class="pln">ESI</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;start at ps2&nbsp;&nbsp;</span><span class="lit">0x30</span><span class="pln">
</span><span class="lit">00439CE2</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">80EA</span><span class="pln"> </span><span class="lit">7C</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">|</span><span class="pln">SUB DL</span><span class="pun">,</span><span class="lit">7C</span><span class="pln">
</span><span class="lit">00439CE5</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">32D0</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">XOR DL</span><span class="pun">,</span><span class="pln">AL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
</span><span class="lit">00439CE7</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> D2CA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">ROR DL</span><span class="pun">,</span><span class="pln">CL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><span class="lit">00439CE9</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">83EF</span><span class="pln"> </span><span class="lit">01</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">|</span><span class="pln">SUB EDI</span><span class="pun">,</span><span class="lit">1</span><span class="pln">
</span><span class="lit">00439CEC</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">83C6</span><span class="pln"> </span><span class="lit">01</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">|</span><span class="pln">ADD ESI</span><span class="pun">,</span><span class="lit">1</span><span class="pln">
</span><span class="lit">00439CEF</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">85FF</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">TEST EDI</span><span class="pun">,</span><span class="pln">EDI
</span><span class="lit">00439CF1</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">8856</span><span class="pln"> FF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">|</span><span class="pln">MOV BYTE PTR DS</span><span class="pun">:[</span><span class="pln">ESI</span><span class="pun">-</span><span class="lit">1</span><span class="pun">],</span><span class="pln">DL
</span><span class="lit">00439CF4</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.^</span><span class="lit">77</span><span class="pln"> EA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\JA SHORT cmvs</span><span class="pun">.</span><span class="lit">00439CE0</span><span class="pln">


</span><span class="lit">00439D00</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">8B45</span><span class="pln"> </span><span class="lit">28</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOV EAX</span><span class="pun">,</span><span class="pln">DWORD PTR SS</span><span class="pun">:[</span><span class="pln">EBP</span><span class="pun">+</span><span class="lit">28</span><span class="pun">]</span><span class="pln">
</span><span class="lit">00439D03</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">83C0</span><span class="pln"> </span><span class="lit">30</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADD EAX</span><span class="pun">,</span><span class="lit">30</span><span class="pln">
</span><span class="lit">00439D06</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">50</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH EAX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">/</span><span class="typ">Size</span><span class="pln">
</span><span class="lit">00439D07</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">6A</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PUSH </span><span class="lit">0</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="typ">Flags</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> LMEM_FIXED
</span><span class="lit">00439D09</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> FF15 </span><span class="lit">94125000</span><span class="pln">&nbsp;&nbsp;CALL DWORD PTR DS</span><span class="pun">:[&lt;&amp;</span><span class="pln">KERNEL32</span><span class="pun">.</span><span class="typ">LocalAlloc</span><span class="pun">&gt;;</span><span class="pln"> \LocalAlloc


lzss</span><span class="pun">解压</span><span class="pln">
</span><span class="lit">0043CC50</span><span class="pln">&nbsp;&nbsp; $ </span><span class="lit">8B4424</span><span class="pln"> </span><span class="lit">10</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOV EAX</span><span class="pun">,</span><span class="pln">DWORD PTR SS</span><span class="pun">:[</span><span class="pln">ESP</span><span class="pun">+</span><span class="lit">10</span><span class="pun">]</span><span class="pln">
</span><span class="lit">0043CC54</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">53</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH EBX
</span><span class="lit">0043CC55</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">55</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH EBP
</span><span class="lit">0043CC56</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">56</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH ESI
</span><span class="lit">0043CC57</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">8B7424</span><span class="pln"> </span><span class="lit">14</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOV ESI</span><span class="pun">,</span><span class="pln">DWORD PTR SS</span><span class="pun">:[</span><span class="pln">ESP</span><span class="pun">+</span><span class="lit">14</span><span class="pun">]</span><span class="pln">
</span><span class="lit">0043CC5B</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">57</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH EDI
</span><span class="lit">0043CC5C</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">68</span><span class="pln"> DF070000&nbsp;&nbsp;&nbsp;&nbsp;PUSH </span><span class="lit">7DF</span><span class="pln">
</span><span class="lit">0043CC61</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">8D1C06</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LEA EBX</span><span class="pun">,</span><span class="pln">DWORD PTR DS</span><span class="pun">:[</span><span class="pln">ESI</span><span class="pun">+</span><span class="pln">EAX</span><span class="pun">]</span><span class="pln">
</span><span class="lit">0043CC64</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">6A</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PUSH </span><span class="lit">0</span><span class="pln">
</span><span class="lit">0043CC66</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">68</span><span class="pln"> </span><span class="lit">38FB5300</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;PUSH cmvs</span><span class="pun">.</span><span class="lit">0053FB38</span><span class="pln">
</span><span class="lit">0043CC6B</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">895C24</span><span class="pln"> </span><span class="lit">2C</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOV DWORD PTR SS</span><span class="pun">:[</span><span class="pln">ESP</span><span class="pun">+</span><span class="lit">2C</span><span class="pun">],</span><span class="pln">EBX
</span><span class="lit">0043CC6F</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> E8 </span><span class="lit">9C7B0A00</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;CALL cmvs</span><span class="pun">.</span><span class="lit">004E4810</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;empty text_buf
</span><span class="lit">0043CC74</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">8B7C24</span><span class="pln"> </span><span class="lit">20</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOV EDI</span><span class="pun">,</span><span class="pln">DWORD PTR SS</span><span class="pun">:[</span><span class="pln">ESP</span><span class="pun">+</span><span class="lit">20</span><span class="pun">]</span><span class="pln">
</span><span class="lit">0043CC78</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">83C4</span><span class="pln"> </span><span class="lit">0C</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADD ESP</span><span class="pun">,</span><span class="lit">0C</span><span class="pln">
</span><span class="lit">0043CC7B</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> B9 DF070000&nbsp;&nbsp;&nbsp;&nbsp;MOV ECX</span><span class="pun">,</span><span class="lit">7DF</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;r</span><span class="pun">=</span><span class="lit">2015</span><span class="pun">;</span><span class="pln">
</span><span class="lit">0043CC80</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">33D2</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; XOR EDX</span><span class="pun">,</span><span class="pln">EDX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;flags</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="lit">0043CC82</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> EB </span><span class="lit">0C</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JMP SHORT cmvs</span><span class="pun">.</span><span class="lit">0043CC90</span><span class="pln">
</span><span class="lit">0043CC84</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">8B5C24</span><span class="pln"> </span><span class="lit">20</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOV EBX</span><span class="pun">,</span><span class="pln">DWORD PTR SS</span><span class="pun">:[</span><span class="pln">ESP</span><span class="pun">+</span><span class="lit">20</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;</span><span class="kwd">for</span><span class="pun">(;;){</span><span class="pln">
</span><span class="lit">0043CC88</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> EB </span><span class="lit">06</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JMP SHORT cmvs</span><span class="pun">.</span><span class="lit">0043CC90</span><span class="pln">
</span><span class="lit">0043CC8A</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="lit">8D9B</span><span class="pln"> </span><span class="lit">00000000</span><span class="pln">&nbsp;&nbsp;LEA EBX</span><span class="pun">,</span><span class="pln">DWORD PTR DS</span><span class="pun">:[</span><span class="pln">EBX</span><span class="pun">]</span><span class="pln">
</span><span class="lit">0043CC90</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">&gt;</span><span class="pln"> D1EA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SHR EDX</span><span class="pun">,</span><span class="lit">1</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;flags</span><span class="pun">&gt;&gt;=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
</span><span class="lit">0043CC92</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> F7C2 </span><span class="lit">00010000</span><span class="pln">&nbsp;&nbsp;TEST EDX</span><span class="pun">,</span><span class="lit">100</span><span class="pln">
</span><span class="lit">0043CC98</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">895424</span><span class="pln"> </span><span class="lit">18</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOV DWORD PTR SS</span><span class="pun">:[</span><span class="pln">ESP</span><span class="pun">+</span><span class="lit">18</span><span class="pun">],</span><span class="pln">EDX
</span><span class="lit">0043CC9C</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">75</span><span class="pln"> </span><span class="lit">19</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JNZ SHORT cmvs</span><span class="pun">.</span><span class="lit">0043CCB7</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">flags</span><span class="pun">&amp;</span><span class="lit">256</span><span class="pun">==</span><span class="lit">0</span><span class="pun">){</span><span class="pln">
</span><span class="lit">0043CC9E</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">3BF3</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CMP ESI</span><span class="pun">,</span><span class="pln">EBX
</span><span class="lit">0043CCA0</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">0F83</span><span class="pln"> AE000000&nbsp;&nbsp;JNB cmvs</span><span class="pun">.</span><span class="lit">0043CD54</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">EOF</span><span class="pun">)</span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
</span><span class="lit">0043CCA6</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">0FB606</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOVZX EAX</span><span class="pun">,</span><span class="pln">BYTE PTR DS</span><span class="pun">:[</span><span class="pln">ESI</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c</span><span class="pun">=</span><span class="pln">readByte</span><span class="pun">();</span><span class="pln">
</span><span class="lit">0043CCA9</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">83C6</span><span class="pln"> </span><span class="lit">01</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADD ESI</span><span class="pun">,</span><span class="lit">1</span><span class="pln">
</span><span class="lit">0043CCAC</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">0D</span><span class="pln"> </span><span class="lit">00FF0000</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;OR EAX</span><span class="pun">,</span><span class="lit">0FF00</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flags </span><span class="pun">=</span><span class="pln"> c </span><span class="pun">|</span><span class="pln"> </span><span class="lit">0xff00</span><span class="pun">;</span><span class="pln">
</span><span class="lit">0043CCB1</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">894424</span><span class="pln"> </span><span class="lit">18</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOV DWORD PTR SS</span><span class="pun">:[</span><span class="pln">ESP</span><span class="pun">+</span><span class="lit">18</span><span class="pun">],</span><span class="pln">EAX
</span><span class="lit">0043CCB5</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">8BD0</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV EDX</span><span class="pun">,</span><span class="pln">EAX
</span><span class="lit">0043CCB7</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">&gt;</span><span class="pln"> F6C2 </span><span class="lit">01</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEST DL</span><span class="pun">,</span><span class="lit">1</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
</span><span class="lit">0043CCBA</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">74</span><span class="pln"> </span><span class="lit">24</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JE SHORT cmvs</span><span class="pun">.</span><span class="lit">0043CCE0</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">flags </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="lit">0043CCBC</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">3BF3</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CMP ESI</span><span class="pun">,</span><span class="pln">EBX
</span><span class="lit">0043CCBE</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">0F83</span><span class="pln"> </span><span class="lit">90000000</span><span class="pln">&nbsp;&nbsp;JNB cmvs</span><span class="pun">.</span><span class="lit">0043CD54</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">EOF</span><span class="pun">)</span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
</span><span class="lit">0043CCC4</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">0FB606</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOVZX EAX</span><span class="pun">,</span><span class="pln">BYTE PTR DS</span><span class="pun">:[</span><span class="pln">ESI</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c</span><span class="pun">=</span><span class="pln">readByte</span><span class="pun">();</span><span class="pln">
</span><span class="lit">0043CCC7</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">8807</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV BYTE PTR DS</span><span class="pun">:[</span><span class="pln">EDI</span><span class="pun">],</span><span class="pln">AL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output</span><span class="pun">(</span><span class="pln">c</span><span class="pun">);</span><span class="pln">
</span><span class="lit">0043CCC9</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">8881</span><span class="pln"> </span><span class="lit">38FB5300</span><span class="pln">&nbsp;&nbsp;MOV BYTE PTR DS</span><span class="pun">:[</span><span class="pln">ECX</span><span class="pun">+</span><span class="lit">53FB38</span><span class="pun">],</span><span class="pln">AL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text_buf</span><span class="pun">[</span><span class="pln">r</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> c</span><span class="pun">;</span><span class="pln">
</span><span class="lit">0043CCCF</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">83C1</span><span class="pln"> </span><span class="lit">01</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADD ECX</span><span class="pun">,</span><span class="lit">1</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r</span><span class="pun">++;</span><span class="pln">
</span><span class="lit">0043CCD2</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">83C6</span><span class="pln"> </span><span class="lit">01</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADD ESI</span><span class="pun">,</span><span class="lit">1</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i</span><span class="pun">=</span><span class="pln">readByte</span><span class="pun">();</span><span class="pln">
</span><span class="lit">0043CCD5</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">83C7</span><span class="pln"> </span><span class="lit">01</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADD EDI</span><span class="pun">,</span><span class="lit">1</span><span class="pln">
</span><span class="lit">0043CCD8</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">81E1</span><span class="pln"> FF070000&nbsp;&nbsp;AND ECX</span><span class="pun">,</span><span class="lit">7FF</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r </span><span class="pun">&amp;=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">N </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
</span><span class="lit">0043CCDE</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.^</span><span class="pln">EB B0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JMP SHORT cmvs</span><span class="pun">.</span><span class="lit">0043CC90</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="kwd">else</span><span class="pun">{</span><span class="pln">
</span><span class="lit">0043CCE0</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">3BF3</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CMP ESI</span><span class="pun">,</span><span class="pln">EBX
</span><span class="lit">0043CCE2</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">73</span><span class="pln"> </span><span class="lit">70</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JNB SHORT cmvs</span><span class="pun">.</span><span class="lit">0043CD54</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">EOF</span><span class="pun">)</span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
</span><span class="lit">0043CCE4</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">0FB62E</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOVZX EBP</span><span class="pun">,</span><span class="pln">BYTE PTR DS</span><span class="pun">:[</span><span class="pln">ESI</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i</span><span class="pun">=</span><span class="pln">readByte</span><span class="pun">();</span><span class="pln">
</span><span class="lit">0043CCE7</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">83C6</span><span class="pln"> </span><span class="lit">01</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADD ESI</span><span class="pun">,</span><span class="lit">1</span><span class="pln">
</span><span class="lit">0043CCEA</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">3BF3</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CMP ESI</span><span class="pun">,</span><span class="pln">EBX
</span><span class="lit">0043CCEC</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">73</span><span class="pln"> </span><span class="lit">66</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JNB SHORT cmvs</span><span class="pun">.</span><span class="lit">0043CD54</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">EOF</span><span class="pun">)</span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
</span><span class="lit">0043CCEE</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">0FB606</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOVZX EAX</span><span class="pun">,</span><span class="pln">BYTE PTR DS</span><span class="pun">:[</span><span class="pln">ESI</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j</span><span class="pun">=</span><span class="pln">readByte</span><span class="pun">();</span><span class="pln">
</span><span class="lit">0043CCF1</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">8BD8</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV EBX</span><span class="pun">,</span><span class="pln">EAX
</span><span class="lit">0043CCF3</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">81E3</span><span class="pln"> E0000000&nbsp;&nbsp;AND EBX</span><span class="pun">,</span><span class="lit">0E0</span><span class="pln">
</span><span class="lit">0043CCF9</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">03DB</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ADD EBX</span><span class="pun">,</span><span class="pln">EBX
</span><span class="lit">0043CCFB</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">03DB</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ADD EBX</span><span class="pun">,</span><span class="pln">EBX
</span><span class="lit">0043CCFD</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">03DB</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ADD EBX</span><span class="pun">,</span><span class="pln">EBX
</span><span class="lit">0043CCFF</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">83E0</span><span class="pln"> </span><span class="lit">1F</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND EAX</span><span class="pun">,</span><span class="lit">1F</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">j </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">0x1f</span><span class="pun">);</span><span class="pln">
</span><span class="lit">0043CD02</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">0BEB</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OR EBP</span><span class="pun">,</span><span class="pln">EBX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i </span><span class="pun">|=</span><span class="pln"> </span><span class="pun">((</span><span class="pln">j </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">0xe0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">3</span><span class="pun">);</span><span class="pln">
</span><span class="lit">0043CD04</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">83C6</span><span class="pln"> </span><span class="lit">01</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADD ESI</span><span class="pun">,</span><span class="lit">1</span><span class="pln">
</span><span class="lit">0043CD07</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">83C0</span><span class="pln"> </span><span class="lit">01</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADD EAX</span><span class="pun">,</span><span class="lit">1</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j</span><span class="pun">++;</span><span class="pln">
</span><span class="lit">0043CD0A</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">8BD8</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV EBX</span><span class="pun">,</span><span class="pln">EAX
</span><span class="lit">0043CD0C</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> B8 </span><span class="lit">00000000</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;MOV EAX</span><span class="pun">,</span><span class="lit">0</span><span class="pln">
</span><span class="lit">0043CD11</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.^</span><span class="lit">0F88</span><span class="pln"> </span><span class="lit">6DFFFFFF</span><span class="pln">&nbsp;&nbsp;JS cmvs</span><span class="pun">.</span><span class="lit">0043CC84</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pun">(?&lt;</span><span class="lit">0</span><span class="pun">)</span><span class="kwd">goto</span><span class="pln"> </span><span class="pun">?;</span><span class="pln">
</span><span class="lit">0043CD17</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> EB </span><span class="lit">07</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JMP SHORT cmvs</span><span class="pun">.</span><span class="lit">0043CD20</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">for</span><span class="pun">(</span><span class="pln">k</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">k</span><span class="pun">&lt;=</span><span class="pln">j</span><span class="pun">;</span><span class="pln">k</span><span class="pun">++){</span><span class="pln">
</span><span class="lit">0043CD19</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">8DA424</span><span class="pln"> </span><span class="lit">0000000</span><span class="pun">&gt;</span><span class="pln">LEA ESP</span><span class="pun">,</span><span class="pln">DWORD PTR SS</span><span class="pun">:[</span><span class="pln">ESP</span><span class="pun">]</span><span class="pln">
</span><span class="lit">0043CD20</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">8D1428</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LEA EDX</span><span class="pun">,</span><span class="pln">DWORD PTR DS</span><span class="pun">:[</span><span class="pln">EAX</span><span class="pun">+</span><span class="pln">EBP</span><span class="pun">]</span><span class="pln">
</span><span class="lit">0043CD23</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">81E2</span><span class="pln"> FF070000&nbsp;&nbsp;AND EDX</span><span class="pun">,</span><span class="lit">7FF</span><span class="pln">
</span><span class="lit">0043CD29</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">0FB692</span><span class="pln"> </span><span class="lit">38FB530</span><span class="pun">&gt;</span><span class="pln">MOVZX EDX</span><span class="pun">,</span><span class="pln">BYTE PTR DS</span><span class="pun">:[</span><span class="pln">EDX</span><span class="pun">+</span><span class="lit">53FB38</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c </span><span class="pun">=</span><span class="pln"> text_buf</span><span class="pun">[(</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> k</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">2047</span><span class="pun">];</span><span class="pln">
</span><span class="lit">0043CD30</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">8817</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV BYTE PTR DS</span><span class="pun">:[</span><span class="pln">EDI</span><span class="pun">],</span><span class="pln">DL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output</span><span class="pun">(</span><span class="pln">c</span><span class="pun">);</span><span class="pln">
</span><span class="lit">0043CD32</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">8891</span><span class="pln"> </span><span class="lit">38FB5300</span><span class="pln">&nbsp;&nbsp;MOV BYTE PTR DS</span><span class="pun">:[</span><span class="pln">ECX</span><span class="pun">+</span><span class="lit">53FB38</span><span class="pun">],</span><span class="pln">DL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text_buf</span><span class="pun">[</span><span class="pln">r</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> c</span><span class="pun">;</span><span class="pln">
</span><span class="lit">0043CD38</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">83C1</span><span class="pln"> </span><span class="lit">01</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADD ECX</span><span class="pun">,</span><span class="lit">1</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r</span><span class="pun">++;</span><span class="pln">
</span><span class="lit">0043CD3B</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">83C0</span><span class="pln"> </span><span class="lit">01</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADD EAX</span><span class="pun">,</span><span class="lit">1</span><span class="pln">
</span><span class="lit">0043CD3E</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">83C7</span><span class="pln"> </span><span class="lit">01</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADD EDI</span><span class="pun">,</span><span class="lit">1</span><span class="pln">
</span><span class="lit">0043CD41</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">81E1</span><span class="pln"> FF070000&nbsp;&nbsp;AND ECX</span><span class="pun">,</span><span class="lit">7FF</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r </span><span class="pun">&amp;=</span><span class="pln"> </span><span class="lit">2047</span><span class="pun">;</span><span class="pln">
</span><span class="lit">0043CD47</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">3BC3</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CMP EAX</span><span class="pun">,</span><span class="pln">EBX
</span><span class="lit">0043CD49</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.^</span><span class="lit">7E</span><span class="pln"> D5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JLE SHORT cmvs</span><span class="pun">.</span><span class="lit">0043CD20</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
</span><span class="lit">0043CD4B</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">8B5424</span><span class="pln"> </span><span class="lit">18</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOV EDX</span><span class="pun">,</span><span class="pln">DWORD PTR SS</span><span class="pun">:[</span><span class="pln">ESP</span><span class="pun">+</span><span class="lit">18</span><span class="pun">]</span><span class="pln">
</span><span class="lit">0043CD4F</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.^</span><span class="pln">E9 </span><span class="lit">30FFFFFF</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;JMP cmvs</span><span class="pun">.</span><span class="lit">0043CC84</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln"> </span><span class="pun">}</span><span class="pln">
</span><span class="lit">0043CD54</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">8B4424</span><span class="pln"> </span><span class="lit">1C</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOV EAX</span><span class="pun">,</span><span class="pln">DWORD PTR SS</span><span class="pun">:[</span><span class="pln">ESP</span><span class="pun">+</span><span class="lit">1C</span><span class="pun">]</span><span class="pln">
</span><span class="lit">0043CD58</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">5F</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; POP EDI
</span><span class="lit">0043CD59</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">5E</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; POP ESI
</span><span class="lit">0043CD5A</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">5D</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; POP EBP
</span><span class="lit">0043CD5B</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">5B</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; POP EBX
</span><span class="lit">0043CD5C</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RETN</span></pre><br><br>那么可以写个解密函数，按汇编直接翻译：<br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code6'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code6" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="kwd">def</span><span class="pln"> decryptPs2</span><span class="pun">(</span><span class="pln">buf</span><span class="pun">,</span><span class="pln"> offset</span><span class="pun">,</span><span class="pln"> length</span><span class="pun">,</span><span class="pln"> key</span><span class="pun">):</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;ecx </span><span class="pun">=</span><span class="pln"> key
&nbsp;&nbsp;&nbsp;&nbsp;eax </span><span class="pun">=</span><span class="pln"> ecx
&nbsp;&nbsp;&nbsp;&nbsp;eax </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">0x14</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;edx </span><span class="pun">=</span><span class="pln"> eax </span><span class="pun">%</span><span class="pln"> </span><span class="lit">5</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;eax </span><span class="pun">=</span><span class="pln"> eax </span><span class="pun">/</span><span class="pln"> </span><span class="lit">5</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;eax </span><span class="pun">=</span><span class="pln"> ecx
&nbsp;&nbsp;&nbsp;&nbsp;eax </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">0x18</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;ecx </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">3</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;al </span><span class="pun">=</span><span class="pln"> eax </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">0xff</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;cl </span><span class="pun">=</span><span class="pln"> ecx </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">0xff</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;al </span><span class="pun">+=</span><span class="pln"> cl
&nbsp;&nbsp;&nbsp;&nbsp;al </span><span class="pun">&amp;=</span><span class="pln"> </span><span class="lit">0xff</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;dl </span><span class="pun">=</span><span class="pln"> edx </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">0xff</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;dl </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;ecx </span><span class="pun">=</span><span class="pln"> dl
&nbsp;&nbsp;&nbsp;&nbsp;cl </span><span class="pun">=</span><span class="pln"> ecx </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">0xff</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">for</span><span class="pln"> i </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="pln">offset</span><span class="pun">,</span><span class="pln"> offset </span><span class="pun">+</span><span class="pln"> length</span><span class="pun">):</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dl </span><span class="pun">=</span><span class="pln"> buf</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dl </span><span class="pun">=</span><span class="pln"> dl </span><span class="pun">-</span><span class="pln"> </span><span class="lit">0x7C</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dl </span><span class="pun">=</span><span class="pln"> dl </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">0xFF</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dl </span><span class="pun">=</span><span class="pln"> dl </span><span class="pun">^</span><span class="pln"> al
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dl </span><span class="pun">=</span><span class="pln"> ror8</span><span class="pun">(</span><span class="pln">dl</span><span class="pun">,</span><span class="pln"> cl</span><span class="pun">)</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> dl</span></pre><br><br>这里游戏用的是一个日本人写的lzss压缩算法。<br>用原版C代码修改几个游戏做了改动的地方，然后改成Python模块：<br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code7'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code7" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="com">/**************************************************************
&nbsp;&nbsp;&nbsp;&nbsp;LZSS.C -- A Data Compression Program
&nbsp;&nbsp;&nbsp;&nbsp;(tab = 4 spaces)
***************************************************************
&nbsp;&nbsp;&nbsp;&nbsp;4/6/1989 Haruhiko Okumura
&nbsp;&nbsp;&nbsp;&nbsp;Use, distribute, and modify this program freely.
&nbsp;&nbsp;&nbsp;&nbsp;Please send me your improved versions.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PC-VAN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SCIENCE
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NIFTY-Serve&nbsp;&nbsp;&nbsp;&nbsp;PAF01022
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CompuServe&nbsp;&nbsp;&nbsp;&nbsp;74050,1022
**************************************************************/</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;stdio.h&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;stdlib.h&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;string.h&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;ctype.h&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;Python.h&gt;</span><span class="pln">

</span><span class="com">#define</span><span class="pln"> N&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="lit">2048</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* size of ring buffer */</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="lit">33</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* upper limit for match_length */</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> THRESHOLD&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="lit">1</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* encode string into position and length
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if match_length is greater than this */</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> NIL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* index for root of binary search trees */</span><span class="pln">

</span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">int</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;textsize </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* text size counter */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;codesize </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* code size counter */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printcount </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* counter for reporting progress every 1K bytes */</span><span class="pln">
</span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">char</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text_buf</span><span class="pun">[</span><span class="pln">N </span><span class="pun">+</span><span class="pln"> F </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">];</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* ring buffer of size N,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with extra F-1 bytes to facilitate string comparison */</span><span class="pln">
</span><span class="kwd">int</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match_position</span><span class="pun">,</span><span class="pln"> match_length</span><span class="pun">,</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* of longest match.&nbsp;&nbsp;These are
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set by the InsertNode() procedure. */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lson</span><span class="pun">[</span><span class="pln">N </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">],</span><span class="pln"> rson</span><span class="pun">[</span><span class="pln">N </span><span class="pun">+</span><span class="pln"> </span><span class="lit">257</span><span class="pun">],</span><span class="pln"> dad</span><span class="pun">[</span><span class="pln">N </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">];</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* left &amp; right children &amp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parents -- These constitute binary search trees. */</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> </span><span class="typ">InitTree</span><span class="pun">(</span><span class="kwd">void</span><span class="pun">)</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* initialize trees */</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">int</span><span class="pln">&nbsp;&nbsp;i</span><span class="pun">;</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* For i = 0 to N - 1, rson[i] and lson[i] will be the right and
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; left children of node i.&nbsp;&nbsp;These nodes need not be initialized.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Also, dad[i] is the parent of node i.&nbsp;&nbsp;These are initialized to
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NIL (= N), which stands for 'not used.'
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; For i = 0 to 255, rson[N + i + 1] is the root of the tree
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for strings that begin with character i.&nbsp;&nbsp;These are initialized
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; to NIL.&nbsp;&nbsp;Note there are 256 trees. */</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> N </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> N </span><span class="pun">+</span><span class="pln"> </span><span class="lit">256</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> rson</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> NIL</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> N</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> dad</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> NIL</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> </span><span class="typ">InsertNode</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> r</span><span class="pun">)</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* Inserts string of length F, text_buf[r..r+F-1], into one of the
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; trees (text_buf[r]'th tree) and returns the longest-match position
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; and length via the global variables match_position and match_length.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If match_length = F, then removes the old node in favor of the new
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; one, because the old one will be deleted sooner.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Note r plays double role, as tree node and position in buffer. */</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">int</span><span class="pln">&nbsp;&nbsp;i</span><span class="pun">,</span><span class="pln"> p</span><span class="pun">,</span><span class="pln"> cmp</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">char</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">*</span><span class="pln">key</span><span class="pun">;</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;cmp </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;key </span><span class="pun">=</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">text_buf</span><span class="pun">[</span><span class="pln">r</span><span class="pun">];</span><span class="pln">&nbsp;&nbsp;p </span><span class="pun">=</span><span class="pln"> N </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> key</span><span class="pun">[</span><span class="lit">0</span><span class="pun">];</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;rson</span><span class="pun">[</span><span class="pln">r</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> lson</span><span class="pun">[</span><span class="pln">r</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> NIL</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;match_length </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln"> </span><span class="pun">;</span><span class="pln"> </span><span class="pun">;</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">cmp </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">rson</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> NIL</span><span class="pun">)</span><span class="pln"> p </span><span class="pun">=</span><span class="pln"> rson</span><span class="pun">[</span><span class="pln">p</span><span class="pun">];</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">&nbsp;&nbsp;rson</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> r</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;dad</span><span class="pun">[</span><span class="pln">r</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> p</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;</span><span class="kwd">return</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">lson</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> NIL</span><span class="pun">)</span><span class="pln"> p </span><span class="pun">=</span><span class="pln"> lson</span><span class="pun">[</span><span class="pln">p</span><span class="pun">];</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">&nbsp;&nbsp;lson</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> r</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;dad</span><span class="pun">[</span><span class="pln">r</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> p</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;</span><span class="kwd">return</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> F</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">((</span><span class="pln">cmp </span><span class="pun">=</span><span class="pln"> key</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> text_buf</span><span class="pun">[</span><span class="pln">p </span><span class="pun">+</span><span class="pln"> i</span><span class="pun">])</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln">&nbsp;&nbsp;</span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">&gt;</span><span class="pln"> match_length</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match_position </span><span class="pun">=</span><span class="pln"> p</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">((</span><span class="pln">match_length </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&gt;=</span><span class="pln"> F</span><span class="pun">)</span><span class="pln">&nbsp;&nbsp;</span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;dad</span><span class="pun">[</span><span class="pln">r</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> dad</span><span class="pun">[</span><span class="pln">p</span><span class="pun">];</span><span class="pln">&nbsp;&nbsp;lson</span><span class="pun">[</span><span class="pln">r</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> lson</span><span class="pun">[</span><span class="pln">p</span><span class="pun">];</span><span class="pln">&nbsp;&nbsp;rson</span><span class="pun">[</span><span class="pln">r</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> rson</span><span class="pun">[</span><span class="pln">p</span><span class="pun">];</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;dad</span><span class="pun">[</span><span class="pln">lson</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> r</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;dad</span><span class="pun">[</span><span class="pln">rson</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> r</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">rson</span><span class="pun">[</span><span class="pln">dad</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> p</span><span class="pun">)</span><span class="pln"> rson</span><span class="pun">[</span><span class="pln">dad</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> r</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">else</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lson</span><span class="pun">[</span><span class="pln">dad</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> r</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;dad</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> NIL</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* remove p */</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> </span><span class="typ">DeleteNode</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">)</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* deletes node p from tree */</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">int</span><span class="pln">&nbsp;&nbsp;q</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp; 
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">dad</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> NIL</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* not in tree */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">rson</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> NIL</span><span class="pun">)</span><span class="pln"> q </span><span class="pun">=</span><span class="pln"> lson</span><span class="pun">[</span><span class="pln">p</span><span class="pun">];</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">lson</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> NIL</span><span class="pun">)</span><span class="pln"> q </span><span class="pun">=</span><span class="pln"> rson</span><span class="pun">[</span><span class="pln">p</span><span class="pun">];</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q </span><span class="pun">=</span><span class="pln"> lson</span><span class="pun">[</span><span class="pln">p</span><span class="pun">];</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">rson</span><span class="pun">[</span><span class="pln">q</span><span class="pun">]</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> NIL</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">do</span><span class="pln"> </span><span class="pun">{</span><span class="pln">&nbsp;&nbsp;q </span><span class="pun">=</span><span class="pln"> rson</span><span class="pun">[</span><span class="pln">q</span><span class="pun">];</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln"> </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">rson</span><span class="pun">[</span><span class="pln">q</span><span class="pun">]</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> NIL</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rson</span><span class="pun">[</span><span class="pln">dad</span><span class="pun">[</span><span class="pln">q</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> lson</span><span class="pun">[</span><span class="pln">q</span><span class="pun">];</span><span class="pln">&nbsp;&nbsp;dad</span><span class="pun">[</span><span class="pln">lson</span><span class="pun">[</span><span class="pln">q</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> dad</span><span class="pun">[</span><span class="pln">q</span><span class="pun">];</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lson</span><span class="pun">[</span><span class="pln">q</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> lson</span><span class="pun">[</span><span class="pln">p</span><span class="pun">];</span><span class="pln">&nbsp;&nbsp;dad</span><span class="pun">[</span><span class="pln">lson</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> q</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rson</span><span class="pun">[</span><span class="pln">q</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> rson</span><span class="pun">[</span><span class="pln">p</span><span class="pun">];</span><span class="pln">&nbsp;&nbsp;dad</span><span class="pun">[</span><span class="pln">rson</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> q</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;dad</span><span class="pun">[</span><span class="pln">q</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> dad</span><span class="pun">[</span><span class="pln">p</span><span class="pun">];</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">rson</span><span class="pun">[</span><span class="pln">dad</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> p</span><span class="pun">)</span><span class="pln"> rson</span><span class="pun">[</span><span class="pln">dad</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> q</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;</span><span class="kwd">else</span><span class="pln"> lson</span><span class="pun">[</span><span class="pln">dad</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> q</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;dad</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> NIL</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">inline</span><span class="pln"> </span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> mygetc</span><span class="pun">(</span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">**</span><span class="pln"> input</span><span class="pun">){</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">char</span><span class="pln"> r</span><span class="pun">=**</span><span class="pln">input</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">(*</span><span class="pln">input</span><span class="pun">)++;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">return</span><span class="pln"> r</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">inline</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> myputc</span><span class="pun">(</span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> r</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">**</span><span class="pln"> input</span><span class="pun">){</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">**</span><span class="pln">input </span><span class="pun">=</span><span class="pln"> r</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">(*</span><span class="pln">input</span><span class="pun">)++;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">static</span><span class="pln"> </span><span class="typ">PyObject</span><span class="pln"> </span><span class="pun">*</span><span class="pln">
encode</span><span class="pun">(</span><span class="typ">PyObject</span><span class="pln"> </span><span class="pun">*</span><span class="kwd">self</span><span class="pun">,</span><span class="pln"> </span><span class="typ">PyObject</span><span class="pln"> </span><span class="pun">*</span><span class="pln">args</span><span class="pun">,</span><span class="pln"> </span><span class="typ">PyObject</span><span class="pln"> </span><span class="pun">*</span><span class="pln">keywds</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">int</span><span class="pln">&nbsp;&nbsp;i</span><span class="pun">,</span><span class="pln"> c</span><span class="pun">,</span><span class="pln"> len</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">,</span><span class="pln"> s</span><span class="pun">,</span><span class="pln"> last_match_length</span><span class="pun">,</span><span class="pln"> code_buf_ptr</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">char</span><span class="pln">&nbsp;&nbsp;code_buf</span><span class="pun">[</span><span class="lit">17</span><span class="pun">],</span><span class="pln"> mask</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">char</span><span class="pln"> </span><span class="pun">*</span><span class="pln">inputBuf </span><span class="pun">=</span><span class="pln"> </span><span class="str">""</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">int</span><span class="pln"> offset </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">int</span><span class="pln"> length </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">char</span><span class="pln"> </span><span class="pun">*</span><span class="pln">kwlist</span><span class="pun">[]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="str">"inputBuf"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"offset"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"length"</span><span class="pun">,</span><span class="pln"> NULL</span><span class="pun">};</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="typ">PyArg_ParseTupleAndKeywords</span><span class="pun">(</span><span class="pln">args</span><span class="pun">,</span><span class="pln"> keywds</span><span class="pun">,</span><span class="pln"> </span><span class="str">"s#ii"</span><span class="pun">,</span><span class="pln"> kwlist</span><span class="pun">,</span><span class="pln"> 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">&amp;</span><span class="pln">inputBuf</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">length</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">offset</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">length</span><span class="pun">))</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">return</span><span class="pln"> NULL</span><span class="pun">;</span><span class="pln"> 

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">char</span><span class="pln"> </span><span class="pun">*</span><span class="pln">outputBuf </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*)</span><span class="pln"> malloc </span><span class="pun">(</span><span class="pln">length</span><span class="pun">*</span><span class="lit">2</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">char</span><span class="pln"> </span><span class="pun">*</span><span class="pln">outputBufStart </span><span class="pun">=</span><span class="pln"> outputBuf</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">char</span><span class="pln"> </span><span class="pun">*</span><span class="pln">inputBufEnd </span><span class="pun">=</span><span class="pln"> inputBuf </span><span class="pun">+</span><span class="pln"> offset </span><span class="pun">+</span><span class="pln"> length</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;inputBuf </span><span class="pun">+=</span><span class="pln"> offset</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp; 
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">InitTree</span><span class="pun">();</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* initialize trees */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;code_buf</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* code_buf[1..16] saves eight units of code, and
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code_buf[0] works as eight flags, "1" representing that the unit
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is an unencoded letter (1 byte), "0" a position-and-length pair
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(2 bytes).&nbsp;&nbsp;Thus, eight units require at most 16 bytes of code. */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;code_buf_ptr </span><span class="pun">=</span><span class="pln"> mask </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;s </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;r </span><span class="pun">=</span><span class="pln"> N </span><span class="pun">-</span><span class="pln"> F</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> s</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> r</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> text_buf</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">'\0'</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* Clear the buffer with
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;any character that will appear often. */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">len </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> len </span><span class="pun">&lt;</span><span class="pln"> F </span><span class="pun">&amp;&amp;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">c </span><span class="pun">=</span><span class="pln"> </span><span class="pun">*(</span><span class="pln">inputBuf</span><span class="pun">++),</span><span class="pln"> inputBuf </span><span class="pun">&lt;=</span><span class="pln"> inputBufEnd</span><span class="pun">);</span><span class="pln"> len</span><span class="pun">++)</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text_buf</span><span class="pun">[</span><span class="pln">r </span><span class="pun">+</span><span class="pln"> len</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> c</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* Read F bytes into the last F bytes of
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the buffer */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">((</span><span class="pln">textsize </span><span class="pun">=</span><span class="pln"> len</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> NULL</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* text of size zero */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> F</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="typ">InsertNode</span><span class="pun">(</span><span class="pln">r </span><span class="pun">-</span><span class="pln"> i</span><span class="pun">);</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* Insert the F strings,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;each of which begins with one or more 'space' characters.&nbsp;&nbsp;Note
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the order in which these strings are inserted.&nbsp;&nbsp;This way,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;degenerate trees will be less likely to occur. */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">InsertNode</span><span class="pun">(</span><span class="pln">r</span><span class="pun">);</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* Finally, insert the whole string just read.&nbsp;&nbsp;The
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;global variables match_length and match_position are set. */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">do</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">match_length </span><span class="pun">&gt;</span><span class="pln"> len</span><span class="pun">)</span><span class="pln"> match_length </span><span class="pun">=</span><span class="pln"> len</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* match_length
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;may be spuriously long near the end of text. */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">match_length </span><span class="pun">&lt;=</span><span class="pln"> THRESHOLD</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match_length </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* Not long enough match.&nbsp;&nbsp;Send one byte. */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code_buf</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">|=</span><span class="pln"> mask</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* 'send one byte' flag */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code_buf</span><span class="pun">[</span><span class="pln">code_buf_ptr</span><span class="pun">++]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> text_buf</span><span class="pun">[</span><span class="pln">r</span><span class="pun">];</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* Send uncoded. */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code_buf</span><span class="pun">[</span><span class="pln">code_buf_ptr</span><span class="pun">++]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">)</span><span class="pln"> match_position</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code_buf</span><span class="pun">[</span><span class="pln">code_buf_ptr</span><span class="pun">++]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">)</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">(((</span><span class="pln">match_position </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">3</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">0xe0</span><span class="pun">)</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln"> </span><span class="pun">(</span><span class="pln">match_length </span><span class="pun">-</span><span class="pln"> </span><span class="pun">(</span><span class="pln">THRESHOLD </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)));</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* Send position and
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;length pair. Note match_length &gt; THRESHOLD. */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">((</span><span class="pln">mask </span><span class="pun">&lt;&lt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* Shift mask left one bit. */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> code_buf_ptr</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* Send at most 8 units of */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myputc</span><span class="pun">(</span><span class="pln">code_buf</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">outputBuf</span><span class="pun">);</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* code together */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;codesize </span><span class="pun">+=</span><span class="pln"> code_buf_ptr</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code_buf</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;code_buf_ptr </span><span class="pun">=</span><span class="pln"> mask </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last_match_length </span><span class="pun">=</span><span class="pln"> match_length</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> last_match_length </span><span class="pun">&amp;&amp;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">(</span><span class="pln">c </span><span class="pun">=</span><span class="pln"> </span><span class="pun">*(</span><span class="pln">inputBuf</span><span class="pun">++),</span><span class="pln"> inputBuf </span><span class="pun">&lt;=</span><span class="pln"> inputBufEnd</span><span class="pun">);</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">DeleteNode</span><span class="pun">(</span><span class="pln">s</span><span class="pun">);</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* Delete old strings and */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text_buf</span><span class="pun">[</span><span class="pln">s</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> c</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* read new bytes */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s </span><span class="pun">&lt;</span><span class="pln"> F </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> text_buf</span><span class="pun">[</span><span class="pln">s </span><span class="pun">+</span><span class="pln"> N</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> c</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* If the position is
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;near the end of buffer, extend the buffer to make
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string comparison easier. */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">N </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">&nbsp;&nbsp;r </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">r </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">N </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* Since this is a ring buffer, increment the position
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; modulo N. */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">InsertNode</span><span class="pun">(</span><span class="pln">r</span><span class="pun">);</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* Register the string in text_buf[r..r+F-1] */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">((</span><span class="pln">textsize </span><span class="pun">+=</span><span class="pln"> i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> printcount</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
</span><span class="com">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf("%12ld\r", textsize);&nbsp;&nbsp;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printcount </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1024</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* Reports progress each time the textsize exceeds
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; multiples of 1024. */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i</span><span class="pun">++</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> last_match_length</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* After the end of text, */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">DeleteNode</span><span class="pun">(</span><span class="pln">s</span><span class="pun">);</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* no need to read, but */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">N </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">&nbsp;&nbsp;r </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">r </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">N </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(--</span><span class="pln">len</span><span class="pun">)</span><span class="pln"> </span><span class="typ">InsertNode</span><span class="pun">(</span><span class="pln">r</span><span class="pun">);</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* buffer may not be empty. */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln"> </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">len </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* until length of string to be processed is zero */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">code_buf_ptr </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* Send remaining code. */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> code_buf_ptr</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> myputc</span><span class="pun">(</span><span class="pln">code_buf</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">outputBuf</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;codesize </span><span class="pun">+=</span><span class="pln"> code_buf_ptr</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;

</span><span class="com">//&nbsp;&nbsp;&nbsp;&nbsp;myputc(0, &amp;outputBuf);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">PyObject</span><span class="pln"> </span><span class="pun">*</span><span class="pln">result </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Py_BuildValue</span><span class="pun">(</span><span class="str">"s#"</span><span class="pun">,</span><span class="pln"> outputBufStart</span><span class="pun">,</span><span class="pln"> outputBuf </span><span class="pun">-</span><span class="pln"> outputBufStart</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;free</span><span class="pun">(</span><span class="pln">outputBufStart</span><span class="pun">);</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">return</span><span class="pln"> result</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">static</span><span class="pln"> </span><span class="typ">PyObject</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> 
decode</span><span class="pun">(</span><span class="typ">PyObject</span><span class="pln"> </span><span class="pun">*</span><span class="kwd">self</span><span class="pun">,</span><span class="pln"> </span><span class="typ">PyObject</span><span class="pln"> </span><span class="pun">*</span><span class="pln">args</span><span class="pun">,</span><span class="pln"> </span><span class="typ">PyObject</span><span class="pln"> </span><span class="pun">*</span><span class="pln">keywds</span><span class="pun">)</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* Just the reverse of Encode(). */</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">int</span><span class="pln">&nbsp;&nbsp;i</span><span class="pun">,</span><span class="pln"> j</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">,</span><span class="pln"> c</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">int</span><span class="pln">&nbsp;&nbsp;flags</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">char</span><span class="pln"> </span><span class="pun">*</span><span class="pln">inputBuf </span><span class="pun">=</span><span class="pln"> </span><span class="str">""</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">int</span><span class="pln"> offset </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">int</span><span class="pln"> length </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">char</span><span class="pln"> </span><span class="pun">*</span><span class="pln">kwlist</span><span class="pun">[]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="str">"inputBuf"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"offset"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"length"</span><span class="pun">,</span><span class="pln"> NULL</span><span class="pun">};</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="typ">PyArg_ParseTupleAndKeywords</span><span class="pun">(</span><span class="pln">args</span><span class="pun">,</span><span class="pln"> keywds</span><span class="pun">,</span><span class="pln"> </span><span class="str">"s#ii"</span><span class="pun">,</span><span class="pln"> kwlist</span><span class="pun">,</span><span class="pln"> 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">&amp;</span><span class="pln">inputBuf</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">length</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">offset</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">length</span><span class="pun">))</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">return</span><span class="pln"> NULL</span><span class="pun">;</span><span class="pln"> 

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">char</span><span class="pln"> </span><span class="pun">*</span><span class="pln">outputBuf </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">*)</span><span class="pln"> malloc </span><span class="pun">(</span><span class="pln">length</span><span class="pun">*</span><span class="lit">10</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">char</span><span class="pln"> </span><span class="pun">*</span><span class="pln">outputBufStart </span><span class="pun">=</span><span class="pln"> outputBuf</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">char</span><span class="pln"> </span><span class="pun">*</span><span class="pln">inputBufEnd </span><span class="pun">=</span><span class="pln"> inputBuf </span><span class="pun">+</span><span class="pln"> offset </span><span class="pun">+</span><span class="pln"> length</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;inputBuf </span><span class="pun">+=</span><span class="pln"> offset</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> N </span><span class="pun">-</span><span class="pln"> F</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> text_buf</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">'\0'</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;r </span><span class="pun">=</span><span class="pln"> N </span><span class="pun">-</span><span class="pln"> F</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;flags </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln"> </span><span class="pun">;</span><span class="pln"> </span><span class="pun">;</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(((</span><span class="pln">flags </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">256</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c </span><span class="pun">=</span><span class="pln"> </span><span class="pun">*(</span><span class="pln">inputBuf</span><span class="pun">++);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">inputBuf </span><span class="pun">&gt;</span><span class="pln"> inputBufEnd</span><span class="pun">)</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flags </span><span class="pun">=</span><span class="pln"> c </span><span class="pun">|</span><span class="pln"> </span><span class="lit">0xff00</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* uses higher byte cleverly */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* to count eight */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">flags </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c </span><span class="pun">=</span><span class="pln"> </span><span class="pun">*(</span><span class="pln">inputBuf</span><span class="pun">++);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">inputBuf </span><span class="pun">&gt;</span><span class="pln"> inputBufEnd</span><span class="pun">)</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myputc</span><span class="pun">(</span><span class="pln">c</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">outputBuf</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text_buf</span><span class="pun">[</span><span class="pln">r</span><span class="pun">++]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> c</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r </span><span class="pun">&amp;=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">N </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i </span><span class="pun">=</span><span class="pln"> </span><span class="pun">*(</span><span class="pln">inputBuf</span><span class="pun">++);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">inputBuf </span><span class="pun">&gt;</span><span class="pln"> inputBufEnd</span><span class="pun">)</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;j </span><span class="pun">=</span><span class="pln"> </span><span class="pun">*(</span><span class="pln">inputBuf</span><span class="pun">++);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">inputBuf </span><span class="pun">&gt;</span><span class="pln"> inputBufEnd</span><span class="pun">)</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i </span><span class="pun">|=</span><span class="pln"> </span><span class="pun">((</span><span class="pln">j </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">0xe0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">3</span><span class="pun">);</span><span class="pln">&nbsp;&nbsp;j </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">j </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">0x1f</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> THRESHOLD</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">k </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> k </span><span class="pun">&lt;=</span><span class="pln"> j</span><span class="pun">;</span><span class="pln"> k</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c </span><span class="pun">=</span><span class="pln"> text_buf</span><span class="pun">[(</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> k</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">N </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)];</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;myputc</span><span class="pun">(</span><span class="pln">c</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">outputBuf</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text_buf</span><span class="pun">[</span><span class="pln">r</span><span class="pun">++]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> c</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r </span><span class="pun">&amp;=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">N </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">PyObject</span><span class="pln"> </span><span class="pun">*</span><span class="pln">result </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Py_BuildValue</span><span class="pun">(</span><span class="str">"s#"</span><span class="pun">,</span><span class="pln"> outputBufStart</span><span class="pun">,</span><span class="pln"> outputBuf </span><span class="pun">-</span><span class="pln"> outputBufStart</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;free</span><span class="pun">(</span><span class="pln">outputBufStart</span><span class="pun">);</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">return</span><span class="pln"> result</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="com">/* registration table&nbsp;&nbsp;*/</span><span class="pln">
</span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">struct</span><span class="pln"> </span><span class="typ">PyMethodDef</span><span class="pln"> c_lzss_methods</span><span class="pun">[]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">{</span><span class="str">"encode"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">(</span><span class="typ">PyCFunction</span><span class="pun">)</span><span class="pln">encode</span><span class="pun">,</span><span class="pln"> METH_VARARGS</span><span class="pun">|</span><span class="pln">METH_KEYWORDS</span><span class="pun">,</span><span class="pln"> NULL</span><span class="pun">},</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="com">/* method name, C func ptr, always-tuple */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">{</span><span class="str">"decode"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">(</span><span class="typ">PyCFunction</span><span class="pun">)</span><span class="pln">decode</span><span class="pun">,</span><span class="pln"> METH_VARARGS</span><span class="pun">|</span><span class="pln">METH_KEYWORDS</span><span class="pun">,</span><span class="pln"> NULL</span><span class="pun">},</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="com">/* method name, C func ptr, always-tuple */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">{</span><span class="pln">NULL</span><span class="pun">,</span><span class="pln">NULL</span><span class="pun">,</span><span class="lit">0</span><span class="pun">,</span><span class="pln">NULL</span><span class="pun">}</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* end of table marker */</span><span class="pln">
</span><span class="pun">};</span><span class="pln">

</span><span class="com">/* module initializer */</span><span class="pln">
</span><span class="typ">PyMODINIT_FUNC</span><span class="pln"> initc_lzss</span><span class="pun">(</span><span class="pln"> </span><span class="pun">)</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="com">/* called on first import */</span><span class="pln">
</span><span class="pun">{</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* name matters if loaded dynamically */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">(</span><span class="kwd">void</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Py_InitModule</span><span class="pun">(</span><span class="str">"c_lzss"</span><span class="pun">,</span><span class="pln"> c_lzss_methods</span><span class="pun">);</span><span class="pln">&nbsp;&nbsp; </span><span class="com">/* mod name, table ptr */</span><span class="pln">
</span><span class="pun">}</span></pre><br>重新打开解密和解压后的ps2文件，可以发现文本全部位于文件的最后面。懒得继续跟了，就黑箱分析了下，0x01200201大概是load string指令，后面跟的int32是每句文本在末尾的偏移。<br><br>那么把解包代码里TODO的部分再修改一下，从ps2文件中导出文本：<br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code8'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code8" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">#解密&amp;解压ps2</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> itemFilename</span><span class="pun">.</span><span class="pln">endswith</span><span class="pun">(</span><span class="str">'.ps2'</span><span class="pun">):</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decryptPs2</span><span class="pun">(</span><span class="pln">item</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0x30</span><span class="pun">,</span><span class="pln"> itemLength </span><span class="pun">-</span><span class="pln"> </span><span class="lit">0x30</span><span class="pun">,</span><span class="pln"> unpack</span><span class="pun">(</span><span class="str">'L'</span><span class="pun">,</span><span class="pln"> item</span><span class="pun">[</span><span class="lit">0x0c</span><span class="pun">:</span><span class="lit">0x10</span><span class="pun">])[</span><span class="lit">0</span><span class="pun">])</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;itemHeader </span><span class="pun">=</span><span class="pln"> item</span><span class="pun">[</span><span class="lit">0</span><span class="pun">:</span><span class="lit">0x30</span><span class="pun">]</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;itemContent </span><span class="pun">=</span><span class="pln"> decode</span><span class="pun">(</span><span class="pln">item</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0x30</span><span class="pun">,</span><span class="pln"> itemLength </span><span class="pun">-</span><span class="pln"> </span><span class="lit">0x30</span><span class="pun">)</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scriptLength </span><span class="pun">=</span><span class="pln"> unpack</span><span class="pun">(</span><span class="str">'L'</span><span class="pun">,</span><span class="pln"> itemHeader</span><span class="pun">[</span><span class="lit">0x1C</span><span class="pun">:</span><span class="lit">0x20</span><span class="pun">])[</span><span class="lit">0</span><span class="pun">]</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;scriptOffset </span><span class="pun">=</span><span class="pln"> len</span><span class="pun">(</span><span class="pln">itemContent</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> scriptLength

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">with</span><span class="pln"> open</span><span class="pun">(</span><span class="pln">outputFolder </span><span class="pun">+</span><span class="pln"> itemFilename </span><span class="pun">+</span><span class="pln"> </span><span class="str">'.txt'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'wb'</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">as</span><span class="pln"> outputTxtFile</span><span class="pun">:</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">for</span><span class="pln"> j </span><span class="kwd">in</span><span class="pln"> xrange</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> scriptOffset </span><span class="pun">-</span><span class="pln"> </span><span class="lit">8</span><span class="pun">):</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> unpack</span><span class="pun">(</span><span class="str">'L'</span><span class="pun">,</span><span class="pln"> itemContent</span><span class="pun">[</span><span class="pln">j</span><span class="pun">:</span><span class="pln">j </span><span class="pun">+</span><span class="pln"> </span><span class="lit">4</span><span class="pun">])[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0x01200201</span><span class="pun">:</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sentenceOffset </span><span class="pun">=</span><span class="pln"> unpack</span><span class="pun">(</span><span class="str">'L'</span><span class="pun">,</span><span class="pln"> itemContent</span><span class="pun">[</span><span class="pln">j </span><span class="pun">+</span><span class="pln"> </span><span class="lit">4</span><span class="pun">:</span><span class="pln">j </span><span class="pun">+</span><span class="pln"> </span><span class="lit">8</span><span class="pun">])[</span><span class="lit">0</span><span class="pun">]</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sentence </span><span class="pun">=</span><span class="pln"> itemContent</span><span class="pun">[</span><span class="pln">scriptOffset </span><span class="pun">+</span><span class="pln"> sentenceOffset</span><span class="pun">:</span><span class="pln">scriptOffset </span><span class="pun">+</span><span class="pln"> sentenceOffset </span><span class="pun">+</span><span class="pln"> </span><span class="lit">255</span><span class="pun">].</span><span class="pln">tostring</span><span class="pun">()</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sentence </span><span class="pun">=</span><span class="pln"> sentence</span><span class="pun">.</span><span class="pln">split</span><span class="pun">(</span><span class="str">'\0'</span><span class="pun">)[</span><span class="lit">0</span><span class="pun">]</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> sentence </span><span class="pun">==</span><span class="pln"> </span><span class="str">''</span><span class="pun">:</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">continue</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;outputTxtFile</span><span class="pun">.</span><span class="pln">write</span><span class="pun">(</span><span class="str">';'</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> sentence</span><span class="pun">)</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;outputTxtFile</span><span class="pun">.</span><span class="pln">write</span><span class="pun">(</span><span class="str">'\r\n'</span><span class="pun">)</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;outputTxtFile</span><span class="pun">.</span><span class="pln">write</span><span class="pun">(</span><span class="pln">str</span><span class="pun">(</span><span class="pln">count</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="str">'='</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> sentence</span><span class="pun">)</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;outputTxtFile</span><span class="pun">.</span><span class="pln">write</span><span class="pun">(</span><span class="str">'\r\n'</span><span class="pun">)</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">#outputFile.write(item)</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;itemHeader</span><span class="pun">.</span><span class="pln">tofile</span><span class="pun">(</span><span class="pln">outputFile</span><span class="pun">)</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;itemContent</span><span class="pun">.</span><span class="pln">tofile</span><span class="pun">(</span><span class="pln">outputFile</span><span class="pun">)</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">#item.tofile(outputFile)</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">elif</span><span class="pln"> itemFilename</span><span class="pun">.</span><span class="pln">endswith</span><span class="pun">(</span><span class="str">'.pb3'</span><span class="pun">):</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;decryptPb3</span><span class="pun">(</span><span class="pln">item</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> itemLength</span><span class="pun">)</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item</span><span class="pun">.</span><span class="pln">tofile</span><span class="pun">(</span><span class="pln">outputFile</span><span class="pun">)</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">else</span><span class="pun">:</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item</span><span class="pun">.</span><span class="pln">tofile</span><span class="pun">(</span><span class="pln">outputFile</span><span class="pun">)</span></pre><br>因为整个过程是可逆的，所以封包没什么好说的。<br>然后是改exe，首先是绘制文字时字体的字符集：<br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code9'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code9" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="lit">004337E2</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">51</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH ECX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">/</span><span class="typ">FaceName</span><span class="pln">
</span><span class="lit">004337E3</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">6A</span><span class="pln"> </span><span class="lit">30</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PUSH </span><span class="lit">30</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="typ">PitchAndFamily</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> DEFAULT_PITCH</span><span class="pun">|</span><span class="pln">FF_MODERN
</span><span class="lit">004337E5</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">6A</span><span class="pln"> </span><span class="lit">02</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PUSH </span><span class="lit">2</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="typ">Quality</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> PROOF_QUALITY
</span><span class="lit">004337E7</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">6A</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PUSH </span><span class="lit">0</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="typ">ClipPrecision</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> CLIP_DEFAULT_PRECIS
</span><span class="lit">004337E9</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">6A</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PUSH </span><span class="lit">0</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="typ">OutputPrecision</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> OUT_DEFAULT_PRECIS
</span><span class="lit">004337EB</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">68</span><span class="pln"> </span><span class="lit">86000000</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;PUSH </span><span class="lit">86</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="typ">CharSet</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">134.</span><span class="pln">
</span><span class="lit">004337F0</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">6A</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PUSH </span><span class="lit">0</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="typ">StrikeOut</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> FALSE
</span><span class="lit">004337F2</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">6A</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PUSH </span><span class="lit">0</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="typ">Underline</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> FALSE
</span><span class="lit">004337F4</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">6A</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PUSH </span><span class="lit">0</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="typ">Italic</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> FALSE
</span><span class="lit">004337F6</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">8946</span><span class="pln"> </span><span class="lit">14</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOV DWORD PTR DS</span><span class="pun">:[</span><span class="pln">ESI</span><span class="pun">+</span><span class="lit">14</span><span class="pun">],</span><span class="pln">EAX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="pln">
</span><span class="lit">004337F9</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">8B0C95</span><span class="pln"> BC32500</span><span class="pun">&gt;</span><span class="pln">MOV ECX</span><span class="pun">,</span><span class="pln">DWORD PTR DS</span><span class="pun">:[</span><span class="pln">EDX</span><span class="pun">*</span><span class="lit">4</span><span class="pun">+</span><span class="lit">5032BC</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="pln">
</span><span class="lit">00433800</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">51</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH ECX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="typ">Weight</span><span class="pln">
</span><span class="lit">00433801</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">6A</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PUSH </span><span class="lit">0</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="typ">Orientation</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
</span><span class="lit">00433803</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">6A</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PUSH </span><span class="lit">0</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="typ">Escapement</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
</span><span class="lit">00433805</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">6A</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PUSH </span><span class="lit">0</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="typ">Width</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
</span><span class="lit">00433807</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">50</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH EAX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="typ">Height</span><span class="pln">
</span><span class="lit">00433808</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> FF15 </span><span class="lit">68105000</span><span class="pln">&nbsp;&nbsp;CALL DWORD PTR DS</span><span class="pun">:[&lt;&amp;</span><span class="pln">GDI32</span><span class="pun">.</span><span class="typ">CreateFontA</span><span class="pun">&gt;]</span><span class="pln"> </span><span class="pun">;</span><span class="pln"> \CreateFontA</span></pre><br>注意有好几处，这里只贴了第一处。<br><br>接下来是字符宽度（全角/半角）判断：<br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code10'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code10" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="lit">004034D0</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">/</span><span class="pln">$ </span><span class="lit">8A4424</span><span class="pln"> </span><span class="lit">04</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOV AL</span><span class="pun">,</span><span class="pln">BYTE PTR SS</span><span class="pun">:[</span><span class="pln">ESP</span><span class="pun">+</span><span class="lit">4</span><span class="pun">]</span><span class="pln">
</span><span class="lit">004034D4</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">3C</span><span class="pln"> </span><span class="lit">81</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CMP AL</span><span class="pun">,</span><span class="lit">81</span><span class="pln">
</span><span class="lit">004034D6</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">72</span><span class="pln"> </span><span class="lit">04</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JB SHORT cmvs3</span><span class="pun">.</span><span class="lit">004034DC</span><span class="pln">
</span><span class="lit">004034D8</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">3C</span><span class="pln"> </span><span class="lit">9F</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CMP AL</span><span class="pun">,</span><span class="lit">9F</span><span class="pln">
</span><span class="lit">004034DA</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">76</span><span class="pln"> </span><span class="lit">06</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JBE SHORT cmvs3</span><span class="pun">.</span><span class="lit">004034E2</span><span class="pln">
</span><span class="lit">004034DC</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|&gt;</span><span class="pln"> </span><span class="lit">04</span><span class="pln"> </span><span class="lit">20</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADD AL</span><span class="pun">,</span><span class="lit">20</span><span class="pln">
</span><span class="lit">004034DE</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">3C</span><span class="pln"> </span><span class="lit">1C</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CMP AL</span><span class="pun">,</span><span class="lit">1C</span><span class="pln">
</span><span class="lit">004034E0</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">77</span><span class="pln"> </span><span class="lit">08</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JA SHORT cmvs3</span><span class="pun">.</span><span class="lit">004034EA</span><span class="pln">
</span><span class="lit">004034E2</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|&gt;</span><span class="pln"> B8 </span><span class="lit">01000000</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;MOV EAX</span><span class="pun">,</span><span class="lit">1</span><span class="pln">
</span><span class="lit">004034E7</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> C2 </span><span class="lit">0400</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETN </span><span class="lit">4</span><span class="pln">
</span><span class="lit">004034EA</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|&gt;</span><span class="pln"> </span><span class="lit">33C0</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; XOR EAX</span><span class="pun">,</span><span class="pln">EAX
</span><span class="lit">004034EC</span><span class="pln">&nbsp;&nbsp;\. C2 </span><span class="lit">0400</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETN </span><span class="lit">4</span></pre><br>暴力改成：<br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code11'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code11" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="lit">004034D0</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">/</span><span class="pln">$ </span><span class="lit">8A4424</span><span class="pln"> </span><span class="lit">04</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOV AL</span><span class="pun">,</span><span class="pln">BYTE PTR SS</span><span class="pun">:[</span><span class="pln">ESP</span><span class="pun">+</span><span class="lit">4</span><span class="pun">]</span><span class="pln">
</span><span class="lit">004034D4</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">3C</span><span class="pln"> </span><span class="lit">80</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CMP AL</span><span class="pun">,</span><span class="lit">80</span><span class="pln">
</span><span class="lit">004034D6</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">72</span><span class="pln"> </span><span class="lit">12</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JB SHORT cmvs12</span><span class="pun">.</span><span class="lit">004034EA</span><span class="pln">
</span><span class="lit">004034D8</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">90</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NOP
</span><span class="lit">004034D9</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">90</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NOP
</span><span class="lit">004034DA</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">90</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NOP
</span><span class="lit">004034DB</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">90</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NOP
</span><span class="lit">004034DC</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">90</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NOP
</span><span class="lit">004034DD</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">90</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NOP
</span><span class="lit">004034DE</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">90</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NOP
</span><span class="lit">004034DF</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">90</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NOP
</span><span class="lit">004034E0</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">90</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NOP
</span><span class="lit">004034E1</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">90</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NOP
</span><span class="lit">004034E2</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> B8 </span><span class="lit">01000000</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;MOV EAX</span><span class="pun">,</span><span class="lit">1</span><span class="pln">
</span><span class="lit">004034E7</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> C2 </span><span class="lit">0400</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETN </span><span class="lit">4</span><span class="pln">
</span><span class="lit">004034EA</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|&gt;</span><span class="pln"> </span><span class="lit">33C0</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; XOR EAX</span><span class="pun">,</span><span class="pln">EAX
</span><span class="lit">004034EC</span><span class="pln">&nbsp;&nbsp;\. C2 </span><span class="lit">0400</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETN </span><span class="lit">4</span></pre><br>看起来像是折行断句计算长度的地方：<br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code12'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code12" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="lit">00434AF3</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">837F</span><span class="pln"> </span><span class="lit">6C</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">CMP DWORD PTR DS</span><span class="pun">:[</span><span class="pln">EDI</span><span class="pun">+</span><span class="lit">6C</span><span class="pun">],</span><span class="lit">0</span><span class="pln">
</span><span class="lit">00434AF7</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">74</span><span class="pln"> </span><span class="lit">1C</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">|</span><span class="pln">JE SHORT cmvs3</span><span class="pun">.</span><span class="lit">00434B15</span><span class="pln">
</span><span class="lit">00434AF9</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">66</span><span class="pun">:</span><span class="lit">81F9</span><span class="pln"> </span><span class="lit">4181</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">CMP CX</span><span class="pun">,</span><span class="lit">8141</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;CMP CX</span><span class="pun">,</span><span class="lit">8141</span><span class="pln"> comma
</span><span class="lit">00434AFE</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">74</span><span class="pln"> </span><span class="lit">1C</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">|</span><span class="pln">JE SHORT cmvs3</span><span class="pun">.</span><span class="lit">00434B1C</span><span class="pln">
</span><span class="lit">00434B00</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">66</span><span class="pun">:</span><span class="lit">81F9</span><span class="pln"> </span><span class="lit">4281</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">CMP CX</span><span class="pun">,</span><span class="lit">8142</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;CMP CX</span><span class="pun">,</span><span class="lit">8142</span><span class="pln"> space
</span><span class="lit">00434B05</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">74</span><span class="pln"> </span><span class="lit">15</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">|</span><span class="pln">JE SHORT cmvs3</span><span class="pun">.</span><span class="lit">00434B1C</span><span class="pln">
</span><span class="lit">00434B07</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">66</span><span class="pun">:</span><span class="lit">81F9</span><span class="pln"> </span><span class="lit">7681</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">CMP CX</span><span class="pun">,</span><span class="lit">8176</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;CMP CX</span><span class="pun">,</span><span class="lit">8176</span><span class="pln"> bracket
</span><span class="lit">00434B0C</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">74</span><span class="pln"> </span><span class="lit">0E</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">|</span><span class="pln">JE SHORT cmvs3</span><span class="pun">.</span><span class="lit">00434B1C</span><span class="pln">
</span><span class="lit">00434B0E</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">66</span><span class="pun">:</span><span class="lit">81F9</span><span class="pln"> </span><span class="lit">7881</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">CMP CX</span><span class="pun">,</span><span class="lit">8178</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;CMP CX</span><span class="pun">,</span><span class="lit">8178</span><span class="pln"> bracket
</span><span class="lit">00434B13</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|.</span><span class="pln"> </span><span class="lit">74</span><span class="pln"> </span><span class="lit">07</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">|</span><span class="pln">JE SHORT cmvs3</span><span class="pun">.</span><span class="lit">00434B1C</span><span class="pln">
</span><span class="lit">00434B15</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">|&gt;</span><span class="pln"> </span><span class="lit">834424</span><span class="pln"> </span><span class="lit">18</span><span class="pln"> </span><span class="lit">01</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">|</span><span class="pln">ADD DWORD PTR SS</span><span class="pun">:[</span><span class="pln">ESP</span><span class="pun">+</span><span class="lit">18</span><span class="pun">],</span><span class="lit">1</span></pre><br>相应改掉几个字符的值即可。<br><br>文字部分结束，然后是图片。<br><br>pb3格式看起来比较复杂，不会压缩，于是决定偷懒了。用extractdata解压开以后，得到32位的反序bmp。改图后保存成原bmp格式，放到image目录里，然后修改exe，让exe检查是否存在对应的bmp文件，如果存在，就读bmp文件的内容，就免去了封包的麻烦，也减小了补丁的体积。<br><br>解包图片将位图放进内存的是004CFFC0函数，找到最后面LocalFree函数后面，我们在这里动一下手脚，插个跳转：<br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code13'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code13" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="lit">004D03A6</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">50</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH EAX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">/</span><span class="pln">hMemory
</span><span class="lit">004D03A7</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> FF15 </span><span class="lit">60115000</span><span class="pln">&nbsp;&nbsp;CALL DWORD PTR DS</span><span class="pun">:[&lt;&amp;</span><span class="pln">KERNEL32</span><span class="pun">.</span><span class="typ">LocalFree</span><span class="pun">&gt;&gt;;</span><span class="pln"> \LocalFree
</span><span class="lit">004D03AD</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">&gt;</span><span class="pln"> E9 C4E50200&nbsp;&nbsp;&nbsp;&nbsp;JMP cmvs12</span><span class="pun">.</span><span class="lit">004FE976</span><span class="pln">
</span><span class="lit">004D03B2</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">5B</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; POP EBX
</span><span class="lit">004D03B3</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">83C4</span><span class="pln"> </span><span class="lit">50</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADD ESP</span><span class="pun">,</span><span class="lit">50</span><span class="pln">
</span><span class="lit">004D03B6</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> C2 </span><span class="lit">0C00</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETN </span><span class="lit">0C</span></pre><br>然后在文件最后面找块空白写代码<br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code14'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code14" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="lit">004FE976</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">50</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH EAX
</span><span class="lit">004FE977</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">53</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH EBX
</span><span class="lit">004FE978</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">51</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH ECX
</span><span class="lit">004FE979</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">52</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH EDX
</span><span class="lit">004FE97A</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">55</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH EBP
</span><span class="lit">004FE97B</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">56</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH ESI
</span><span class="lit">004FE97C</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">57</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH EDI
</span><span class="lit">004FE97D</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">90</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NOP
</span><span class="lit">004FE97E</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">90</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NOP
</span><span class="lit">004FE97F</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">90</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NOP
</span><span class="lit">004FE980</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">90</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NOP
</span><span class="lit">004FE981</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">68</span><span class="pln"> </span><span class="lit">00100000</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;PUSH </span><span class="lit">1000</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">;</span><span class="pln"> </span><span class="str">/Size = 1000 (4096.)
004FE986&nbsp;&nbsp; . 6A 00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PUSH 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; |Flags = LMEM_FIXED
004FE988&nbsp;&nbsp; . FF15 94125000&nbsp;&nbsp;CALL DWORD PTR DS:[&lt;&amp;KERNEL32.LocalAlloc&gt;; \LocalAlloc
004FE98E&nbsp;&nbsp; . 8BF8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV EDI,EAX
004FE990&nbsp;&nbsp; . 57&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH EDI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; /Buffer
004FE991&nbsp;&nbsp; . 68 80070000&nbsp;&nbsp;&nbsp;&nbsp;PUSH 780&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; |BufSize = 780 (1920.)
004FE996&nbsp;&nbsp; . FF15 E4105000&nbsp;&nbsp;CALL DWORD PTR DS:[&lt;&amp;KERNEL32.GetCurrent&gt;; \GetCurrentDirectoryA
004FE99C&nbsp;&nbsp; . 68 A7EA4F00&nbsp;&nbsp;&nbsp;&nbsp;PUSH cmvs12.004FEAA7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; /StringToAdd = "\image\"
004FE9A1&nbsp;&nbsp; . 57&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH EDI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; |ConcatString
004FE9A2&nbsp;&nbsp; . FF15 A8105000&nbsp;&nbsp;CALL DWORD PTR DS:[&lt;&amp;KERNEL32.lstrcatA&gt;] ; \lstrcatA
004FE9A8&nbsp;&nbsp; . 90&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NOP
004FE9A9&nbsp;&nbsp; . 90&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NOP
004FE9AA&nbsp;&nbsp; . 8B9C24 9400000&gt;MOV EBX,DWORD PTR SS:[ESP+94]
004FE9B1&nbsp;&nbsp; . 53&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH EBX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; /</span><span class="typ">StringToAdd</span><span class="pln">
</span><span class="lit">004FE9B2</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">57</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH EDI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="typ">ConcatString</span><span class="pln">
</span><span class="lit">004FE9B3</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> FF15 A8105000&nbsp;&nbsp;CALL DWORD PTR DS</span><span class="pun">:[&lt;&amp;</span><span class="pln">KERNEL32</span><span class="pun">.</span><span class="pln">lstrcatA</span><span class="pun">&gt;]</span><span class="pln"> </span><span class="pun">;</span><span class="pln"> \lstrcatA
</span><span class="lit">004FE9B9</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">90</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NOP
</span><span class="lit">004FE9BA</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">90</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NOP
</span><span class="lit">004FE9BB</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">90</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NOP
</span><span class="lit">004FE9BC</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">57</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH EDI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="str">/String
004FE9BD&nbsp;&nbsp; . FF15 B8105000&nbsp;&nbsp;CALL DWORD PTR DS:[&lt;&amp;KERNEL32.lstrlenA&gt;] ; \lstrlenA
004FE9C3&nbsp;&nbsp; . C74438 FC 2E62&gt;MOV DWORD PTR DS:[EAX+EDI-4],706D622E
004FE9CB&nbsp;&nbsp; . 90&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NOP
004FE9CC&nbsp;&nbsp; . 6A 00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PUSH 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; /</span><span class="pln">hTemplateFile </span><span class="pun">=</span><span class="pln"> NULL
</span><span class="lit">004FE9CE</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">68</span><span class="pln"> </span><span class="lit">80000010</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;PUSH </span><span class="lit">10000080</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="typ">Attributes</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> NORMAL</span><span class="pun">|</span><span class="pln">RANDOM_ACCESS
</span><span class="lit">004FE9D3</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">6A</span><span class="pln"> </span><span class="lit">03</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PUSH </span><span class="lit">3</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="typ">Mode</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> OPEN_EXISTING
</span><span class="lit">004FE9D5</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">6A</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PUSH </span><span class="lit">0</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="pln">pSecurity </span><span class="pun">=</span><span class="pln"> NULL
</span><span class="lit">004FE9D7</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">6A</span><span class="pln"> </span><span class="lit">01</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PUSH </span><span class="lit">1</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="typ">ShareMode</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> FILE_SHARE_READ
</span><span class="lit">004FE9D9</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">68</span><span class="pln"> </span><span class="lit">00000080</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;PUSH </span><span class="lit">80000000</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="typ">Access</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> GENERIC_READ
</span><span class="lit">004FE9DE</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">57</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH EDI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="typ">FileName</span><span class="pln">
</span><span class="lit">004FE9DF</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> FF15 CC105000&nbsp;&nbsp;CALL DWORD PTR DS</span><span class="pun">:[&lt;&amp;</span><span class="pln">KERNEL32</span><span class="pun">.</span><span class="typ">CreateFile</span><span class="pun">&gt;;</span><span class="pln"> \CreateFileA
</span><span class="lit">004FE9E5</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">83F8</span><span class="pln"> FF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CMP EAX</span><span class="pun">,-</span><span class="lit">1</span><span class="pln">
</span><span class="lit">004FE9E8</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">74</span><span class="pln"> </span><span class="lit">3A</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JE SHORT cmvs12</span><span class="pun">.</span><span class="lit">004FEA24</span><span class="pln">
</span><span class="lit">004FE9EA</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">90</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NOP
</span><span class="lit">004FE9EB</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">8BC8</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV ECX</span><span class="pun">,</span><span class="pln">EAX
</span><span class="lit">004FE9ED</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">90</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NOP
</span><span class="lit">004FE9EE</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">51</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH ECX
</span><span class="lit">004FE9EF</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">6A</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PUSH </span><span class="lit">0</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="str">/Origin = FILE_BEGIN
004FE9F1&nbsp;&nbsp; . 6A 00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PUSH 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; |pOffsetHi = NULL
004FE9F3&nbsp;&nbsp; . 6A 36&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PUSH 36&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; |OffsetLo = 36 (54.)
004FE9F5&nbsp;&nbsp; . 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH EAX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; |hFile
004FE9F6&nbsp;&nbsp; . FF15 D4105000&nbsp;&nbsp;CALL DWORD PTR DS:[&lt;&amp;KERNEL32.SetFilePoi&gt;; \SetFilePointer
004FE9FC&nbsp;&nbsp; . 59&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; POP ECX
004FE9FD&nbsp;&nbsp; . 90&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NOP
004FE9FE&nbsp;&nbsp; . 8BE9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV EBP,ECX
004FEA00&nbsp;&nbsp; . 90&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NOP
004FEA01&nbsp;&nbsp; . 90&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NOP
004FEA02&nbsp;&nbsp; . 90&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NOP
004FEA03&nbsp;&nbsp; . 8B5C24 14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOV EBX,DWORD PTR SS:[ESP+14]
004FEA07&nbsp;&nbsp; . 6A 00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PUSH 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; /</span><span class="pln">pOverlapped </span><span class="pun">=</span><span class="pln"> NULL
</span><span class="lit">004FEA09</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">8D0424</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LEA EAX</span><span class="pun">,</span><span class="pln">DWORD PTR SS</span><span class="pun">:[</span><span class="pln">ESP</span><span class="pun">]</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="pln">
</span><span class="lit">004FEA0C</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">90</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NOP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="pln">
</span><span class="lit">004FEA0D</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">50</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH EAX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="pln">pBytesRead
</span><span class="lit">004FEA0E</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">90</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NOP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="pln">
</span><span class="lit">004FEA0F</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">53</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH EBX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="typ">BytesToRead</span><span class="pln">
</span><span class="lit">004FEA10</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">56</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH ESI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="typ">Buffer</span><span class="pln">
</span><span class="lit">004FEA11</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">51</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH ECX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="pln">hFile
</span><span class="lit">004FEA12</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> FF15 D0105000&nbsp;&nbsp;CALL DWORD PTR DS</span><span class="pun">:[&lt;&amp;</span><span class="pln">KERNEL32</span><span class="pun">.</span><span class="typ">ReadFile</span><span class="pun">&gt;]</span><span class="pln"> </span><span class="pun">;</span><span class="pln"> \ReadFile
</span><span class="lit">004FEA18</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">90</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NOP
</span><span class="lit">004FEA19</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">90</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NOP
</span><span class="lit">004FEA1A</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">8BCD</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV ECX</span><span class="pun">,</span><span class="pln">EBP
</span><span class="lit">004FEA1C</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">90</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NOP
</span><span class="lit">004FEA1D</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">51</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH ECX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">/</span><span class="pln">hObject
</span><span class="lit">004FEA1E</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> FF15 C8105000&nbsp;&nbsp;CALL DWORD PTR DS</span><span class="pun">:[&lt;&amp;</span><span class="pln">KERNEL32</span><span class="pun">.</span><span class="typ">CloseHandl</span><span class="pun">&gt;;</span><span class="pln"> \CloseHandle
</span><span class="lit">004FEA24</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">57</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH EDI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">/</span><span class="pln">hMemory
</span><span class="lit">004FEA25</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> FF15 </span><span class="lit">60115000</span><span class="pln">&nbsp;&nbsp;CALL DWORD PTR DS</span><span class="pun">:[&lt;&amp;</span><span class="pln">KERNEL32</span><span class="pun">.</span><span class="typ">LocalFree</span><span class="pun">&gt;&gt;;</span><span class="pln"> \LocalFree
</span><span class="lit">004FEA2B</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">90</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NOP
</span><span class="lit">004FEA2C</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">90</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NOP
</span><span class="lit">004FEA2D</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">5F</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; POP EDI
</span><span class="lit">004FEA2E</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">5E</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; POP ESI
</span><span class="lit">004FEA2F</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">5D</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; POP EBP
</span><span class="lit">004FEA30</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">5A</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; POP EDX
</span><span class="lit">004FEA31</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">59</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; POP ECX
</span><span class="lit">004FEA32</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">5B</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; POP EBX
</span><span class="lit">004FEA33</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">58</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; POP EAX
</span><span class="lit">004FEA34</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">90</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NOP
</span><span class="lit">004FEA35</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">90</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NOP
</span><span class="lit">004FEA36</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">5F</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; POP EDI
</span><span class="lit">004FEA37</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">8BC6</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV EAX</span><span class="pun">,</span><span class="pln">ESI
</span><span class="lit">004FEA39</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">5E</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; POP ESI
</span><span class="lit">004FEA3A</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">5D</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; POP EBP
</span><span class="lit">004FEA3B</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">5B</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; POP EBX
</span><span class="lit">004FEA3C</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> </span><span class="lit">83C4</span><span class="pln"> </span><span class="lit">50</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADD ESP</span><span class="pun">,</span><span class="lit">50</span><span class="pln">
</span><span class="lit">004FEA3F</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">.</span><span class="pln"> C2 </span><span class="lit">0C00</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETN </span><span class="lit">0C</span></pre><br><br>剩下的就是干掉HASH验证，还有一些默认字体，全角空格什么的问题，这里就省略了。<div id="alert_tpc" style="color: gray; margin-top: 30px; --darkreader-inline-color:#bfb9ac;" data-darkreader-inline-color="">[ 此帖被clowwindy在2011-10-02 22:15重新编辑 ]</div></div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_tpc" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2011-10-02 22:05 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 楼主(clowwindy) 的帖子');" data-mx-warn="Empty URL">[楼 主]</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="4554118" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570905904-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>Gyc</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=41138" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570905904-4d23c94f646ff98f96236241ba6810a9.png" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_1"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空二年生下学期</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570905904-14d3050259d6ae6cb4b43275cd83308d.gif"><br>

<span class="user-info2" id="showface_1">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">1346</span><br>
学分: <span class="s2 f9">4 点</span><br>
澄空币: <span class="s3 f9">879 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2006-03-05<br>
		最后登录:2016-09-22 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_4554118" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=11010868&amp;pid=4554118&amp;article=1" onclick="return sendurl(this,4,event)" id="quote_4554118" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=11010868&amp;pid=4554118&amp;article=1" id="modify_4554118" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=41138" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=11010868&amp;pid=4554118" onclick="return sendurl(this,8)" id="report_4554118" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=11010868&amp;uid=41138" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('4554118')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_4554118" class="fl">&nbsp;</h1>
			

			<div id="p_4554118" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_4554118">膜拜一下， 楼主的强大～～<br><br>汇编什么， 完全不懂的说</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_4554118" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2011-10-02 23:33 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 1楼(Gyc) 的帖子');" data-mx-warn="Empty URL">1 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="5228593" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570905904-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>tony_jansan</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=524434" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570905904-4e7b80c5ceee57e53ab948c857057210.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_2"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空新生</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570905904-be59bc9a4edb96b6b54ba67c9267b93f.gif"><br>

<span class="user-info2" id="showface_2">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">11</span><br>
学分: <span class="s2 f9">0 点</span><br>
澄空币: <span class="s3 f9">553 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2010-11-21<br>
		最后登录:2018-12-30 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_5228593" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=11010868&amp;pid=5228593&amp;article=2" onclick="return sendurl(this,4,event)" id="quote_5228593" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=11010868&amp;pid=5228593&amp;article=2" id="modify_5228593" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=524434" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=11010868&amp;pid=5228593" onclick="return sendurl(this,8)" id="report_5228593" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=11010868&amp;uid=524434" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('5228593')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_5228593" class="fl">&nbsp;</h1>
			

			<div id="p_5228593" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_5228593">LZ没给出decryptPb3的过程，个人尝试过解出.pb3文件，但是无法进一步获取图像数据（打开文件看过~感觉ps2类似同样有加密）~应该.pb3还是经过一层加密压缩吧~求指点啊~<br><br>PS:python写双字处理...高手啊...（是在linux下吧？我记得win32下貌似没有rol32(,)这东西的说）</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_5228593" class="c"></div>

		<div><img src="assets/1570905904-ee75bbe39bae3a2e6fc29b9593dde416.png" align="absbottom"></div>
		<div class="card" style="overflow:hidden;">
			<table width="100%">
				<tbody><tr>
					<td id="ck_card_container_5228593">
					<img src="assets/1570905904-09d5f0412d98d0df2a1c5c86dbd87eef.png" width="224" border="0"> <img src="assets/1570905904-18b83bf7612a5ed07481dbb0c1a7dd01.png" width="224" border="0"> <img src="assets/1570905904-ac579194f77119aa423b6271cd9f8278.png" width="224" border="0"> </td><td>
				</td></tr>
				
			</tbody></table>
		</div>


		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2012-08-03 14:50 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 2楼(tony_jansan) 的帖子');" data-mx-warn="Empty URL">2 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="5229529" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570905904-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>idid233</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=807617" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570905904-bc3b3631a24154c2d9ba8189508a5212.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_3"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">新注册会员</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570905904-be59bc9a4edb96b6b54ba67c9267b93f.gif"><br>

<span class="user-info2" id="showface_3">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">3</span><br>
学分: <span class="s2 f9">0 点</span><br>
澄空币: <span class="s3 f9">651 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2012-07-23<br>
		最后登录:2012-08-09 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_5229529" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=11010868&amp;pid=5229529&amp;article=3" onclick="return sendurl(this,4,event)" id="quote_5229529" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=11010868&amp;pid=5229529&amp;article=3" id="modify_5229529" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=807617" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=11010868&amp;pid=5229529" onclick="return sendurl(this,8)" id="report_5229529" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=11010868&amp;uid=807617" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('5229529')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_5229529" class="fl">&nbsp;</h1>
			

			<div id="p_5229529" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_5229529">c神碉堡了<br>我搞了一会死合わせ家族部就放弃了<br>有一地段循环被编译器优化成了巨长的函数 <br>哈希太简单直接写回去就是了<br><br>另外值得一说的是两次lzss解压缩buffer是不一样大的，不过这个压缩挺简单，反推很容易</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_5229529" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2012-08-03 18:50 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 3楼(idid233) 的帖子');" data-mx-warn="Empty URL">3 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="5233985" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570905904-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>tony_jansan</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=524434" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570905904-4e7b80c5ceee57e53ab948c857057210.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_4"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空新生</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570905904-be59bc9a4edb96b6b54ba67c9267b93f.gif"><br>

<span class="user-info2" id="showface_4">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">11</span><br>
学分: <span class="s2 f9">0 点</span><br>
澄空币: <span class="s3 f9">553 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2010-11-21<br>
		最后登录:2018-12-30 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_5233985" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=11010868&amp;pid=5233985&amp;article=4" onclick="return sendurl(this,4,event)" id="quote_5233985" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=11010868&amp;pid=5233985&amp;article=4" id="modify_5233985" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=524434" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=11010868&amp;pid=5233985" onclick="return sendurl(this,8)" id="report_5233985" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=11010868&amp;uid=524434" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('5233985')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_5233985" class="fl">&nbsp;</h1>
			

			<div id="p_5233985" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_5233985">两次lzss解压？不就用到一次lzss算法decode吗？难道pb3经过了两次压缩吗？没太看懂~<br><br>暂时还没尝试用LZ提供的lzss数据结构和方法去解压~目前转存出来的.pb3文件结构大致如下：<br><br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code15'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code15" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="typ">Offset</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="lit">0</span><span class="pln">&nbsp;&nbsp;</span><span class="lit">1</span><span class="pln">&nbsp;&nbsp;</span><span class="lit">2</span><span class="pln">&nbsp;&nbsp;</span><span class="lit">3</span><span class="pln">&nbsp;&nbsp;</span><span class="lit">4</span><span class="pln">&nbsp;&nbsp;</span><span class="lit">5</span><span class="pln">&nbsp;&nbsp;</span><span class="lit">6</span><span class="pln">&nbsp;&nbsp;</span><span class="lit">7</span><span class="pln">&nbsp;&nbsp; </span><span class="lit">8</span><span class="pln">&nbsp;&nbsp;</span><span class="lit">9</span><span class="pln"> </span><span class="lit">10</span><span class="pln"> </span><span class="lit">11</span><span class="pln"> </span><span class="lit">12</span><span class="pln"> </span><span class="lit">13</span><span class="pln"> </span><span class="lit">14</span><span class="pln"> </span><span class="lit">15</span><span class="pln">

</span><span class="lit">00000000</span><span class="pln">&nbsp;&nbsp; </span><span class="lit">50</span><span class="pln"> </span><span class="lit">42</span><span class="pln"> </span><span class="lit">33</span><span class="pln"> </span><span class="lit">42</span><span class="pln"> A4 </span><span class="lit">20</span><span class="pln"> </span><span class="lit">09</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp;&nbsp;A8 </span><span class="lit">19</span><span class="pln"> </span><span class="lit">8E</span><span class="pln"> </span><span class="lit">17</span><span class="pln"> </span><span class="lit">09</span><span class="pln"> </span><span class="lit">67</span><span class="pln"> B0 DB&nbsp;&nbsp; PB3B</span><span class="pun">?..??.</span><span class="pln">g</span><span class="pun">佰</span><span class="pln">
</span><span class="lit">00000016</span><span class="pln">&nbsp;&nbsp; </span><span class="lit">2C</span><span class="pln"> </span><span class="lit">5B</span><span class="pln"> </span><span class="lit">31</span><span class="pln"> AD A9 </span><span class="lit">62</span><span class="pln"> </span><span class="lit">1F</span><span class="pln"> </span><span class="lit">37</span><span class="pln">&nbsp;&nbsp;DB E8 </span><span class="lit">54</span><span class="pln"> AD </span><span class="lit">6D</span><span class="pln"> FE </span><span class="lit">87</span><span class="pln"> </span><span class="lit">71</span><span class="pln">&nbsp;&nbsp; </span><span class="pun">,[</span><span class="lit">1</span><span class="pun">?</span><span class="pln">b</span><span class="pun">.</span><span class="lit">7</span><span class="pun">坭</span><span class="pln">T</span><span class="pun">璵</span><span class="pln">q
</span><span class="lit">00000032</span><span class="pln">&nbsp;&nbsp; </span><span class="lit">7A</span><span class="pln"> </span><span class="lit">1C</span><span class="pln"> </span><span class="lit">71</span><span class="pln"> F0 B0 </span><span class="lit">5C</span><span class="pln"> </span><span class="lit">1B</span><span class="pln"> </span><span class="lit">77</span><span class="pln">&nbsp;&nbsp;</span><span class="lit">2A</span><span class="pln"> </span><span class="lit">5A</span><span class="pln"> C5 B6 CE </span><span class="lit">16</span><span class="pln"> E1 </span><span class="lit">74</span><span class="pln">&nbsp;&nbsp; z</span><span class="pun">.</span><span class="pln">q</span><span class="pun">鸢</span><span class="pln">\.w</span><span class="pun">*</span><span class="pln">Z</span><span class="pun">哦?醫</span><span class="pln">
</span><span class="lit">00000048</span><span class="pln">&nbsp;&nbsp; </span><span class="lit">55</span><span class="pln"> AF CC B6 </span><span class="lit">4A</span><span class="pln"> </span><span class="lit">42</span><span class="pln"> </span><span class="lit">50</span><span class="pln"> </span><span class="lit">31</span><span class="pln">&nbsp;&nbsp;</span><span class="lit">2C</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">02</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> C0 </span><span class="lit">58</span><span class="pln">&nbsp;&nbsp; U</span><span class="pun">?禞</span><span class="pln">BP1</span><span class="pun">,.....繶</span><span class="pln">
</span><span class="lit">00000064</span><span class="pln">&nbsp;&nbsp; </span><span class="lit">64</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">04</span><span class="pln"> A8 </span><span class="lit">02</span><span class="pln">&nbsp;&nbsp;</span><span class="lit">18</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp;&nbsp; d</span><span class="pun">.....?........</span><span class="pln">
</span><span class="lit">00000080</span><span class="pln">&nbsp;&nbsp; </span><span class="lit">30</span><span class="pln"> </span><span class="lit">54</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">38</span><span class="pln"> CB </span><span class="lit">08</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp;&nbsp;</span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp;&nbsp; </span><span class="lit">0T</span><span class="pun">..</span><span class="lit">8</span><span class="pun">?.........</span><span class="pln">
</span><span class="lit">00000096</span><span class="pln">&nbsp;&nbsp; </span><span class="lit">24</span><span class="pln"> </span><span class="lit">01</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> F3 </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp;&nbsp;</span><span class="lit">5A</span><span class="pln"> </span><span class="lit">01</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">2A</span><span class="pln"> </span><span class="lit">02</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp;&nbsp; $</span><span class="pun">...?..</span><span class="pln">Z</span><span class="pun">...*...</span><span class="pln">
</span><span class="lit">00000112</span><span class="pln">&nbsp;&nbsp; </span><span class="lit">22</span><span class="pln"> </span><span class="lit">04</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">8E</span><span class="pln"> </span><span class="lit">05</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp;&nbsp;</span><span class="lit">09</span><span class="pln"> </span><span class="lit">07</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">34</span><span class="pln"> </span><span class="lit">09</span><span class="pln"> </span><span class="lit">00</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp;&nbsp; </span><span class="str">"...?......4...
00000128&nbsp;&nbsp; F0 0A 00 00 6C 08 00 00&nbsp;&nbsp;56 0B 00 00 46 02 00 00&nbsp;&nbsp; ?..l...V...F...
00000144&nbsp;&nbsp; 00 00 00 00 00 00 00 00&nbsp;&nbsp;00 00 00 00 00 00 00 00&nbsp;&nbsp; ................
00000160&nbsp;&nbsp; 4D CD 01 00 BB AB 03 00&nbsp;&nbsp;53 0A 03 00 37 55 02 00&nbsp;&nbsp; M?.猾..S...7U..
00000176&nbsp;&nbsp; 76 7E 01 00 06 CB 00 00&nbsp;&nbsp;C1 5B 00 00 65 20 00 00&nbsp;&nbsp; v~...?.羀..e ..
00000192&nbsp;&nbsp; B3 07 00 00 AD 00 00 00&nbsp;&nbsp;00 00 00 00 00 00 00 00&nbsp;&nbsp; ?..?..........
00000208&nbsp;&nbsp; 00 00 00 00 00 00 00 00&nbsp;&nbsp;00 00 00 00 2A 20 00 00&nbsp;&nbsp; ............* ..
00000224&nbsp;&nbsp; 00 01 02 03 04 05 06 07&nbsp;&nbsp;08 0F 09 0A 0C 0B 0D 0E&nbsp;&nbsp; ................
00000240&nbsp;&nbsp; 01 01 01 01 01 01 01 01&nbsp;&nbsp;01 01 01 01 01 01 01 01&nbsp;&nbsp; ................
00000256&nbsp;&nbsp; 01 01 01 01 01 01 01 01&nbsp;&nbsp;01 01 01 01 01 01 01 01&nbsp;&nbsp; ................
00000272&nbsp;&nbsp; 01 01 01 01 01 01 01 01&nbsp;&nbsp;01 01 01 01 01 01 01 01&nbsp;&nbsp; ................
00000288&nbsp;&nbsp; 01 01 01 01 01 01 01 01&nbsp;&nbsp;01 01 01 01 01 01 01 01&nbsp;&nbsp; ................
00000304&nbsp;&nbsp; 01 01 01 01 01 01 01 01&nbsp;&nbsp;01 01 01 01 01 01 01 01&nbsp;&nbsp; ................
00000320&nbsp;&nbsp; 01 01 01 01 01 01 01 01&nbsp;&nbsp;01 01 01 01 01 01 01 01&nbsp;&nbsp; ................
00000336&nbsp;&nbsp; 01 01 01 01 01 01 01 01&nbsp;&nbsp;01 01 01 01 01 01 01 01&nbsp;&nbsp; ................
00000352&nbsp;&nbsp; 01 01 01 01 01 01 01 01&nbsp;&nbsp;01 01 01 01 01 01 01 01&nbsp;&nbsp; ................
00000368&nbsp;&nbsp; 52 96 48 39 83 9C B7 87&nbsp;&nbsp;F7 6B 2B E8 A0 77 49 59&nbsp;&nbsp; R朒9儨穱鱧+锠wIY
00000384&nbsp;&nbsp; B5 F8 7E 97 B8 CA B7 5F&nbsp;&nbsp;5E E3 8B 94 07 70 42 5E&nbsp;&nbsp; 跌~椄史_^銒?pB^
00000400&nbsp;&nbsp; 35 A5 AB 89 ED 0D AF 29&nbsp;&nbsp;F7 AF 37 AE A5 C6 8F F4&nbsp;&nbsp; 5カ夗.?鳢7???
00000416&nbsp;&nbsp; 13 78 29 72 AC 66 1F 88&nbsp;&nbsp;CF CA 5B 6B 2D D9 E5 1F&nbsp;&nbsp; .x)r琭.埾蔥k-馘.
00000432&nbsp;&nbsp; 3E F5 5B 3D 58 ED FD F5&nbsp;&nbsp;5E FC E1 DF 56 77 87 FD&nbsp;&nbsp; &gt;鮗=X睚鮚?遃w圐
00000448&nbsp;&nbsp; DF F9 95 ED 46 CC 9B 8E&nbsp;&nbsp;7A 78 EA BD EA 45 7B 0E&nbsp;&nbsp; 啭曧F虥巣x杲闑{.
00000464&nbsp;&nbsp; AB 57 7A 9E 28 BB 84 F5&nbsp;&nbsp;F7 F1 68 5B 53 C3 2B 12&nbsp;&nbsp; 玏z?粍貅駂[S?.
00000480&nbsp;&nbsp; CE 0A BF 9E 23 B6 B7 86&nbsp;&nbsp;95 C5 7A 0A DD D9 25 7E&nbsp;&nbsp; ?繛#斗啎舲.葙%~
00000496&nbsp;&nbsp; BA 6C B3 12 BA 44 C4 6D&nbsp;&nbsp;F6 88 3D C3 3C 6D D1 A1&nbsp;&nbsp; 簂?篋膍鰣=?m选
00000512&nbsp;&nbsp; 6D B6 67 58 A6 2D 3A B0&nbsp;&nbsp;CD F6 0C EB B4 59 07 F6&nbsp;&nbsp; m秅X?:巴?氪Y.?
00000528&nbsp;&nbsp; 88 3D C3 36 6D D6 BE D5&nbsp;&nbsp;A8 3D C3 36 6D D6 AE 3D&nbsp;&nbsp; ??m志炸=?m之=
00000544&nbsp;&nbsp; 66 CF B0 4F 9B B4 67 35&nbsp;&nbsp;6E CF B0 4F 9B B4 6B 3D&nbsp;&nbsp; f习O洿g5n习O洿k=
00000560&nbsp;&nbsp; 66 CF 70 4C 1B B7 67 1A&nbsp;&nbsp;B1 67 38 A6 8D 3A B4 47&nbsp;&nbsp; f蟨L.穏.眊8?:碐</span></pre><br>后略...都是看不懂的（加密|压缩?）数据块...<br><br>感觉224-367这段像是分隔符~前边如果全部是文件头的话感觉很恐怖的说...这块比较搞不懂的是应该如何解压，把368以后的数据都放入lzss decode进行解码还是说需要解出文件头中的某段数据来处理后边的数据块呢？<br><br>不行的话是不还得动态跟cmvs.exe...</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_5233985" class="c"></div>

		<div><img src="assets/1570905904-ee75bbe39bae3a2e6fc29b9593dde416.png" align="absbottom"></div>
		<div class="card" style="overflow:hidden;">
			<table width="100%">
				<tbody><tr>
					<td id="ck_card_container_5233985">
					<img src="assets/1570905904-09d5f0412d98d0df2a1c5c86dbd87eef.png" width="224" border="0"> <img src="assets/1570905904-18b83bf7612a5ed07481dbb0c1a7dd01.png" width="224" border="0"> <img src="assets/1570905904-ac579194f77119aa423b6271cd9f8278.png" width="224" border="0"> </td><td>
				</td></tr>
				
			</tbody></table>
		</div>


		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2012-08-04 17:59 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 4楼(tony_jansan) 的帖子');" data-mx-warn="Empty URL">4 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="a" data-mx-warn="Empty URL"></a><a name="5234286" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570905904-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>idid233</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=807617" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570905904-bc3b3631a24154c2d9ba8189508a5212.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_5"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">新注册会员</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570905904-be59bc9a4edb96b6b54ba67c9267b93f.gif"><br>

<span class="user-info2" id="showface_5">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">3</span><br>
学分: <span class="s2 f9">0 点</span><br>
澄空币: <span class="s3 f9">651 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2012-07-23<br>
		最后登录:2012-08-09 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_5234286" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=11010868&amp;pid=5234286&amp;article=5" onclick="return sendurl(this,4,event)" id="quote_5234286" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=11010868&amp;pid=5234286&amp;article=5" id="modify_5234286" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=807617" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=11010868&amp;pid=5234286" onclick="return sendurl(this,8)" id="report_5234286" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=11010868&amp;uid=807617" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('5234286')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_5234286" class="fl">&nbsp;</h1>
			

			<div id="p_5234286" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_5234286"><h6 class="quote">Quote:</h6><blockquote class="blockquote">引用第4楼tony_jansan于2012-08-04 17:59发表的&nbsp;&nbsp;:<br>两次lzss解压？不就用到一次lzss算法decode吗？难道pb3经过了两次压缩吗？没太看懂~<br><br>暂时还没尝试用LZ提供的lzss数据结构和方法去解压~目前转存出来的.pb3文件结构大致如下：<br><br>[code]<br>.......</blockquote><br><br>没人说两次解压啊？<br>我只是说新版本的indexs和data解压的buffer不一样大而已</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_5234286" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2012-08-04 19:25 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 5楼(idid233) 的帖子');" data-mx-warn="Empty URL">5 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

</form>
<div class="t3" style="margin:initial"><table cellspacing="0" cellpadding="0" width="100%" align="center">
	<tbody><tr><td align="left"></td>
		<td valign="center" align="right">
		<a class="abtn f_two" id="readlog" onclick="sendmsg('pw_ajax.php?action=readlog','',this.id);" data-mx-warn="Empty URL">帖子浏览记录<img src="assets/1570905904-5c8e409588b73ce4284cf5b9bd619e15.gif"></a>
		<select onchange="Fjump(this.options[this.selectedIndex].value)"><option value="" selected="">快速跳至</option>
<option value="1">&gt;&gt; 『澄空学园 办公楼区』</option>
<option value="2"> &nbsp;|- 【校园公告栏】</option>
<option value="5"> &nbsp;|- 【论坛意见箱】</option>
<option value="113">&gt;&gt; 『澄空学园 资讯社』</option>
<option value="47"> &nbsp;|- 【新鲜速报】</option>
<option value="103"> &nbsp;|- 【新作介绍】</option>
<option value="8"> &nbsp; &nbsp;|-  【电子杂志下载区】</option>
<option value="104"> &nbsp;|- 【杂志专题】</option>
<option value="7">&gt;&gt; 『澄空学园 教学楼区』</option>
<option value="62"> &nbsp;|- 【AGE主题学部】</option>
<option value="39"> &nbsp;|- 【Akabeesoft2主题学部】</option>
<option value="100"> &nbsp;|- 【AUGUST主题学部】</option>
<option value="42"> &nbsp;|- 【CIRCUS主题学部】</option>
<option value="40"> &nbsp;|- 【Cotton-Nekoneko主题学部】</option>
<option value="64"> &nbsp;|- 【GIGA主题学部】</option>
<option value="38"> &nbsp;|- 【Key主题学部】</option>
<option value="10"> &nbsp;|- 【KID主题学部】</option>
<option value="37"> &nbsp;|- 【Leaf主题学部】</option>
<option value="70"> &nbsp;|- 【minori主题学部】</option>
<option value="12"> &nbsp;|- 【Navel主题学部】</option>
<option value="65"> &nbsp;|- 【Nitro+主题学部】</option>
<option value="14"> &nbsp;|- 【Type-Moon应援会】</option>
<option value="17"> &nbsp; &nbsp;|-  【TM精华区】</option>
<option value="98"> &nbsp;|- 【Will主题学部】</option>
<option value="116"> &nbsp;|- 【FAVORITE主题学部】</option>
<option value="108"> &nbsp;|- 【ALcot主题学部】</option>
<option value="55"> &nbsp;|- 【GALGAME综合作品讨论室】</option>
<option value="97"> &nbsp; &nbsp;|-  【Light主题学部】</option>
<option value="117"> &nbsp; &nbsp;|-  【CUFFS主题学部】</option>
<option value="15"> &nbsp; &nbsp;|-  【Liar Soft主题学部】</option>
<option value="57"> &nbsp; &nbsp;|-  【Purple 主题学部】</option>
<option value="13"> &nbsp; &nbsp;|-  【工画堂主题学部】</option>
<option value="35"> &nbsp;|- 【GALGAME综合杂谈室】</option>
<option value="99"> &nbsp;|- 【ぱれっと主题学部】</option>
<option value="122"> &nbsp;|- 【SAGA PLANETS研讨室】</option>
<option value="123"> &nbsp;|- 【Lump of Sugar 研讨室】</option>
<option value="86">&gt;&gt; 『澄空学园 图书馆』</option>
<option value="80"> &nbsp;|- 【游戏鉴赏室】</option>
<option value="56"> &nbsp;|- 【GALGAME攻略馆】</option>
<option value="115"> &nbsp;|- 【作品出处问询室】</option>
<option value="63"> &nbsp;|- 【Galgame疑问求助室】</option>
<option value="18">&gt;&gt; 『澄空学园 教辅楼区』</option>
<option value="73"> &nbsp;|- 【同人游戏区】</option>
<option value="60"> &nbsp;|- 【二次元轻小说社】</option>
<option value="20"> &nbsp;|- 【日语自学教室】</option>
<option value="61"> &nbsp; &nbsp;|-  【日语学习资料区】</option>
<option value="118"> &nbsp; &nbsp;|-  【日语参考文章区】</option>
<option value="21"> &nbsp;|- 【一般游戏社团】</option>
<option value="24"> &nbsp;|- 【多媒体课堂】</option>
<option value="88">&gt;&gt; 『澄空学园 原创综合区』</option>
<option value="79"> &nbsp;|- 【原创游戏部】</option>
<option value="36"> &nbsp; &nbsp;|-  【ss-square】</option>
<option value="89"> &nbsp;|- 【MAD研究室】</option>
<option value="91"> &nbsp;|- 【莉可屋 REC ROOM】</option>
<option value="119"> &nbsp; &nbsp;|-  【澄空百合社翻唱作品】</option>
<option value="19"> &nbsp;|- 【澄空文学部】</option>
<option value="120"> &nbsp; &nbsp;|-  【落日余晖】</option>
<option value="23"> &nbsp;|- 【绘画工房】</option>
<option value="69"> &nbsp;|- 【活动投票区】</option>
<option value="74"> &nbsp;|- 【友谊赛投票区】</option>
<option value="58"> &nbsp;|- 【澄空部活室】</option>
<option value="41"> &nbsp;|- 【暑假原创作品活动专区】</option>
<option value="59"> &nbsp;|- 【实物周边交流区】</option>
<option value="85"> &nbsp; &nbsp;|-  【ComicMarket相关资料】</option>
<option value="82"> &nbsp; &nbsp;|-  【新品介绍】</option>
<option value="84"> &nbsp; &nbsp;|-  【综合交流】</option>
<option value="83"> &nbsp; &nbsp;|-  【好物收集】</option>
<option value="81"> &nbsp; &nbsp;|-  【交易求购】</option>
<option value="95"> &nbsp;|- 【澄空放送部】</option>
<option value="111"> &nbsp; &nbsp;|-  【放送策划室】</option>
<option value="27"> &nbsp;|- 【水下乐园LeMU】</option>
<option value="46"> &nbsp; &nbsp;|-  【美工作品收藏室】</option>
<option value="26"> &nbsp; &nbsp;|-  【COS自爆馆】</option>
<option value="90"> &nbsp; &nbsp;|-  【澄空期刊室】</option>
<option value="71"> &nbsp;|- 【澄空演剧部】</option>
<option value="9"> &nbsp; &nbsp;|-  演剧部排练室</option>
<option value="52"> &nbsp;|- 【废帖回收站】</option>
<option value="29">&gt;&gt; 『澄空学园 好物交流站』</option>
<option value="50"> &nbsp;|- 【澄空学园字幕作品】</option>
<option value="51"> &nbsp;|- 【澄空学园漫画作品】</option>
<option value="77"> &nbsp;|- 【游戏汉化交流区】</option>
<option value="28"> &nbsp; &nbsp;|-  【CK-GAL中文化小组】</option>
<option value="106"> &nbsp; &nbsp;|-  【PRO2】</option>
<option value="49"> &nbsp; &nbsp;|-      【桜】</option>
<option value="30"> &nbsp;|- 【资源求助区】</option>
<option value="32"> &nbsp;|- 【澄空音乐厅】</option>
<option value="33"> &nbsp;|- 【澄空美术馆】</option>
<option value="34"> &nbsp;|- 【动漫租售屋】</option>
<option value="44">&gt;&gt; 『澄空学园 课余工作区』</option>
<option value="45"> &nbsp;|- 【澄空漫画汉化组】</option>
<option value="48"> &nbsp;|-  【澄空学园字幕组】</option>
<option value="101"> &nbsp; &nbsp;|-  字幕组资料区</option>
<option value="72"> &nbsp;|- 【澄空学园分流组】</option>
<option value="87"> &nbsp;|- 【澄空学园新闻组】</option>
<option value="96"> &nbsp;|- 【澄空学园文学社】</option>
<option value="75"> &nbsp;|- 【澄空学园百合社】</option>
<option value="112"> &nbsp;|- 【澄空学园编辑部】</option>
<option value="114"> &nbsp;|- 【澄空学园美工部】</option>
<option value="121"> &nbsp;|-  【澄空祭运行委员会】</option>
</select></td>
		
	</tr>
	<tr><td style="padding-top: 12px;text-align: left;"><img src="assets/1570905904-ca4a91079181c2a5cb3514b2e5b5f035.gif" align="absbottom"> <b><a href="https://bbs.sumisora.net/index.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">『澄空学园』</a> » <a href="https://bbs.sumisora.net/thread.php?fid=78&amp;page=5" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">【汉化破解研讨室】</a></b> </td>
	<td style="padding-top: 12px;text-align: right;"><a href="https://bbs.sumisora.net/post.php?action=reply&amp;fid=78&amp;tid=11010868" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img src="assets/1570905904-132cb83b134d7ecd9b390389d489bc43.png"></a>

<a href="https://bbs.sumisora.net/post.php?fid=78" style="margin-left:.5em" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img src="assets/1570905904-8cab7ee31ae503cf78e5410d40cec291.png" id="td_post1"></a>
</td>
	</tr>
</tbody></table></div>




<form name="FORM" method="post" action="post.php?" enctype="multipart/form-data" onsubmit="return checkpost(document.FORM);">
<div class="t" style="margin-top:8px"><table cellspacing="0" cellpadding="0" align="center" width="100%">
	<tbody><tr>
		<td class="h" colspan="3"><b>快速发帖</b></td>
	</tr>
	<tr></tr>
	<tr class="tr2"><td colspan="100" style="border-bottom: 0px; --darkreader-inline-border-bottom: initial;" data-darkreader-inline-border-bottom=""></td></tr>
	<tr>
		<td valign="top" width="20%" class="f_one" style="padding:7px">
		<fieldset id="smiliebox" style="border: 1px solid rgb(213, 229, 232); --darkreader-inline-border-top:#354e51; --darkreader-inline-border-right:#354e51; --darkreader-inline-border-bottom:#354e51; --darkreader-inline-border-left:#354e51;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
		<legend>内容</legend>
		<br>
		<input type="checkbox" name="atc_usesign" value="1" checked="">使用签名<br>
		<input type="checkbox" name="atc_convert" value="1" checked="">Wind Code自动转换 <br>
	 	<input type="checkbox" id="atc_autoimg" name="atc_autoimg" value="1" onchange="onAutoImgchange()" checked="" title="此设置会记在浏览器中"><label for="atc_autoimg" title="此设置会记在浏览器中">自动分析img</label><br><br>
	 	
		<input type="checkbox" name="atc_requiresell" value="1" disabled="">出售此帖
		<input class="input" type="text" maxlength="3" size="3" name="atc_money" value="0">
		<br>
		<input type="checkbox" name="atc_requirervrc" value="1">加密此帖
		<input class="input" type="text" maxlength="6" size="3" name="atc_rvrc" value="0">
		<br>
		<br><br><a href="https://bbs.sumisora.net/read.php?tid=10925672" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">如何在帖子中贴图？</a>
		<br><a href="https://bbs.sumisora.net/read.php?tid=10942243" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Wind Code使用教程</a>
		<br><a href="https://bbs.sumisora.net/yume/recover/" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">恢复帖子内容</a>
		</fieldset>
		</td>
		<td width="60%" class="f_one" style="padding:7px">
		<div>


<blockquote style="width: 96%;" class="blockquote">澄空娘：『转帖请标注[转帖]，并注明原作者和出处，这是对原作者的尊重
』</blockquote>

		<input type="text" class="input" name="atc_title" value="Re:明日の君と逢うために分析" size="65">
		

		 认证码: <input class="input" type="text" name="gdcode" size="5" tabindex="6" onfocus="try{opencode('menu_gd',this)}catch(e){}"><br>
		

		</div><div style="padding:.3em 0">
		</div>
		<textarea onkeydown="quickpost(event)" id="atc_content" name="atc_content" rows="8" style="width:96%"></textarea>
		
		
		
		
		
		<div style="margin:5px 0">
		<div style="padding: 4px 10px 0px 0px; float: left; color: rgb(136, 136, 136); --darkreader-inline-color:#bfb9ac;" data-darkreader-inline-color="">按 Ctrl+Enter 直接提交</div>
		<input class="btn" type="submit" name="Submit" value=" 提 交 "></div>
		</td>
		<td width="20%" class="f_one">
		<div style="padding:3px; text-align:center; width:200px;">
		<fieldset id="smiliebox" style="border: 1px solid rgb(213, 229, 232); --darkreader-inline-border-top:#354e51; --darkreader-inline-border-right:#354e51; --darkreader-inline-border-bottom:#354e51; --darkreader-inline-border-left:#354e51;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<legend>表情</legend>
			<div id="menu_show"></div>
<span style="float:right; margin:3px 10px 5px;"><a id="td_face" style="cursor:pointer;" onclick="showDefault();" align="absmiddle" unselectable="on" data-mx-warn="Empty URL">[更多]</a></span>
<span style="float:left; margin:3px 10px 5px;"><a id="td_generalface" style="cursor:pointer;" onclick="showfaces();$('#td_generalface').fadeOut();" align="absmiddle" data-mx-warn="Empty URL">[显示表情]</a></span>
		</fieldset></div>
		
		
		</td>
	</tr>
</tbody></table></div></form>







</div>
<div id="bottom"></div><br>
<center class="gray">
<small><span id="windspend">Total 0.055560(s) query 6, Time is now 10-13 02:43, 
Load is low.
</span> <br>
Powered by <a href="http://www.phpwind.net/" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><b>PHPWind</b></a> <a href="http://www.phpwind.net/" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><b style="color: rgb(255, 153, 0); --darkreader-inline-color:#f7b24b;" data-darkreader-inline-color="">v6.3.2</b></a> Code © 2003-08 <a href="http://www.phpwind.com/" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><b>PHPWind.com</b></a> Corporation</small>
</center><br>
<div id="footer">
	<span class="f12 fl"></span><a href="https://bbs.sumisora.net/sendmail.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Contact us</a>

</div>
</div>
        
      </div>
    </body>
  </html>