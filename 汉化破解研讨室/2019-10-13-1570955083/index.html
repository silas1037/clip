
  <!DOCTYPE html>
  <html id="" class="">
    <!-- OriginalSrc: https://bbs.sumisora.net/read.php?tid=10974554&fpage=7 -->
    <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />

      <title>关于yga图片问题|【汉化破解研讨室】|【游戏汉化交流区】 - 『澄空学园』 GalGame专题网</title>
      

<link rel="stylesheet" type="text/css" href="assets/1570955083-5f21d2d0f0e14c54e3e080ff47c8ec08.css" referrerpolicy="no-referrer">
<link type="text/css" href="assets/1570955083-2f10d407050ab6b2185fb483267feb32.css" rel="stylesheet" referrerpolicy="no-referrer">
<link href="assets/1570955083-6ea61090578ddc8e91dc9b26707cebc8.css" rel="stylesheet" type="text/css" referrerpolicy="no-referrer">
<link rel="stylesheet" type="text/css" href="assets/1570955083-46d427da9cafb653c4ed606490c99b3a.css" referrerpolicy="no-referrer">


<style class="darkreader darkreader--fallback" media="screen"></style>
<style class="darkreader darkreader--text" media="screen"></style>
<style class="darkreader darkreader--invert" media="screen"></style>
<style class="darkreader darkreader--inline" media="screen">[data-darkreader-inline-bgcolor] {
  background-color: var(--darkreader-inline-bgcolor) !important;
}
[data-darkreader-inline-bgimage] {
  background-image: var(--darkreader-inline-bgimage) !important;
}
[data-darkreader-inline-border] {
  border-color: var(--darkreader-inline-border) !important;
}
[data-darkreader-inline-border-bottom] {
  border-bottom-color: var(--darkreader-inline-border-bottom) !important;
}
[data-darkreader-inline-border-left] {
  border-left-color: var(--darkreader-inline-border-left) !important;
}
[data-darkreader-inline-border-right] {
  border-right-color: var(--darkreader-inline-border-right) !important;
}
[data-darkreader-inline-border-top] {
  border-top-color: var(--darkreader-inline-border-top) !important;
}
[data-darkreader-inline-boxshadow] {
  box-shadow: var(--darkreader-inline-boxshadow) !important;
}
[data-darkreader-inline-color] {
  color: var(--darkreader-inline-color) !important;
}
[data-darkreader-inline-fill] {
  fill: var(--darkreader-inline-fill) !important;
}
[data-darkreader-inline-stroke] {
  stroke: var(--darkreader-inline-stroke) !important;
}
[data-darkreader-inline-outline] {
  outline-color: var(--darkreader-inline-outline) !important;
}</style>
<style class="darkreader darkreader--user-agent" media="screen">html {
    background-color: #191a1b !important;
}
html, body, input, textarea, select, button {
    background-color: #191a1b;
}
html, body, input, textarea, select, button {
    border-color: #5a5956;
    color: #f0ebe2;
}
a {
    color: #4791e7;
}
table {
    border-color: #4f4e4c;
}
::placeholder {
    color: #bfb9ac;
}
::selection {
    background-color: #125cb4;
    color: #fffffd;
}
::-moz-selection {
    background-color: #125cb4;
    color: #fffffd;
}
input:-webkit-autofill,
textarea:-webkit-autofill,
select:-webkit-autofill {
    background-color: #565a0f !important;
    color: #f0ebe2 !important;
}
::-webkit-scrollbar {
    background-color: #1d1f1f;
    color: #cbc5b9;
}
::-webkit-scrollbar-thumb {
    background-color: #2c2d2d;
}
::-webkit-scrollbar-thumb:hover {
    background-color: #343636;
}
::-webkit-scrollbar-thumb:active {
    background-color: #404142;
}
::-webkit-scrollbar-corner {
    background-color: #191a1b;
}
* {
    scrollbar-color: #2c2d2d #1d1f1f;
}</style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style type="text/css"> 
.tr3 td,.tr3 th{border-right:1px solid #D5E5E8;}
.y-style{text-align:center;}
.tr1 th{border-right:1px solid #D5E5E8;}
.tr1 td.td1{border-left:0}
 

.signature img { max-height:250px !important; }
</style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style class="darkreader darkreader--override" media="screen">.jfk-bubble {
    background-color: #000000 !important;
}
.vimvixen-hint {
    background-color: #765500 !important;
    border-color: #d5b22e !important;
    color: #f9edcc !important;
}</style>
<style type="text/css">@keyframes fadeInOpacity{0%{opacity:0}to{opacity:1}}:hover>*>.fbvd--wrapper{animation-name:fadeInOpacity;animation-duration:.3s;opacity:1}.fbvd--wrapper{position:absolute;top:10px;left:10px;opacity:0;text-align:center;margin:0;z-index:5}.fbvd--wrapper a{background: url("") no-repeat 3px 4.55px; background-color: #fff; display:inline-block;font:700 14px Helvetica,Arial,sans-serif;color:#4b4f56;text-decoration:none;vertical-align:middle;padding:0px 8px 0px;margin-right:8px;border-radius:2px; line-height: 22px; padding-left:19px; border: 1px solid #e7e7e7; background-size: 13px}.fbvd--wrapper a:last-child{margin-right:0}.fbvd--wrapper a:hover{text-decoration:none}.fbvd--wrapper a:focus{box-shadow:0 0 1px 2px rgba(88,144,255,.75),0 1px 1px rgba(0,0,0,.15);outline:none}.fbvd--wrapper b{font-size:13px;position:relative;top:1px;color:#3b5998;font-weight:400}</style>
<style class="darkreader darkreader--sync" media="screen"></style>

      <style class="mx-wc-style">
        .mx-wc-main img {max-width: 100%;}
        .mx-wc-main{
          box-sizing: content-box;
          background-color: rgb(25, 26, 27) !important;
          margin: 0 auto;
          margin-top: 20px;
          max-width: 1349px;
        }
        @media (min-width: 768px) {
          .mx-wc-main { padding: 15px 15px 80px 15px }
        }
        @media (max-width: 767px) {
          .mx-wc-main { padding: 15px 3px 80px 3px }
        }
  
      </style>
    </head>
    <body style="background-color: #ffffff !important; min-height: 100%; height: auto; position: static !important; overflow: auto !important; padding-bottom: 0px !important;" id="" class="">
      <div class="mx-wc-main">
        <div id="wrapA" class="mx-wc-selected-elem mx-wc-1570955083" style="display: block; float: none !important; position: relative !important; top: 0px !important; left: 0px !important; margin: 0px !important; flex: unset !important; width: 100% !important; max-width: 100% !important; box-sizing: border-box !important;">

<div id="header">
<div class="toptool tar">	<span>
	<a href="https://bbs.sumisora.net/read.php?tid=10974554&amp;fpage=7&amp;skinco=simple" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">手机版</a>

	| <a style="cursor:pointer;" id="td_skin" data-mx-warn="Empty URL">风格切换<img src="assets/1570955083-5c8e409588b73ce4284cf5b9bd619e15.gif"></a>
	| <a href="https://bbs.sumisora.net/read.php?tid=10894912" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">学生手册</a>
	</span>
</div>
<table cellspacing="0" cellpadding="0" align="center" width="100%">
<tbody><tr>
	<td class="banner"><a href="https://bbs.sumisora.net/" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img id="forumlogo" src="assets/1570955083-7ac78a0e1e3ce795251288b0c8bd4b1b.png"></a></td>
	<td class="banner" id="banner" align="right"></td>
</tr>
<tr><td align="center" height="1" colspan="2"></td></tr>
</tbody></table>
<div id="h_guide" class="guide" colspan="2"><span class="s3">»</span>

	<span style="font-weight:bold" class="s3">silasu</span>&nbsp;<a href="https://bbs.sumisora.net/login.php?action=quit&amp;verify=034be2bd" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">退出</a> |
	<a id="td_profile" href="https://bbs.sumisora.net/profile.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">控制面板</a>
	| <a id="td_msg" href="https://bbs.sumisora.net/message.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">

	短消息</a>

	| <a id="td_sort" href="https://bbs.sumisora.net/sort.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">统计排行</a>

	| <a href="https://bbs.sumisora.net/member.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">会员</a>

	| <a href="https://bbs.sumisora.net/search.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">搜索</a>
	| <a style="cursor:pointer;" id="td_hack" data-mx-warn="Empty URL">社区服务<img src="assets/1570955083-5c8e409588b73ce4284cf5b9bd619e15.gif"></a>

	| <a href="https://bbs.sumisora.net/hack.php?H_name=galgamevote" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">GALGAME角色人气投票活动</a>

 | <a href="https://bbs.sumisora.net/yume/polls/" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">近期关注</a><!--[if lte IE 6]>
 | <a href="read.php?tid=10955539" style="color:red">本站已停止支持IE6，请升级或更换浏览器</a>
<![endif]-->
</div>



</div>
<div id="main">




<div class="t3" style="margin-top:8px"><table width="100%" cellspacing="0" cellpadding="0" align="center">
	<tbody><tr><td class="b"><img src="assets/1570955083-ca4a91079181c2a5cb3514b2e5b5f035.gif" align="absmiddle"> <a href="https://bbs.sumisora.net/index.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">『澄空学园』</a> » <a href="https://bbs.sumisora.net/thread.php?fid=77" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">【游戏汉化交流区】</a> » <a href="https://bbs.sumisora.net/thread.php?fid=78&amp;page=7" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">【汉化破解研讨室】</a> » <a href="https://bbs.sumisora.net/read.php?tid=10974554" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">关于yga图片问题</a> <a href="https://bbs.sumisora.net/rss.php?tid=10974554" target="_blank" title="Rss订阅本帖最新内容" referrerpolicy="no-referrer" rel="noopener noreferrer"><img align="absmiddle" src="assets/1570955083-b4369735f1bfb33ab69477230a8ba635.png"></a></td></tr>
</tbody></table></div>

<!--ads begin-->

<!--ads end-->
<div class="t3"><table width="100%" align="center" cellspacing="0" cellpadding="0">
	<tbody><tr><td align="left"><div class="fl"></div></td><td align="right" style="padding-bottom:.2em"><a href="https://bbs.sumisora.net/post.php?action=reply&amp;fid=78&amp;tid=10974554" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img src="assets/1570955083-132cb83b134d7ecd9b390389d489bc43.png"></a>

<a href="https://bbs.sumisora.net/post.php?fid=78" style="margin-left:.5em" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img src="assets/1570955083-8cab7ee31ae503cf78e5410d40cec291.png" id="td_post"></a>

</td></tr>
</tbody></table></div>



<form name="delatc" method="post">


<div class="t" style="margin-bottom: 0px; border-bottom: 0px; --darkreader-inline-border-bottom: initial;" data-darkreader-inline-border-bottom=""><table cellspacing="0" cellpadding="0" width="100%">
	<tbody><tr><th class="h"><strong class="fl w"><b>本页主题:</b> 关于yga图片问题</strong>
	<span class="fr w"><a data-mx-warn="Empty URL">&nbsp;</a><a href="https://bbs.sumisora.net/job.php?action=previous&amp;fid=78&amp;tid=10974554&amp;fpage=7&amp;goto=previous" class="fn" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">上一主题</a> | <a href="https://bbs.sumisora.net/job.php?action=previous&amp;fid=78&amp;tid=10974554&amp;fpage=7&amp;goto=next" class="fn" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">下一主题</a> | <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span> </th>
	</tr>
	<tr><td></td></tr>
	<tr class="tr2"><td colspan="2" class="tar">

		<a id="usetool" style="cursor:pointer" onclick="sendmsg('pw_ajax.php?action=usetool','',this.id)" data-mx-warn="Empty URL">[使用道具]</a>

		<br></td>
	</tr>
	<tr><td></td></tr>
</tbody></table></div>

<a name="tpc" data-mx-warn="Empty URL"></a>
<div class="t t2" style="border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top=""><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570955083-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>majia1166</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=483855" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570955083-bc3b3631a24154c2d9ba8189508a5212.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_0"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空新生</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570955083-be59bc9a4edb96b6b54ba67c9267b93f.gif"><br>

<span class="user-info2" id="showface_0">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">9</span><br>
学分: <span class="s2 f9">0 点</span><br>
澄空币: <span class="s3 f9">657 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2010-08-22<br>
		最后登录:2015-01-19 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_tpc" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10974554&amp;pid=tpc&amp;article=0" onclick="return sendurl(this,4,event)" id="quote_tpc" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10974554&amp;pid=tpc&amp;article=0" id="modify_tpc" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=483855" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10974554&amp;pid=tpc" onclick="return sendurl(this,8)" id="report_tpc" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10974554&amp;uid=483855" title="只看楼主的所有帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('tpc')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_tpc" class="fl">&nbsp;关于yga图片问题</h1>
			

			<div id="p_tpc" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_tpc">yga数据段解密后拼接头文件显示还是不正常<br>这里有没有大侠能够提供下yga转化数据啊<img src="assets/1570955083-41cdcbb6811a13f75b48c247382af27d.gif"></div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_tpc" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2010-09-15 12:17 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 楼主(majia1166) 的帖子');" data-mx-warn="Empty URL">[楼 主]</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="3587684" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570955083-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>majia1166</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=483855" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570955083-bc3b3631a24154c2d9ba8189508a5212.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_1"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空新生</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570955083-be59bc9a4edb96b6b54ba67c9267b93f.gif"><br>

<span class="user-info2" id="showface_1">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">9</span><br>
学分: <span class="s2 f9">0 点</span><br>
澄空币: <span class="s3 f9">657 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2010-08-22<br>
		最后登录:2015-01-19 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_3587684" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10974554&amp;pid=3587684&amp;article=1" onclick="return sendurl(this,4,event)" id="quote_3587684" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10974554&amp;pid=3587684&amp;article=1" id="modify_3587684" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=483855" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10974554&amp;pid=3587684" onclick="return sendurl(this,8)" id="report_3587684" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10974554&amp;uid=483855" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('3587684')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_3587684" class="fl">&nbsp;</h1>
			

			<div id="p_3587684" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_3587684">(#‵′)<br>居然没一个人鸟我<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (int y = 0; y &lt; height; y++)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for (int x = 0; x &lt; width; x++)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p1 = (y * width_len) + x * 3;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p2 = ((height - y - 1) * width + x) * 4;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha = data3[p2 + 3];<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (alpha == 255)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha = 256;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g = data3[p2 + 0] * alpha / 256 + bg * (256 - alpha) / 256;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b = data3[p2 + 1] * alpha / 256 + bb * (256 - alpha) / 256;<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r = data3[p2 + 2] * alpha / 256 + br * (256 - alpha) / 256;<br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data4[p1 + 0] = Convert.ToByte(g &gt; 255 ? 255 : g);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data4[p1 + 1] = Convert.ToByte(b &gt; 255 ? 255 : b);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data4[p1 + 2] = Convert.ToByte(r &gt; 255 ? 255 : r);<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_3587684" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2010-09-17 18:05 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 1楼(majia1166) 的帖子');" data-mx-warn="Empty URL">1 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="3587720" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570955083-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>初音拓海</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=284925" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570955083-80678a1e90de4d0a85fbe524c3d35182.jpg" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_2"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空二年生上学期</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570955083-3699e74cfe4e975552e8db25eb7cc233.gif"><br>

<span class="user-info2" id="showface_2">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">412</span><br>
学分: <span class="s2 f9">11 点</span><br>
澄空币: <span class="s3 f9">674 KID</span><br>

		GPA: <span class="s2 f9">1 点</span><br>

		<span class="gray">注册时间:2009-05-07<br>
		最后登录:2017-06-12 <br><br> 
		<img src="assets/1570955083-d1be6d7f9758587bb010e932f19b099a.gif" title="ピアノの森の満開の下"> <img src="assets/1570955083-15e89d0b08be5c8eefbdfacf3bb9dffd.gif" title="天神乱漫汉化纪念勋章"> <img src="assets/1570955083-0be30e42d981b60e7b1ef013372e2d39.gif" title="V.G.NEO汉化纪念勋章"> <img src="assets/1570955083-cf90ee580aa7aa167980e457d4ade136.gif" title="青空の見える丘汉化纪念勋章"> <img src="assets/1570955083-28c25581c211b3c7aef52d987ff9b722.gif" title="Akabeesoft2主题学部纪念勋章"> <img src="assets/1570955083-073c3b6be58f710904aa8fb76d998d56.gif" title="高町なのは"> <br></span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_3587720" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10974554&amp;pid=3587720&amp;article=2" onclick="return sendurl(this,4,event)" id="quote_3587720" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10974554&amp;pid=3587720&amp;article=2" id="modify_3587720" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=284925" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10974554&amp;pid=3587720" onclick="return sendurl(this,8)" id="report_3587720" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10974554&amp;uid=284925" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('3587720')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_3587720" class="fl">&nbsp;</h1>
			

			<div id="p_3587720" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_3587720">233 <br>都没人知道您在说什么<br>谁还能回帖<br>--------------------------<br>//我太弱了&nbsp;&nbsp;不能看后缀说结构<br>//构架引擎ing&nbsp;&nbsp;暂时没空干其他的活</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_3587720" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2010-09-17 18:23 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 2楼(初音拓海) 的帖子');" data-mx-warn="Empty URL">2 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="3588958" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570955083-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>majia1166</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=483855" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570955083-bc3b3631a24154c2d9ba8189508a5212.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_3"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空新生</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570955083-be59bc9a4edb96b6b54ba67c9267b93f.gif"><br>

<span class="user-info2" id="showface_3">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">9</span><br>
学分: <span class="s2 f9">0 点</span><br>
澄空币: <span class="s3 f9">657 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2010-08-22<br>
		最后登录:2015-01-19 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_3588958" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10974554&amp;pid=3588958&amp;article=3" onclick="return sendurl(this,4,event)" id="quote_3588958" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10974554&amp;pid=3588958&amp;article=3" id="modify_3588958" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=483855" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10974554&amp;pid=3588958" onclick="return sendurl(this,8)" id="report_3588958" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10974554&amp;uid=483855" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('3588958')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_3588958" class="fl">&nbsp;</h1>
			

			<div id="p_3588958" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_3588958">老大 怎么去除黑色背景啊&nbsp;&nbsp;我导出来的图片全都带黑底啊。。<br><br><br>MakeTransparent(Color.Black);直接出锯齿了。。。<div id="alert_3588958" style="color: gray; margin-top: 30px; --darkreader-inline-color:#bfb9ac;" data-darkreader-inline-color="">[ 此帖被majia1166在2010-09-18 13:34重新编辑 ]</div></div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_3588958" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2010-09-18 11:46 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 3楼(majia1166) 的帖子');" data-mx-warn="Empty URL">3 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="3590400" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570955083-a65fefcc9dcdcab59a5a1c722cc495b9.gif" title="该用户目前在线" align="absmiddle">

<b>amemiya</b>
<div style="margin:.3em 0 .4em .2em">まい散る空へ</div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=209259" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570955083-4ca40062fa022a2922d69ce3a65f7abf.png" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_4"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">学生会副会长</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570955083-35aa8c414aad91387ad565c549e6cd0f.gif"><br>

<span class="user-info2" id="showface_4">
<span class="user-infoWrap2">


精华:

		<a href="https://bbs.sumisora.net/search.php?authorid=209259&amp;digest=1" target="_blank" class="s4 f9" referrerpolicy="no-referrer" rel="noopener noreferrer">1</a>
<br>
发帖: <span class="s1 f9">1395</span><br>
学分: <span class="s2 f9">66 点</span><br>
澄空币: <span class="s3 f9">4825 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2008-05-11<br>
		最后登录:2019-10-13 <br><br> 
		<img src="assets/1570955083-bd1b51324558fe7f970dc337a22ab44d.gif" title="杏子御津爱护同好会勋章"> <img src="assets/1570955083-88b82f7e803a86b0eafd242ea48657de.gif" title="袋鼠"> <br></span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_3590400" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10974554&amp;pid=3590400&amp;article=4" onclick="return sendurl(this,4,event)" id="quote_3590400" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10974554&amp;pid=3590400&amp;article=4" id="modify_3590400" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=209259" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10974554&amp;pid=3590400" onclick="return sendurl(this,8)" id="report_3590400" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10974554&amp;uid=209259" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('3590400')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_3590400" class="fl">&nbsp;</h1>
			

			<div id="p_3590400" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_3590400">难道是C#么……好眼熟<br><br>你需要的是自己写一个32位BMP类，手工处理alpha通道</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_3590400" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2010-09-19 00:50 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 4楼(amemiya) 的帖子');" data-mx-warn="Empty URL">4 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="3590453" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570955083-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>风织翼</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=331970" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570955083-bc91a33538b6ab863b6bd50bbcda8ed2.png" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_5"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空一年生下学期</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570955083-0e03c5ece6b57c19681c4186b2d07c62.gif"><br>

<span class="user-info2" id="showface_5">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">259</span><br>
学分: <span class="s2 f9">1 点</span><br>
澄空币: <span class="s3 f9">612 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2009-11-12<br>
		最后登录:2014-11-02 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_3590453" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10974554&amp;pid=3590453&amp;article=5" onclick="return sendurl(this,4,event)" id="quote_3590453" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10974554&amp;pid=3590453&amp;article=5" id="modify_3590453" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=331970" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10974554&amp;pid=3590453" onclick="return sendurl(this,8)" id="report_3590453" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10974554&amp;uid=331970" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('3590453')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_3590453" class="fl">&nbsp;</h1>
			

			<div id="p_3590453" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_3590453"><h6 class="quote">Quote:</h6><blockquote class="blockquote">引用第4楼amemiya于2010-09-19 00:50发表的&nbsp;&nbsp;:<br>难道是C#么……好眼熟<br><br>你需要的是自己写一个32位BMP类，手工处理alpha通道</blockquote><br>C系列通用的，你个就知道C#的啊呀呀……</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_3590453" class="c"></div>

		<div><img class="signature" src="assets/1570955083-f23b8ffd0b6b327441aa828c9cd3243d.gif" align="absbottom"></div>
		<div class="signature" style="max-height:380px;maxHeight:380px; overflow:hidden;"><table width="100%"><tbody><tr><td>乃们敢不敢先把程序日好了，把测试补丁出了再开坑？</td><td></td></tr></tbody></table></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2010-09-19 01:52 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 5楼(风织翼) 的帖子');" data-mx-warn="Empty URL">5 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="3590645" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570955083-a65fefcc9dcdcab59a5a1c722cc495b9.gif" title="该用户目前在线" align="absmiddle">

<b>amemiya</b>
<div style="margin:.3em 0 .4em .2em">まい散る空へ</div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=209259" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570955083-4ca40062fa022a2922d69ce3a65f7abf.png" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_6"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">学生会副会长</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570955083-35aa8c414aad91387ad565c549e6cd0f.gif"><br>

<span class="user-info2" id="showface_6">
<span class="user-infoWrap2">


精华:

		<a href="https://bbs.sumisora.net/search.php?authorid=209259&amp;digest=1" target="_blank" class="s4 f9" referrerpolicy="no-referrer" rel="noopener noreferrer">1</a>
<br>
发帖: <span class="s1 f9">1395</span><br>
学分: <span class="s2 f9">66 点</span><br>
澄空币: <span class="s3 f9">4825 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2008-05-11<br>
		最后登录:2019-10-13 <br><br> 
		<img src="assets/1570955083-bd1b51324558fe7f970dc337a22ab44d.gif" title="杏子御津爱护同好会勋章"> <img src="assets/1570955083-88b82f7e803a86b0eafd242ea48657de.gif" title="袋鼠"> <br></span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_3590645" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10974554&amp;pid=3590645&amp;article=6" onclick="return sendurl(this,4,event)" id="quote_3590645" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10974554&amp;pid=3590645&amp;article=6" id="modify_3590645" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=209259" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10974554&amp;pid=3590645" onclick="return sendurl(this,8)" id="report_3590645" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10974554&amp;uid=209259" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('3590645')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_3590645" class="fl">&nbsp;</h1>
			

			<div id="p_3590645" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_3590645"><h6 class="quote">Quote:</h6><blockquote class="blockquote">引用第5楼风织翼于2010-09-19 01:52发表的&nbsp;&nbsp;:<br><br>C系列通用的，你个就知道C#的啊呀呀……</blockquote><br>不是啊，我看到了System.Drawing.Color.Black，这不就标准库么…</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_3590645" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2010-09-19 10:02 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 6楼(amemiya) 的帖子');" data-mx-warn="Empty URL">6 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="3591902" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570955083-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>majia1166</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=483855" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570955083-bc3b3631a24154c2d9ba8189508a5212.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_7"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空新生</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570955083-be59bc9a4edb96b6b54ba67c9267b93f.gif"><br>

<span class="user-info2" id="showface_7">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">9</span><br>
学分: <span class="s2 f9">0 点</span><br>
澄空币: <span class="s3 f9">657 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2010-08-22<br>
		最后登录:2015-01-19 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_3591902" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10974554&amp;pid=3591902&amp;article=7" onclick="return sendurl(this,4,event)" id="quote_3591902" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10974554&amp;pid=3591902&amp;article=7" id="modify_3591902" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=483855" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10974554&amp;pid=3591902" onclick="return sendurl(this,8)" id="report_3591902" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10974554&amp;uid=483855" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('3591902')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_3591902" class="fl">&nbsp;</h1>
			

			<div id="p_3591902" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_3591902">嗯 我用的c#&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;手工怎么处理alpha通道啊&nbsp;&nbsp;有攻略提供吗<br>ps：老大是不是高手啊 我第一次接触c#&nbsp;&nbsp;能不能帮优化下代码</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_3591902" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2010-09-19 21:54 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 7楼(majia1166) 的帖子');" data-mx-warn="Empty URL">7 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="3592580" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570955083-a65fefcc9dcdcab59a5a1c722cc495b9.gif" title="该用户目前在线" align="absmiddle">

<b>amemiya</b>
<div style="margin:.3em 0 .4em .2em">まい散る空へ</div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=209259" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570955083-4ca40062fa022a2922d69ce3a65f7abf.png" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_8"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">学生会副会长</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570955083-35aa8c414aad91387ad565c549e6cd0f.gif"><br>

<span class="user-info2" id="showface_8">
<span class="user-infoWrap2">


精华:

		<a href="https://bbs.sumisora.net/search.php?authorid=209259&amp;digest=1" target="_blank" class="s4 f9" referrerpolicy="no-referrer" rel="noopener noreferrer">1</a>
<br>
发帖: <span class="s1 f9">1395</span><br>
学分: <span class="s2 f9">66 点</span><br>
澄空币: <span class="s3 f9">4825 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2008-05-11<br>
		最后登录:2019-10-13 <br><br> 
		<img src="assets/1570955083-bd1b51324558fe7f970dc337a22ab44d.gif" title="杏子御津爱护同好会勋章"> <img src="assets/1570955083-88b82f7e803a86b0eafd242ea48657de.gif" title="袋鼠"> <br></span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_3592580" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10974554&amp;pid=3592580&amp;article=8" onclick="return sendurl(this,4,event)" id="quote_3592580" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10974554&amp;pid=3592580&amp;article=8" id="modify_3592580" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=209259" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10974554&amp;pid=3592580" onclick="return sendurl(this,8)" id="report_3592580" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10974554&amp;uid=209259" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('3592580')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_3592580" class="fl">&nbsp;</h1>
			

			<div id="p_3592580" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_3592580">已发送。<br>PS：YGA是啥我并不清楚……而且按照LZ代码的变量命名，我也看不懂是啥- =</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_3592580" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2010-09-20 10:32 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 8楼(amemiya) 的帖子');" data-mx-warn="Empty URL">8 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="3592860" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570955083-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>majia1166</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=483855" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570955083-bc3b3631a24154c2d9ba8189508a5212.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_9"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空新生</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570955083-be59bc9a4edb96b6b54ba67c9267b93f.gif"><br>

<span class="user-info2" id="showface_9">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">9</span><br>
学分: <span class="s2 f9">0 点</span><br>
澄空币: <span class="s3 f9">657 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2010-08-22<br>
		最后登录:2015-01-19 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_3592860" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10974554&amp;pid=3592860&amp;article=9" onclick="return sendurl(this,4,event)" id="quote_3592860" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10974554&amp;pid=3592860&amp;article=9" id="modify_3592860" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=483855" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10974554&amp;pid=3592860" onclick="return sendurl(this,8)" id="report_3592860" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10974554&amp;uid=483855" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('3592860')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_3592860" class="fl">&nbsp;</h1>
			

			<div id="p_3592860" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_3592860">我快无语了。。<br>这个是从内存dump出来的 自己加了0x36字节的头文件 老大帮看下吧<br><a href="http://u.115.com/file/t8e0a62442" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">http://u.115.com/file/t8e0a62442</a><br><br>个人感觉是图片的问题<img src="assets/1570955083-41cdcbb6811a13f75b48c247382af27d.gif"></div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_3592860" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2010-09-20 14:02 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 9楼(majia1166) 的帖子');" data-mx-warn="Empty URL">9 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="3593076" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570955083-a65fefcc9dcdcab59a5a1c722cc495b9.gif" title="该用户目前在线" align="absmiddle">

<b>amemiya</b>
<div style="margin:.3em 0 .4em .2em">まい散る空へ</div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=209259" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570955083-4ca40062fa022a2922d69ce3a65f7abf.png" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_10"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">学生会副会长</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570955083-35aa8c414aad91387ad565c549e6cd0f.gif"><br>

<span class="user-info2" id="showface_10">
<span class="user-infoWrap2">


精华:

		<a href="https://bbs.sumisora.net/search.php?authorid=209259&amp;digest=1" target="_blank" class="s4 f9" referrerpolicy="no-referrer" rel="noopener noreferrer">1</a>
<br>
发帖: <span class="s1 f9">1395</span><br>
学分: <span class="s2 f9">66 点</span><br>
澄空币: <span class="s3 f9">4825 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2008-05-11<br>
		最后登录:2019-10-13 <br><br> 
		<img src="assets/1570955083-bd1b51324558fe7f970dc337a22ab44d.gif" title="杏子御津爱护同好会勋章"> <img src="assets/1570955083-88b82f7e803a86b0eafd242ea48657de.gif" title="袋鼠"> <br></span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_3593076" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10974554&amp;pid=3593076&amp;article=10" onclick="return sendurl(this,4,event)" id="quote_3593076" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10974554&amp;pid=3593076&amp;article=10" id="modify_3593076" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=209259" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10974554&amp;pid=3593076" onclick="return sendurl(this,8)" id="report_3593076" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10974554&amp;uid=209259" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('3593076')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_3593076" class="fl">&nbsp;</h1>
			

			<div id="p_3593076" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_3593076">ALPHA怎么是全黑色<br><span class="highslide"><img src="assets/1570955083-63cbbd5c6538c8ade0d4b007f808e2d5.jpg" border="0" style="max-width: 100%;max-height: 800px;"></span><br><br>传张YGA原图</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_3593076" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2010-09-20 17:13 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 10楼(amemiya) 的帖子');" data-mx-warn="Empty URL">10 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="3593268" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570955083-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>majia1166</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=483855" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570955083-bc3b3631a24154c2d9ba8189508a5212.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_11"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空新生</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570955083-be59bc9a4edb96b6b54ba67c9267b93f.gif"><br>

<span class="user-info2" id="showface_11">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">9</span><br>
学分: <span class="s2 f9">0 点</span><br>
澄空币: <span class="s3 f9">657 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2010-08-22<br>
		最后登录:2015-01-19 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_3593268" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10974554&amp;pid=3593268&amp;article=11" onclick="return sendurl(this,4,event)" id="quote_3593268" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10974554&amp;pid=3593268&amp;article=11" id="modify_3593268" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=483855" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10974554&amp;pid=3593268" onclick="return sendurl(this,8)" id="report_3593268" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10974554&amp;uid=483855" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('3593268')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_3593268" class="fl">&nbsp;</h1>
			

			<div id="p_3593268" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_3593268">yga-&gt; <a href="http://u.115.com/file/t84952564a" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">http://u.115.com/file/t84952564a</a><br>dword<br>dword w<br>dword h<br>dword compressed=1<br>dword size<br>dword compressedsize<br>lzss压缩<br><br>果然是没破解干净么。。。<br><br><br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code1'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code1" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="com">/**************************************************************
&nbsp;&nbsp;&nbsp;&nbsp;LZSS.C -- A Data Compression Program
&nbsp;&nbsp;&nbsp;&nbsp;(tab = 4 spaces)
***************************************************************
&nbsp;&nbsp;&nbsp;&nbsp;4/6/1989 Haruhiko Okumura
&nbsp;&nbsp;&nbsp;&nbsp;Use, distribute, and modify this program freely.
&nbsp;&nbsp;&nbsp;&nbsp;Please send me your improved versions.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PC-VAN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SCIENCE
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NIFTY-Serve&nbsp;&nbsp;&nbsp;&nbsp;PAF01022
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CompuServe&nbsp;&nbsp;&nbsp;&nbsp;74050,1022
**************************************************************/</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;stdio.h&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;stdlib.h&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;string.h&gt;</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;ctype.h&gt;</span><span class="pln">

</span><span class="com">#define</span><span class="pln"> N&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="lit">4096</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* size of ring buffer */</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="lit">18</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* upper limit for match_length */</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> THRESHOLD&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="lit">2</span><span class="pln">&nbsp;&nbsp; </span><span class="com">/* encode string into position and length
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if match_length is greater than this */</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> NIL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;N&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* index for root of binary search trees */</span><span class="pln">

</span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> </span><span class="kwd">int</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;textsize </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* text size counter */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;codesize </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* code size counter */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printcount </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* counter for reporting progress every 1K bytes */</span><span class="pln">
</span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">char</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text_buf</span><span class="pun">[</span><span class="pln">N </span><span class="pun">+</span><span class="pln"> F </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">];</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* ring buffer of size N,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with extra F-1 bytes to facilitate string comparison */</span><span class="pln">
</span><span class="kwd">int</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match_position</span><span class="pun">,</span><span class="pln"> match_length</span><span class="pun">,</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* of longest match.&nbsp;&nbsp;These are
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set by the InsertNode() procedure. */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lson</span><span class="pun">[</span><span class="pln">N </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">],</span><span class="pln"> rson</span><span class="pun">[</span><span class="pln">N </span><span class="pun">+</span><span class="pln"> </span><span class="lit">257</span><span class="pun">],</span><span class="pln"> dad</span><span class="pun">[</span><span class="pln">N </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">];</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* left &amp; right children &amp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parents -- These constitute binary search trees. */</span><span class="pln">
FILE&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">*</span><span class="pln">infile</span><span class="pun">,</span><span class="pln"> </span><span class="pun">*</span><span class="pln">outfile</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* input &amp; output files */</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> </span><span class="typ">InitTree</span><span class="pun">(</span><span class="kwd">void</span><span class="pun">)</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* initialize trees */</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">int</span><span class="pln">&nbsp;&nbsp;i</span><span class="pun">;</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* For i = 0 to N - 1, rson[i] and lson[i] will be the right and
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; left children of node i.&nbsp;&nbsp;These nodes need not be initialized.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Also, dad[i] is the parent of node i.&nbsp;&nbsp;These are initialized to
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NIL (= N), which stands for 'not used.'
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; For i = 0 to 255, rson[N + i + 1] is the root of the tree
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for strings that begin with character i.&nbsp;&nbsp;These are initialized
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; to NIL.&nbsp;&nbsp;Note there are 256 trees. */</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> N </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> N </span><span class="pun">+</span><span class="pln"> </span><span class="lit">256</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> rson</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> NIL</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> N</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> dad</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> NIL</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> </span><span class="typ">InsertNode</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> r</span><span class="pun">)</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* Inserts string of length F, text_buf[r..r+F-1], into one of the
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; trees (text_buf[r]'th tree) and returns the longest-match position
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; and length via the global variables match_position and match_length.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If match_length = F, then removes the old node in favor of the new
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; one, because the old one will be deleted sooner.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Note r plays double role, as tree node and position in buffer. */</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">int</span><span class="pln">&nbsp;&nbsp;i</span><span class="pun">,</span><span class="pln"> p</span><span class="pun">,</span><span class="pln"> cmp</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">char</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">*</span><span class="pln">key</span><span class="pun">;</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;cmp </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;key </span><span class="pun">=</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">text_buf</span><span class="pun">[</span><span class="pln">r</span><span class="pun">];</span><span class="pln">&nbsp;&nbsp;p </span><span class="pun">=</span><span class="pln"> N </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> key</span><span class="pun">[</span><span class="lit">0</span><span class="pun">];</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;rson</span><span class="pun">[</span><span class="pln">r</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> lson</span><span class="pun">[</span><span class="pln">r</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> NIL</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;match_length </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln"> </span><span class="pun">;</span><span class="pln"> </span><span class="pun">;</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">cmp </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">rson</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> NIL</span><span class="pun">)</span><span class="pln"> p </span><span class="pun">=</span><span class="pln"> rson</span><span class="pun">[</span><span class="pln">p</span><span class="pun">];</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">&nbsp;&nbsp;rson</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> r</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;dad</span><span class="pun">[</span><span class="pln">r</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> p</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;</span><span class="kwd">return</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">lson</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> NIL</span><span class="pun">)</span><span class="pln"> p </span><span class="pun">=</span><span class="pln"> lson</span><span class="pun">[</span><span class="pln">p</span><span class="pun">];</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">&nbsp;&nbsp;lson</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> r</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;dad</span><span class="pun">[</span><span class="pln">r</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> p</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;</span><span class="kwd">return</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> F</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">((</span><span class="pln">cmp </span><span class="pun">=</span><span class="pln"> key</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> text_buf</span><span class="pun">[</span><span class="pln">p </span><span class="pun">+</span><span class="pln"> i</span><span class="pun">])</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln">&nbsp;&nbsp;</span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">&gt;</span><span class="pln"> match_length</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match_position </span><span class="pun">=</span><span class="pln"> p</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">((</span><span class="pln">match_length </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&gt;=</span><span class="pln"> F</span><span class="pun">)</span><span class="pln">&nbsp;&nbsp;</span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;dad</span><span class="pun">[</span><span class="pln">r</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> dad</span><span class="pun">[</span><span class="pln">p</span><span class="pun">];</span><span class="pln">&nbsp;&nbsp;lson</span><span class="pun">[</span><span class="pln">r</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> lson</span><span class="pun">[</span><span class="pln">p</span><span class="pun">];</span><span class="pln">&nbsp;&nbsp;rson</span><span class="pun">[</span><span class="pln">r</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> rson</span><span class="pun">[</span><span class="pln">p</span><span class="pun">];</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;dad</span><span class="pun">[</span><span class="pln">lson</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> r</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;dad</span><span class="pun">[</span><span class="pln">rson</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> r</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">rson</span><span class="pun">[</span><span class="pln">dad</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> p</span><span class="pun">)</span><span class="pln"> rson</span><span class="pun">[</span><span class="pln">dad</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> r</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">else</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lson</span><span class="pun">[</span><span class="pln">dad</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> r</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;dad</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> NIL</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* remove p */</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> </span><span class="typ">DeleteNode</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> p</span><span class="pun">)</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* deletes node p from tree */</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">int</span><span class="pln">&nbsp;&nbsp;q</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">dad</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> NIL</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* not in tree */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">rson</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> NIL</span><span class="pun">)</span><span class="pln"> q </span><span class="pun">=</span><span class="pln"> lson</span><span class="pun">[</span><span class="pln">p</span><span class="pun">];</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">lson</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> NIL</span><span class="pun">)</span><span class="pln"> q </span><span class="pun">=</span><span class="pln"> rson</span><span class="pun">[</span><span class="pln">p</span><span class="pun">];</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q </span><span class="pun">=</span><span class="pln"> lson</span><span class="pun">[</span><span class="pln">p</span><span class="pun">];</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">rson</span><span class="pun">[</span><span class="pln">q</span><span class="pun">]</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> NIL</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">do</span><span class="pln"> </span><span class="pun">{</span><span class="pln">&nbsp;&nbsp;q </span><span class="pun">=</span><span class="pln"> rson</span><span class="pun">[</span><span class="pln">q</span><span class="pun">];</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln"> </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">rson</span><span class="pun">[</span><span class="pln">q</span><span class="pun">]</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> NIL</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rson</span><span class="pun">[</span><span class="pln">dad</span><span class="pun">[</span><span class="pln">q</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> lson</span><span class="pun">[</span><span class="pln">q</span><span class="pun">];</span><span class="pln">&nbsp;&nbsp;dad</span><span class="pun">[</span><span class="pln">lson</span><span class="pun">[</span><span class="pln">q</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> dad</span><span class="pun">[</span><span class="pln">q</span><span class="pun">];</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lson</span><span class="pun">[</span><span class="pln">q</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> lson</span><span class="pun">[</span><span class="pln">p</span><span class="pun">];</span><span class="pln">&nbsp;&nbsp;dad</span><span class="pun">[</span><span class="pln">lson</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> q</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rson</span><span class="pun">[</span><span class="pln">q</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> rson</span><span class="pun">[</span><span class="pln">p</span><span class="pun">];</span><span class="pln">&nbsp;&nbsp;dad</span><span class="pun">[</span><span class="pln">rson</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> q</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;dad</span><span class="pun">[</span><span class="pln">q</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> dad</span><span class="pun">[</span><span class="pln">p</span><span class="pun">];</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">rson</span><span class="pun">[</span><span class="pln">dad</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> p</span><span class="pun">)</span><span class="pln"> rson</span><span class="pun">[</span><span class="pln">dad</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> q</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;</span><span class="kwd">else</span><span class="pln"> lson</span><span class="pun">[</span><span class="pln">dad</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> q</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;dad</span><span class="pun">[</span><span class="pln">p</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> NIL</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> </span><span class="typ">Encode</span><span class="pun">(</span><span class="kwd">void</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">int</span><span class="pln">&nbsp;&nbsp;i</span><span class="pun">,</span><span class="pln"> c</span><span class="pun">,</span><span class="pln"> len</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">,</span><span class="pln"> s</span><span class="pun">,</span><span class="pln"> last_match_length</span><span class="pun">,</span><span class="pln"> code_buf_ptr</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">char</span><span class="pln">&nbsp;&nbsp;code_buf</span><span class="pun">[</span><span class="lit">17</span><span class="pun">],</span><span class="pln"> mask</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">InitTree</span><span class="pun">();</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* initialize trees */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;code_buf</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* code_buf[1..16] saves eight units of code, and
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code_buf[0] works as eight flags, "1" representing that the unit
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is an unencoded letter (1 byte), "0" a position-and-length pair
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(2 bytes).&nbsp;&nbsp;Thus, eight units require at most 16 bytes of code. */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;code_buf_ptr </span><span class="pun">=</span><span class="pln"> mask </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;s </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;r </span><span class="pun">=</span><span class="pln"> N </span><span class="pun">-</span><span class="pln"> F</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> s</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> r</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> text_buf</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">' '</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* Clear the buffer with
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;any character that will appear often. */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">len </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> len </span><span class="pun">&lt;</span><span class="pln"> F </span><span class="pun">&amp;&amp;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">c </span><span class="pun">=</span><span class="pln"> getc</span><span class="pun">(</span><span class="pln">infile</span><span class="pun">))</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> EOF</span><span class="pun">;</span><span class="pln"> len</span><span class="pun">++)</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text_buf</span><span class="pun">[</span><span class="pln">r </span><span class="pun">+</span><span class="pln"> len</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> c</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* Read F bytes into the last F bytes of
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the buffer */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">((</span><span class="pln">textsize </span><span class="pun">=</span><span class="pln"> len</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* text of size zero */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;=</span><span class="pln"> F</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="typ">InsertNode</span><span class="pun">(</span><span class="pln">r </span><span class="pun">-</span><span class="pln"> i</span><span class="pun">);</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* Insert the F strings,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;each of which begins with one or more 'space' characters.&nbsp;&nbsp;Note
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the order in which these strings are inserted.&nbsp;&nbsp;This way,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;degenerate trees will be less likely to occur. */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">InsertNode</span><span class="pun">(</span><span class="pln">r</span><span class="pun">);</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* Finally, insert the whole string just read.&nbsp;&nbsp;The
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;global variables match_length and match_position are set. */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">do</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">match_length </span><span class="pun">&gt;</span><span class="pln"> len</span><span class="pun">)</span><span class="pln"> match_length </span><span class="pun">=</span><span class="pln"> len</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* match_length
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;may be spuriously long near the end of text. */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">match_length </span><span class="pun">&lt;=</span><span class="pln"> THRESHOLD</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match_length </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* Not long enough match.&nbsp;&nbsp;Send one byte. */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code_buf</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">|=</span><span class="pln"> mask</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* 'send one byte' flag */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code_buf</span><span class="pun">[</span><span class="pln">code_buf_ptr</span><span class="pun">++]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> text_buf</span><span class="pun">[</span><span class="pln">r</span><span class="pun">];</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* Send uncoded. */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code_buf</span><span class="pun">[</span><span class="pln">code_buf_ptr</span><span class="pun">++]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">)</span><span class="pln"> match_position</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code_buf</span><span class="pun">[</span><span class="pln">code_buf_ptr</span><span class="pun">++]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">char</span><span class="pun">)</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">(((</span><span class="pln">match_position </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">4</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">0xf0</span><span class="pun">)</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">|</span><span class="pln"> </span><span class="pun">(</span><span class="pln">match_length </span><span class="pun">-</span><span class="pln"> </span><span class="pun">(</span><span class="pln">THRESHOLD </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)));</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* Send position and
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;length pair. Note match_length &gt; THRESHOLD. */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">((</span><span class="pln">mask </span><span class="pun">&lt;&lt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* Shift mask left one bit. */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> code_buf_ptr</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* Send at most 8 units of */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;putc</span><span class="pun">(</span><span class="pln">code_buf</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> outfile</span><span class="pun">);</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="com">/* code together */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;codesize </span><span class="pun">+=</span><span class="pln"> code_buf_ptr</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code_buf</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;code_buf_ptr </span><span class="pun">=</span><span class="pln"> mask </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last_match_length </span><span class="pun">=</span><span class="pln"> match_length</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> last_match_length </span><span class="pun">&amp;&amp;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">(</span><span class="pln">c </span><span class="pun">=</span><span class="pln"> getc</span><span class="pun">(</span><span class="pln">infile</span><span class="pun">))</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> EOF</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">DeleteNode</span><span class="pun">(</span><span class="pln">s</span><span class="pun">);</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* Delete old strings and */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text_buf</span><span class="pun">[</span><span class="pln">s</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> c</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* read new bytes */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s </span><span class="pun">&lt;</span><span class="pln"> F </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> text_buf</span><span class="pun">[</span><span class="pln">s </span><span class="pun">+</span><span class="pln"> N</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> c</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* If the position is
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;near the end of buffer, extend the buffer to make
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string comparison easier. */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">N </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">&nbsp;&nbsp;r </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">r </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">N </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* Since this is a ring buffer, increment the position
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; modulo N. */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">InsertNode</span><span class="pun">(</span><span class="pln">r</span><span class="pun">);</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* Register the string in text_buf[r..r+F-1] */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">((</span><span class="pln">textsize </span><span class="pun">+=</span><span class="pln"> i</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln"> printcount</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf</span><span class="pun">(</span><span class="str">"%12ld\r"</span><span class="pun">,</span><span class="pln"> textsize</span><span class="pun">);</span><span class="pln">&nbsp;&nbsp;printcount </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">1024</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* Reports progress each time the textsize exceeds
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; multiples of 1024. */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i</span><span class="pun">++</span><span class="pln"> </span><span class="pun">&lt;</span><span class="pln"> last_match_length</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* After the end of text, */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">DeleteNode</span><span class="pun">(</span><span class="pln">s</span><span class="pun">);</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* no need to read, but */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">N </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">&nbsp;&nbsp;r </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">r </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">N </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(--</span><span class="pln">len</span><span class="pun">)</span><span class="pln"> </span><span class="typ">InsertNode</span><span class="pun">(</span><span class="pln">r</span><span class="pun">);</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* buffer may not be empty. */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln"> </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">len </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* until length of string to be processed is zero */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">code_buf_ptr </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* Send remaining code. */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> code_buf_ptr</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> putc</span><span class="pun">(</span><span class="pln">code_buf</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln"> outfile</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;codesize </span><span class="pun">+=</span><span class="pln"> code_buf_ptr</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;printf</span><span class="pun">(</span><span class="str">"In : %ld bytes\n"</span><span class="pun">,</span><span class="pln"> textsize</span><span class="pun">);</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* Encoding is done. */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;printf</span><span class="pun">(</span><span class="str">"Out: %ld bytes\n"</span><span class="pun">,</span><span class="pln"> codesize</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;printf</span><span class="pun">(</span><span class="str">"Out/In: %.3f\n"</span><span class="pun">,</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">double</span><span class="pun">)</span><span class="pln">codesize </span><span class="pun">/</span><span class="pln"> textsize</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">void</span><span class="pln"> </span><span class="typ">Decode</span><span class="pun">(</span><span class="kwd">void</span><span class="pun">)</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* Just the reverse of Encode(). */</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">int</span><span class="pln">&nbsp;&nbsp;i</span><span class="pun">,</span><span class="pln"> j</span><span class="pun">,</span><span class="pln"> k</span><span class="pun">,</span><span class="pln"> r</span><span class="pun">,</span><span class="pln"> c</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">int</span><span class="pln">&nbsp;&nbsp;flags</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> N </span><span class="pun">-</span><span class="pln"> F</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> text_buf</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">' '</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;r </span><span class="pun">=</span><span class="pln"> N </span><span class="pun">-</span><span class="pln"> F</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;flags </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln"> </span><span class="pun">;</span><span class="pln"> </span><span class="pun">;</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(((</span><span class="pln">flags </span><span class="pun">&gt;&gt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">256</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">((</span><span class="pln">c </span><span class="pun">=</span><span class="pln"> getc</span><span class="pun">(</span><span class="pln">infile</span><span class="pun">))</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> EOF</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;flags </span><span class="pun">=</span><span class="pln"> c </span><span class="pun">|</span><span class="pln"> </span><span class="lit">0xff00</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* uses higher byte cleverly */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* to count eight */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">flags </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">((</span><span class="pln">c </span><span class="pun">=</span><span class="pln"> getc</span><span class="pun">(</span><span class="pln">infile</span><span class="pun">))</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> EOF</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;putc</span><span class="pun">(</span><span class="pln">c</span><span class="pun">,</span><span class="pln"> outfile</span><span class="pun">);</span><span class="pln">&nbsp;&nbsp;text_buf</span><span class="pun">[</span><span class="pln">r</span><span class="pun">++]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> c</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;r </span><span class="pun">&amp;=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">N </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">((</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> getc</span><span class="pun">(</span><span class="pln">infile</span><span class="pun">))</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> EOF</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">((</span><span class="pln">j </span><span class="pun">=</span><span class="pln"> getc</span><span class="pun">(</span><span class="pln">infile</span><span class="pun">))</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> EOF</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i </span><span class="pun">|=</span><span class="pln"> </span><span class="pun">((</span><span class="pln">j </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">0xf0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">4</span><span class="pun">);</span><span class="pln">&nbsp;&nbsp;j </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">j </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">0x0f</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> THRESHOLD</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">k </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> k </span><span class="pun">&lt;=</span><span class="pln"> j</span><span class="pun">;</span><span class="pln"> k</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c </span><span class="pun">=</span><span class="pln"> text_buf</span><span class="pun">[(</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> k</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="pun">(</span><span class="pln">N </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)];</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;putc</span><span class="pun">(</span><span class="pln">c</span><span class="pun">,</span><span class="pln"> outfile</span><span class="pun">);</span><span class="pln">&nbsp;&nbsp;text_buf</span><span class="pun">[</span><span class="pln">r</span><span class="pun">++]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> c</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;r </span><span class="pun">&amp;=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">N </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> argc</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pln"> </span><span class="pun">*</span><span class="pln">argv</span><span class="pun">[])</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">char</span><span class="pln">&nbsp;&nbsp;</span><span class="pun">*</span><span class="pln">s</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">argc </span><span class="pun">!=</span><span class="pln"> </span><span class="lit">4</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf</span><span class="pun">(</span><span class="str">"'lzss e file1 file2' encodes file1 into file2.\n"</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="str">"'lzss d file2 file1' decodes file2 into file1.\n"</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">return</span><span class="pln"> EXIT_FAILURE</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">((</span><span class="pln">s </span><span class="pun">=</span><span class="pln"> argv</span><span class="pun">[</span><span class="lit">1</span><span class="pun">],</span><span class="pln"> s</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> strpbrk</span><span class="pun">(</span><span class="pln">s</span><span class="pun">,</span><span class="pln"> </span><span class="str">"DEde"</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> NULL</span><span class="pun">)</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s </span><span class="pun">=</span><span class="pln"> argv</span><span class="pun">[</span><span class="lit">2</span><span class="pun">],</span><span class="pln"> </span><span class="pun">(</span><span class="pln">infile&nbsp;&nbsp;</span><span class="pun">=</span><span class="pln"> fopen</span><span class="pun">(</span><span class="pln">s</span><span class="pun">,</span><span class="pln"> </span><span class="str">"rb"</span><span class="pun">))</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> NULL</span><span class="pun">)</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">||</span><span class="pln"> </span><span class="pun">(</span><span class="pln">s </span><span class="pun">=</span><span class="pln"> argv</span><span class="pun">[</span><span class="lit">3</span><span class="pun">],</span><span class="pln"> </span><span class="pun">(</span><span class="pln">outfile </span><span class="pun">=</span><span class="pln"> fopen</span><span class="pun">(</span><span class="pln">s</span><span class="pun">,</span><span class="pln"> </span><span class="str">"wb"</span><span class="pun">))</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> NULL</span><span class="pun">))</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf</span><span class="pun">(</span><span class="str">"??? %s\n"</span><span class="pun">,</span><span class="pln"> s</span><span class="pun">);</span><span class="pln">&nbsp;&nbsp;</span><span class="kwd">return</span><span class="pln"> EXIT_FAILURE</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">toupper</span><span class="pun">(*</span><span class="pln">argv</span><span class="pun">[</span><span class="lit">1</span><span class="pun">])</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="str">'E'</span><span class="pun">)</span><span class="pln"> </span><span class="typ">Encode</span><span class="pun">();</span><span class="pln">&nbsp;&nbsp;</span><span class="kwd">else</span><span class="pln"> </span><span class="typ">Decode</span><span class="pun">();</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;fclose</span><span class="pun">(</span><span class="pln">infile</span><span class="pun">);</span><span class="pln">&nbsp;&nbsp;fclose</span><span class="pun">(</span><span class="pln">outfile</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">return</span><span class="pln"> EXIT_SUCCESS</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span></pre><div id="alert_3593268" style="color: gray; margin-top: 30px; --darkreader-inline-color:#bfb9ac;" data-darkreader-inline-color="">[ 此帖被majia1166在2010-09-20 19:04重新编辑 ]</div></div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_3593268" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2010-09-20 18:58 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 11楼(majia1166) 的帖子');" data-mx-warn="Empty URL">11 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="3593294" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570955083-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>初音拓海</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=284925" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570955083-80678a1e90de4d0a85fbe524c3d35182.jpg" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_12"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空二年生上学期</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570955083-3699e74cfe4e975552e8db25eb7cc233.gif"><br>

<span class="user-info2" id="showface_12">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">412</span><br>
学分: <span class="s2 f9">11 点</span><br>
澄空币: <span class="s3 f9">674 KID</span><br>

		GPA: <span class="s2 f9">1 点</span><br>

		<span class="gray">注册时间:2009-05-07<br>
		最后登录:2017-06-12 <br><br> 
		<img src="assets/1570955083-d1be6d7f9758587bb010e932f19b099a.gif" title="ピアノの森の満開の下"> <img src="assets/1570955083-15e89d0b08be5c8eefbdfacf3bb9dffd.gif" title="天神乱漫汉化纪念勋章"> <img src="assets/1570955083-0be30e42d981b60e7b1ef013372e2d39.gif" title="V.G.NEO汉化纪念勋章"> <img src="assets/1570955083-cf90ee580aa7aa167980e457d4ade136.gif" title="青空の見える丘汉化纪念勋章"> <img src="assets/1570955083-28c25581c211b3c7aef52d987ff9b722.gif" title="Akabeesoft2主题学部纪念勋章"> <img src="assets/1570955083-073c3b6be58f710904aa8fb76d998d56.gif" title="高町なのは"> <br></span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_3593294" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10974554&amp;pid=3593294&amp;article=12" onclick="return sendurl(this,4,event)" id="quote_3593294" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10974554&amp;pid=3593294&amp;article=12" id="modify_3593294" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=284925" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10974554&amp;pid=3593294" onclick="return sendurl(this,8)" id="report_3593294" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10974554&amp;uid=284925" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('3593294')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_3593294" class="fl">&nbsp;</h1>
			

			<div id="p_3593294" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_3593294">这个不是lzss么.....<br>AYA果断贴你的c#代码<br>通用的,封装好的那个<br>我的Delphi就不拿出来了<br>---------------------------------<br>能否说下游戏名?<br>告诉我引擎名或者有个EXE我才能看...估计AYA也可能是这样..<div id="alert_3593294" style="color: gray; margin-top: 30px; --darkreader-inline-color:#bfb9ac;" data-darkreader-inline-color="">[ 此帖被初音拓海在2010-09-20 19:21重新编辑 ]</div></div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_3593294" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2010-09-20 19:14 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 12楼(初音拓海) 的帖子');" data-mx-warn="Empty URL">12 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="3593365" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570955083-a65fefcc9dcdcab59a5a1c722cc495b9.gif" title="该用户目前在线" align="absmiddle">

<b>amemiya</b>
<div style="margin:.3em 0 .4em .2em">まい散る空へ</div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=209259" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570955083-4ca40062fa022a2922d69ce3a65f7abf.png" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_13"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">学生会副会长</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570955083-35aa8c414aad91387ad565c549e6cd0f.gif"><br>

<span class="user-info2" id="showface_13">
<span class="user-infoWrap2">


精华:

		<a href="https://bbs.sumisora.net/search.php?authorid=209259&amp;digest=1" target="_blank" class="s4 f9" referrerpolicy="no-referrer" rel="noopener noreferrer">1</a>
<br>
发帖: <span class="s1 f9">1395</span><br>
学分: <span class="s2 f9">66 点</span><br>
澄空币: <span class="s3 f9">4825 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2008-05-11<br>
		最后登录:2019-10-13 <br><br> 
		<img src="assets/1570955083-bd1b51324558fe7f970dc337a22ab44d.gif" title="杏子御津爱护同好会勋章"> <img src="assets/1570955083-88b82f7e803a86b0eafd242ea48657de.gif" title="袋鼠"> <br></span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_3593365" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10974554&amp;pid=3593365&amp;article=13" onclick="return sendurl(this,4,event)" id="quote_3593365" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10974554&amp;pid=3593365&amp;article=13" id="modify_3593365" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=209259" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10974554&amp;pid=3593365" onclick="return sendurl(this,8)" id="report_3593365" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10974554&amp;uid=209259" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('3593365')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_3593365" class="fl">&nbsp;</h1>
			

			<div id="p_3593365" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_3593365">看起来虽然在YGA里有alpha通道，但是引擎似乎没有用到这个233<br>LZSS解压流应该没有出问题，否则BMP不会正常到底<br><br>嘛，现在说的过去的解释就是引擎太weak，有alpha不知道用了<img src="assets/1570955083-7ca0e2c96d22ed4b82fa7e59ccab8be1.gif"></div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_3593365" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2010-09-20 20:08 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 13楼(amemiya) 的帖子');" data-mx-warn="Empty URL">13 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="3593513" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570955083-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>初音拓海</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=284925" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570955083-80678a1e90de4d0a85fbe524c3d35182.jpg" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_14"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空二年生上学期</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570955083-3699e74cfe4e975552e8db25eb7cc233.gif"><br>

<span class="user-info2" id="showface_14">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">412</span><br>
学分: <span class="s2 f9">11 点</span><br>
澄空币: <span class="s3 f9">674 KID</span><br>

		GPA: <span class="s2 f9">1 点</span><br>

		<span class="gray">注册时间:2009-05-07<br>
		最后登录:2017-06-12 <br><br> 
		<img src="assets/1570955083-d1be6d7f9758587bb010e932f19b099a.gif" title="ピアノの森の満開の下"> <img src="assets/1570955083-15e89d0b08be5c8eefbdfacf3bb9dffd.gif" title="天神乱漫汉化纪念勋章"> <img src="assets/1570955083-0be30e42d981b60e7b1ef013372e2d39.gif" title="V.G.NEO汉化纪念勋章"> <img src="assets/1570955083-cf90ee580aa7aa167980e457d4ade136.gif" title="青空の見える丘汉化纪念勋章"> <img src="assets/1570955083-28c25581c211b3c7aef52d987ff9b722.gif" title="Akabeesoft2主题学部纪念勋章"> <img src="assets/1570955083-073c3b6be58f710904aa8fb76d998d56.gif" title="高町なのは"> <br></span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_3593513" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10974554&amp;pid=3593513&amp;article=14" onclick="return sendurl(this,4,event)" id="quote_3593513" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10974554&amp;pid=3593513&amp;article=14" id="modify_3593513" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=284925" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10974554&amp;pid=3593513" onclick="return sendurl(this,8)" id="report_3593513" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10974554&amp;uid=284925" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('3593513')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_3593513" class="fl">&nbsp;</h1>
			

			<div id="p_3593513" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_3593513">BMP有alpha不用的很多....<br>不过我还是想知道游戏名<br>这个yga我越看越眼熟.....<br>总觉得搞过..........................</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_3593513" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2010-09-20 21:23 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 14楼(初音拓海) 的帖子');" data-mx-warn="Empty URL">14 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="3594102" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570955083-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>majia1166</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=483855" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570955083-bc3b3631a24154c2d9ba8189508a5212.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_15"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空新生</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570955083-be59bc9a4edb96b6b54ba67c9267b93f.gif"><br>

<span class="user-info2" id="showface_15">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">9</span><br>
学分: <span class="s2 f9">0 点</span><br>
澄空币: <span class="s3 f9">657 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2010-08-22<br>
		最后登录:2015-01-19 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_3594102" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10974554&amp;pid=3594102&amp;article=15" onclick="return sendurl(this,4,event)" id="quote_3594102" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10974554&amp;pid=3594102&amp;article=15" id="modify_3594102" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=483855" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10974554&amp;pid=3594102" onclick="return sendurl(this,8)" id="report_3594102" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10974554&amp;uid=483855" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('3594102')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_3594102" class="fl">&nbsp;</h1>
			

			<div id="p_3594102" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_3594102">游戏是内裤电磁炮<br>yanepkdx<br>yga图片能用matilda打开）不过不支持中文路径<br><br>我现在想解决输出透明问题 不知道是我没破解干净还是其他什么的。。</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_3594102" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2010-09-21 10:30 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 15楼(majia1166) 的帖子');" data-mx-warn="Empty URL">15 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="3594213" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570955083-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>majia1166</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=483855" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570955083-bc3b3631a24154c2d9ba8189508a5212.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_16"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空新生</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570955083-be59bc9a4edb96b6b54ba67c9267b93f.gif"><br>

<span class="user-info2" id="showface_16">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">9</span><br>
学分: <span class="s2 f9">0 点</span><br>
澄空币: <span class="s3 f9">657 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2010-08-22<br>
		最后登录:2015-01-19 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_3594213" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10974554&amp;pid=3594213&amp;article=16" onclick="return sendurl(this,4,event)" id="quote_3594213" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10974554&amp;pid=3594213&amp;article=16" id="modify_3594213" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=483855" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10974554&amp;pid=3594213" onclick="return sendurl(this,8)" id="report_3594213" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10974554&amp;uid=483855" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('3594213')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_3594213" class="fl">&nbsp;</h1>
			

			<div id="p_3594213" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_3594213">ifyga-&gt;&nbsp;&nbsp;<a href="http://u.115.com/file/t8e087b829" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">http://u.115.com/file/t8e087b829</a>&nbsp;&nbsp;解密<br>ygamaker-&gt;&nbsp;&nbsp;<a href="http://u.115.com/file/t8c7953921" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">http://u.115.com/file/t8c7953921</a> 加密<br><br>ifyga<br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code2'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code2" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="com">/***************************************************************************
 ifyga.cpp

 Copyright(C) 2001 Lucifer(IKEDA, Ritsuya)
&nbsp;&nbsp;e-mail : [email]</span><span class="com">lucifer3@spica.freemail.ne.jp</span><span class="com">[/email]

 このソースコードはTransTECH 2000年3月号に掲載されていた43T氏のサンプルを
 元に作製しました．
***************************************************************************/</span><span class="pln">

</span><span class="com">#include</span><span class="pln"> </span><span class="str">&lt;windows.h&gt;</span><span class="pln">

</span><span class="com">#include</span><span class="pln"> </span><span class="str">"yaneLZSS.h"</span><span class="pln">

</span><span class="com">//&nbsp;&nbsp;&nbsp;&nbsp;YPGのヘッダー</span><span class="pln">
</span><span class="kwd">struct</span><span class="pln"> </span><span class="typ">SYPGHeader</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;DWORD dwIdentifier</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;DWORD dwSizeX</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;DWORD dwSizeY</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;DWORD bCompress</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;DWORD dwOriginalSize</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;DWORD dwCompressSize</span><span class="pun">;</span><span class="pln">
</span><span class="pun">};</span><span class="pln">

</span><span class="com">//---------------------------------------------------------------------------</span><span class="pln">
</span><span class="com">/*-------------------------------------------------------------------------*/</span><span class="pln">
</span><span class="com">/* このPluginの情報&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span class="pln">
</span><span class="com">/*-------------------------------------------------------------------------*/</span><span class="pln">
</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">char</span><span class="pln"> </span><span class="pun">*</span><span class="pln">pluginfo</span><span class="pun">[]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="str">"00IN"</span><span class="pun">,</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="com">/* Plug-in APIバージョン */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="str">"YGA to DIB filter ver 0.01 (C)Lucifer"</span><span class="pun">,</span><span class="pln"> </span><span class="com">/* Plug-in名、バージョン及び copyright */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="str">"*.yga"</span><span class="pun">,</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* 代表的な拡張子 ("*.JPG" "*.JPG;*.JPEG" など) */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="str">"yga file(*.yga)"</span><span class="pun">,</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* ファイル形式名 */</span><span class="pln">
</span><span class="pun">};</span><span class="pln">

</span><span class="com">/*-------------------------------------------------------------------------*/</span><span class="pln">
</span><span class="com">/* 画像情報構造体&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span class="pln">
</span><span class="com">/*-------------------------------------------------------------------------*/</span><span class="pln">
</span><span class="com">#pragma</span><span class="pln"> pack</span><span class="pun">(</span><span class="pln">push</span><span class="pun">)</span><span class="pln">
</span><span class="com">#pragma</span><span class="pln"> pack</span><span class="pun">(</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="com">//構造体のメンバ境界を1バイトにする</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">struct</span><span class="pln"> </span><span class="typ">PictureInfo</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">long</span><span class="pln"> left</span><span class="pun">,</span><span class="pln">top</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="com">// 画像を展開する位置</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">long</span><span class="pln"> width</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">// 画像の幅(pixel)</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">long</span><span class="pln"> height</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="com">// 画像の高さ(pixel)</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;WORD x_density</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">// 画素の水平方向密度</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;WORD y_density</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">// 画素の垂直方向密度</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">short</span><span class="pln"> colorDepth</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">// 画素当たりのbit数</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;HLOCAL hInfo</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">// 画像内のテキスト情報</span><span class="pln">
</span><span class="pun">}</span><span class="pln"> </span><span class="typ">PictureInfo</span><span class="pun">;</span><span class="pln">
</span><span class="com">#pragma</span><span class="pln"> pack</span><span class="pun">(</span><span class="pln">pop</span><span class="pun">)</span><span class="pln">

</span><span class="com">/*-------------------------------------------------------------------------*/</span><span class="pln">
</span><span class="com">/* エラーコード&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span class="pln">
</span><span class="com">/*-------------------------------------------------------------------------*/</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> SPI_NO_FUNCTION&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">-</span><span class="lit">1</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* その機能はインプリメントされていない */</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> SPI_ALL_RIGHT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="lit">0</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* 正常終了 */</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> SPI_ABORT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="lit">1</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* コールバック関数が非0を返したので展開を中止した */</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> SPI_NOT_SUPPORT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="lit">2</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* 未知のフォーマット */</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> SPI_OUT_OF_ORDER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="lit">3</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* データが壊れている */</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> SPI_NO_MEMORY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="lit">4</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* メモリーが確保出来ない */</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> SPI_MEMORY_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="lit">5</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* メモリーエラー */</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> SPI_FILE_READ_ERROR&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="lit">6</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* ファイルリードエラー */</span><span class="pln">
</span><span class="com">#define</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;SPI_WINDOW_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="lit">7</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* 窓が開けない (非公開のエラーコード) */</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> SPI_OTHER_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="lit">8</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* 内部エラー */</span><span class="pln">
</span><span class="com">#define</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;SPI_FILE_WRITE_ERROR&nbsp;&nbsp; </span><span class="lit">9</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* 書き込みエラー (非公開のエラーコード) */</span><span class="pln">
</span><span class="com">#define</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;SPI_END_OF_FILE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="lit">10</span><span class="pln">&nbsp;&nbsp;</span><span class="com">/* ファイル終端 (非公開のエラーコード) */</span><span class="pln">

</span><span class="com">/*-------------------------------------------------------------------------*/</span><span class="pln">
</span><span class="com">/* '00IN'関数のプロトタイプ宣言&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span class="pln">
</span><span class="com">/*-------------------------------------------------------------------------*/</span><span class="pln">
</span><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> </span><span class="pun">(</span><span class="pln">CALLBACK </span><span class="pun">*</span><span class="pln">SPI_PROGRESS</span><span class="pun">)(</span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">long</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">extern</span><span class="pln"> </span><span class="str">"C"</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">int</span><span class="pln"> __declspec</span><span class="pun">(</span><span class="pln">dllexport</span><span class="pun">)</span><span class="pln"> __stdcall </span><span class="typ">GetPluginInfo</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> infono</span><span class="pun">,</span><span class="pln"> LPSTR buf</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> buflen</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">int</span><span class="pln"> __declspec</span><span class="pun">(</span><span class="pln">dllexport</span><span class="pun">)</span><span class="pln"> __stdcall </span><span class="typ">IsSupported</span><span class="pun">(</span><span class="pln">LPSTR filename</span><span class="pun">,</span><span class="pln"> DWORD dw</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">int</span><span class="pln"> __declspec</span><span class="pun">(</span><span class="pln">dllexport</span><span class="pun">)</span><span class="pln"> __stdcall </span><span class="typ">GetPictureInfo</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">(</span><span class="pln">LPSTR buf</span><span class="pun">,</span><span class="kwd">long</span><span class="pln"> len</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> flag</span><span class="pun">,</span><span class="pln"> </span><span class="typ">PictureInfo</span><span class="pln"> </span><span class="pun">*</span><span class="pln">lpInfo</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">int</span><span class="pln"> __declspec</span><span class="pun">(</span><span class="pln">dllexport</span><span class="pun">)</span><span class="pln"> __stdcall </span><span class="typ">GetPicture</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">(</span><span class="pln">LPSTR buf</span><span class="pun">,</span><span class="kwd">long</span><span class="pln"> len</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> flag</span><span class="pun">,</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; HANDLE </span><span class="pun">*</span><span class="pln">pHBInfo</span><span class="pun">,</span><span class="pln"> HANDLE </span><span class="pun">*</span><span class="pln">pHBm</span><span class="pun">,</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SPI_PROGRESS lpPrgressCallback</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> lData</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">int</span><span class="pln"> __declspec</span><span class="pun">(</span><span class="pln">dllexport</span><span class="pun">)</span><span class="pln"> __stdcall </span><span class="typ">GetPreview</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">(</span><span class="pln">LPSTR buf</span><span class="pun">,</span><span class="kwd">long</span><span class="pln"> len</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> flag</span><span class="pun">,</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; HANDLE </span><span class="pun">*</span><span class="pln">pHBInfo</span><span class="pun">,</span><span class="pln"> HANDLE </span><span class="pun">*</span><span class="pln">pHBm</span><span class="pun">,</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SPI_PROGRESS lpPrgressCallback</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> lData</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="com">//---------------------------------------------------------------------------</span><span class="pln">

</span><span class="com">/***************************************************************************
 * 画像形式依存の処理。&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*
 * ～Ex関数を画像形式に合わせて書き換える。&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*
 ***************************************************************************/</span><span class="pln">
</span><span class="com">//---------------------------------------------------------------------------</span><span class="pln">
</span><span class="com">//ヘッダを見て対応フォーマットか確認。</span><span class="pln">
</span><span class="com">//対応しているものならtrue、そうでなければfalse、を返す。</span><span class="pln">
</span><span class="com">//filnameはファイル名で、NULLが入っていることもある。</span><span class="pln">
</span><span class="com">//dataはファイルのヘッダで、サイズは2000バイト以上。</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> HEADBUF_SIZE </span><span class="lit">2000</span><span class="pln"> </span><span class="com">/* 2kbyte=2048byte? */</span><span class="pln">
</span><span class="kwd">bool</span><span class="pln"> </span><span class="typ">IsSupportedEx</span><span class="pun">(</span><span class="kwd">char</span><span class="pln"> </span><span class="pun">*</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pln"> </span><span class="pun">*</span><span class="pln">data</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">SYPGHeader</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">header </span><span class="pun">=</span><span class="pln"> </span><span class="pun">*(</span><span class="typ">SYPGHeader</span><span class="pln"> </span><span class="pun">*)</span><span class="pln">data</span><span class="pun">;</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">return</span><span class="pln"> header</span><span class="pun">.</span><span class="pln">dwIdentifier </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0x616779</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="com">//---------------------------------------------------------------------------</span><span class="pln">
</span><span class="com">//画像ファイルの情報を書き込み、エラーコードを返す。</span><span class="pln">
</span><span class="com">//dataはファイルイメージで、サイズはdatasizeバイト。</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> </span><span class="typ">GetPictureInfoEx</span><span class="pun">(</span><span class="kwd">long</span><span class="pln"> datasize</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">struct</span><span class="pln"> </span><span class="typ">PictureInfo</span><span class="pln"> </span><span class="pun">*</span><span class="pln">lpInfo</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pln"> </span><span class="pun">*</span><span class="pln">data</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">SYPGHeader</span><span class="pln"> </span><span class="pun">*</span><span class="pln">header </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="typ">SYPGHeader</span><span class="pln"> </span><span class="pun">*)</span><span class="pln">data</span><span class="pun">;</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;lpInfo</span><span class="pun">-&gt;</span><span class="pln">left&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;lpInfo</span><span class="pun">-&gt;</span><span class="pln">top&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;lpInfo</span><span class="pun">-&gt;</span><span class="pln">width&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">=</span><span class="pln"> header</span><span class="pun">-&gt;</span><span class="pln">dwSizeX</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;lpInfo</span><span class="pun">-&gt;</span><span class="pln">height&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">=</span><span class="pln"> header</span><span class="pun">-&gt;</span><span class="pln">dwSizeY</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;lpInfo</span><span class="pun">-&gt;</span><span class="pln">x_density&nbsp;&nbsp;</span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;lpInfo</span><span class="pun">-&gt;</span><span class="pln">y_density&nbsp;&nbsp;</span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;lpInfo</span><span class="pun">-&gt;</span><span class="pln">colorDepth </span><span class="pun">=</span><span class="pln"> </span><span class="lit">24</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;lpInfo</span><span class="pun">-&gt;</span><span class="pln">hInfo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">=</span><span class="pln"> NULL</span><span class="pun">;</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">return</span><span class="pln"> SPI_ALL_RIGHT</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="com">//---------------------------------------------------------------------------</span><span class="pln">
</span><span class="com">//画像ファイルをDIBに変換し、エラーコードを返す。</span><span class="pln">
</span><span class="com">//dataはファイルイメージで、サイズはdatasizeバイト。</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> </span><span class="typ">GetPictureEx</span><span class="pun">(</span><span class="kwd">long</span><span class="pln"> datasize</span><span class="pun">,</span><span class="pln"> HANDLE </span><span class="pun">*</span><span class="pln">pHBInfo</span><span class="pun">,</span><span class="pln"> HANDLE </span><span class="pun">*</span><span class="pln">pHBm</span><span class="pun">,</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SPI_PROGRESS lpPrgressCallback</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> lData</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">char</span><span class="pln"> </span><span class="pun">*</span><span class="pln">data</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">SYPGHeader</span><span class="pln"> </span><span class="pun">*</span><span class="pln">header </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="typ">SYPGHeader</span><span class="pln"> </span><span class="pun">*)</span><span class="pln">data</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;BITMAPINFOHEADER </span><span class="pun">*</span><span class="pln">pInfo</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">char</span><span class="pln"> </span><span class="pun">*</span><span class="pln">pBm</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">char</span><span class="pln"> </span><span class="pun">*</span><span class="pln">load_data</span><span class="pun">;</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">int</span><span class="pln"> width </span><span class="pun">=</span><span class="pln"> header</span><span class="pun">-&gt;</span><span class="pln">dwSizeX</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">int</span><span class="pln"> height </span><span class="pun">=</span><span class="pln"> header</span><span class="pun">-&gt;</span><span class="pln">dwSizeY</span><span class="pun">;</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">//* 24bppなDIBの1行のバイト数</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">int</span><span class="pln"> width_len</span><span class="pun">;</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">width </span><span class="pun">*</span><span class="pln"> </span><span class="lit">3</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> </span><span class="lit">4</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">){</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;width_len </span><span class="pun">=</span><span class="pln"> width </span><span class="pun">*</span><span class="pln"> </span><span class="lit">3</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;width_len </span><span class="pun">=</span><span class="pln"> </span><span class="pun">((</span><span class="pln">width </span><span class="pun">*</span><span class="pln"> </span><span class="lit">3</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="lit">4</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="lit">4</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">lpPrgressCallback </span><span class="pun">!=</span><span class="pln"> NULL</span><span class="pun">)</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">lpPrgressCallback</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> lData</span><span class="pun">))</span><span class="pln"> </span><span class="com">//0%</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">return</span><span class="pln"> SPI_ABORT</span><span class="pun">;</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">*</span><span class="pln">pHBInfo </span><span class="pun">=</span><span class="pln"> </span><span class="typ">LocalAlloc</span><span class="pun">(</span><span class="pln">LMEM_MOVEABLE</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">sizeof</span><span class="pun">(</span><span class="pln">BITMAPINFOHEADER</span><span class="pun">));</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">*</span><span class="pln">pHBm&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">=</span><span class="pln"> </span><span class="typ">LocalAlloc</span><span class="pun">(</span><span class="pln">LMEM_MOVEABLE</span><span class="pun">,</span><span class="pln"> width_len </span><span class="pun">*</span><span class="pln"> height</span><span class="pun">);</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(*</span><span class="pln">pHBInfo </span><span class="pun">==</span><span class="pln"> NULL </span><span class="pun">||</span><span class="pln"> </span><span class="pun">*</span><span class="pln">pHBm </span><span class="pun">==</span><span class="pln"> NULL</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(*</span><span class="pln">pHBInfo </span><span class="pun">==</span><span class="pln"> NULL</span><span class="pun">)</span><span class="pln"> </span><span class="typ">LocalFree</span><span class="pun">(*</span><span class="pln">pHBInfo</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(*</span><span class="pln">pHBm </span><span class="pun">==</span><span class="pln"> NULL</span><span class="pun">)</span><span class="pln"> </span><span class="typ">LocalFree</span><span class="pun">(*</span><span class="pln">pHBm</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">return</span><span class="pln"> SPI_NO_MEMORY</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">//* いっぺん読み込むバッファ</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;load_data </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">char</span><span class="pln"> </span><span class="pun">*)</span><span class="pln">malloc</span><span class="pun">(</span><span class="pln">header</span><span class="pun">-&gt;</span><span class="pln">dwOriginalSize</span><span class="pun">);</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">load_data </span><span class="pun">==</span><span class="pln"> NULL</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">return</span><span class="pln"> SPI_NO_MEMORY</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">//メモリをロック</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;pInfo </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">BITMAPINFOHEADER </span><span class="pun">*)</span><span class="typ">LocalLock</span><span class="pun">(*</span><span class="pln">pHBInfo</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;pBm&nbsp;&nbsp; </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">char</span><span class="pln"> </span><span class="pun">*)</span><span class="typ">LocalLock</span><span class="pun">(*</span><span class="pln">pHBm</span><span class="pun">);</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">ZeroMemory</span><span class="pun">(</span><span class="pln">pInfo</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">sizeof</span><span class="pun">(</span><span class="pln">BITMAPINFOHEADER</span><span class="pun">));</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;pInfo</span><span class="pun">-&gt;</span><span class="pln">biSize&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">=</span><span class="pln"> </span><span class="kwd">sizeof</span><span class="pun">(</span><span class="pln">BITMAPINFOHEADER</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;pInfo</span><span class="pun">-&gt;</span><span class="pln">biWidth&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">=</span><span class="pln"> width</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;pInfo</span><span class="pun">-&gt;</span><span class="pln">biHeight&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">=</span><span class="pln"> height</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;pInfo</span><span class="pun">-&gt;</span><span class="pln">biPlanes&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;pInfo</span><span class="pun">-&gt;</span><span class="pln">biBitCount&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">=</span><span class="pln"> </span><span class="lit">24</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;pInfo</span><span class="pun">-&gt;</span><span class="pln">biCompression&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">=</span><span class="pln"> BI_RGB</span><span class="pun">;</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">//* バッファに読み込む</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">header</span><span class="pun">-&gt;</span><span class="pln">bCompress</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">//&nbsp;&nbsp;&nbsp;&nbsp;非圧縮転送</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memcpy</span><span class="pun">(</span><span class="pln">load_data</span><span class="pun">,</span><span class="pln"> data </span><span class="pun">+</span><span class="pln"> </span><span class="kwd">sizeof</span><span class="pun">(</span><span class="typ">SYPGHeader</span><span class="pun">),</span><span class="pln"> header</span><span class="pun">-&gt;</span><span class="pln">dwOriginalSize</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">// 圧縮されているので解凍しながらの転送</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLZSS lzss</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BYTE</span><span class="pun">*</span><span class="pln"> lpDst </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">char</span><span class="pln"> </span><span class="pun">*)</span><span class="pln">load_data</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">lzss</span><span class="pun">.</span><span class="typ">Decode</span><span class="pun">((</span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">char</span><span class="pln"> </span><span class="pun">*)</span><span class="pln">data </span><span class="pun">+</span><span class="pln"> </span><span class="kwd">sizeof</span><span class="pun">(</span><span class="typ">SYPGHeader</span><span class="pun">),</span><span class="pln"> lpDst</span><span class="pun">,</span><span class="pln"> 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;header</span><span class="pun">-&gt;</span><span class="pln">dwOriginalSize</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">)</span><span class="pln"> </span><span class="pun">!=</span><span class="lit">0</span><span class="pln"> </span><span class="pun">)</span><span class="pln"> 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">return</span><span class="pln"> SPI_OUT_OF_ORDER</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">//* load_dataに画像データが入っている．</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">//* αブレンディングをしつつ，24bitにして</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">//* SUSIEに返すバッファ(pBm)に書き込む</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">int</span><span class="pln"> p1</span><span class="pun">,</span><span class="pln"> p2</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> alpha</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> r</span><span class="pun">,</span><span class="pln"> g</span><span class="pun">,</span><span class="pln"> b</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">char</span><span class="pln"> br</span><span class="pun">,</span><span class="pln"> bg</span><span class="pun">,</span><span class="pln"> bb</span><span class="pun">;</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">// αブレンディングするときの背景色</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;br </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0x00</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;bg </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0x00</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;bb </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0x00</span><span class="pun">;</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> y </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> y </span><span class="pun">&lt;</span><span class="pln"> height</span><span class="pun">;</span><span class="pln"> y</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> x </span><span class="pun">&lt;</span><span class="pln"> width</span><span class="pun">;</span><span class="pln"> x</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p1 </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">y </span><span class="pun">*</span><span class="pln"> width_len</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> x </span><span class="pun">*</span><span class="pln"> </span><span class="lit">3</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p2 </span><span class="pun">=</span><span class="pln"> </span><span class="pun">((</span><span class="pln">height </span><span class="pun">-</span><span class="pln"> y </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> width </span><span class="pun">+</span><span class="pln"> x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="lit">4</span><span class="pun">;</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">//* αブレンディング</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">//* やねうらおさんのウェブページのスーパープログラマーへの道 第CB回を参照</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">//* [url]http://www.sun-inet.or.jp/~yaneurao/rsp/[/url]</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha </span><span class="pun">=</span><span class="pln"> load_data</span><span class="pun">[</span><span class="pln">p2 </span><span class="pun">+</span><span class="pln"> </span><span class="lit">3</span><span class="pun">];</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">alpha </span><span class="pun">==</span><span class="pln"> </span><span class="lit">255</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha </span><span class="pun">=</span><span class="pln"> </span><span class="lit">256</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g </span><span class="pun">=</span><span class="pln"> load_data</span><span class="pun">[</span><span class="pln">p2 </span><span class="pun">+</span><span class="pln"> </span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> alpha </span><span class="pun">/</span><span class="pln"> </span><span class="lit">256</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> bg </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="lit">256</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> alpha</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="lit">256</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b </span><span class="pun">=</span><span class="pln"> load_data</span><span class="pun">[</span><span class="pln">p2 </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> alpha </span><span class="pun">/</span><span class="pln"> </span><span class="lit">256</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> bb </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="lit">256</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> alpha</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="lit">256</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r </span><span class="pun">=</span><span class="pln"> load_data</span><span class="pun">[</span><span class="pln">p2 </span><span class="pun">+</span><span class="pln"> </span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> alpha </span><span class="pun">/</span><span class="pln"> </span><span class="lit">256</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> br </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="lit">256</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> alpha</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="lit">256</span><span class="pun">;</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pBm</span><span class="pun">[</span><span class="pln">p1 </span><span class="pun">+</span><span class="pln"> </span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> g </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">255</span><span class="pln"> </span><span class="pun">?</span><span class="pln"> </span><span class="lit">255</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> g</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pBm</span><span class="pun">[</span><span class="pln">p1 </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> b </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">255</span><span class="pln"> </span><span class="pun">?</span><span class="pln"> </span><span class="lit">255</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> b</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pBm</span><span class="pun">[</span><span class="pln">p1 </span><span class="pun">+</span><span class="pln"> </span><span class="lit">2</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> r </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">255</span><span class="pln"> </span><span class="pun">?</span><span class="pln"> </span><span class="lit">255</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> r</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;free</span><span class="pun">(</span><span class="pln">load_data</span><span class="pun">);</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">//メモリをアンロック</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">LocalUnlock</span><span class="pun">(*</span><span class="pln">pHBInfo</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">LocalUnlock</span><span class="pun">(*</span><span class="pln">pHBm</span><span class="pun">);</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">lpPrgressCallback </span><span class="pun">!=</span><span class="pln"> NULL</span><span class="pun">)</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">lpPrgressCallback</span><span class="pun">(</span><span class="lit">1</span><span class="pun">,</span><span class="pln"> </span><span class="lit">1</span><span class="pun">,</span><span class="pln"> lData</span><span class="pun">))</span><span class="pln"> </span><span class="com">//100%</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">return</span><span class="pln"> SPI_ABORT</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">return</span><span class="pln"> SPI_ALL_RIGHT</span><span class="pun">;</span><span class="pln">

</span><span class="pun">}</span><span class="pln">
</span><span class="com">//---------------------------------------------------------------------------</span><span class="pln">

</span><span class="com">/***************************************************************************
 * SPI関数&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *
 * 決まり切った処理はこちらで済ませている。&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*
 ***************************************************************************/</span><span class="pln">
</span><span class="com">//---------------------------------------------------------------------------</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> __stdcall </span><span class="typ">GetPluginInfo</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> infono</span><span class="pun">,</span><span class="pln"> LPSTR buf</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> buflen</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">char</span><span class="pln"> </span><span class="pun">*</span><span class="pln">str</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">infono </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> infono </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">sizeof</span><span class="pun">(</span><span class="pln">pluginfo</span><span class="pun">)</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="kwd">sizeof</span><span class="pun">(</span><span class="kwd">char</span><span class="pln"> </span><span class="pun">*)))</span><span class="pln"> 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;strncpy</span><span class="pun">(</span><span class="pln">buf</span><span class="pun">,</span><span class="pln"> pluginfo</span><span class="pun">[</span><span class="pln">infono</span><span class="pun">],</span><span class="pln"> buflen</span><span class="pun">);</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">return</span><span class="pln"> strlen</span><span class="pun">(</span><span class="pln">buf</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="com">//---------------------------------------------------------------------------</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> __stdcall </span><span class="typ">IsSupported</span><span class="pun">(</span><span class="pln">LPSTR filename</span><span class="pun">,</span><span class="pln"> DWORD dw</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">char</span><span class="pln"> </span><span class="pun">*</span><span class="pln">data</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">char</span><span class="pln"> buff</span><span class="pun">[</span><span class="pln">HEADBUF_SIZE</span><span class="pun">];</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">((</span><span class="pln">dw </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">0xFFFF0000</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* dwはファイルハンドル */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DWORD </span><span class="typ">ReadBytes</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memset</span><span class="pun">(</span><span class="pln">buff</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> HEADBUF_SIZE</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="typ">ReadFile</span><span class="pun">((</span><span class="pln">HANDLE</span><span class="pun">)</span><span class="pln">dw</span><span class="pun">,</span><span class="pln"> buff</span><span class="pun">,</span><span class="pln"> HEADBUF_SIZE</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="typ">ReadBytes</span><span class="pun">,</span><span class="pln"> NULL</span><span class="pun">))</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data </span><span class="pun">=</span><span class="pln"> buff</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* dwはバッファへのポインタ */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">char</span><span class="pln"> </span><span class="pun">*)</span><span class="pln">dw</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">


&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* フォーマット確認 */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="typ">IsSupportedEx</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> data</span><span class="pun">))</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="com">//---------------------------------------------------------------------------</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> __stdcall </span><span class="typ">GetPictureInfo</span><span class="pln">
</span><span class="pun">(</span><span class="pln">LPSTR buf</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> len</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> flag</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">struct</span><span class="pln"> </span><span class="typ">PictureInfo</span><span class="pln"> </span><span class="pun">*</span><span class="pln">lpInfo</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">int</span><span class="pln"> ret </span><span class="pun">=</span><span class="pln"> SPI_OTHER_ERROR</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">char</span><span class="pln"> </span><span class="pun">*</span><span class="pln">data</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">char</span><span class="pln"> </span><span class="pun">*</span><span class="pln">filename</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">long</span><span class="pln"> datasize</span><span class="pun">;</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">((</span><span class="pln">flag </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">7</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* bufはファイル名 */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HANDLE hf</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DWORD </span><span class="typ">ReadBytes</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hf </span><span class="pun">=</span><span class="pln"> </span><span class="typ">CreateFile</span><span class="pun">(</span><span class="pln">buf</span><span class="pun">,</span><span class="pln"> GENERIC_READ</span><span class="pun">,</span><span class="pln"> FILE_SHARE_READ</span><span class="pun">,</span><span class="pln"> NULL</span><span class="pun">,</span><span class="pln"> OPEN_EXISTING</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> NULL</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">hf </span><span class="pun">==</span><span class="pln"> INVALID_HANDLE_VALUE</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> SPI_FILE_READ_ERROR</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;datasize </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GetFileSize</span><span class="pun">(</span><span class="pln">hf</span><span class="pun">,</span><span class="pln"> NULL</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln">len</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">datasize </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">CloseHandle</span><span class="pun">(</span><span class="pln">hf</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">return</span><span class="pln"> SPI_NOT_SUPPORT</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">SetFilePointer</span><span class="pun">(</span><span class="pln">hf</span><span class="pun">,</span><span class="pln"> len</span><span class="pun">,</span><span class="pln"> NULL</span><span class="pun">,</span><span class="pln"> FILE_BEGIN</span><span class="pun">);</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">char</span><span class="pln"> </span><span class="pun">*)</span><span class="pln">malloc</span><span class="pun">(</span><span class="pln">datasize</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">data </span><span class="pun">==</span><span class="pln"> NULL</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">CloseHandle</span><span class="pun">(</span><span class="pln">hf</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">return</span><span class="pln"> SPI_NO_MEMORY</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="typ">ReadFile</span><span class="pun">(</span><span class="pln">hf</span><span class="pun">,</span><span class="pln"> data</span><span class="pun">,</span><span class="pln"> datasize</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="typ">ReadBytes</span><span class="pun">,</span><span class="pln"> NULL</span><span class="pun">))</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">CloseHandle</span><span class="pun">(</span><span class="pln">hf</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;free</span><span class="pun">(</span><span class="pln">data</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">return</span><span class="pln"> SPI_FILE_READ_ERROR</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">CloseHandle</span><span class="pun">(</span><span class="pln">hf</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename </span><span class="pun">=</span><span class="pln"> buf</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* bufはファイルイメージへのポインタ */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">char</span><span class="pln"> </span><span class="pun">*)</span><span class="pln">buf</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename </span><span class="pun">=</span><span class="pln"> NULL</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* 一応フォーマット確認 */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="typ">IsSupportedEx</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> data</span><span class="pun">))</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ret </span><span class="pun">=</span><span class="pln"> SPI_NOT_SUPPORT</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ret </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GetPictureInfoEx</span><span class="pun">(</span><span class="pln">datasize</span><span class="pun">,</span><span class="pln"> lpInfo</span><span class="pun">,</span><span class="pln"> data</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">((</span><span class="pln">flag </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">7</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> free</span><span class="pun">(</span><span class="pln">data</span><span class="pun">);</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">return</span><span class="pln"> ret</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="com">//---------------------------------------------------------------------------</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> __stdcall </span><span class="typ">GetPicture</span><span class="pun">(</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LPSTR buf</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> len</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> flag</span><span class="pun">,</span><span class="pln"> 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HANDLE </span><span class="pun">*</span><span class="pln">pHBInfo</span><span class="pun">,</span><span class="pln"> HANDLE </span><span class="pun">*</span><span class="pln">pHBm</span><span class="pun">,</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPI_PROGRESS lpPrgressCallback</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> lData</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">int</span><span class="pln"> ret </span><span class="pun">=</span><span class="pln"> SPI_OTHER_ERROR</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">char</span><span class="pln"> </span><span class="pun">*</span><span class="pln">data</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">char</span><span class="pln"> </span><span class="pun">*</span><span class="pln">filename</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">long</span><span class="pln"> datasize</span><span class="pun">;</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">((</span><span class="pln">flag </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">7</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* bufはファイル名 */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HANDLE hf</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DWORD </span><span class="typ">ReadBytes</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hf </span><span class="pun">=</span><span class="pln"> </span><span class="typ">CreateFile</span><span class="pun">(</span><span class="pln">buf</span><span class="pun">,</span><span class="pln"> GENERIC_READ</span><span class="pun">,</span><span class="pln"> FILE_SHARE_READ</span><span class="pun">,</span><span class="pln"> NULL</span><span class="pun">,</span><span class="pln"> OPEN_EXISTING</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> NULL</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">hf </span><span class="pun">==</span><span class="pln"> INVALID_HANDLE_VALUE</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> SPI_FILE_READ_ERROR</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;datasize </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GetFileSize</span><span class="pun">(</span><span class="pln">hf</span><span class="pun">,</span><span class="pln"> NULL</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln">len</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">datasize </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">CloseHandle</span><span class="pun">(</span><span class="pln">hf</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">return</span><span class="pln"> SPI_NOT_SUPPORT</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">SetFilePointer</span><span class="pun">(</span><span class="pln">hf</span><span class="pun">,</span><span class="pln"> len</span><span class="pun">,</span><span class="pln"> NULL</span><span class="pun">,</span><span class="pln"> FILE_BEGIN</span><span class="pun">);</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">char</span><span class="pln"> </span><span class="pun">*)</span><span class="pln">malloc</span><span class="pun">(</span><span class="pln">datasize</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">data </span><span class="pun">==</span><span class="pln"> NULL</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">CloseHandle</span><span class="pun">(</span><span class="pln">hf</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">return</span><span class="pln"> SPI_NO_MEMORY</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="typ">ReadFile</span><span class="pun">(</span><span class="pln">hf</span><span class="pun">,</span><span class="pln"> data</span><span class="pun">,</span><span class="pln"> datasize</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="typ">ReadBytes</span><span class="pun">,</span><span class="pln"> NULL</span><span class="pun">))</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">CloseHandle</span><span class="pun">(</span><span class="pln">hf</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;free</span><span class="pun">(</span><span class="pln">data</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">return</span><span class="pln"> SPI_FILE_READ_ERROR</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">CloseHandle</span><span class="pun">(</span><span class="pln">hf</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename </span><span class="pun">=</span><span class="pln"> buf</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* bufはファイルイメージへのポインタ */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data </span><span class="pun">=</span><span class="pln"> buf</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;datasize </span><span class="pun">=</span><span class="pln"> len</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename </span><span class="pun">=</span><span class="pln"> NULL</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/* 一応フォーマット確認 */</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="typ">IsSupportedEx</span><span class="pun">(</span><span class="pln">filename</span><span class="pun">,</span><span class="pln"> data</span><span class="pun">))</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ret </span><span class="pun">=</span><span class="pln"> SPI_NOT_SUPPORT</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ret </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GetPictureEx</span><span class="pun">(</span><span class="pln">datasize</span><span class="pun">,</span><span class="pln"> pHBInfo</span><span class="pun">,</span><span class="pln"> pHBm</span><span class="pun">,</span><span class="pln"> lpPrgressCallback</span><span class="pun">,</span><span class="pln"> lData</span><span class="pun">,</span><span class="pln"> data</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">((</span><span class="pln">flag </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">7</span><span class="pun">)</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> free</span><span class="pun">(</span><span class="pln">data</span><span class="pun">);</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">return</span><span class="pln"> ret</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="com">//---------------------------------------------------------------------------</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> __stdcall </span><span class="typ">GetPreview</span><span class="pun">(</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;LPSTR buf</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> len</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> flag</span><span class="pun">,</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;HANDLE </span><span class="pun">*</span><span class="pln">pHBInfo</span><span class="pun">,</span><span class="pln"> HANDLE </span><span class="pun">*</span><span class="pln">pHBm</span><span class="pun">,</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;SPI_PROGRESS lpPrgressCallback</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> lData</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">return</span><span class="pln"> SPI_NO_FUNCTION</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">
</span><span class="com">//---------------------------------------------------------------------------</span></pre><br><br>ygamaker<br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code3'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code3" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="com">#include</span><span class="pln"> </span><span class="str">"stdafx.h"</span><span class="pln">
</span><span class="com">#include</span><span class="pln"> </span><span class="str">"CApp.h"</span><span class="pln">

</span><span class="kwd">void</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">CApp</span><span class="pun">::</span><span class="typ">MainThread</span><span class="pun">(</span><span class="kwd">void</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="com">//&nbsp;&nbsp;&nbsp;&nbsp; これが実行される</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">GetDraw</span><span class="pun">()-&gt;</span><span class="typ">SetDisplay</span><span class="pun">(</span><span class="kwd">false</span><span class="pun">);</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">//&nbsp;&nbsp;&nbsp;&nbsp;Windowモード</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">CFileDialog</span><span class="pln"> dlg</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;CDIB32 plane</span><span class="pun">[</span><span class="lit">3</span><span class="pun">];</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">int</span><span class="pln"> sx</span><span class="pun">[</span><span class="lit">2</span><span class="pun">],</span><span class="pln">sy</span><span class="pun">[</span><span class="lit">2</span><span class="pun">];</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;CHAR file</span><span class="pun">[</span><span class="lit">2</span><span class="pun">][</span><span class="pln">MAX_PATH</span><span class="pun">];</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">CMsgDlg</span><span class="pln"> msg</span><span class="pun">;</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">CFPSTimer</span><span class="pln"> t</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;t</span><span class="pun">.</span><span class="typ">SetFPS</span><span class="pun">(</span><span class="lit">30</span><span class="pun">);</span><span class="pln">

</span><span class="kwd">retry</span><span class="pun">:;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;msg</span><span class="pun">.</span><span class="typ">Out</span><span class="pun">(</span><span class="str">"画像選択"</span><span class="pun">,</span><span class="str">"黒画像→白画像の順番で選んでください"</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">i</span><span class="pun">&lt;</span><span class="lit">2</span><span class="pun">;</span><span class="pln">i</span><span class="pun">++){</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">true</span><span class="pun">){</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">dlg</span><span class="pun">.</span><span class="typ">GetOpenFile</span><span class="pun">(</span><span class="pln">file</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])!=</span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="typ">IsThreadValid</span><span class="pun">())</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">plane</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="typ">Load</span><span class="pun">(</span><span class="pln">file</span><span class="pun">[</span><span class="pln">i</span><span class="pun">])==</span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">plane</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="typ">IsYGA</span><span class="pun">())</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">//&nbsp;&nbsp;&nbsp;&nbsp;YGA画像なのでそれを表示する</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> j</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">j</span><span class="pun">&lt;</span><span class="lit">256</span><span class="pun">;</span><span class="pln">j</span><span class="pun">+=</span><span class="lit">8</span><span class="pun">){</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="typ">IsThreadValid</span><span class="pun">())</span><span class="pln"> </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">GetDraw</span><span class="pun">()-&gt;</span><span class="typ">Clear</span><span class="pun">(</span><span class="pln">DIB32RGB</span><span class="pun">(</span><span class="pln">j</span><span class="pun">,</span><span class="pln">j</span><span class="pun">,</span><span class="pln">j</span><span class="pun">));</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">GetDraw</span><span class="pun">()-&gt;</span><span class="typ">BltNatural</span><span class="pun">(&amp;</span><span class="pln">plane</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="lit">0</span><span class="pun">,</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">GetDraw</span><span class="pun">()-&gt;</span><span class="typ">OnDraw</span><span class="pun">();</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t</span><span class="pun">.</span><span class="typ">WaitFrame</span><span class="pun">();</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">goto</span><span class="pln"> </span><span class="kwd">retry</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;plane</span><span class="pun">[</span><span class="pln">i</span><span class="pun">].</span><span class="typ">GetSize</span><span class="pun">(</span><span class="pln">sx</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="pln">sy</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">GetDraw</span><span class="pun">()-&gt;</span><span class="typ">Clear</span><span class="pun">();</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">GetDraw</span><span class="pun">()-&gt;</span><span class="typ">BltFast</span><span class="pun">(&amp;</span><span class="pln">plane</span><span class="pun">[</span><span class="pln">i</span><span class="pun">],</span><span class="lit">0</span><span class="pun">,</span><span class="lit">0</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">GetDraw</span><span class="pun">()-&gt;</span><span class="typ">OnDraw</span><span class="pun">();</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">sx</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]!=</span><span class="pln">sx</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> sy</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]!=</span><span class="pln">sy</span><span class="pun">[</span><span class="lit">1</span><span class="pun">])</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">CMsgDlg</span><span class="pln"> msg</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg</span><span class="pun">.</span><span class="typ">Out</span><span class="pun">(</span><span class="str">"エラー！"</span><span class="pun">,</span><span class="str">"２つの画像サイズが異なります"</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">goto</span><span class="pln"> </span><span class="kwd">retry</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;plane</span><span class="pun">[</span><span class="lit">2</span><span class="pun">].</span><span class="typ">CreateSurface</span><span class="pun">(</span><span class="pln">sx</span><span class="pun">[</span><span class="lit">0</span><span class="pun">],</span><span class="pln">sy</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;DWORD nSize </span><span class="pun">=</span><span class="pln"> sx</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]*</span><span class="pln">sy</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]*</span><span class="lit">4</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;DWORD</span><span class="pun">*</span><span class="pln"> p</span><span class="pun">[</span><span class="lit">2</span><span class="pun">];</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;DWORD</span><span class="pun">*</span><span class="pln"> pd</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;p</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> plane</span><span class="pun">[</span><span class="lit">0</span><span class="pun">].</span><span class="typ">GetPtr</span><span class="pun">();</span><span class="pln"> p</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> plane</span><span class="pun">[</span><span class="lit">1</span><span class="pun">].</span><span class="typ">GetPtr</span><span class="pun">();</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;pd&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="pun">=</span><span class="pln"> plane</span><span class="pun">[</span><span class="lit">2</span><span class="pun">].</span><span class="typ">GetPtr</span><span class="pun">();</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> y</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">y</span><span class="pun">&lt;</span><span class="pln">sy</span><span class="pun">[</span><span class="lit">0</span><span class="pun">];</span><span class="pln">y</span><span class="pun">++){</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">for</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">=</span><span class="lit">0</span><span class="pun">;</span><span class="pln">x</span><span class="pun">&lt;</span><span class="pln">sx</span><span class="pun">[</span><span class="lit">0</span><span class="pun">];</span><span class="pln">x</span><span class="pun">++){</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DWORD r</span><span class="pun">,</span><span class="pln">g</span><span class="pun">,</span><span class="pln">b</span><span class="pun">,</span><span class="pln">alpha</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b</span><span class="pun">=*</span><span class="pln">p</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">0xff</span><span class="pun">;</span><span class="pln">g</span><span class="pun">=(*</span><span class="pln">p</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]&gt;&gt;</span><span class="lit">8</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">0xff</span><span class="pun">;</span><span class="pln">r</span><span class="pun">=(*</span><span class="pln">p</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]&gt;&gt;</span><span class="lit">16</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">0xff</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DWORD d </span><span class="pun">=</span><span class="pln"> </span><span class="lit">255</span><span class="pun">*</span><span class="lit">3</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">b</span><span class="pun">+</span><span class="pln">g</span><span class="pun">+</span><span class="pln">r</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="pun">((*</span><span class="pln">p</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">0xff</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">((*</span><span class="pln">p</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]&gt;&gt;</span><span class="lit">8</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">0xff</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">((*</span><span class="pln">p</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]&gt;&gt;</span><span class="lit">16</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">0xff</span><span class="pun">));</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pun">(</span><span class="pln">d</span><span class="pun">==</span><span class="lit">0</span><span class="pun">){</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">*(</span><span class="pln">pd</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="kwd">else</span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b </span><span class="pun">=</span><span class="pln"> b </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="lit">255</span><span class="pun">*</span><span class="lit">3</span><span class="pun">)/</span><span class="pln">d</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;g </span><span class="pun">=</span><span class="pln"> g </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="lit">255</span><span class="pun">*</span><span class="lit">3</span><span class="pun">)/</span><span class="pln">d</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r </span><span class="pun">=</span><span class="pln"> r </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="lit">255</span><span class="pun">*</span><span class="lit">3</span><span class="pun">)/</span><span class="pln">d</span><span class="pun">;</span><span class="pln">

</span><span class="com">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha = 255 * d/(255*3);</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">// 実際にαチャンネル付転送するときには、</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">// dest += ((src-dest)*alpha)&gt;&gt;8;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">// とされていることを意識して、</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DWORD tmp </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="lit">256</span><span class="pun">*</span><span class="pln">d</span><span class="pun">)/(</span><span class="lit">255</span><span class="pun">*</span><span class="lit">3</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">tmp </span><span class="pun">&gt;=</span><span class="pln"> </span><span class="lit">0xFF</span><span class="pun">)</span><span class="pln"> alpha </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0xFF</span><span class="pun">;</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">// 0xFFを超える危険性がある</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">else</span><span class="pln"> alpha </span><span class="pun">=</span><span class="pln"> tmp</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">*(</span><span class="pln">pd</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">r</span><span class="pun">&lt;&lt;</span><span class="lit">16</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">g</span><span class="pun">&lt;&lt;</span><span class="lit">8</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> b </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">alpha</span><span class="pun">&lt;&lt;</span><span class="lit">24</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]++;</span><span class="pln"> p</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]++;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/*
&nbsp;&nbsp;&nbsp;&nbsp;for(int y=0;y&lt;sy[0];y++){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(int x=0;x&lt;sx[0];x++){
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DWORD dw;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dw = *p[0] &amp; 0xffffff;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;最上位バイトをマスク

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int alpha;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha = 255 - ((*p[1]&amp;0x000000ff) - (*p[0]&amp;0x000000ff));
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( alpha &gt; 255 ) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;msg.Out("Warning","Alpha が 255を越えました\n画像に問題があります");
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto retry;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alpha = 255 - ((*p[1]&amp;0xff) - (*p[0]&amp;0xff));
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dw += ((DWORD)alpha) &lt;&lt; 24;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;最上位バイトに持ってくる
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*(pd++) = dw;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p[0]++; p[1]++;
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">CFile</span><span class="pln"> f</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">::</span><span class="pln">strcat</span><span class="pun">(</span><span class="pln">file</span><span class="pun">[</span><span class="lit">0</span><span class="pun">],</span><span class="str">".yga"</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">/*&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;そのままデータを書き出す
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f.Write(file[0],(void*)(BYTE*)dst,nSize);
&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;plane</span><span class="pun">[</span><span class="lit">2</span><span class="pun">].</span><span class="typ">SaveYGA</span><span class="pun">(</span><span class="pln">file</span><span class="pun">[</span><span class="lit">0</span><span class="pun">]);</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">//&nbsp;&nbsp;&nbsp;&nbsp;YGAで保存</span><span class="pln">

&nbsp;&nbsp;&nbsp;&nbsp;msg</span><span class="pun">.</span><span class="typ">Out</span><span class="pun">(</span><span class="str">"正常終了"</span><span class="pun">,</span><span class="str">"処理が終わりました"</span><span class="pun">);</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">goto</span><span class="pln"> </span><span class="kwd">retry</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="com">//&nbsp;&nbsp;&nbsp;&nbsp;これがmain windowのためのクラス。</span><span class="pln">
</span><span class="kwd">class</span><span class="pln"> </span><span class="typ">CAppMainWindow</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">CAppBase</span><span class="pln"> </span><span class="pun">{</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">//&nbsp;&nbsp;&nbsp;&nbsp;アプリケーションクラスから派生</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">virtual</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> </span><span class="typ">MainThread</span><span class="pun">(</span><span class="kwd">void</span><span class="pun">){</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">//&nbsp;&nbsp;&nbsp;&nbsp;これがワーカースレッド</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">CApp</span><span class="pun">().</span><span class="typ">Start</span><span class="pun">();</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">//&nbsp;&nbsp;&nbsp;&nbsp;CApp app; app.Start();の意味ね</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
</span><span class="pun">};</span><span class="pln">

</span><span class="com">//&nbsp;&nbsp;&nbsp;&nbsp;言わずと知れたWinMain</span><span class="pln">
</span><span class="kwd">int</span><span class="pln"> APIENTRY </span><span class="typ">WinMain</span><span class="pun">(</span><span class="pln">HINSTANCE hInstance</span><span class="pun">,</span><span class="pln">HINSTANCE hPrevInstance</span><span class="pun">,</span><span class="pln">LPSTR lpCmdLine</span><span class="pun">,</span><span class="kwd">int</span><span class="pln"> nCmdShow</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">CAppInitializer</span><span class="pun">::</span><span class="typ">Init</span><span class="pun">(</span><span class="pln">hInstance</span><span class="pun">,</span><span class="pln">hPrevInstance</span><span class="pun">,</span><span class="pln">lpCmdLine</span><span class="pun">,</span><span class="pln">nCmdShow</span><span class="pun">);</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">//&nbsp;&nbsp;&nbsp;&nbsp;必ず書いてね</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">CSingleApp</span><span class="pln"> sapp</span><span class="pun">;</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">sapp</span><span class="pun">.</span><span class="typ">IsValid</span><span class="pun">())</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="typ">CAppMainWindow</span><span class="pun">().</span><span class="typ">Run</span><span class="pun">();</span><span class="pln">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="com">//&nbsp;&nbsp;&nbsp;&nbsp;上で定義したメインのウィンドゥを作成</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="pun">}</span><span class="pln">
&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span></pre></div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_3594213" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2010-09-21 11:44 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 16楼(majia1166) 的帖子');" data-mx-warn="Empty URL">16 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="3601992" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570955083-a65fefcc9dcdcab59a5a1c722cc495b9.gif" title="该用户目前在线" align="absmiddle">

<b>amemiya</b>
<div style="margin:.3em 0 .4em .2em">まい散る空へ</div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=209259" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570955083-4ca40062fa022a2922d69ce3a65f7abf.png" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_17"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">学生会副会长</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570955083-35aa8c414aad91387ad565c549e6cd0f.gif"><br>

<span class="user-info2" id="showface_17">
<span class="user-infoWrap2">


精华:

		<a href="https://bbs.sumisora.net/search.php?authorid=209259&amp;digest=1" target="_blank" class="s4 f9" referrerpolicy="no-referrer" rel="noopener noreferrer">1</a>
<br>
发帖: <span class="s1 f9">1395</span><br>
学分: <span class="s2 f9">66 点</span><br>
澄空币: <span class="s3 f9">4825 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2008-05-11<br>
		最后登录:2019-10-13 <br><br> 
		<img src="assets/1570955083-bd1b51324558fe7f970dc337a22ab44d.gif" title="杏子御津爱护同好会勋章"> <img src="assets/1570955083-88b82f7e803a86b0eafd242ea48657de.gif" title="袋鼠"> <br></span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_3601992" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10974554&amp;pid=3601992&amp;article=17" onclick="return sendurl(this,4,event)" id="quote_3601992" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10974554&amp;pid=3601992&amp;article=17" id="modify_3601992" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=209259" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10974554&amp;pid=3601992" onclick="return sendurl(this,8)" id="report_3601992" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10974554&amp;uid=209259" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('3601992')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_3601992" class="fl">&nbsp;</h1>
			

			<div id="p_3601992" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_3601992"><h6 class="quote">Quote:</h6><blockquote class="blockquote">引用第15楼majia1166于2010-09-21 10:30发表的&nbsp;&nbsp;:<br>我现在想解决输出透明问题 不知道是我没破解干净还是其他什么的。。</blockquote><br>真实情况就是这样而已，你试试PS里容差写0对着白色点一下，会刚好选定至人物边缘——嘛，大概就是运行时把FFFFFF替换成透明色了</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_3601992" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2010-09-24 23:44 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 17楼(amemiya) 的帖子');" data-mx-warn="Empty URL">17 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="a" data-mx-warn="Empty URL"></a><a name="3603063" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570955083-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>初音拓海</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=284925" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570955083-80678a1e90de4d0a85fbe524c3d35182.jpg" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_18"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空二年生上学期</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570955083-3699e74cfe4e975552e8db25eb7cc233.gif"><br>

<span class="user-info2" id="showface_18">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">412</span><br>
学分: <span class="s2 f9">11 点</span><br>
澄空币: <span class="s3 f9">674 KID</span><br>

		GPA: <span class="s2 f9">1 点</span><br>

		<span class="gray">注册时间:2009-05-07<br>
		最后登录:2017-06-12 <br><br> 
		<img src="assets/1570955083-d1be6d7f9758587bb010e932f19b099a.gif" title="ピアノの森の満開の下"> <img src="assets/1570955083-15e89d0b08be5c8eefbdfacf3bb9dffd.gif" title="天神乱漫汉化纪念勋章"> <img src="assets/1570955083-0be30e42d981b60e7b1ef013372e2d39.gif" title="V.G.NEO汉化纪念勋章"> <img src="assets/1570955083-cf90ee580aa7aa167980e457d4ade136.gif" title="青空の見える丘汉化纪念勋章"> <img src="assets/1570955083-28c25581c211b3c7aef52d987ff9b722.gif" title="Akabeesoft2主题学部纪念勋章"> <img src="assets/1570955083-073c3b6be58f710904aa8fb76d998d56.gif" title="高町なのは"> <br></span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_3603063" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10974554&amp;pid=3603063&amp;article=18" onclick="return sendurl(this,4,event)" id="quote_3603063" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10974554&amp;pid=3603063&amp;article=18" id="modify_3603063" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=284925" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10974554&amp;pid=3603063" onclick="return sendurl(this,8)" id="report_3603063" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10974554&amp;uid=284925" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('3603063')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_3603063" class="fl">&nbsp;</h1>
			

			<div id="p_3603063" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_3603063">其实说起来。。。<br>无颜之月的bmp也是无alpha的<br>所以没关系~<br>我还被问过为什么alpha是黑的呢 - =</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_3603063" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2010-09-25 19:32 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 18楼(初音拓海) 的帖子');" data-mx-warn="Empty URL">18 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

</form>
<div class="t3" style="margin:initial"><table cellspacing="0" cellpadding="0" width="100%" align="center">
	<tbody><tr><td align="left"></td>
		<td valign="center" align="right">
		<a class="abtn f_two" id="readlog" onclick="sendmsg('pw_ajax.php?action=readlog','',this.id);" data-mx-warn="Empty URL">帖子浏览记录<img src="assets/1570955083-5c8e409588b73ce4284cf5b9bd619e15.gif"></a>
		<select onchange="Fjump(this.options[this.selectedIndex].value)"><option value="" selected="">快速跳至</option>
<option value="1">&gt;&gt; 『澄空学园 办公楼区』</option>
<option value="2"> &nbsp;|- 【校园公告栏】</option>
<option value="5"> &nbsp;|- 【论坛意见箱】</option>
<option value="113">&gt;&gt; 『澄空学园 资讯社』</option>
<option value="47"> &nbsp;|- 【新鲜速报】</option>
<option value="103"> &nbsp;|- 【新作介绍】</option>
<option value="8"> &nbsp; &nbsp;|-  【电子杂志下载区】</option>
<option value="104"> &nbsp;|- 【杂志专题】</option>
<option value="7">&gt;&gt; 『澄空学园 教学楼区』</option>
<option value="62"> &nbsp;|- 【AGE主题学部】</option>
<option value="39"> &nbsp;|- 【Akabeesoft2主题学部】</option>
<option value="100"> &nbsp;|- 【AUGUST主题学部】</option>
<option value="42"> &nbsp;|- 【CIRCUS主题学部】</option>
<option value="40"> &nbsp;|- 【Cotton-Nekoneko主题学部】</option>
<option value="64"> &nbsp;|- 【GIGA主题学部】</option>
<option value="38"> &nbsp;|- 【Key主题学部】</option>
<option value="10"> &nbsp;|- 【KID主题学部】</option>
<option value="37"> &nbsp;|- 【Leaf主题学部】</option>
<option value="70"> &nbsp;|- 【minori主题学部】</option>
<option value="12"> &nbsp;|- 【Navel主题学部】</option>
<option value="65"> &nbsp;|- 【Nitro+主题学部】</option>
<option value="14"> &nbsp;|- 【Type-Moon应援会】</option>
<option value="17"> &nbsp; &nbsp;|-  【TM精华区】</option>
<option value="98"> &nbsp;|- 【Will主题学部】</option>
<option value="116"> &nbsp;|- 【FAVORITE主题学部】</option>
<option value="108"> &nbsp;|- 【ALcot主题学部】</option>
<option value="55"> &nbsp;|- 【GALGAME综合作品讨论室】</option>
<option value="97"> &nbsp; &nbsp;|-  【Light主题学部】</option>
<option value="117"> &nbsp; &nbsp;|-  【CUFFS主题学部】</option>
<option value="15"> &nbsp; &nbsp;|-  【Liar Soft主题学部】</option>
<option value="57"> &nbsp; &nbsp;|-  【Purple 主题学部】</option>
<option value="13"> &nbsp; &nbsp;|-  【工画堂主题学部】</option>
<option value="35"> &nbsp;|- 【GALGAME综合杂谈室】</option>
<option value="99"> &nbsp;|- 【ぱれっと主题学部】</option>
<option value="122"> &nbsp;|- 【SAGA PLANETS研讨室】</option>
<option value="123"> &nbsp;|- 【Lump of Sugar 研讨室】</option>
<option value="86">&gt;&gt; 『澄空学园 图书馆』</option>
<option value="80"> &nbsp;|- 【游戏鉴赏室】</option>
<option value="56"> &nbsp;|- 【GALGAME攻略馆】</option>
<option value="115"> &nbsp;|- 【作品出处问询室】</option>
<option value="63"> &nbsp;|- 【Galgame疑问求助室】</option>
<option value="18">&gt;&gt; 『澄空学园 教辅楼区』</option>
<option value="73"> &nbsp;|- 【同人游戏区】</option>
<option value="60"> &nbsp;|- 【二次元轻小说社】</option>
<option value="20"> &nbsp;|- 【日语自学教室】</option>
<option value="61"> &nbsp; &nbsp;|-  【日语学习资料区】</option>
<option value="118"> &nbsp; &nbsp;|-  【日语参考文章区】</option>
<option value="21"> &nbsp;|- 【一般游戏社团】</option>
<option value="24"> &nbsp;|- 【多媒体课堂】</option>
<option value="88">&gt;&gt; 『澄空学园 原创综合区』</option>
<option value="79"> &nbsp;|- 【原创游戏部】</option>
<option value="36"> &nbsp; &nbsp;|-  【ss-square】</option>
<option value="89"> &nbsp;|- 【MAD研究室】</option>
<option value="91"> &nbsp;|- 【莉可屋 REC ROOM】</option>
<option value="119"> &nbsp; &nbsp;|-  【澄空百合社翻唱作品】</option>
<option value="19"> &nbsp;|- 【澄空文学部】</option>
<option value="120"> &nbsp; &nbsp;|-  【落日余晖】</option>
<option value="23"> &nbsp;|- 【绘画工房】</option>
<option value="69"> &nbsp;|- 【活动投票区】</option>
<option value="74"> &nbsp;|- 【友谊赛投票区】</option>
<option value="58"> &nbsp;|- 【澄空部活室】</option>
<option value="41"> &nbsp;|- 【暑假原创作品活动专区】</option>
<option value="59"> &nbsp;|- 【实物周边交流区】</option>
<option value="85"> &nbsp; &nbsp;|-  【ComicMarket相关资料】</option>
<option value="82"> &nbsp; &nbsp;|-  【新品介绍】</option>
<option value="84"> &nbsp; &nbsp;|-  【综合交流】</option>
<option value="83"> &nbsp; &nbsp;|-  【好物收集】</option>
<option value="81"> &nbsp; &nbsp;|-  【交易求购】</option>
<option value="95"> &nbsp;|- 【澄空放送部】</option>
<option value="111"> &nbsp; &nbsp;|-  【放送策划室】</option>
<option value="27"> &nbsp;|- 【水下乐园LeMU】</option>
<option value="46"> &nbsp; &nbsp;|-  【美工作品收藏室】</option>
<option value="26"> &nbsp; &nbsp;|-  【COS自爆馆】</option>
<option value="90"> &nbsp; &nbsp;|-  【澄空期刊室】</option>
<option value="71"> &nbsp;|- 【澄空演剧部】</option>
<option value="9"> &nbsp; &nbsp;|-  演剧部排练室</option>
<option value="52"> &nbsp;|- 【废帖回收站】</option>
<option value="29">&gt;&gt; 『澄空学园 好物交流站』</option>
<option value="50"> &nbsp;|- 【澄空学园字幕作品】</option>
<option value="51"> &nbsp;|- 【澄空学园漫画作品】</option>
<option value="77"> &nbsp;|- 【游戏汉化交流区】</option>
<option value="28"> &nbsp; &nbsp;|-  【CK-GAL中文化小组】</option>
<option value="106"> &nbsp; &nbsp;|-  【PRO2】</option>
<option value="49"> &nbsp; &nbsp;|-      【桜】</option>
<option value="30"> &nbsp;|- 【资源求助区】</option>
<option value="32"> &nbsp;|- 【澄空音乐厅】</option>
<option value="33"> &nbsp;|- 【澄空美术馆】</option>
<option value="34"> &nbsp;|- 【动漫租售屋】</option>
<option value="44">&gt;&gt; 『澄空学园 课余工作区』</option>
<option value="45"> &nbsp;|- 【澄空漫画汉化组】</option>
<option value="48"> &nbsp;|-  【澄空学园字幕组】</option>
<option value="101"> &nbsp; &nbsp;|-  字幕组资料区</option>
<option value="72"> &nbsp;|- 【澄空学园分流组】</option>
<option value="87"> &nbsp;|- 【澄空学园新闻组】</option>
<option value="96"> &nbsp;|- 【澄空学园文学社】</option>
<option value="75"> &nbsp;|- 【澄空学园百合社】</option>
<option value="112"> &nbsp;|- 【澄空学园编辑部】</option>
<option value="114"> &nbsp;|- 【澄空学园美工部】</option>
<option value="121"> &nbsp;|-  【澄空祭运行委员会】</option>
</select></td>
		
	</tr>
	<tr><td style="padding-top: 12px;text-align: left;"><img src="assets/1570955083-ca4a91079181c2a5cb3514b2e5b5f035.gif" align="absbottom"> <b><a href="https://bbs.sumisora.net/index.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">『澄空学园』</a> » <a href="https://bbs.sumisora.net/thread.php?fid=78&amp;page=7" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">【汉化破解研讨室】</a></b> </td>
	<td style="padding-top: 12px;text-align: right;"><a href="https://bbs.sumisora.net/post.php?action=reply&amp;fid=78&amp;tid=10974554" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img src="assets/1570955083-132cb83b134d7ecd9b390389d489bc43.png"></a>

<a href="https://bbs.sumisora.net/post.php?fid=78" style="margin-left:.5em" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img src="assets/1570955083-8cab7ee31ae503cf78e5410d40cec291.png" id="td_post1"></a>
</td>
	</tr>
</tbody></table></div>




<form name="FORM" method="post" action="post.php?" enctype="multipart/form-data" onsubmit="return checkpost(document.FORM);">
<div class="t" style="margin-top:8px"><table cellspacing="0" cellpadding="0" align="center" width="100%">
	<tbody><tr>
		<td class="h" colspan="3"><b>快速发帖</b></td>
	</tr>
	<tr></tr>
	<tr class="tr2"><td colspan="100" style="border-bottom: 0px; --darkreader-inline-border-bottom: initial;" data-darkreader-inline-border-bottom=""></td></tr>
	<tr>
		<td valign="top" width="20%" class="f_one" style="padding:7px">
		<fieldset id="smiliebox" style="border: 1px solid rgb(213, 229, 232); --darkreader-inline-border-top:#354e51; --darkreader-inline-border-right:#354e51; --darkreader-inline-border-bottom:#354e51; --darkreader-inline-border-left:#354e51;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
		<legend>内容</legend>
		<br>
		<input type="checkbox" name="atc_usesign" value="1" checked="">使用签名<br>
		<input type="checkbox" name="atc_convert" value="1" checked="">Wind Code自动转换 <br>
	 	<input type="checkbox" id="atc_autoimg" name="atc_autoimg" value="1" onchange="onAutoImgchange()" checked="" title="此设置会记在浏览器中"><label for="atc_autoimg" title="此设置会记在浏览器中">自动分析img</label><br><br>
	 	
		<input type="checkbox" name="atc_requiresell" value="1" disabled="">出售此帖
		<input class="input" type="text" maxlength="3" size="3" name="atc_money" value="0">
		<br>
		<input type="checkbox" name="atc_requirervrc" value="1">加密此帖
		<input class="input" type="text" maxlength="6" size="3" name="atc_rvrc" value="0">
		<br>
		<br><br><a href="https://bbs.sumisora.net/read.php?tid=10925672" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">如何在帖子中贴图？</a>
		<br><a href="https://bbs.sumisora.net/read.php?tid=10942243" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Wind Code使用教程</a>
		<br><a href="https://bbs.sumisora.net/yume/recover/" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">恢复帖子内容</a>
		</fieldset>
		</td>
		<td width="60%" class="f_one" style="padding:7px">
		<div>


<blockquote style="width: 96%;" class="blockquote">澄空娘：『在手机上使用受姬版可以节省流量
』</blockquote>

		<input type="text" class="input" name="atc_title" value="Re:关于yga图片问题" size="65">
		

		 认证码: <input class="input" type="text" name="gdcode" size="5" tabindex="6" onfocus="try{opencode('menu_gd',this)}catch(e){}"><br>
		

		</div><div style="padding:.3em 0">
		</div>
		<textarea onkeydown="quickpost(event)" id="atc_content" name="atc_content" rows="8" style="width:96%"></textarea>
		
		
		
		
		
		<div style="margin:5px 0">
		<div style="padding: 4px 10px 0px 0px; float: left; color: rgb(136, 136, 136); --darkreader-inline-color:#bfb9ac;" data-darkreader-inline-color="">按 Ctrl+Enter 直接提交</div>
		<input class="btn" type="submit" name="Submit" value=" 提 交 "></div>
		</td>
		<td width="20%" class="f_one">
		<div style="padding:3px; text-align:center; width:200px;">
		<fieldset id="smiliebox" style="border: 1px solid rgb(213, 229, 232); --darkreader-inline-border-top:#354e51; --darkreader-inline-border-right:#354e51; --darkreader-inline-border-bottom:#354e51; --darkreader-inline-border-left:#354e51;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<legend>表情</legend>
			<div id="menu_show"></div>
<span style="float:right; margin:3px 10px 5px;"><a id="td_face" style="cursor:pointer;" onclick="showDefault();" align="absmiddle" unselectable="on" data-mx-warn="Empty URL">[更多]</a></span>
<span style="float:left; margin:3px 10px 5px;"><a id="td_generalface" style="cursor:pointer;" onclick="showfaces();$('#td_generalface').fadeOut();" align="absmiddle" data-mx-warn="Empty URL">[显示表情]</a></span>
		</fieldset></div>
		
		
		</td>
	</tr>
</tbody></table></div></form>







</div>
<div id="bottom"></div><br>
<center class="gray">
<small><span id="windspend">Total 0.056447(s) query 6, Time is now 10-13 16:19, 
Load is low.
</span> <br>
Powered by <a href="http://www.phpwind.net/" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><b>PHPWind</b></a> <a href="http://www.phpwind.net/" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><b style="color: rgb(255, 153, 0); --darkreader-inline-color:#f7b24b;" data-darkreader-inline-color="">v6.3.2</b></a> Code © 2003-08 <a href="http://www.phpwind.com/" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><b>PHPWind.com</b></a> Corporation</small>
</center><br>
<div id="footer">
	<span class="f12 fl"></span><a href="https://bbs.sumisora.net/sendmail.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Contact us</a>

</div>
</div>
        
      </div>
    </body>
  </html>