
  <!DOCTYPE html>
  <html id="" class="">
    <!-- OriginalSrc: https://www.iteye.com/blog/rednaxelafx-180434 -->
    <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />

      <title>桃華月憚体験版的解压缩程序 (Java) - Script Ahead, Code Behind - ITeye博客</title>
      
<link rel="shortcut icon" href="assets/1571225657-1cd7c6fd0de855e9efac8dbe4a274b55.ico" type="image/x-icon" referrerpolicy="no-referrer">


<link href="assets/1571225657-86dfe308f444f6e1aa00f6b28e8b2407.css" media="screen" rel="stylesheet" type="text/css" referrerpolicy="no-referrer">
<link href="assets/1571225657-771d0182f7eae18f5989664d94717b86.css" media="screen" rel="stylesheet" type="text/css" referrerpolicy="no-referrer">
<link href="assets/1571225657-396dd74c56d84598b8a22d8cb10eaf3a.css" media="screen" rel="stylesheet" type="text/css" referrerpolicy="no-referrer">
<link rel="stylesheet" type="text/css" href="assets/1571225657-9aeb703993455cc093fff678a2ad3401.css" referrerpolicy="no-referrer">
<link rel="stylesheet" type="text/css" href="assets/1571225657-05fb66a2c1140728ea8d74162a702c22.css" referrerpolicy="no-referrer">


<style class="darkreader darkreader--fallback" media="screen"></style>
<style class="darkreader darkreader--text" media="screen"></style>
<style class="darkreader darkreader--invert" media="screen"></style>
<style class="darkreader darkreader--inline" media="screen">[data-darkreader-inline-bgcolor] {
  background-color: var(--darkreader-inline-bgcolor) !important;
}
[data-darkreader-inline-bgimage] {
  background-image: var(--darkreader-inline-bgimage) !important;
}
[data-darkreader-inline-border] {
  border-color: var(--darkreader-inline-border) !important;
}
[data-darkreader-inline-border-bottom] {
  border-bottom-color: var(--darkreader-inline-border-bottom) !important;
}
[data-darkreader-inline-border-left] {
  border-left-color: var(--darkreader-inline-border-left) !important;
}
[data-darkreader-inline-border-right] {
  border-right-color: var(--darkreader-inline-border-right) !important;
}
[data-darkreader-inline-border-top] {
  border-top-color: var(--darkreader-inline-border-top) !important;
}
[data-darkreader-inline-boxshadow] {
  box-shadow: var(--darkreader-inline-boxshadow) !important;
}
[data-darkreader-inline-color] {
  color: var(--darkreader-inline-color) !important;
}
[data-darkreader-inline-fill] {
  fill: var(--darkreader-inline-fill) !important;
}
[data-darkreader-inline-stroke] {
  stroke: var(--darkreader-inline-stroke) !important;
}
[data-darkreader-inline-outline] {
  outline-color: var(--darkreader-inline-outline) !important;
}</style>
<style class="darkreader darkreader--user-agent" media="screen">html {
    background-color: #191a1b !important;
}
html, body, input, textarea, select, button {
    background-color: #191a1b;
}
html, body, input, textarea, select, button {
    border-color: #5a5956;
    color: #f0ebe2;
}
a {
    color: #4791e7;
}
table {
    border-color: #4f4e4c;
}
::placeholder {
    color: #bfb9ac;
}
::selection {
    background-color: #125cb4;
    color: #fffffd;
}
::-moz-selection {
    background-color: #125cb4;
    color: #fffffd;
}
input:-webkit-autofill,
textarea:-webkit-autofill,
select:-webkit-autofill {
    background-color: #565a0f !important;
    color: #f0ebe2 !important;
}
::-webkit-scrollbar {
    background-color: #1d1f1f;
    color: #cbc5b9;
}
::-webkit-scrollbar-thumb {
    background-color: #2c2d2d;
}
::-webkit-scrollbar-thumb:hover {
    background-color: #343636;
}
::-webkit-scrollbar-thumb:active {
    background-color: #404142;
}
::-webkit-scrollbar-corner {
    background-color: #191a1b;
}
* {
    scrollbar-color: #2c2d2d #1d1f1f;
}</style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style class="darkreader darkreader--override" media="screen">.jfk-bubble {
    background-color: #000000 !important;
}
.vimvixen-hint {
    background-color: #765500 !important;
    border-color: #d5b22e !important;
    color: #f9edcc !important;
}</style>
<style>
 
.hide-main-content{
    position: relative;
}
.hide-article-box {
    display: none;
    position: absolute;
    z-index: 9999;
    bottom: -1px;
    width: 100%;
    padding-top: 160px;
    background-image: -webkit-gradient(linear,left top, left bottom,from(rgba(255,255,255,0)),color-stop(70%, #fff));
    background-image: linear-gradient(-180deg,rgba(255,255,255,0) 0%,#fff 70%);
}
.hide-article-box #btn-readmore{
    color: #ca0c16;
    border: 1px solid #ca0c16;
    margin: 10px auto;
    padding: 0 8px;
    display: block;
    font-size: 14px;
    border-radius: 4px;
    text-align: center;
    background-color: transparent;
    height: 34px;
    width: 74px;
    line-height: 32px;
    min-width: 72px;
    cursor: pointer;
}
.hide-article-box #btn-readmore:hover{
    background: #ca0c16;
    color:#fff;
    text-decoration: none;
}
</style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style type="text/css">.dp-j .annotation { color: #646464; }.dp-j .number { color: #C00000; }</style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style type="text/css">.dp-j .annotation { color: #646464; }.dp-j .number { color: #C00000; }</style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style type="text/css">.dp-j .annotation { color: #646464; }.dp-j .number { color: #C00000; }</style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style type="text/css">.dp-j .annotation { color: #646464; }.dp-j .number { color: #C00000; }</style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style class="darkreader darkreader--cors" media="screen">body,dd,div,dl,dt,form,h1,h2,h3,h4,h5,h6,html,input,li,ol,p,select,td,textarea,th,ul{margin:0;padding:0}*{box-sizing:border-box}body,html{min-height:100%}h1,h2,h3,h4,h5,h6{font-weight:400}.recommend-right ul,ol{list-style:none}.recommend-right img{border:none;vertical-align:middle}.recommend-right a{text-decoration:none;color:#232323}.recommend-right table{border-collapse:collapse;table-layout:fixed}.recommend-right input,textarea{outline:0;border:none}.recommend-right textarea{resize:none;overflow:auto}.clearfix:after{content:" ";display:block;height:0;visibility:hidden;clear:both}.recommend{overflow:hidden}.newbox.recommend{overflow:hidden}svg.icon{width:1em;height:1em;vertical-align:-.15em;fill:currentColor;overflow:hidden;margin-right:4px}svg.icon.icon-level{width:3em;height:1em}.recommend-right{float:right;width:300px;margin-left:8px;background-color:#fff;-webkit-box-shadow:0 2px 4px 0 rgba(0,0,0,.05);box-shadow:0 2px 4px 0 rgba(0,0,0,.05)}.recommend-right .recommend-fixed-box{background-color:#fff}.recommend-right .right-item{padding:8px 0;overflow:hidden;word-break:break-all;margin-left:8px;margin-right:8px;border-bottom:1px solid #f5f5f5;box-sizing:border-box}.recommend-right .right-item:hover .content h5{color:#ca0c16}.recommend-right .right-item .content{margin-bottom:4px}.recommend-right .right-item .content img{width:58px;height:36px}.recommend-right .right-item .content h5{display:inline;font-size:14px;color:#5c5c5c;letter-spacing:0;line-height:20px;max-height:44px;overflow:hidden;font-weight:500;margin-right:4px;white-space:nowrap;text-overflow:ellipsis}.recommend-right .right-item .content .h5width{width:76%;margin-left:8px}.recommend-right .right-item .content span{margin-right:8px;font-size:12px;color:#999;letter-spacing:0;line-height:20px}.recommend-right .right-item .content .download_mark{border:1px solid #e3e3e3;padding:2px;margin-right:4px}.recommend-right .right-item .right-item-desc{font-size:12px;color:#999;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}</style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style class="darkreader darkreader--cors" media="screen">.{font-family:""!important;font-size:16px;font-style:normal;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.fanyi:before{content:"\e661"}.shouji:before{content:"\e66f"}.yuedushu:before{content:"\e682"}</style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style type="text/css">@keyframes fadeInOpacity{0%{opacity:0}to{opacity:1}}:hover>*>.fbvd--wrapper{animation-name:fadeInOpacity;animation-duration:.3s;opacity:1}.fbvd--wrapper{position:absolute;top:10px;left:10px;opacity:0;text-align:center;margin:0;z-index:5}.fbvd--wrapper a{background: url("") no-repeat 3px 4.55px; background-color: #fff; display:inline-block;font:700 14px Helvetica,Arial,sans-serif;color:#4b4f56;text-decoration:none;vertical-align:middle;padding:0px 8px 0px;margin-right:8px;border-radius:2px; line-height: 22px; padding-left:19px; border: 1px solid #e7e7e7; background-size: 13px}.fbvd--wrapper a:last-child{margin-right:0}.fbvd--wrapper a:hover{text-decoration:none}.fbvd--wrapper a:focus{box-shadow:0 0 1px 2px rgba(88,144,255,.75),0 1px 1px rgba(0,0,0,.15);outline:none}.fbvd--wrapper b{font-size:13px;position:relative;top:1px;color:#3b5998;font-weight:400}</style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style>
  .userinfo {display: none !important;}
  .persion_article h3{
    background: none !important;
    border-bottom: none!important;
    padding: 0!important;
    margin-bottom: 0!important;
    line-height: 1!important;
  }
  .persion_article .right_box{
    margin-top: 0!important;
  }
  .persion_article .footer_box .feed_new_tit span{
    padding-left: 0!important;
  }
</style>
<style class="darkreader darkreader--sync" media="screen"></style>

      <style class="mx-wc-style">
        .mx-wc-main img {max-width: 100%;}
        .mx-wc-main{
          box-sizing: content-box;
          background-color: rgb(35, 36, 36) !important;
          margin: 0 auto;
          margin-top: 20px;
          max-width: 706px;
        }
        @media (min-width: 768px) {
          .mx-wc-main { padding: 15px 15px 80px 15px }
        }
        @media (max-width: 767px) {
          .mx-wc-main { padding: 15px 3px 80px 3px }
        }
  
      </style>
    </head>
    <body style="background-color: #464646 !important; min-height: 100%; height: auto; position: static !important; overflow: auto !important; padding-bottom: 0px !important;" id="" class="">
      <div class="mx-wc-main">
        <DIV id="page" style="display: block !important;float: none !important;position: relative !important;top: 0 !important;left: 0 !important;border: 0px !important;width: 100% !important;min-width: 100% !important;max-width: 100% !important;height: auto !important;min-height: auto !important;max-height: 100% !important;margin: 0px !important;padding: 0px !important;"><DIV id="content" class="clearfix" style="display: block !important;float: none !important;position: relative !important;top: 0 !important;left: 0 !important;border: 0px !important;width: 100% !important;min-width: 100% !important;max-width: 100% !important;height: auto !important;min-height: auto !important;max-height: 100% !important;margin: 0px !important;padding: 0px !important;"><div id="main" class="mx-wc-selected-elem mx-wc-1571225657" style="display: block; float: none !important; position: relative !important; top: 0px !important; left: 0px !important; margin: 0px !important; flex: unset !important; width: 100% !important; max-width: 100% !important;">
        



        





<div class="blog_main">
  
  <div class="blog_title">
    <h3>
      桃華月憚体験版的解压缩程序 (Java)
      <em class="actions">      </em>
    </h3>
    <ul class="blog_categories"><strong>博客分类：</strong> <li><a href="https://www.iteye.com/category/24338" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Reverse Engineering</a></li> </ul>
        <div class="news_tag"><a href="http://www.iteye.com/blogs/tag/Java" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Java</a><a href="http://www.iteye.com/blogs/tag/Windows" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Windows</a><a href="http://www.iteye.com/blogs/tag/J%23" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">J#</a><a href="http://www.iteye.com/blogs/tag/F%23" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">F#</a>&nbsp;</div>
  </div>

  <div id="blog_content" class="hide-main-content">
    
    这是差不多一年前写的程序了……有人说想看于是发出来。
<br>当时也是为了求快，代码结构乱七八糟的。不过现在也没什么时间把这代码重构一次，就这么原样发出来吧。嗯，好歹应该把LZSS、文件IO之类的方法扔到外面去的……后来在处理ケータイ少女啊之类的东西的时候就没这么乱了，不过文件一时找不到了 T T
<br>如果没记错的话当时是直接从<a target="_blank" href="http://www.hotpixel.net/software.html" referrerpolicy="no-referrer" rel="noopener noreferrer">BlowfishJ</a>里拿了BinConverter.java来，然后加了些方法进去。因此以下代码以<a target="_blank" href="http://www.gnu.org/copyleft/lesser.html" referrerpolicy="no-referrer" rel="noopener noreferrer">LGPL</a>许可证发布。
<br>
<br>哦，对了。解图片出来的时候我偷懒了。32位的BMP图我就这么直接写到文件里了而没做处理——意味着图片是“正向BMP”，有些图片浏览程序打开的时候可能会不太正常……
<br>
<br>Extract.java:
<br><div class="dp-highlighter" id=""><div class="bar"><div class="tools">Java代码 <embed wmode="transparent" src="/javascripts/syntaxhighlighter/clipboard_new.swf" width="14" height="15" flashvars="clipboard=import%20java.io.*%3B%0Aimport%20java.util.*%3B%0A%0Aclass%20Extract%20%7B%0A%20%20%20%20%0A%20%20%20%20%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%0A%20%20%20%20%2F%2F%20Common%20constants%0A%20%20%20%20%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%0A%20%20%20%20private%20static%20final%20int%20WINDOW_LENGTH%20%3D%204096%3B%0A%20%20%20%20%0A%20%20%20%20%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%0A%20%20%20%20%2F%2F%20Signature%20constants%0A%20%20%20%20%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%0A%20%20%20%20%0A%20%20%20%20%2F%2F-------------------------%0A%20%20%20%20%2F%2F%20Scr.pak%0A%20%20%20%20%2F%2F-------------------------%0A%20%20%20%20private%20static%20final%20byte%5B%5D%20scwSig%20%3D%20%7B%0A%20%20%20%20%20%20%20%20(byte)'S'%2C%20(byte)'c'%2C%20(byte)'w'%2C%20(byte)'5'%2C%20(byte)'.'%2C%20(byte)'x'%2C%20(byte)0%2C%20(byte)0%2C%20%0A%20%20%20%20%20%20%20%20(byte)0%2C%20(byte)0%2C%20(byte)0%2C%20(byte)0%2C%20(byte)0%2C%20(byte)0%2C%20(byte)0%2C%20(byte)0%0A%20%20%20%20%7D%3B%0A%20%20%20%20%0A%20%20%20%20private%20static%20final%20byte%5B%5D%20unknownSig%20%3D%20%7B%0A%20%20%20%20%20%20%20%20(byte)0%2C%20(byte)0%2C%20(byte)0%2C%20(byte)5%2C%20(byte)0x0FF%2C%20(byte)0x0FF%2C%20(byte)0x0FF%2C%20(byte)0x0FF%0A%20%20%20%20%7D%3B%0A%20%20%20%20%0A%20%20%20%20%2F%2F-------------------------%0A%20%20%20%20%2F%2F%20Graphic.pak%0A%20%20%20%20%2F%2F-------------------------%0A%20%20%20%20private%20static%20final%20byte%5B%5D%20grpSig%20%3D%20%7B%0A%20%20%20%20%20%20%20%20(byte)0%2C%20(byte)0%2C%20(byte)4%2C%20(byte)0%0A%20%20%20%20%7D%3B%0A%20%20%20%20%0A%20%20%20%20%2F%2F-------------------------%0A%20%20%20%20%2F%2F%20BGM.pak%2C%20SE.pak%0A%20%20%20%20%2F%2F-------------------------%0A%20%20%20%20private%20static%20final%20byte%5B%5D%20oggSig%20%3D%20%7B%0A%20%20%20%20%20%20%20%20(byte)'O'%2C%20(byte)'g'%2C%20(byte)'g'%2C%20(byte)'S'%0A%20%20%20%20%7D%3B%0A%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%0A%20%20%20%20%2F%2F%20Global%20variables%0A%20%20%20%20%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%0A%20%20%20%20private%20static%20RandomAccessFile%20raf%20%3D%20null%3B%0A%20%20%20%20private%20static%20BufferedWriter%20writer%20%3D%20null%3B%0A%20%20%20%20private%20static%20Header%20header%20%3D%20null%3B%0A%20%20%20%20private%20static%20IndexEntry%5B%5D%20index%20%3D%20null%3B%0A%20%20%20%20%0A%20%20%20%20%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%0A%20%20%20%20%2F%2F%20Program%20entry%20point%0A%20%20%20%20%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%0A%20%20%20%20public%20static%20void%20main(String%5B%5D%20args)%20throws%20Exception%20%7B%0A%20%20%20%20%20%20%20%20String%20srcFilename%20%3D%20args%5B0%5D%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20if%20(srcFilename%20%3D%3D%20null%20%7C%7C%20srcFilename.trim().length()%20%3D%3D%200)%0A%20%20%20%20%20%20%20%20%20%20%20%20warnAndExit(%22Usage%3A%20java%20Extract%20srcFile%5Cnwhere%20srcFile%20is%20the%20filename%20of%20the%20file%20to%20be%20extracted.%22)%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20read%20archive%20header%0A%20%20%20%20%20%20%20%20FileInputStream%20tempFis%20%3D%20new%20FileInputStream(srcFilename)%3B%0A%20%20%20%20%20%20%20%20byte%5B%5D%20headerBytes%20%3D%20new%20byte%5BHeader.BUFFER_SIZE%5D%3B%0A%20%20%20%20%20%20%20%20tempFis.read(headerBytes)%3B%0A%20%20%20%20%20%20%20%20tempFis.close()%3B%0A%20%20%20%20%20%20%20%20tempFis%20%3D%20null%3B%20%2F%2F%20dispose%20this%20input%20stream%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20parse%20archive%20header%0A%20%20%20%20%20%20%20%20parseHeader(headerBytes)%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20open%20source%20archive%20file%0A%20%20%20%20%20%20%20%20raf%20%3D%20new%20RandomAccessFile(srcFilename%2C%20%22r%22)%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20read%20file%20index%0A%20%20%20%20%20%20%20%20raf.seek(header.getIndexBaseOffset())%3B%0A%20%20%20%20%20%20%20%20byte%5B%5D%20indexBytes%20%3D%20new%20byte%5Bheader.getIndexCompSize()%5D%3B%0A%20%20%20%20%20%20%20%20raf.read(indexBytes)%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20DEBUG%20ONLY!%0A%20%20%20%20%20%20%20%20System.err.println(%22indexCompSize%20%20%20%3D0x%22%20%2B%20Integer.toHexString(header.getIndexCompSize()).toUpperCase())%3B%0A%20%20%20%20%20%20%20%20System.err.println(%22fileCount%20%20%20%20%20%20%20%3D0x%22%20%2B%20Integer.toHexString(header.getFileCount()).toUpperCase())%3B%0A%20%20%20%20%20%20%20%20System.err.println(%22indexOrigSize%20%20%20%3D0x%22%20%2B%20Integer.toHexString(IndexEntry.LENGTH_IN_FILE%20*%20header.getFileCount()).toUpperCase())%3B%0A%20%20%20%20%20%20%20%20System.err.println(%22dataBaseOffset%20%20%3D0x%22%20%2B%20Long.toHexString(header.getDataBaseOffset()).toUpperCase())%3B%0A%20%20%20%20%20%20%20%20System.err.println(%22indexBaseOffset%20%3D0x%22%20%2B%20Long.toHexString(header.getIndexBaseOffset()).toUpperCase())%3B%0A%20%20%20%20%20%20%20%20System.err.println()%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20decompress%20file%20index%0A%20%20%20%20%20%20%20%20indexBytes%20%3D%20lzssDecompress(indexBytes%2C%20header.getIndexCompSize()%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20null%2C%20IndexEntry.LENGTH_IN_FILE%20*%20header.getFileCount())%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20parse%20file%20index%0A%20%20%20%20%20%20%20%20parseIndex(indexBytes)%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20extract%20files%20from%20archive%0A%20%20%20%20%20%20%20%20byte%5B%5D%20bytes16%20%3D%20new%20byte%5B16%5D%3B%0A%20%20%20%20%20%20%20%20for%20(IndexEntry%20entry%20%3A%20index)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20System.err.print(%22Extracting%20file%20%22%20%2B%20entry.getFilename()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2B%20%22%20at%200x%22%20%2B%20Long.toHexString(header.getDataBaseOffset()%20%2B%20entry.getOffset()).toUpperCase()%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2B%20%22...%22)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20set%20file%20pointer%0A%20%20%20%20%20%20%20%20%20%20%20%20raf.seek(header.getDataBaseOffset()%20%2B%20entry.getOffset())%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20read%20signature%0A%20%20%20%20%20%20%20%20%20%20%20%20raf.read(bytes16)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20reset%20file%20pointer%0A%20%20%20%20%20%20%20%20%20%20%20%20raf.seek(header.getDataBaseOffset()%20%2B%20entry.getOffset())%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20match%20known%20signatures%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(match(bytes16%2C%20scwSig))%20%7B%20%2F%2F%20script%20file%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20writeScriptFile(entry)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%20(BinConverter.byteArrayToInt(bytes16%2C%200)%20%3D%3D%200x00000400)%20%7B%20%2F%2F%20graphic%20file%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20writeGraphicFile(entry)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%20(BinConverter.byteArrayToInt(bytes16%2C%200)%20%3D%3D%200x4F676753)%20%7B%20%2F%2F%20Ogg%20file%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20writeOggFile(entry)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20warnAndExit(%22Unsupported%20file%20format%20found%20in%20archive%2C%200x%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%2B%20Long.toHexString(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20header.getDataBaseOffset()%20%2B%20entry.getOffset()).toUpperCase())%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20System.err.println(%22done%22)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20raf.close()%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20private%20static%20void%20parseHeader(byte%5B%5D%20buf)%20throws%20IOException%20%7B%0A%20%20%20%20%20%20%20%20header%20%3D%20new%20Header()%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20byte%5B%5D%20temp%20%3D%20null%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20check%20against%20archive%20signature%0A%20%20%20%20%20%20%20%20temp%20%3D%20extractArray(buf%2C%20Header.ARCHIVE_SIG_OFS%2C%20Header.ARCHIVE_SIG_LEN)%3B%0A%20%20%20%20%20%20%20%20if%20(!match(temp%2C%20Header.dataPackSig))%20warnAndExit(%22Unsupported%20archive%20type%22)%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20check%20against%20archive%20subtype%20signature%0A%20%20%20%20%20%20%20%20temp%20%3D%20extractArray(buf%2C%20Header.SUBTYPE_SIG_OFS%2C%20Header.SUBTYPE_SIG_LEN)%3B%0A%20%20%20%20%20%20%20%20if%20(!match(temp%2C%20Header.momoSig))%20warnAndExit(%22Unsupported%20archive%20subtype%22)%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20check%20against%20magic%20value%0A%20%20%20%20%20%20%20%20temp%20%3D%20extractArray(buf%2C%20Header.MAGIC_OFS%2C%20Header.MAGIC_LEN)%3B%0A%20%20%20%20%20%20%20%20if%20(!match(temp%2C%20Header.magic))%20warnAndExit(%22Unexpected%20magic%20value%22)%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20header.setIndexCompSize(%0A%20%20%20%20%20%20%20%20%20%20%20%20BinConverter.byteArrayToIntLE(buf%2C%20Header.INDEX_COMPSIZE_OFS))%3B%0A%20%20%20%20%20%20%20%20header.setFileCount(%0A%20%20%20%20%20%20%20%20%20%20%20%20BinConverter.byteArrayToIntLE(buf%2C%20Header.FILE_COUNT_OFS))%3B%0A%20%20%20%20%20%20%20%20header.setDataBaseOffset(%0A%20%20%20%20%20%20%20%20%20%20%20%20BinConverter.byteArrayToIntLE(buf%2C%20Header.DATA_BASEOFFSET_OFS)%20%26%200x0FFFFFFFFL)%3B%0A%20%20%20%20%20%20%20%20header.setIndexBaseOffset(%0A%20%20%20%20%20%20%20%20%20%20%20%20BinConverter.byteArrayToIntLE(buf%2C%20Header.INDEX_BASEOFFSET_OFS)%20%26%200x0FFFFFFFFL)%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20private%20static%20void%20parseIndex(byte%5B%5D%20buf)%20throws%20IOException%20%7B%0A%20%20%20%20%20%20%20%20index%20%3D%20new%20IndexEntry%5Bheader.getFileCount()%5D%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20int%20baseOfs%20%3D%200%3B%0A%20%20%20%20%20%20%20%20for%20(int%20i%20%3D%200%3B%20i%20%3C%20index.length%3B%20%2B%2Bi)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20index%5Bi%5D%20%3D%20new%20IndexEntry()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20IndexEntry%20current%20%3D%20index%5Bi%5D%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20current.setFilename(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20readCString(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20new%20ByteArrayInputStream(buf%2C%20baseOfs%20%2B%20IndexEntry.FILENAME_OFS%2C%20IndexEntry.FILENAME_LEN)))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20current.setOffset(BinConverter.byteArrayToIntLE(buf%2C%20baseOfs%20%2B%20IndexEntry.OFFSET_OFS))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20current.setSize(BinConverter.byteArrayToIntLE(buf%2C%20baseOfs%20%2B%20IndexEntry.SIZE_OFS))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20baseOfs%20%2B%3D%20IndexEntry.LENGTH_IN_FILE%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20private%20static%20byte%5B%5D%20extractArray(byte%5B%5D%20src%2C%20int%20srcPos%2C%20int%20len)%20%7B%0A%20%20%20%20%20%20%20%20byte%5B%5D%20result%20%3D%20new%20byte%5Blen%5D%3B%0A%20%20%20%20%20%20%20%20Arrays.fill(result%2C%20(byte)0)%3B%0A%20%20%20%20%20%20%20%20System.arraycopy(src%2C%20srcPos%2C%20result%2C%200%2C%20len)%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20return%20result%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20private%20static%20boolean%20match(byte%5B%5D%20b1%2C%20byte%5B%5D%20b2)%20%7B%0A%20%20%20%20%20%20%20%20return%20Arrays.equals(b1%2C%20b2)%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20private%20static%20void%20exit(int%20back)%20throws%20IOException%20%7B%0A%20%20%20%20%20%20%20%20writer.write(%22Error%20at%3A%200x%22%20%2B%20Long.toHexString(raf.getFilePointer()%20-%20back))%3B%0A%20%20%20%20%20%20%20%20writer.newLine()%3B%0A%20%20%20%20%20%20%20%20System.exit(1)%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20private%20static%20void%20warnAndExit(String%20mes)%20%7B%0A%20%20%20%20%20%20%20%20System.err.println(mes)%3B%0A%20%20%20%20%20%20%20%20System.exit(1)%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20private%20static%20void%20xorDecode(byte%5B%5D%20b)%20%7B%0A%20%20%20%20%20%20%20%20for%20(int%20offset%20%3D%200%3B%20offset%20%3C%20b.length%3B%20%2B%2Boffset)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20b%5Boffset%5D%20%3D%20(byte)(b%5Boffset%5D%20%5E%20offset)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20private%20static%20byte%5B%5D%20lzssDecompress(byte%5B%5D%20from%2C%20int%20compLen%2C%20byte%5B%5D%20to%2C%20int%20origLen)%20%7B%0A%20%20%20%20%20%20%20%20return%20lzssDecompress(from%2C%20compLen%2C%20to%2C%200%2C%20origLen)%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20private%20static%20byte%5B%5D%20lzssDecompress(byte%5B%5D%20from%2C%20int%20compLen%2C%20byte%5B%5D%20to%2C%20int%20pos%2C%20int%20origLen)%20%7B%0A%20%20%20%20%20%20%20%20if%20(to%20%3D%3D%20null)%20to%20%3D%20new%20byte%5BorigLen%5D%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20byte%5B%5D%20window%20%3D%20new%20byte%5BWINDOW_LENGTH%5D%3B%0A%20%20%20%20%20%20%20%20int%20readOffset%20%3D%200%3B%0A%20%20%20%20%20%20%20%20int%20writeOffset%20%3D%20pos%3B%0A%20%20%20%20%20%20%20%20int%20marker%20%3D%200%3B%20%2F%2F%20read%20marker%2C%208-bits%2C%201%20for%20raw%20byte%2C%200%20for%20back%20ref%0A%20%20%20%20%20%20%20%20int%20windowWriteOffset%20%3D%200x0FEE%3B%0A%20%20%20%20%20%20%20%20int%20windowReadOffset%20%3D%200%3B%0A%20%20%20%20%20%20%20%20int%20backRefLength%20%3D%200%3B%0A%20%20%20%20%20%20%20%20int%20current%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20while%20(readOffset%20!%3D%20from.length)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20marker%20%3E%3E%3D%201%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20((marker%20%26%200x0100)%20%3D%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20current%20%3D%20from%5BreadOffset%2B%2B%5D%20%26%200x0FF%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20marker%20%3D%200x0FF00%20%7C%20current%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20if(readOffset%20%3D%3D%20from.length)%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20((marker%20%26%200x01)%20%3D%3D%201)%20%7B%20%2F%2F%20copy%20raw%20bytes%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20current%20%3D%20from%5BreadOffset%2B%2B%5D%20%26%200x0FF%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20to%5BwriteOffset%2B%2B%5D%20%3D%20(byte)current%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20window%5BwindowWriteOffset%2B%2B%5D%20%3D%20(byte)current%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20windowWriteOffset%20%26%3D%200x0FFF%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%20%2F%2F%20copy%20from%20slide%20window%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20windowReadOffset%20%3D%20from%5BreadOffset%2B%2B%5D%20%26%200x0FF%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(readOffset%20%3D%3D%20from.length)%20break%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20current%20%3D%20from%5BreadOffset%2B%2B%5D%20%26%200x0FF%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20windowReadOffset%20%7C%3D%20(current%20%26%200x0F0)%20%3C%3C%204%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20backRefLength%20%3D%20(current%20%26%200x0F)%20%2B%202%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(backRefLength%20%3C%200)%20continue%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20int%20addOffset%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20while%20(addOffset%20%3C%3D%20backRefLength)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20int%20curOfs%20%3D%20(windowReadOffset%20%2B%20addOffset%2B%2B)%20%26%200x0FFF%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20current%20%3D%20window%5BcurOfs%5D%20%26%200x0FF%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20windowReadOffset%20%26%3D%200x0FFF%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20to%5BwriteOffset%2B%2B%5D%20%3D%20(byte)current%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20window%5BwindowWriteOffset%2B%2B%5D%20%3D%20(byte)current%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20windowWriteOffset%20%26%3D%200x0FFF%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%20%2F%2F%20while%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20%2F%2F%20if-else%20%20%20%20%0A%20%20%20%20%20%20%20%20%7D%20%2F%2F%20while%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20return%20to%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20private%20static%20String%20readCString(InputStream%20in)%20throws%20IOException%20%7B%0A%20%20%20%20%20%20%20%20ArrayList%3CByte%3E%20list%20%3D%20new%20ArrayList%3CByte%3E()%3B%0A%20%20%20%20%20%20%20%20int%20i%20%3D%20in.read()%3B%0A%20%20%20%20%20%20%20%20while%20(i%20!%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20list.add((byte)i)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20i%20%3D%20in.read()%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20int%20size%20%3D%20list.size()%3B%0A%20%20%20%20%20%20%20%20byte%5B%5D%20b%20%3D%20new%20byte%5Bsize%5D%3B%0A%20%20%20%20%20%20%20%20for%20(i%20%3D%200%3B%20i%20%3C%20size%3B%20%2B%2Bi)%0A%20%20%20%20%20%20%20%20%20%20%20%20b%5Bi%5D%20%3D%20list.get(i)%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20return%20new%20String(b)%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20private%20static%20void%20writeGraphicFile(IndexEntry%20entry)%20throws%20IOException%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20initialize%20some%20constants%20for%20Windows%20Bitmap%20header%0A%20%20%20%20%20%20%20%20int%20bitmapDataOffset%20%3D%200x036%3B%0A%20%20%20%20%20%20%20%20int%20bitmapHeaderSize%20%3D%200x028%3B%0A%20%20%20%20%20%20%20%20int%20width%20%3D%200%3B%20%2F%2F%20dummy%20value%0A%20%20%20%20%20%20%20%20int%20height%20%3D%200%3B%20%2F%2F%20dummy%20value%0A%20%20%20%20%20%20%20%20int%20planes%20%3D%201%3B%20%2F%2F%20locked%20value%20for%20a%20standard%20Windows%20Bitmap%0A%20%20%20%20%20%20%20%20int%20depth%20%3D%200%3B%20%2F%2F%20dummy%20value%0A%20%20%20%20%20%20%20%20int%20compression%20%3D%200%3B%20%2F%2F%20we're%20not%20gonna%20use%20compression%20here%0A%20%20%20%20%20%20%20%20int%20dataSize%20%3D%200%3B%20%2F%2F%20dummy%20value%0A%20%20%20%20%20%20%20%20int%20hRes%20%3D%200%3B%20%2F%2F%200x0B12%3B%20%2F%2F%2072%3F%0A%20%20%20%20%20%20%20%20int%20vRes%20%3D%200%3B%20%2F%2F%200x0B12%3B%20%2F%2F%2072%3F%0A%20%20%20%20%20%20%20%20int%20colorsUsed%20%3D%200%3B%20%2F%2F%20set%20to%20zero%2C%20indicating%20it's%20same%20as%20depth%0A%20%20%20%20%20%20%20%20int%20colorsImportant%20%3D%200%3B%20%2F%2F%20no%20palette%20used%20here%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20check%20against%20graphic%20file%20signature%0A%20%20%20%20%20%20%20%20if%20(raf.readInt()%20!%3D%200x00000400)%20exit(4)%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20get%20size%20info%0A%20%20%20%20%20%20%20%20int%20compSize%20%20%3D%20BinConverter.reverseEndian(raf.readInt())%3B%0A%20%20%20%20%20%20%20%20int%20origSize%20%20%3D%20BinConverter.reverseEndian(raf.readInt())%3B%0A%20%20%20%20%20%20%20%20int%20headerLen%20%3D%20BinConverter.reverseEndian(raf.readInt())%3B%0A%20%20%20%20%20%20%20%20if%20(raf.readInt()%20!%3D%200)%20exit(4)%3B%20%2F%2F%20what's%20this%3F%20seems%20like%20it's%20always%20zero%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20width%20%20%20%20%20%20%20%20%20%3D%20BinConverter.reverseEndian(raf.readInt())%3B%0A%20%20%20%20%20%20%20%20height%20%20%20%20%20%20%20%20%3D%20BinConverter.reverseEndian(raf.readInt())%3B%0A%20%20%20%20%20%20%20%20depth%20%20%20%20%20%20%20%20%20%3D%20BinConverter.reverseEndianShort(raf.readShort())%3B%0A%20%20%20%20%20%20%20%20dataSize%20%20%20%20%20%20%3D%20origSize%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20fine%20tune%20a%20few%20values%0A%20%20%20%20%20%20%20%20colorsUsed%20%3D%20depth%20%3C%3D%208%20%3F%20(1%20%3C%3C%20depth)%20%3A%200%3B%0A%20%20%20%20%20%20%20%20int%20actPaletteLen%20%3D%20depth%20%3C%3D%208%20%3F%20(1%20%3C%3C%20depth)%20*%204%20%3A%200%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20skip%20a%20few%20bytes...%0A%20%20%20%20%20%20%20%20%2F%2F%20raf.skip()%3B%0A%20%20%20%20%20%20%20%20raf.seek(header.getDataBaseOffset()%20%2B%20entry.getOffset()%20%2B%20headerLen)%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20read%20the%20compressed%20data%0A%20%20%20%20%20%20%20%20byte%5B%5D%20readBuffer%20%3D%20new%20byte%5BcompSize%5D%3B%0A%20%20%20%20%20%20%20%20raf.read(readBuffer)%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20build%20BMP%20header%0A%20%20%20%20%20%20%20%20byte%5B%5D%20writeBuffer%20%3D%20new%20byte%5BorigSize%20%2B%200x036%5D%3B%0A%20%20%20%20%20%20%20%20writeBuffer%5B0%5D%20%3D%20(byte)'B'%3B%0A%20%20%20%20%20%20%20%20writeBuffer%5B1%5D%20%3D%20(byte)'M'%3B%0A%20%20%20%20%20%20%20%20BinConverter.intToByteArrayLE(origSize%20%2B%20bitmapDataOffset%2C%20writeBuffer%2C%200x02)%3B%0A%20%20%20%20%20%20%20%20BinConverter.intToByteArrayLE(0%2C%20writeBuffer%2C%200x06)%3B%0A%20%20%20%20%20%20%20%20BinConverter.intToByteArrayLE(bitmapDataOffset%20%2B%20actPaletteLen%2C%20writeBuffer%2C%200x0A)%3B%0A%20%20%20%20%20%20%20%20BinConverter.intToByteArrayLE(bitmapHeaderSize%2C%20writeBuffer%2C%200x0E)%3B%0A%20%20%20%20%20%20%20%20BinConverter.intToByteArrayLE(width%2C%20writeBuffer%2C%200x012)%3B%0A%20%20%20%20%20%20%20%20BinConverter.intToByteArrayLE(-height%2C%20writeBuffer%2C%200x016)%3B%20%2F%2F%20negative%20height%20value%20for%20%22not-reversed%22%20bitmap%0A%20%20%20%20%20%20%20%20BinConverter.shortToByteArrayLE(planes%2C%20writeBuffer%2C%200x01A)%3B%0A%20%20%20%20%20%20%20%20BinConverter.shortToByteArrayLE(depth%2C%20writeBuffer%2C%200x01C)%3B%0A%20%20%20%20%20%20%20%20BinConverter.intToByteArrayLE(compression%2C%20writeBuffer%2C%200x01E)%3B%0A%20%20%20%20%20%20%20%20BinConverter.intToByteArrayLE(dataSize%20-%20actPaletteLen%2C%20writeBuffer%2C%200x022)%3B%0A%20%20%20%20%20%20%20%20BinConverter.intToByteArrayLE(hRes%2C%20writeBuffer%2C%200x026)%3B%0A%20%20%20%20%20%20%20%20BinConverter.intToByteArrayLE(vRes%2C%20writeBuffer%2C%200x02A)%3B%0A%20%20%20%20%20%20%20%20BinConverter.intToByteArrayLE(colorsUsed%2C%20writeBuffer%2C%200x02E)%3B%0A%20%20%20%20%20%20%20%20BinConverter.intToByteArrayLE(colorsImportant%2C%20writeBuffer%2C%200x032)%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20LZSS%20decompress%0A%20%20%20%20%20%20%20%20lzssDecompress(readBuffer%2C%20compSize%2C%20%20writeBuffer%2C%20bitmapDataOffset%2C%20origSize)%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20write%20out%20the%20bitmap%20file%0A%20%20%20%20%20%20%20%20writeFile(writeBuffer%2C%20entry.getFilename()%20%2B%20%22.bmp%22)%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20private%20static%20void%20writeOggFile(IndexEntry%20entry)%20throws%20IOException%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20read%20the%20compressed%20and%20encrypted%20data%0A%20%20%20%20%20%20%20%20byte%5B%5D%20readBuffer%20%3D%20new%20byte%5Bentry.getSize()%5D%3B%0A%20%20%20%20%20%20%20%20raf.read(readBuffer)%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20writeFile(readBuffer%2C%20entry.getFilename()%20%2B%20%22.ogg%22)%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20private%20static%20void%20writeScriptFile(IndexEntry%20entry)%20throws%20IOException%20%7B%0A%20%20%20%20%20%20%20%20final%20int%20headerLen%20%3D%20456%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20check%20against%20script%20file%20signature%0A%20%20%20%20%20%20%20%20byte%5B%5D%20bytes16%20%3D%20new%20byte%5B16%5D%3B%0A%20%20%20%20%20%20%20%20raf.read(bytes16)%3B%0A%20%20%20%20%20%20%20%20if%20(!match(bytes16%2C%20scwSig))%20exit(16)%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20check%20against%20script%20file%20magic%20value%0A%20%20%20%20%20%20%20%20byte%5B%5D%20bytes8%20%3D%20new%20byte%5B8%5D%3B%0A%20%20%20%20%20%20%20%20raf.read(bytes8)%3B%0A%20%20%20%20%20%20%20%20if%20(!match(bytes8%2C%20unknownSig))%20exit(8)%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20get%20size%20info%0A%20%20%20%20%20%20%20%20int%20origSize%20%3D%20BinConverter.reverseEndian(raf.readInt())%3B%0A%20%20%20%20%20%20%20%20int%20compSize%20%3D%20BinConverter.reverseEndian(raf.readInt())%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20skip%20a%20few%20bytes...%0A%20%20%20%20%20%20%20%20%2F%2F%20raf.skipBytes(424)%3B%20%2F%2F%20do%20something%20about%20this...%0A%20%20%20%20%20%20%20%20raf.seek(header.getDataBaseOffset()%20%2B%20entry.getOffset()%20%2B%20headerLen)%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20read%20the%20compressed%20and%20encrypted%20data%0A%20%20%20%20%20%20%20%20byte%5B%5D%20readBuffer%20%3D%20new%20byte%5BcompSize%5D%3B%0A%20%20%20%20%20%20%20%20raf.read(readBuffer)%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20XOR%20decrypt%0A%20%20%20%20%20%20%20%20xorDecode(readBuffer)%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%2F%2F%20LZSS%20decompress%0A%20%20%20%20%20%20%20%20byte%5B%5D%20writeBuffer%20%3D%20lzssDecompress(readBuffer%2C%20compSize%2C%20%20null%2C%20origSize)%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20writeFile(writeBuffer%2C%20entry.getFilename()%20%2B%20%22.scw%22)%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20private%20static%20void%20writeFile(byte%5B%5D%20buf%2C%20String%20name)%20throws%20IOException%20%7B%0A%20%20%20%20%20%20%20%20File%20dir%20%3D%20new%20File(%22.%2Fdata%2F%22)%3B%0A%20%20%20%20%20%20%20%20if%20(!dir.exists())%20dir.mkdirs()%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20FileOutputStream%20fos%20%3D%20new%20FileOutputStream(%22.%2Fdata%2F%22%20%2B%20name)%3B%0A%20%20%20%20%20%20%20%20fos.write(buf)%3B%0A%20%20%20%20%20%20%20%20fos.flush()%3B%0A%20%20%20%20%20%20%20%20fos.close()%3B%0A%20%20%20%20%7D%0A%7D" quality="high" allowscriptaccess="always" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer">&nbsp;<a href="javascript:void()" title="收藏这段代码" onclick="code_favorites_do_favorite(this);return false;" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="star" src="assets/1571225657-bf632ec55a05f69a9359f73417402b26.png" alt="收藏代码"><img class="spinner" src="assets/1571225657-a42df3a5b569bdc98ca473a4a3adfeac.gif" style="display:none"></a></div></div><ol start="1" class="dp-j"><li><span><span class="keyword">import</span><span>&nbsp;java.io.*;&nbsp;&nbsp;</span></span></li><li><span><span class="keyword">import</span><span>&nbsp;java.util.*;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span><span class="keyword">class</span><span>&nbsp;Extract&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">///////////////////////////</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;Common&nbsp;constants</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">///////////////////////////</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;WINDOW_LENGTH&nbsp;=&nbsp;</span><span class="number">4096</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">///////////////////////////</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;Signature&nbsp;constants</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">///////////////////////////</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//-------------------------</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;Scr.pak</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//-------------------------</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">byte</span><span>[]&nbsp;scwSig&nbsp;=&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="keyword">byte</span><span>)</span><span class="string">'S'</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="string">'c'</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="string">'w'</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="string">'5'</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="string">'.'</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="string">'x'</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;};&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">byte</span><span>[]&nbsp;unknownSig&nbsp;=&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">5</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0x0FF</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0x0FF</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0x0FF</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0x0FF</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;};&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//-------------------------</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;Graphic.pak</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//-------------------------</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">byte</span><span>[]&nbsp;grpSig&nbsp;=&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">4</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;};&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//-------------------------</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;BGM.pak,&nbsp;SE.pak</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//-------------------------</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">byte</span><span>[]&nbsp;oggSig&nbsp;=&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="keyword">byte</span><span>)</span><span class="string">'O'</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="string">'g'</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="string">'g'</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="string">'S'</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;};&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">///////////////////////////</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;Global&nbsp;variables</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">///////////////////////////</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;RandomAccessFile&nbsp;raf&nbsp;=&nbsp;</span><span class="keyword">null</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;BufferedWriter&nbsp;writer&nbsp;=&nbsp;</span><span class="keyword">null</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;Header&nbsp;header&nbsp;=&nbsp;</span><span class="keyword">null</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;IndexEntry[]&nbsp;index&nbsp;=&nbsp;</span><span class="keyword">null</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">///////////////////////////</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;Program&nbsp;entry&nbsp;point</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">///////////////////////////</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;main(String[]&nbsp;args)&nbsp;</span><span class="keyword">throws</span><span>&nbsp;Exception&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;srcFilename&nbsp;=&nbsp;args[<span class="number">0</span><span>];&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(srcFilename&nbsp;==&nbsp;</span><span class="keyword">null</span><span>&nbsp;||&nbsp;srcFilename.trim().length()&nbsp;==&nbsp;</span><span class="number">0</span><span>)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warnAndExit(<span class="string">"Usage:&nbsp;java&nbsp;Extract&nbsp;srcFile\nwhere&nbsp;srcFile&nbsp;is&nbsp;the&nbsp;filename&nbsp;of&nbsp;the&nbsp;file&nbsp;to&nbsp;be&nbsp;extracted."</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;read&nbsp;archive&nbsp;header</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FileInputStream&nbsp;tempFis&nbsp;=&nbsp;<span class="keyword">new</span><span>&nbsp;FileInputStream(srcFilename);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>[]&nbsp;headerBytes&nbsp;=&nbsp;</span><span class="keyword">new</span><span>&nbsp;</span><span class="keyword">byte</span><span>[Header.BUFFER_SIZE];&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tempFis.read(headerBytes);&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tempFis.close();&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tempFis&nbsp;=&nbsp;<span class="keyword">null</span><span>;&nbsp;</span><span class="comment">//&nbsp;dispose&nbsp;this&nbsp;input&nbsp;stream</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;parse&nbsp;archive&nbsp;header</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parseHeader(headerBytes);&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;open&nbsp;source&nbsp;archive&nbsp;file</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raf&nbsp;=&nbsp;<span class="keyword">new</span><span>&nbsp;RandomAccessFile(srcFilename,&nbsp;</span><span class="string">"r"</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;read&nbsp;file&nbsp;index</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raf.seek(header.getIndexBaseOffset());&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>[]&nbsp;indexBytes&nbsp;=&nbsp;</span><span class="keyword">new</span><span>&nbsp;</span><span class="keyword">byte</span><span>[header.getIndexCompSize()];&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raf.read(indexBytes);&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;DEBUG&nbsp;ONLY!</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.err.println(<span class="string">"indexCompSize&nbsp;&nbsp;&nbsp;=0x"</span><span>&nbsp;+&nbsp;Integer.toHexString(header.getIndexCompSize()).toUpperCase());&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.err.println(<span class="string">"fileCount&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=0x"</span><span>&nbsp;+&nbsp;Integer.toHexString(header.getFileCount()).toUpperCase());&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.err.println(<span class="string">"indexOrigSize&nbsp;&nbsp;&nbsp;=0x"</span><span>&nbsp;+&nbsp;Integer.toHexString(IndexEntry.LENGTH_IN_FILE&nbsp;*&nbsp;header.getFileCount()).toUpperCase());&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.err.println(<span class="string">"dataBaseOffset&nbsp;&nbsp;=0x"</span><span>&nbsp;+&nbsp;Long.toHexString(header.getDataBaseOffset()).toUpperCase());&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.err.println(<span class="string">"indexBaseOffset&nbsp;=0x"</span><span>&nbsp;+&nbsp;Long.toHexString(header.getIndexBaseOffset()).toUpperCase());&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.err.println();&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;decompress&nbsp;file&nbsp;index</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;indexBytes&nbsp;=&nbsp;lzssDecompress(indexBytes,&nbsp;header.getIndexCompSize(),&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">null</span><span>,&nbsp;IndexEntry.LENGTH_IN_FILE&nbsp;*&nbsp;header.getFileCount());&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;parse&nbsp;file&nbsp;index</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parseIndex(indexBytes);&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;extract&nbsp;files&nbsp;from&nbsp;archive</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>[]&nbsp;bytes16&nbsp;=&nbsp;</span><span class="keyword">new</span><span>&nbsp;</span><span class="keyword">byte</span><span>[</span><span class="number">16</span><span>];&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span><span>&nbsp;(IndexEntry&nbsp;entry&nbsp;:&nbsp;index)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.err.print(<span class="string">"Extracting&nbsp;file&nbsp;"</span><span>&nbsp;+&nbsp;entry.getFilename()&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;<span class="string">"&nbsp;at&nbsp;0x"</span><span>&nbsp;+&nbsp;Long.toHexString(header.getDataBaseOffset()&nbsp;+&nbsp;entry.getOffset()).toUpperCase()&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;<span class="string">"..."</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;set&nbsp;file&nbsp;pointer</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raf.seek(header.getDataBaseOffset()&nbsp;+&nbsp;entry.getOffset());&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;read&nbsp;signature</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raf.read(bytes16);&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;reset&nbsp;file&nbsp;pointer</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raf.seek(header.getDataBaseOffset()&nbsp;+&nbsp;entry.getOffset());&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;match&nbsp;known&nbsp;signatures</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(match(bytes16,&nbsp;scwSig))&nbsp;{&nbsp;</span><span class="comment">//&nbsp;script&nbsp;file</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writeScriptFile(entry);&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<span class="keyword">else</span><span>&nbsp;</span><span class="keyword">if</span><span>&nbsp;(BinConverter.byteArrayToInt(bytes16,&nbsp;</span><span class="number">0</span><span>)&nbsp;==&nbsp;</span><span class="number">0x00000400</span><span>)&nbsp;{&nbsp;</span><span class="comment">//&nbsp;graphic&nbsp;file</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writeGraphicFile(entry);&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<span class="keyword">else</span><span>&nbsp;</span><span class="keyword">if</span><span>&nbsp;(BinConverter.byteArrayToInt(bytes16,&nbsp;</span><span class="number">0</span><span>)&nbsp;==&nbsp;</span><span class="number">0x4F676753</span><span>)&nbsp;{&nbsp;</span><span class="comment">//&nbsp;Ogg&nbsp;file</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writeOggFile(entry);&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<span class="keyword">else</span><span>&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;warnAndExit(<span class="string">"Unsupported&nbsp;file&nbsp;format&nbsp;found&nbsp;in&nbsp;archive,&nbsp;0x"</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+&nbsp;Long.toHexString(&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;header.getDataBaseOffset()&nbsp;+&nbsp;entry.getOffset()).toUpperCase());&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.err.println(<span class="string">"done"</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raf.close();&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;parseHeader(</span><span class="keyword">byte</span><span>[]&nbsp;buf)&nbsp;</span><span class="keyword">throws</span><span>&nbsp;IOException&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;header&nbsp;=&nbsp;<span class="keyword">new</span><span>&nbsp;Header();&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>[]&nbsp;temp&nbsp;=&nbsp;</span><span class="keyword">null</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;check&nbsp;against&nbsp;archive&nbsp;signature</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp&nbsp;=&nbsp;extractArray(buf,&nbsp;Header.ARCHIVE_SIG_OFS,&nbsp;Header.ARCHIVE_SIG_LEN);&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(!match(temp,&nbsp;Header.dataPackSig))&nbsp;warnAndExit(</span><span class="string">"Unsupported&nbsp;archive&nbsp;type"</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;check&nbsp;against&nbsp;archive&nbsp;subtype&nbsp;signature</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp&nbsp;=&nbsp;extractArray(buf,&nbsp;Header.SUBTYPE_SIG_OFS,&nbsp;Header.SUBTYPE_SIG_LEN);&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(!match(temp,&nbsp;Header.momoSig))&nbsp;warnAndExit(</span><span class="string">"Unsupported&nbsp;archive&nbsp;subtype"</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;check&nbsp;against&nbsp;magic&nbsp;value</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp&nbsp;=&nbsp;extractArray(buf,&nbsp;Header.MAGIC_OFS,&nbsp;Header.MAGIC_LEN);&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(!match(temp,&nbsp;Header.magic))&nbsp;warnAndExit(</span><span class="string">"Unexpected&nbsp;magic&nbsp;value"</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;header.setIndexCompSize(&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BinConverter.byteArrayToIntLE(buf,&nbsp;Header.INDEX_COMPSIZE_OFS));&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;header.setFileCount(&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BinConverter.byteArrayToIntLE(buf,&nbsp;Header.FILE_COUNT_OFS));&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;header.setDataBaseOffset(&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BinConverter.byteArrayToIntLE(buf,&nbsp;Header.DATA_BASEOFFSET_OFS)&nbsp;&amp;&nbsp;0x0FFFFFFFFL);&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;header.setIndexBaseOffset(&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BinConverter.byteArrayToIntLE(buf,&nbsp;Header.INDEX_BASEOFFSET_OFS)&nbsp;&amp;&nbsp;0x0FFFFFFFFL);&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;parseIndex(</span><span class="keyword">byte</span><span>[]&nbsp;buf)&nbsp;</span><span class="keyword">throws</span><span>&nbsp;IOException&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;index&nbsp;=&nbsp;<span class="keyword">new</span><span>&nbsp;IndexEntry[header.getFileCount()];&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;baseOfs&nbsp;=&nbsp;</span><span class="number">0</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span><span>&nbsp;(</span><span class="keyword">int</span><span>&nbsp;i&nbsp;=&nbsp;</span><span class="number">0</span><span>;&nbsp;i&nbsp;&lt;&nbsp;index.length;&nbsp;++i)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;index[i]&nbsp;=&nbsp;<span class="keyword">new</span><span>&nbsp;IndexEntry();&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IndexEntry&nbsp;current&nbsp;=&nbsp;index[i];&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;current.setFilename(&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;readCString(&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">new</span><span>&nbsp;ByteArrayInputStream(buf,&nbsp;baseOfs&nbsp;+&nbsp;IndexEntry.FILENAME_OFS,&nbsp;IndexEntry.FILENAME_LEN)));&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;current.setOffset(BinConverter.byteArrayToIntLE(buf,&nbsp;baseOfs&nbsp;+&nbsp;IndexEntry.OFFSET_OFS));&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;current.setSize(BinConverter.byteArrayToIntLE(buf,&nbsp;baseOfs&nbsp;+&nbsp;IndexEntry.SIZE_OFS));&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;baseOfs&nbsp;+=&nbsp;IndexEntry.LENGTH_IN_FILE;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">byte</span><span>[]&nbsp;extractArray(</span><span class="keyword">byte</span><span>[]&nbsp;src,&nbsp;</span><span class="keyword">int</span><span>&nbsp;srcPos,&nbsp;</span><span class="keyword">int</span><span>&nbsp;len)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>[]&nbsp;result&nbsp;=&nbsp;</span><span class="keyword">new</span><span>&nbsp;</span><span class="keyword">byte</span><span>[len];&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arrays.fill(result,&nbsp;(<span class="keyword">byte</span><span>)</span><span class="number">0</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.arraycopy(src,&nbsp;srcPos,&nbsp;result,&nbsp;<span class="number">0</span><span>,&nbsp;len);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;result;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">boolean</span><span>&nbsp;match(</span><span class="keyword">byte</span><span>[]&nbsp;b1,&nbsp;</span><span class="keyword">byte</span><span>[]&nbsp;b2)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;Arrays.equals(b1,&nbsp;b2);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;exit(</span><span class="keyword">int</span><span>&nbsp;back)&nbsp;</span><span class="keyword">throws</span><span>&nbsp;IOException&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writer.write(<span class="string">"Error&nbsp;at:&nbsp;0x"</span><span>&nbsp;+&nbsp;Long.toHexString(raf.getFilePointer()&nbsp;-&nbsp;back));&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writer.newLine();&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.exit(<span class="number">1</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;warnAndExit(String&nbsp;mes)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.err.println(mes);&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.exit(<span class="number">1</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;xorDecode(</span><span class="keyword">byte</span><span>[]&nbsp;b)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span><span>&nbsp;(</span><span class="keyword">int</span><span>&nbsp;offset&nbsp;=&nbsp;</span><span class="number">0</span><span>;&nbsp;offset&nbsp;&lt;&nbsp;b.length;&nbsp;++offset)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b[offset]&nbsp;=&nbsp;(<span class="keyword">byte</span><span>)(b[offset]&nbsp;^&nbsp;offset);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">byte</span><span>[]&nbsp;lzssDecompress(</span><span class="keyword">byte</span><span>[]&nbsp;from,&nbsp;</span><span class="keyword">int</span><span>&nbsp;compLen,&nbsp;</span><span class="keyword">byte</span><span>[]&nbsp;to,&nbsp;</span><span class="keyword">int</span><span>&nbsp;origLen)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;lzssDecompress(from,&nbsp;compLen,&nbsp;to,&nbsp;</span><span class="number">0</span><span>,&nbsp;origLen);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">byte</span><span>[]&nbsp;lzssDecompress(</span><span class="keyword">byte</span><span>[]&nbsp;from,&nbsp;</span><span class="keyword">int</span><span>&nbsp;compLen,&nbsp;</span><span class="keyword">byte</span><span>[]&nbsp;to,&nbsp;</span><span class="keyword">int</span><span>&nbsp;pos,&nbsp;</span><span class="keyword">int</span><span>&nbsp;origLen)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(to&nbsp;==&nbsp;</span><span class="keyword">null</span><span>)&nbsp;to&nbsp;=&nbsp;</span><span class="keyword">new</span><span>&nbsp;</span><span class="keyword">byte</span><span>[origLen];&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>[]&nbsp;window&nbsp;=&nbsp;</span><span class="keyword">new</span><span>&nbsp;</span><span class="keyword">byte</span><span>[WINDOW_LENGTH];&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;readOffset&nbsp;=&nbsp;</span><span class="number">0</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;writeOffset&nbsp;=&nbsp;pos;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;marker&nbsp;=&nbsp;</span><span class="number">0</span><span>;&nbsp;</span><span class="comment">//&nbsp;read&nbsp;marker,&nbsp;8-bits,&nbsp;1&nbsp;for&nbsp;raw&nbsp;byte,&nbsp;0&nbsp;for&nbsp;back&nbsp;ref</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;windowWriteOffset&nbsp;=&nbsp;</span><span class="number">0x0FEE</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;windowReadOffset&nbsp;=&nbsp;</span><span class="number">0</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;backRefLength&nbsp;=&nbsp;</span><span class="number">0</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;current&nbsp;=&nbsp;</span><span class="number">0</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">while</span><span>&nbsp;(readOffset&nbsp;!=&nbsp;from.length)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;marker&nbsp;&gt;&gt;=&nbsp;<span class="number">1</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;((marker&nbsp;&amp;&nbsp;</span><span class="number">0x0100</span><span>)&nbsp;==&nbsp;</span><span class="number">0</span><span>)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;current&nbsp;=&nbsp;from[readOffset++]&nbsp;&amp;&nbsp;<span class="number">0x0FF</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;marker&nbsp;=&nbsp;<span class="number">0x0FF00</span><span>&nbsp;|&nbsp;current;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>(readOffset&nbsp;==&nbsp;from.length)&nbsp;</span><span class="keyword">break</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;((marker&nbsp;&amp;&nbsp;</span><span class="number">0x01</span><span>)&nbsp;==&nbsp;</span><span class="number">1</span><span>)&nbsp;{&nbsp;</span><span class="comment">//&nbsp;copy&nbsp;raw&nbsp;bytes</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;current&nbsp;=&nbsp;from[readOffset++]&nbsp;&amp;&nbsp;<span class="number">0x0FF</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to[writeOffset++]&nbsp;=&nbsp;(<span class="keyword">byte</span><span>)current;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;window[windowWriteOffset++]&nbsp;=&nbsp;(<span class="keyword">byte</span><span>)current;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;windowWriteOffset&nbsp;&amp;=&nbsp;<span class="number">0x0FFF</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<span class="keyword">else</span><span>&nbsp;{&nbsp;</span><span class="comment">//&nbsp;copy&nbsp;from&nbsp;slide&nbsp;window</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;windowReadOffset&nbsp;=&nbsp;from[readOffset++]&nbsp;&amp;&nbsp;<span class="number">0x0FF</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>(readOffset&nbsp;==&nbsp;from.length)&nbsp;</span><span class="keyword">break</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;current&nbsp;=&nbsp;from[readOffset++]&nbsp;&amp;&nbsp;<span class="number">0x0FF</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;windowReadOffset&nbsp;|=&nbsp;(current&nbsp;&amp;&nbsp;<span class="number">0x0F0</span><span>)&nbsp;&lt;&lt;&nbsp;</span><span class="number">4</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;backRefLength&nbsp;=&nbsp;(current&nbsp;&amp;&nbsp;<span class="number">0x0F</span><span>)&nbsp;+&nbsp;</span><span class="number">2</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(backRefLength&nbsp;&lt;&nbsp;</span><span class="number">0</span><span>)&nbsp;</span><span class="keyword">continue</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;addOffset&nbsp;=&nbsp;</span><span class="number">0</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">while</span><span>&nbsp;(addOffset&nbsp;&lt;=&nbsp;backRefLength)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;curOfs&nbsp;=&nbsp;(windowReadOffset&nbsp;+&nbsp;addOffset++)&nbsp;&amp;&nbsp;</span><span class="number">0x0FFF</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;current&nbsp;=&nbsp;window[curOfs]&nbsp;&amp;&nbsp;<span class="number">0x0FF</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;windowReadOffset&nbsp;&amp;=&nbsp;<span class="number">0x0FFF</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to[writeOffset++]&nbsp;=&nbsp;(<span class="keyword">byte</span><span>)current;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;window[windowWriteOffset++]&nbsp;=&nbsp;(<span class="keyword">byte</span><span>)current;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;windowWriteOffset&nbsp;&amp;=&nbsp;<span class="number">0x0FFF</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<span class="comment">//&nbsp;while</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<span class="comment">//&nbsp;if-else&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;<span class="comment">//&nbsp;while</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;to;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;String&nbsp;readCString(InputStream&nbsp;in)&nbsp;</span><span class="keyword">throws</span><span>&nbsp;IOException&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ArrayList&lt;Byte&gt;&nbsp;list&nbsp;=&nbsp;<span class="keyword">new</span><span>&nbsp;ArrayList&lt;Byte&gt;();&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;i&nbsp;=&nbsp;in.read();&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">while</span><span>&nbsp;(i&nbsp;!=&nbsp;</span><span class="number">0</span><span>)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list.add((<span class="keyword">byte</span><span>)i);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;=&nbsp;in.read();&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;size&nbsp;=&nbsp;list.size();&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>[]&nbsp;b&nbsp;=&nbsp;</span><span class="keyword">new</span><span>&nbsp;</span><span class="keyword">byte</span><span>[size];&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span><span>&nbsp;(i&nbsp;=&nbsp;</span><span class="number">0</span><span>;&nbsp;i&nbsp;&lt;&nbsp;size;&nbsp;++i)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b[i]&nbsp;=&nbsp;list.get(i);&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;</span><span class="keyword">new</span><span>&nbsp;String(b);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;writeGraphicFile(IndexEntry&nbsp;entry)&nbsp;</span><span class="keyword">throws</span><span>&nbsp;IOException&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;initialize&nbsp;some&nbsp;constants&nbsp;for&nbsp;Windows&nbsp;Bitmap&nbsp;header</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;bitmapDataOffset&nbsp;=&nbsp;</span><span class="number">0x036</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;bitmapHeaderSize&nbsp;=&nbsp;</span><span class="number">0x028</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;width&nbsp;=&nbsp;</span><span class="number">0</span><span>;&nbsp;</span><span class="comment">//&nbsp;dummy&nbsp;value</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;height&nbsp;=&nbsp;</span><span class="number">0</span><span>;&nbsp;</span><span class="comment">//&nbsp;dummy&nbsp;value</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;planes&nbsp;=&nbsp;</span><span class="number">1</span><span>;&nbsp;</span><span class="comment">//&nbsp;locked&nbsp;value&nbsp;for&nbsp;a&nbsp;standard&nbsp;Windows&nbsp;Bitmap</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;depth&nbsp;=&nbsp;</span><span class="number">0</span><span>;&nbsp;</span><span class="comment">//&nbsp;dummy&nbsp;value</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;compression&nbsp;=&nbsp;</span><span class="number">0</span><span>;&nbsp;</span><span class="comment">//&nbsp;we're&nbsp;not&nbsp;gonna&nbsp;use&nbsp;compression&nbsp;here</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;dataSize&nbsp;=&nbsp;</span><span class="number">0</span><span>;&nbsp;</span><span class="comment">//&nbsp;dummy&nbsp;value</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;hRes&nbsp;=&nbsp;</span><span class="number">0</span><span>;&nbsp;</span><span class="comment">//&nbsp;0x0B12;&nbsp;//&nbsp;72?</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;vRes&nbsp;=&nbsp;</span><span class="number">0</span><span>;&nbsp;</span><span class="comment">//&nbsp;0x0B12;&nbsp;//&nbsp;72?</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;colorsUsed&nbsp;=&nbsp;</span><span class="number">0</span><span>;&nbsp;</span><span class="comment">//&nbsp;set&nbsp;to&nbsp;zero,&nbsp;indicating&nbsp;it's&nbsp;same&nbsp;as&nbsp;depth</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;colorsImportant&nbsp;=&nbsp;</span><span class="number">0</span><span>;&nbsp;</span><span class="comment">//&nbsp;no&nbsp;palette&nbsp;used&nbsp;here&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;check&nbsp;against&nbsp;graphic&nbsp;file&nbsp;signature</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(raf.readInt()&nbsp;!=&nbsp;</span><span class="number">0x00000400</span><span>)&nbsp;exit(</span><span class="number">4</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;get&nbsp;size&nbsp;info</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;compSize&nbsp;&nbsp;=&nbsp;BinConverter.reverseEndian(raf.readInt());&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;origSize&nbsp;&nbsp;=&nbsp;BinConverter.reverseEndian(raf.readInt());&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;headerLen&nbsp;=&nbsp;BinConverter.reverseEndian(raf.readInt());&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(raf.readInt()&nbsp;!=&nbsp;</span><span class="number">0</span><span>)&nbsp;exit(</span><span class="number">4</span><span>);&nbsp;</span><span class="comment">//&nbsp;what's&nbsp;this?&nbsp;seems&nbsp;like&nbsp;it's&nbsp;always&nbsp;zero</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;width&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;BinConverter.reverseEndian(raf.readInt());&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;height&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;BinConverter.reverseEndian(raf.readInt());&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;depth&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;BinConverter.reverseEndianShort(raf.readShort());&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dataSize&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;origSize;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;fine&nbsp;tune&nbsp;a&nbsp;few&nbsp;values</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;colorsUsed&nbsp;=&nbsp;depth&nbsp;&lt;=&nbsp;<span class="number">8</span><span>&nbsp;?&nbsp;(</span><span class="number">1</span><span>&nbsp;&lt;&lt;&nbsp;depth)&nbsp;:&nbsp;</span><span class="number">0</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;actPaletteLen&nbsp;=&nbsp;depth&nbsp;&lt;=&nbsp;</span><span class="number">8</span><span>&nbsp;?&nbsp;(</span><span class="number">1</span><span>&nbsp;&lt;&lt;&nbsp;depth)&nbsp;*&nbsp;</span><span class="number">4</span><span>&nbsp;:&nbsp;</span><span class="number">0</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;skip&nbsp;a&nbsp;few&nbsp;bytes...</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;raf.skip();</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raf.seek(header.getDataBaseOffset()&nbsp;+&nbsp;entry.getOffset()&nbsp;+&nbsp;headerLen);&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;read&nbsp;the&nbsp;compressed&nbsp;data</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>[]&nbsp;readBuffer&nbsp;=&nbsp;</span><span class="keyword">new</span><span>&nbsp;</span><span class="keyword">byte</span><span>[compSize];&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raf.read(readBuffer);&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;build&nbsp;BMP&nbsp;header</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>[]&nbsp;writeBuffer&nbsp;=&nbsp;</span><span class="keyword">new</span><span>&nbsp;</span><span class="keyword">byte</span><span>[origSize&nbsp;+&nbsp;</span><span class="number">0x036</span><span>];&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writeBuffer[<span class="number">0</span><span>]&nbsp;=&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="string">'B'</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writeBuffer[<span class="number">1</span><span>]&nbsp;=&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="string">'M'</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BinConverter.intToByteArrayLE(origSize&nbsp;+&nbsp;bitmapDataOffset,&nbsp;writeBuffer,&nbsp;<span class="number">0x02</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BinConverter.intToByteArrayLE(<span class="number">0</span><span>,&nbsp;writeBuffer,&nbsp;</span><span class="number">0x06</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BinConverter.intToByteArrayLE(bitmapDataOffset&nbsp;+&nbsp;actPaletteLen,&nbsp;writeBuffer,&nbsp;<span class="number">0x0A</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BinConverter.intToByteArrayLE(bitmapHeaderSize,&nbsp;writeBuffer,&nbsp;<span class="number">0x0E</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BinConverter.intToByteArrayLE(width,&nbsp;writeBuffer,&nbsp;<span class="number">0x012</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BinConverter.intToByteArrayLE(-height,&nbsp;writeBuffer,&nbsp;<span class="number">0x016</span><span>);&nbsp;</span><span class="comment">//&nbsp;negative&nbsp;height&nbsp;value&nbsp;for&nbsp;"not-reversed"&nbsp;bitmap</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BinConverter.shortToByteArrayLE(planes,&nbsp;writeBuffer,&nbsp;<span class="number">0x01A</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BinConverter.shortToByteArrayLE(depth,&nbsp;writeBuffer,&nbsp;<span class="number">0x01C</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BinConverter.intToByteArrayLE(compression,&nbsp;writeBuffer,&nbsp;<span class="number">0x01E</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BinConverter.intToByteArrayLE(dataSize&nbsp;-&nbsp;actPaletteLen,&nbsp;writeBuffer,&nbsp;<span class="number">0x022</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BinConverter.intToByteArrayLE(hRes,&nbsp;writeBuffer,&nbsp;<span class="number">0x026</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BinConverter.intToByteArrayLE(vRes,&nbsp;writeBuffer,&nbsp;<span class="number">0x02A</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BinConverter.intToByteArrayLE(colorsUsed,&nbsp;writeBuffer,&nbsp;<span class="number">0x02E</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BinConverter.intToByteArrayLE(colorsImportant,&nbsp;writeBuffer,&nbsp;<span class="number">0x032</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;LZSS&nbsp;decompress</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lzssDecompress(readBuffer,&nbsp;compSize,&nbsp;&nbsp;writeBuffer,&nbsp;bitmapDataOffset,&nbsp;origSize);&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;write&nbsp;out&nbsp;the&nbsp;bitmap&nbsp;file</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writeFile(writeBuffer,&nbsp;entry.getFilename()&nbsp;+&nbsp;<span class="string">".bmp"</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;writeOggFile(IndexEntry&nbsp;entry)&nbsp;</span><span class="keyword">throws</span><span>&nbsp;IOException&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;read&nbsp;the&nbsp;compressed&nbsp;and&nbsp;encrypted&nbsp;data</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>[]&nbsp;readBuffer&nbsp;=&nbsp;</span><span class="keyword">new</span><span>&nbsp;</span><span class="keyword">byte</span><span>[entry.getSize()];&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raf.read(readBuffer);&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writeFile(readBuffer,&nbsp;entry.getFilename()&nbsp;+&nbsp;<span class="string">".ogg"</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;writeScriptFile(IndexEntry&nbsp;entry)&nbsp;</span><span class="keyword">throws</span><span>&nbsp;IOException&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">final</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;headerLen&nbsp;=&nbsp;</span><span class="number">456</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;check&nbsp;against&nbsp;script&nbsp;file&nbsp;signature</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>[]&nbsp;bytes16&nbsp;=&nbsp;</span><span class="keyword">new</span><span>&nbsp;</span><span class="keyword">byte</span><span>[</span><span class="number">16</span><span>];&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raf.read(bytes16);&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(!match(bytes16,&nbsp;scwSig))&nbsp;exit(</span><span class="number">16</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;check&nbsp;against&nbsp;script&nbsp;file&nbsp;magic&nbsp;value</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>[]&nbsp;bytes8&nbsp;=&nbsp;</span><span class="keyword">new</span><span>&nbsp;</span><span class="keyword">byte</span><span>[</span><span class="number">8</span><span>];&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raf.read(bytes8);&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(!match(bytes8,&nbsp;unknownSig))&nbsp;exit(</span><span class="number">8</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;get&nbsp;size&nbsp;info</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;origSize&nbsp;=&nbsp;BinConverter.reverseEndian(raf.readInt());&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;compSize&nbsp;=&nbsp;BinConverter.reverseEndian(raf.readInt());&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;skip&nbsp;a&nbsp;few&nbsp;bytes...</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;raf.skipBytes(424);&nbsp;//&nbsp;do&nbsp;something&nbsp;about&nbsp;this...</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raf.seek(header.getDataBaseOffset()&nbsp;+&nbsp;entry.getOffset()&nbsp;+&nbsp;headerLen);&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;read&nbsp;the&nbsp;compressed&nbsp;and&nbsp;encrypted&nbsp;data</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>[]&nbsp;readBuffer&nbsp;=&nbsp;</span><span class="keyword">new</span><span>&nbsp;</span><span class="keyword">byte</span><span>[compSize];&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;raf.read(readBuffer);&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;XOR&nbsp;decrypt</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xorDecode(readBuffer);&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;LZSS&nbsp;decompress</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>[]&nbsp;writeBuffer&nbsp;=&nbsp;lzssDecompress(readBuffer,&nbsp;compSize,&nbsp;&nbsp;</span><span class="keyword">null</span><span>,&nbsp;origSize);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;writeFile(writeBuffer,&nbsp;entry.getFilename()&nbsp;+&nbsp;<span class="string">".scw"</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;writeFile(</span><span class="keyword">byte</span><span>[]&nbsp;buf,&nbsp;String&nbsp;name)&nbsp;</span><span class="keyword">throws</span><span>&nbsp;IOException&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;File&nbsp;dir&nbsp;=&nbsp;<span class="keyword">new</span><span>&nbsp;File(</span><span class="string">"./data/"</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(!dir.exists())&nbsp;dir.mkdirs();&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FileOutputStream&nbsp;fos&nbsp;=&nbsp;<span class="keyword">new</span><span>&nbsp;FileOutputStream(</span><span class="string">"./data/"</span><span>&nbsp;+&nbsp;name);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fos.write(buf);&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fos.flush();&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fos.close();&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>}&nbsp;&nbsp;</span></li></ol></div>
<br>
<br>Header.java:
<br><div class="dp-highlighter" id=""><div class="bar"><div class="tools">Java代码 <embed wmode="transparent" src="/javascripts/syntaxhighlighter/clipboard_new.swf" width="14" height="15" flashvars="clipboard=public%20class%20Header%20%7B%0A%20%20%20%20%0A%20%20%20%20public%20static%20final%20int%20BUFFER_SIZE%20%3D%204096%3B%0A%20%20%20%20%0A%20%20%20%20public%20static%20final%20int%20ARCHIVE_SIG_OFS%20%3D%200%3B%0A%20%20%20%20public%20static%20final%20int%20ARCHIVE_SIG_LEN%20%3D%2016%3B%0A%20%20%20%20public%20static%20final%20int%20SUBTYPE_SIG_OFS%20%3D%2016%3B%0A%20%20%20%20public%20static%20final%20int%20SUBTYPE_SIG_LEN%20%3D%2032%3B%0A%20%20%20%20public%20static%20final%20int%20MAGIC_OFS%20%3D%2048%3B%0A%20%20%20%20public%20static%20final%20int%20MAGIC_LEN%20%3D%204%3B%0A%20%20%20%20public%20static%20final%20int%20INDEX_COMPSIZE_OFS%20%3D%2052%3B%0A%20%20%20%20public%20static%20final%20int%20FILE_COUNT_OFS%20%3D%2060%3B%0A%20%20%20%20public%20static%20final%20int%20DATA_BASEOFFSET_OFS%20%3D%2064%3B%0A%20%20%20%20public%20static%20final%20int%20INDEX_BASEOFFSET_OFS%20%3D%2068%3B%0A%20%20%20%20%0A%20%20%20%20public%20static%20final%20byte%5B%5D%20dataPackSig%20%3D%20%7B%0A%20%20%20%20%20%20%20%20(byte)'D'%2C%20(byte)'a'%2C%20(byte)'t'%2C%20(byte)'a'%2C%20(byte)'P'%2C%20(byte)'a'%2C%20(byte)'c'%2C%20(byte)'k'%2C%0A%20%20%20%20%20%20%20%20(byte)'5'%2C%20(byte)0%2C%20(byte)0%2C%20(byte)0%2C%20(byte)0%2C%20(byte)0%2C%20(byte)0%2C%20(byte)0%0A%20%20%20%20%7D%3B%0A%20%20%20%20%0A%20%20%20%20public%20static%20final%20byte%5B%5D%20momoSig%20%3D%20%7B%0A%20%20%20%20%20%20%20%20(byte)'M'%2C%20(byte)'O'%2C%20(byte)'M'%2C%20(byte)'O'%2C%20(byte)0%2C%20(byte)0%2C%20(byte)0%2C%20(byte)0%2C%0A%20%20%20%20%20%20%20%20(byte)0%2C%20(byte)0%2C%20(byte)0%2C%20(byte)0%2C%20(byte)0%2C%20(byte)0%2C%20(byte)0%2C%20(byte)0%2C%0A%20%20%20%20%20%20%20%20(byte)0%2C%20(byte)0%2C%20(byte)0%2C%20(byte)0%2C%20(byte)0%2C%20(byte)0%2C%20(byte)0%2C%20(byte)0%2C%0A%20%20%20%20%20%20%20%20(byte)0%2C%20(byte)0%2C%20(byte)0%2C%20(byte)0%2C%20(byte)0%2C%20(byte)0%2C%20(byte)0%2C%20(byte)0%0A%20%20%20%20%7D%3B%0A%20%20%20%20%0A%20%20%20%20public%20static%20final%20byte%5B%5D%20magic%20%3D%20%7B%0A%20%20%20%20%20%20%20%20(byte)1%2C%20(byte)0%2C%20(byte)5%2C%20(byte)0%0A%20%20%20%20%7D%3B%0A%20%20%20%20%0A%20%20%20%20private%20int%20indexCompSize%3B%0A%20%20%20%20private%20int%20fileCount%3B%0A%20%20%20%20private%20long%20dataBaseOffset%3B%0A%20%20%20%20private%20long%20indexBaseOffset%3B%0A%20%20%20%20%0A%20%20%20%20public%20int%20getIndexCompSize()%20%7B%0A%20%20%20%20%20%20%20%20return%20indexCompSize%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20public%20void%20setIndexCompSize(int%20size)%20%7B%0A%20%20%20%20%20%20%20%20this.indexCompSize%20%3D%20size%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20public%20int%20getFileCount()%20%7B%0A%20%20%20%20%20%20%20%20return%20fileCount%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20public%20void%20setFileCount(int%20count)%20%7B%0A%20%20%20%20%20%20%20%20this.fileCount%20%3D%20count%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20public%20long%20getDataBaseOffset()%20%7B%0A%20%20%20%20%20%20%20%20return%20dataBaseOffset%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20public%20void%20setDataBaseOffset(long%20offset)%20%7B%0A%20%20%20%20%20%20%20%20this.dataBaseOffset%20%3D%20offset%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20public%20long%20getIndexBaseOffset()%20%7B%0A%20%20%20%20%20%20%20%20return%20indexBaseOffset%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20public%20void%20setIndexBaseOffset(long%20offset)%20%7B%0A%20%20%20%20%20%20%20%20this.indexBaseOffset%20%3D%20offset%3B%0A%20%20%20%20%7D%0A%7D" quality="high" allowscriptaccess="always" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer">&nbsp;<a href="javascript:void()" title="收藏这段代码" onclick="code_favorites_do_favorite(this);return false;" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="star" src="assets/1571225657-bf632ec55a05f69a9359f73417402b26.png" alt="收藏代码"><img class="spinner" src="assets/1571225657-a42df3a5b569bdc98ca473a4a3adfeac.gif" style="display:none"></a></div></div><ol start="1" class="dp-j"><li><span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">class</span><span>&nbsp;Header&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;BUFFER_SIZE&nbsp;=&nbsp;</span><span class="number">4096</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;ARCHIVE_SIG_OFS&nbsp;=&nbsp;</span><span class="number">0</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;ARCHIVE_SIG_LEN&nbsp;=&nbsp;</span><span class="number">16</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;SUBTYPE_SIG_OFS&nbsp;=&nbsp;</span><span class="number">16</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;SUBTYPE_SIG_LEN&nbsp;=&nbsp;</span><span class="number">32</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;MAGIC_OFS&nbsp;=&nbsp;</span><span class="number">48</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;MAGIC_LEN&nbsp;=&nbsp;</span><span class="number">4</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;INDEX_COMPSIZE_OFS&nbsp;=&nbsp;</span><span class="number">52</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;FILE_COUNT_OFS&nbsp;=&nbsp;</span><span class="number">60</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;DATA_BASEOFFSET_OFS&nbsp;=&nbsp;</span><span class="number">64</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;INDEX_BASEOFFSET_OFS&nbsp;=&nbsp;</span><span class="number">68</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">byte</span><span>[]&nbsp;dataPackSig&nbsp;=&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="keyword">byte</span><span>)</span><span class="string">'D'</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="string">'a'</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="string">'t'</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="string">'a'</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="string">'P'</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="string">'a'</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="string">'c'</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="string">'k'</span><span>,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="keyword">byte</span><span>)</span><span class="string">'5'</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;};&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">byte</span><span>[]&nbsp;momoSig&nbsp;=&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="keyword">byte</span><span>)</span><span class="string">'M'</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="string">'O'</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="string">'M'</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="string">'O'</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;};&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">byte</span><span>[]&nbsp;magic&nbsp;=&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="keyword">byte</span><span>)</span><span class="number">1</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">5</span><span>,&nbsp;(</span><span class="keyword">byte</span><span>)</span><span class="number">0</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;};&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;indexCompSize;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;fileCount;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">long</span><span>&nbsp;dataBaseOffset;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">long</span><span>&nbsp;indexBaseOffset;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;getIndexCompSize()&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;indexCompSize;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;setIndexCompSize(</span><span class="keyword">int</span><span>&nbsp;size)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">this</span><span>.indexCompSize&nbsp;=&nbsp;size;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;getFileCount()&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;fileCount;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;setFileCount(</span><span class="keyword">int</span><span>&nbsp;count)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">this</span><span>.fileCount&nbsp;=&nbsp;count;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">long</span><span>&nbsp;getDataBaseOffset()&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;dataBaseOffset;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;setDataBaseOffset(</span><span class="keyword">long</span><span>&nbsp;offset)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">this</span><span>.dataBaseOffset&nbsp;=&nbsp;offset;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">long</span><span>&nbsp;getIndexBaseOffset()&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;indexBaseOffset;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;setIndexBaseOffset(</span><span class="keyword">long</span><span>&nbsp;offset)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">this</span><span>.indexBaseOffset&nbsp;=&nbsp;offset;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>}&nbsp;&nbsp;</span></li></ol></div>
<br>
<br>IndexEntry.java:
<br><div class="dp-highlighter" id=""><div class="bar"><div class="tools">Java代码 <embed wmode="transparent" src="/javascripts/syntaxhighlighter/clipboard_new.swf" width="14" height="15" flashvars="clipboard=public%20class%20IndexEntry%20%7B%0A%20%20%20%20%0A%20%20%20%20public%20static%20final%20int%20LENGTH_IN_FILE%20%3D%20104%3B%0A%20%20%20%20%0A%20%20%20%20public%20static%20final%20int%20FILENAME_OFS%20%3D%200%3B%0A%20%20%20%20public%20static%20final%20int%20FILENAME_LEN%20%3D%2064%3B%0A%20%20%20%20public%20static%20final%20int%20OFFSET_OFS%20%3D%2064%3B%0A%20%20%20%20public%20static%20final%20int%20SIZE_OFS%20%3D%2068%3B%0A%20%20%20%20%0A%20%20%20%20private%20String%20filename%3B%0A%20%20%20%20private%20int%20offset%3B%20%2F%2F%20actual%20offset%20%3D%20base%20%2B%20offset%0A%20%20%20%20private%20int%20size%3B%0A%20%20%20%20%0A%20%20%20%20public%20String%20getFilename()%20%7B%0A%20%20%20%20%20%20%20%20return%20filename%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20public%20void%20setFilename(String%20name)%20%7B%0A%20%20%20%20%20%20%20%20this.filename%20%3D%20name%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20public%20int%20getOffset()%20%7B%0A%20%20%20%20%20%20%20%20return%20offset%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20public%20void%20setOffset(int%20offset)%20%7B%0A%20%20%20%20%20%20%20%20this.offset%20%3D%20offset%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20public%20int%20getSize()%20%7B%0A%20%20%20%20%20%20%20%20return%20size%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20public%20void%20setSize(int%20size)%20%7B%0A%20%20%20%20%20%20%20%20this.size%20%3D%20size%3B%0A%20%20%20%20%7D%0A%7D" quality="high" allowscriptaccess="always" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer">&nbsp;<a href="javascript:void()" title="收藏这段代码" onclick="code_favorites_do_favorite(this);return false;" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="star" src="assets/1571225657-bf632ec55a05f69a9359f73417402b26.png" alt="收藏代码"><img class="spinner" src="assets/1571225657-a42df3a5b569bdc98ca473a4a3adfeac.gif" style="display:none"></a></div></div><ol start="1" class="dp-j"><li><span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">class</span><span>&nbsp;IndexEntry&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;LENGTH_IN_FILE&nbsp;=&nbsp;</span><span class="number">104</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;FILENAME_OFS&nbsp;=&nbsp;</span><span class="number">0</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;FILENAME_LEN&nbsp;=&nbsp;</span><span class="number">64</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;OFFSET_OFS&nbsp;=&nbsp;</span><span class="number">64</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;SIZE_OFS&nbsp;=&nbsp;</span><span class="number">68</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;String&nbsp;filename;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;offset;&nbsp;</span><span class="comment">//&nbsp;actual&nbsp;offset&nbsp;=&nbsp;base&nbsp;+&nbsp;offset</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">private</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;size;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;String&nbsp;getFilename()&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;filename;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;setFilename(String&nbsp;name)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">this</span><span>.filename&nbsp;=&nbsp;name;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;getOffset()&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;offset;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;setOffset(</span><span class="keyword">int</span><span>&nbsp;offset)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">this</span><span>.offset&nbsp;=&nbsp;offset;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;getSize()&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;size;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;setSize(</span><span class="keyword">int</span><span>&nbsp;size)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">this</span><span>.size&nbsp;=&nbsp;size;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>}&nbsp;&nbsp;</span></li></ol></div>
<br>
<br>BinConverter.java:
<br><div class="dp-highlighter" id=""><div class="bar"><div class="tools">Java代码 <embed wmode="transparent" src="/javascripts/syntaxhighlighter/clipboard_new.swf" width="14" height="15" flashvars="clipboard=%2F**%0A%20*%20Some%20helper%20routines%20for%20data%20conversion%2C%20data%20is%20treated%20in%20network%0A%20*%20byte%20order%20except%20the%20ones%20with%20LE%20postfix.%0A%20*%2F%0Apublic%20class%20BinConverter%0A%7B%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Gets%20bytes%20from%20an%20array%20into%20an%20integer.%0A%20%20%20%20%20*%20%40param%20buf%20where%20to%20get%20the%20bytes%0A%20%20%20%20%20*%20%40param%20ofs%20index%20from%20where%20to%20read%20the%20data%0A%20%20%20%20%20*%20%40return%20the%2032bit%20integer%0A%20%20%20%20%20*%2F%0A%20%20%20%20public%20final%20static%20int%20byteArrayToInt(%0A%20%20%20%20%20%20%20%20byte%5B%5D%20buf%2C%0A%20%20%20%20%20%20%20%20int%20ofs)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%20(buf%5Bofs%20%20%20%20%5D%20%20%20%20%20%20%20%20%20%20%3C%3C%2024)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7C%20((buf%5Bofs%20%2B%201%5D%20%26%200x0ff)%20%3C%3C%2016)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7C%20((buf%5Bofs%20%2B%202%5D%20%26%200x0ff)%20%3C%3C%20%208%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7C%20(%20buf%5Bofs%20%2B%203%5D%20%26%200x0ff)%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20%2F%2F%20Little%20Endian%0A%20%20%20%20public%20final%20static%20int%20byteArrayToIntLE(%0A%20%20%20%20%20%20%20%20byte%5B%5D%20buf%2C%0A%20%20%20%20%20%20%20%20int%20ofs)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%20(buf%5Bofs%20%2B%203%5D%20%20%20%20%20%20%20%20%20%20%3C%3C%2024)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7C%20((buf%5Bofs%20%2B%202%5D%20%26%200x0ff)%20%3C%3C%2016)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7C%20((buf%5Bofs%20%2B%201%5D%20%26%200x0ff)%20%3C%3C%20%208%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20%7C%20(%20buf%5Bofs%20%20%20%20%5D%20%26%200x0ff)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Converts%20an%20integer%20to%20bytes%2C%20which%20are%20put%20into%20an%20array.%0A%20%20%20%20%20*%20%40param%20value%20the%2032bit%20integer%20to%20convert%0A%20%20%20%20%20*%20%40param%20buf%20the%20target%20buf%0A%20%20%20%20%20*%20%40param%20ofs%20where%20to%20place%20the%20bytes%20in%20the%20buf%0A%20%20%20%20%20*%2F%0A%20%20%20%20public%20final%20static%20void%20intToByteArray(%0A%20%20%20%20%20%20%20%20int%20value%2C%0A%20%20%20%20%20%20%20%20byte%5B%5D%20buf%2C%0A%20%20%20%20%20%20%20%20int%20ofs)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20buf%5Bofs%20%20%20%20%5D%20%3D%20(byte)((value%20%3E%3E%3E%2024)%20%26%200x0ff)%3B%0A%20%20%20%20%20%20%20%20buf%5Bofs%20%2B%201%5D%20%3D%20(byte)((value%20%3E%3E%3E%2016)%20%26%200x0ff)%3B%0A%20%20%20%20%20%20%20%20buf%5Bofs%20%2B%202%5D%20%3D%20(byte)((value%20%3E%3E%3E%20%208%20)%20%26%200x0ff)%3B%0A%20%20%20%20%20%20%20%20buf%5Bofs%20%2B%203%5D%20%3D%20(byte)%20%20value%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20%2F%2F%20Little%20endian%0A%20%20%20%20public%20final%20static%20void%20intToByteArrayLE(%0A%20%20%20%20%20%20%20%20int%20value%2C%0A%20%20%20%20%20%20%20%20byte%5B%5D%20buf%2C%0A%20%20%20%20%20%20%20%20int%20ofs)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20buf%5Bofs%20%2B%203%5D%20%3D%20(byte)((value%20%3E%3E%3E%2024)%20%26%200x0ff)%3B%0A%20%20%20%20%20%20%20%20buf%5Bofs%20%2B%202%5D%20%3D%20(byte)((value%20%3E%3E%3E%2016)%20%26%200x0ff)%3B%0A%20%20%20%20%20%20%20%20buf%5Bofs%20%2B%201%5D%20%3D%20(byte)((value%20%3E%3E%3E%20%208%20)%20%26%200x0ff)%3B%0A%20%20%20%20%20%20%20%20buf%5Bofs%20%20%20%20%5D%20%3D%20(byte)%20%20value%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20public%20final%20static%20void%20shortToByteArrayLE(%0A%20%20%20%20%20%20%20%20int%20value%2C%0A%20%20%20%20%20%20%20%20byte%5B%5D%20buf%2C%0A%20%20%20%20%20%20%20%20int%20ofs)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20buf%5Bofs%20%2B%201%5D%20%3D%20(byte)((value%20%3E%3E%3E%20%208%20)%20%26%200x0ff)%3B%0A%20%20%20%20%20%20%20%20buf%5Bofs%20%20%20%20%5D%20%3D%20(byte)%20%20value%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Gets%20bytes%20from%20an%20array%20into%20a%20long.%0A%20%20%20%20%20*%20%40param%20buf%20where%20to%20get%20the%20bytes%0A%20%20%20%20%20*%20%40param%20ofs%20index%20from%20where%20to%20read%20the%20data%0A%20%20%20%20%20*%20%40return%20the%2064bit%20integer%0A%20%20%20%20%20*%2F%0A%20%20%20%20public%20final%20static%20long%20byteArrayToLong(%0A%20%20%20%20%20%20%20%20byte%5B%5D%20buf%2C%0A%20%20%20%20%20%20%20%20int%20ofs)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%2F%2F%20Looks%20more%20complex%20-%20but%20it%20is%20faster%20(at%20least%20on%2032bit%20platforms).%0A%0A%20%20%20%20%20%20%20%20return%0A%20%20%20%20%20%20%20%20%20%20%20%20((long)((%20buf%5Bofs%20%20%20%20%5D%20%20%20%20%20%20%20%20%20%20%3C%3C%2024)%20%7C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20((buf%5Bofs%20%2B%201%5D%20%26%200x0ff)%20%3C%3C%2016)%20%7C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20((buf%5Bofs%20%2B%202%5D%20%26%200x0ff)%20%3C%3C%20%208%20)%20%7C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(%20buf%5Bofs%20%2B%203%5D%20%26%200x0ff%20%20%20%20%20%20%20))%20%3C%3C%2032)%20%7C%0A%20%20%20%20%20%20%20%20%20%20%20%20((long)((%20buf%5Bofs%20%2B%204%5D%20%20%20%20%20%20%20%20%20%20%3C%3C%2024)%20%7C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20((buf%5Bofs%20%2B%205%5D%20%26%200x0ff)%20%3C%3C%2016)%20%7C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20((buf%5Bofs%20%2B%206%5D%20%26%200x0ff)%20%3C%3C%20%208%20)%20%7C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(%20buf%5Bofs%20%2B%207%5D%20%26%200x0ff%20%20%20%20%20%20%20))%20%26%200x0ffffffffL)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Converts%20a%20long%20to%20bytes%2C%20which%20are%20put%20into%20an%20array.%0A%20%20%20%20%20*%20%40param%20value%20the%2064bit%20integer%20to%20convert%0A%20%20%20%20%20*%20%40param%20buf%20the%20target%20buf%0A%20%20%20%20%20*%20%40param%20ofs%20where%20to%20place%20the%20bytes%20in%20the%20buf%0A%20%20%20%20%20*%2F%0A%20%20%20%20public%20final%20static%20void%20longToByteArray(%0A%20%20%20%20%20%20%20%20long%20value%2C%0A%20%20%20%20%20%20%20%20byte%5B%5D%20buf%2C%0A%20%20%20%20%20%20%20%20int%20ofs)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20int%20tmp%20%3D%20(int)(value%20%3E%3E%3E%2032)%3B%0A%0A%20%20%20%20%20%20%20%20buf%5Bofs%20%20%20%20%5D%20%3D%20(byte)%20(tmp%20%3E%3E%3E%2024)%3B%0A%20%20%20%20%20%20%20%20buf%5Bofs%20%2B%201%5D%20%3D%20(byte)((tmp%20%3E%3E%3E%2016)%20%26%200x0ff)%3B%0A%20%20%20%20%20%20%20%20buf%5Bofs%20%2B%202%5D%20%3D%20(byte)((tmp%20%3E%3E%3E%20%208%20)%20%26%200x0ff)%3B%0A%20%20%20%20%20%20%20%20buf%5Bofs%20%2B%203%5D%20%3D%20(byte)%20%20tmp%3B%0A%0A%20%20%20%20%20%20%20%20tmp%20%3D%20(int)value%3B%0A%0A%20%20%20%20%20%20%20%20buf%5Bofs%20%2B%204%5D%20%3D%20(byte)%20(tmp%20%3E%3E%3E%2024)%3B%0A%20%20%20%20%20%20%20%20buf%5Bofs%20%2B%205%5D%20%3D%20(byte)((tmp%20%3E%3E%3E%2016)%20%26%200x0ff)%3B%0A%20%20%20%20%20%20%20%20buf%5Bofs%20%2B%206%5D%20%3D%20(byte)((tmp%20%3E%3E%3E%20%208%20)%20%26%200x0ff)%3B%0A%20%20%20%20%20%20%20%20buf%5Bofs%20%2B%207%5D%20%3D%20(byte)%20%20tmp%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Converts%20values%20from%20an%20integer%20array%20to%20a%20long.%0A%20%20%20%20%20*%20%40param%20buf%20where%20to%20get%20the%20bytes%0A%20%20%20%20%20*%20%40param%20ofs%20index%20from%20where%20to%20read%20the%20data%0A%20%20%20%20%20*%20%40return%20the%2064bit%20integer%0A%20%20%20%20%20*%2F%0A%20%20%20%20public%20final%20static%20long%20intArrayToLong(%0A%20%20%20%20%20%20%20%20int%5B%5D%20buf%2C%0A%20%20%20%20%20%20%20%20int%20ofs)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%20(((long)%20buf%5Bofs%20%20%20%20%5D)%20%3C%3C%2032)%20%7C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(((long)%20buf%5Bofs%20%2B%201%5D)%20%26%200x0ffffffffL)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Converts%20a%20long%20to%20integers%20which%20are%20put%20into%20an%20array.%0A%20%20%20%20%20*%20%40param%20value%20the%2064bit%20integer%20to%20convert%0A%20%20%20%20%20*%20%40param%20buf%20the%20target%20buf%0A%20%20%20%20%20*%20%40param%20ofs%20where%20to%20place%20the%20bytes%20in%20the%20buf%0A%20%20%20%20%20*%2F%0A%20%20%20%20public%20final%20static%20void%20longToIntArray(%0A%20%20%20%20%20%20%20%20long%20value%2C%0A%20%20%20%20%20%20%20%20int%5B%5D%20buf%2C%0A%20%20%20%20%20%20%20%20int%20ofs)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20buf%5Bofs%20%20%20%20%5D%20%3D%20(int)(value%20%3E%3E%3E%2032)%3B%0A%20%20%20%20%20%20%20%20buf%5Bofs%20%2B%201%5D%20%3D%20(int)%20value%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Makes%20a%20long%20from%20two%20integers%20(treated%20unsigned).%0A%20%20%20%20%20*%20%40param%20lo%20lower%2032bits%0A%20%20%20%20%20*%20%40param%20hi%20higher%2032bits%0A%20%20%20%20%20*%20%40return%20the%20built%20long%0A%20%20%20%20%20*%2F%0A%20%20%20%20public%20final%20static%20long%20makeLong(%0A%20%20%20%20%20%20%20%20int%20lo%2C%0A%20%20%20%20%20%20%20%20int%20hi)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%20(((long)%20hi%20%3C%3C%2032)%20%7C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20((long)%20lo%20%26%200x00000000ffffffffL))%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Gets%20the%20lower%2032%20bits%20of%20a%20long.%0A%20%20%20%20%20*%20%40param%20val%20the%20long%20integer%0A%20%20%20%20%20*%20%40return%20lower%2032%20bits%0A%20%20%20%20%20*%2F%0A%20%20%20%20public%20final%20static%20int%20longLo32(%0A%20%20%20%20%20%20%20%20long%20val)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%20(int)val%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Gets%20the%20higher%2032%20bits%20of%20a%20long.%0A%20%20%20%20%20*%20%40param%20val%20the%20long%20integer%0A%20%20%20%20%20*%20%40return%20higher%2032%20bits%0A%20%20%20%20%20*%2F%0A%20%20%20%20public%20final%20static%20int%20longHi32(%0A%20%20%20%20%20%20%20%20long%20val)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%20(int)(val%20%3E%3E%3E%2032)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%0A%0A%20%20%20%20%2F%2F%20our%20table%20for%20hex%20conversion%0A%20%20%20%20final%20static%20char%5B%5D%20HEXTAB%20%3D%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20'0'%2C%20'1'%2C%20'2'%2C%20'3'%2C%20'4'%2C%20'5'%2C%20'6'%2C%20'7'%2C%0A%20%20%20%20%20%20%20%20'8'%2C%20'9'%2C%20'a'%2C%20'b'%2C%20'c'%2C%20'd'%2C%20'e'%2C%20'f'%0A%20%20%20%20%7D%3B%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Converts%20a%20byte%20array%20to%20a%20hex%20string.%0A%20%20%20%20%20*%20%40param%20data%20the%20byte%20array%0A%20%20%20%20%20*%20%40return%20the%20hex%20string%0A%20%20%20%20%20*%2F%0A%20%20%20%20public%20final%20static%20String%20bytesToHexStr(%0A%20%20%20%20%20%20%20%20byte%5B%5D%20data)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20return%20bytesToHexStr(data%2C%200%2C%20data.length)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Converts%20a%20byte%20array%20to%20a%20hex%20string.%0A%20%20%20%20%20*%20%40param%20data%20the%20byte%20array%0A%20%20%20%20%20*%20%40param%20ofs%20start%20index%20where%20to%20get%20the%20bytes%0A%20%20%20%20%20*%20%40param%20len%20number%20of%20bytes%20to%20convert%0A%20%20%20%20%20*%20%40return%20the%20hex%20string%0A%20%20%20%20%20*%2F%0A%20%20%20%20public%20final%20static%20String%20bytesToHexStr(%0A%20%20%20%20%20%20%20%20byte%5B%5D%20data%2C%0A%20%20%20%20%20%20%20%20int%20ofs%2C%0A%20%20%20%20%20%20%20%20int%20len)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20int%20pos%2C%20c%3B%0A%20%20%20%20%20%20%20%20StringBuffer%20sbuf%3B%0A%0A%0A%20%20%20%20%20%20%20%20sbuf%20%3D%20new%20StringBuffer()%3B%0A%20%20%20%20%20%20%20%20sbuf.setLength(len%20%3C%3C%201)%3B%0A%0A%20%20%20%20%20%20%20%20pos%20%3D%200%3B%0A%20%20%20%20%20%20%20%20c%20%3D%20ofs%20%2B%20len%3B%0A%0A%20%20%20%20%20%20%20%20while%20(ofs%20%3C%20c)%0A%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20sbuf.setCharAt(pos%2B%2B%2C%20HEXTAB%5B(data%5Bofs%20%20%5D%20%3E%3E%204)%20%26%200x0f%5D)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20sbuf.setCharAt(pos%2B%2B%2C%20HEXTAB%5B%20data%5Bofs%2B%2B%5D%20%20%20%20%20%20%20%26%200x0f%5D)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%20sbuf.toString()%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Converts%20a%20hex%20string%20back%20into%20a%20byte%20array%20(invalid%20codes%20will%20be%0A%20%20%20%20%20*%20skipped).%0A%20%20%20%20%20*%20%40param%20hex%20hex%20string%0A%20%20%20%20%20*%20%40param%20data%20the%20target%20array%0A%20%20%20%20%20*%20%40param%20srcofs%20from%20which%20character%20in%20the%20string%20the%20conversion%20should%0A%20%20%20%20%20*%20begin%2C%20remember%20that%20(nSrcPos%20modulo%202)%20should%20equals%200%20normally%0A%20%20%20%20%20*%20%40param%20dstofs%20to%20store%20the%20bytes%20from%20which%20position%20in%20the%20array%0A%20%20%20%20%20*%20%40param%20len%20number%20of%20bytes%20to%20extract%0A%20%20%20%20%20*%20%40return%20number%20of%20extracted%20bytes%0A%20%20%20%20%20*%2F%0A%20%20%20%20public%20final%20static%20int%20hexStrToBytes(%0A%20%20%20%20%20%20%20%20String%20hex%2C%0A%20%20%20%20%20%20%20%20byte%5B%5D%20data%2C%0A%20%20%20%20%20%20%20%20int%20srcofs%2C%0A%20%20%20%20%20%20%20%20int%20dstofs%2C%0A%20%20%20%20%20%20%20%20int%20len)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20int%20i%2C%20j%2C%20strlen%2C%20avail_bytes%2C%20dstofs_bak%3B%0A%20%20%20%20%20%20%20%20byte%20abyte%3B%0A%20%20%20%20%20%20%20%20boolean%20convertOK%3B%0A%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20check%20for%20correct%20ranges%0A%20%20%20%20%20%20%20%20strlen%20%3D%20hex.length()%3B%0A%0A%20%20%20%20%20%20%20%20avail_bytes%20%3D%20(strlen%20-%20srcofs)%20%3E%3E%201%3B%0A%20%20%20%20%20%20%20%20if%20(avail_bytes%20%3C%20len)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20len%20%3D%20avail_bytes%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20int%20nOutputCapacity%20%3D%20data.length%20-%20dstofs%3B%0A%20%20%20%20%20%20%20%20if%20(len%20%3E%20nOutputCapacity)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20len%20%3D%20nOutputCapacity%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20convert%20now%0A%0A%20%20%20%20%20%20%20%20dstofs_bak%20%3D%20dstofs%3B%0A%0A%20%20%20%20%20%20%20%20for%20(i%20%3D%200%3B%20i%20%3C%20len%3B%20i%2B%2B)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20abyte%20%3D%200%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20convertOK%20%3D%20true%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20for%20(j%20%3D%200%3B%20j%20%3C%202%3B%20%2B%2Bj)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20abyte%20%3C%3C%3D%204%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20char%20cActChar%20%3D%20hex.charAt(srcofs%2B%2B)%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20((cActChar%20%3E%3D%20'a')%20%26%26%20(cActChar%20%3C%3D%20'f'))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20abyte%20%7C%3D%20(byte)%20(cActChar%20-%20'a')%20%2B%2010%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20((cActChar%20%3E%3D%20'0')%20%26%26%20(cActChar%20%3C%3D%20'9'))%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20abyte%20%7C%3D%20(byte)%20(cActChar%20-%20'0')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20convertOK%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(convertOK)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20data%5Bdstofs%2B%2B%5D%20%3D%20abyte%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20return%20(dstofs%20-%20dstofs_bak)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%0A%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Converts%20a%20byte%20array%20into%20a%20Unicode%20string.%0A%20%20%20%20%20*%20%40param%20data%20the%20byte%20array%0A%20%20%20%20%20*%20%40param%20ofs%20where%20to%20begin%20the%20conversion%0A%20%20%20%20%20*%20%40param%20len%20number%20of%20bytes%20to%20handle%0A%20%20%20%20%20*%20%40return%20the%20string%0A%20%20%20%20%20*%2F%0A%20%20%20%20public%20final%20static%20String%20byteArrayToStr(%0A%20%20%20%20%20%20%20%20byte%5B%5D%20data%2C%0A%20%20%20%20%20%20%20%20int%20ofs%2C%0A%20%20%20%20%20%20%20%20int%20len)%0A%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20int%20avail_capacity%2C%20sbuf_pos%3B%0A%20%20%20%20%20%20%20%20StringBuffer%20sbuf%3B%0A%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20we%20need%20two%20bytes%20for%20every%20character%0A%20%20%20%20%20%20%20%20len%20%26%3D%20~1%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20enough%20bytes%20in%20the%20buf%3F%0A%20%20%20%20%20%20%20%20avail_capacity%20%3D%20data.length%20-%20ofs%3B%0A%0A%20%20%20%20%20%20%20%20if%20(avail_capacity%20%3C%20len)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20len%20%3D%20avail_capacity%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20sbuf%20%3D%20new%20StringBuffer()%3B%0A%20%20%20%20%20%20%20%20sbuf.setLength(len%20%3E%3E%201)%3B%0A%0A%20%20%20%20%20%20%20%20sbuf_pos%20%3D%200%3B%0A%0A%20%20%20%20%20%20%20%20while%20(0%20%3C%20len)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20sbuf.setCharAt(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sbuf_pos%2B%2B%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20(char)((data%5Bofs%20%20%20%20%5D%20%3C%3C%208%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7C%20%20(data%5Bofs%20%2B%201%5D%20%26%200x0ff)))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20ofs%20%2B%3D%202%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20len%20-%3D%202%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20return%20sbuf.toString()%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%2F%0A%20%20%20%20%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Reverses%20between%20endians%20for%20integers%0A%20%20%20%20%20*%20%40param%20i%20the%20integer%20to%20convert%20endian%0A%20%20%20%20%20*%20%40return%20integer%20of%20reversed%20endian%0A%20%20%20%20%20*%2F%0A%20%20%20%20public%20final%20static%20int%20reverseEndian(int%20i)%20%7B%0A%20%20%20%20%20%20%20%20byte%5B%5D%20temp%20%3D%20new%20byte%5B4%5D%3B%0A%20%20%20%20%20%20%20%20temp%5B0%5D%20%3D%20(byte)(i%20%3E%3E%2024)%3B%0A%20%20%20%20%20%20%20%20temp%5B1%5D%20%3D%20(byte)(i%20%3E%3E%2016)%3B%0A%20%20%20%20%20%20%20%20temp%5B2%5D%20%3D%20(byte)(i%20%3E%3E%208%20)%3B%0A%20%20%20%20%20%20%20%20temp%5B3%5D%20%3D%20(byte)i%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20return%20(temp%5B3%5D%20%3C%3C%2024)%20%26%200xFF000000%0A%20%20%20%20%20%20%20%20%20%20%20%20%7C%20%20(temp%5B2%5D%20%3C%3C%2016)%20%26%200x00FF0000%0A%20%20%20%20%20%20%20%20%20%20%20%20%7C%20%20(temp%5B1%5D%20%3C%3C%208%20)%20%26%200x0000FF00%0A%20%20%20%20%20%20%20%20%20%20%20%20%7C%20%20%20temp%5B0%5D%20%20%20%20%20%20%20%20%26%200x000000FF%3B%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20%2F**%0A%20%20%20%20%20*%20Reverses%20between%20endians%20for%20integers%0A%20%20%20%20%20*%20%40param%20i%20the%20integer%20to%20convert%20endian%0A%20%20%20%20%20*%20%40return%20integer%20of%20reversed%20endian%0A%20%20%20%20%20*%2F%0A%20%20%20%20public%20final%20static%20short%20reverseEndianShort(short%20s)%20%7B%0A%20%20%20%20%20%20%20%20byte%5B%5D%20temp%20%3D%20new%20byte%5B2%5D%3B%0A%20%20%20%20%20%20%20%20temp%5B0%5D%20%3D%20(byte)(s%20%3E%3E%208%20)%3B%0A%20%20%20%20%20%20%20%20temp%5B1%5D%20%3D%20(byte)s%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20return%20(short)((temp%5B1%5D%20%3C%3C%208%20)%20%26%200x0FF00%0A%20%20%20%20%20%20%20%20%20%20%20%20%7C%20%20%20%20%20%20%20%20%20%20%20temp%5B0%5D%20%20%20%20%20%20%20%20%26%200x000FF)%3B%0A%20%20%20%20%7D%0A%7D" quality="high" allowscriptaccess="always" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer">&nbsp;<a href="javascript:void()" title="收藏这段代码" onclick="code_favorites_do_favorite(this);return false;" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="star" src="assets/1571225657-bf632ec55a05f69a9359f73417402b26.png" alt="收藏代码"><img class="spinner" src="assets/1571225657-a42df3a5b569bdc98ca473a4a3adfeac.gif" style="display:none"></a></div></div><ol start="1" class="dp-j"><li><span><span class="comment">/**</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;*&nbsp;Some&nbsp;helper&nbsp;routines&nbsp;for&nbsp;data&nbsp;conversion,&nbsp;data&nbsp;is&nbsp;treated&nbsp;in&nbsp;network</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;*&nbsp;byte&nbsp;order&nbsp;except&nbsp;the&nbsp;ones&nbsp;with&nbsp;LE&nbsp;postfix.</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li><span><span class="keyword">public</span><span>&nbsp;</span><span class="keyword">class</span><span>&nbsp;BinConverter&nbsp;&nbsp;</span></span></li><li><span>{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Gets&nbsp;bytes&nbsp;from&nbsp;an&nbsp;array&nbsp;into&nbsp;an&nbsp;integer.</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;buf&nbsp;where&nbsp;to&nbsp;get&nbsp;the&nbsp;bytes</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;ofs&nbsp;index&nbsp;from&nbsp;where&nbsp;to&nbsp;read&nbsp;the&nbsp;data</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;32bit&nbsp;integer</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;byteArrayToInt(&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>[]&nbsp;buf,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;ofs)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;(buf[ofs&nbsp;&nbsp;&nbsp;&nbsp;]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;&nbsp;</span><span class="number">24</span><span>)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;((buf[ofs&nbsp;+&nbsp;<span class="number">1</span><span>]&nbsp;&amp;&nbsp;</span><span class="number">0x0ff</span><span>)&nbsp;&lt;&lt;&nbsp;</span><span class="number">16</span><span>)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;((buf[ofs&nbsp;+&nbsp;<span class="number">2</span><span>]&nbsp;&amp;&nbsp;</span><span class="number">0x0ff</span><span>)&nbsp;&lt;&lt;&nbsp;&nbsp;</span><span class="number">8</span><span>&nbsp;)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;(&nbsp;buf[ofs&nbsp;+&nbsp;<span class="number">3</span><span>]&nbsp;&amp;&nbsp;</span><span class="number">0x0ff</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;Little&nbsp;Endian</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;byteArrayToIntLE(&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>[]&nbsp;buf,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;ofs)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;(buf[ofs&nbsp;+&nbsp;</span><span class="number">3</span><span>]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;&nbsp;</span><span class="number">24</span><span>)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;((buf[ofs&nbsp;+&nbsp;<span class="number">2</span><span>]&nbsp;&amp;&nbsp;</span><span class="number">0x0ff</span><span>)&nbsp;&lt;&lt;&nbsp;</span><span class="number">16</span><span>)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;((buf[ofs&nbsp;+&nbsp;<span class="number">1</span><span>]&nbsp;&amp;&nbsp;</span><span class="number">0x0ff</span><span>)&nbsp;&lt;&lt;&nbsp;&nbsp;</span><span class="number">8</span><span>&nbsp;)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;(&nbsp;buf[ofs&nbsp;&nbsp;&nbsp;&nbsp;]&nbsp;&amp;&nbsp;<span class="number">0x0ff</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">///////////////////////////////////////////////////////////////////////////</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Converts&nbsp;an&nbsp;integer&nbsp;to&nbsp;bytes,&nbsp;which&nbsp;are&nbsp;put&nbsp;into&nbsp;an&nbsp;array.</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;value&nbsp;the&nbsp;32bit&nbsp;integer&nbsp;to&nbsp;convert</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;buf&nbsp;the&nbsp;target&nbsp;buf</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;ofs&nbsp;where&nbsp;to&nbsp;place&nbsp;the&nbsp;bytes&nbsp;in&nbsp;the&nbsp;buf</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;intToByteArray(&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;value,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>[]&nbsp;buf,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;ofs)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf[ofs&nbsp;&nbsp;&nbsp;&nbsp;]&nbsp;=&nbsp;(<span class="keyword">byte</span><span>)((value&nbsp;&gt;&gt;&gt;&nbsp;</span><span class="number">24</span><span>)&nbsp;&amp;&nbsp;</span><span class="number">0x0ff</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf[ofs&nbsp;+&nbsp;<span class="number">1</span><span>]&nbsp;=&nbsp;(</span><span class="keyword">byte</span><span>)((value&nbsp;&gt;&gt;&gt;&nbsp;</span><span class="number">16</span><span>)&nbsp;&amp;&nbsp;</span><span class="number">0x0ff</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf[ofs&nbsp;+&nbsp;<span class="number">2</span><span>]&nbsp;=&nbsp;(</span><span class="keyword">byte</span><span>)((value&nbsp;&gt;&gt;&gt;&nbsp;&nbsp;</span><span class="number">8</span><span>&nbsp;)&nbsp;&amp;&nbsp;</span><span class="number">0x0ff</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf[ofs&nbsp;+&nbsp;<span class="number">3</span><span>]&nbsp;=&nbsp;(</span><span class="keyword">byte</span><span>)&nbsp;&nbsp;value;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;Little&nbsp;endian</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;intToByteArrayLE(&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;value,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>[]&nbsp;buf,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;ofs)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf[ofs&nbsp;+&nbsp;<span class="number">3</span><span>]&nbsp;=&nbsp;(</span><span class="keyword">byte</span><span>)((value&nbsp;&gt;&gt;&gt;&nbsp;</span><span class="number">24</span><span>)&nbsp;&amp;&nbsp;</span><span class="number">0x0ff</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf[ofs&nbsp;+&nbsp;<span class="number">2</span><span>]&nbsp;=&nbsp;(</span><span class="keyword">byte</span><span>)((value&nbsp;&gt;&gt;&gt;&nbsp;</span><span class="number">16</span><span>)&nbsp;&amp;&nbsp;</span><span class="number">0x0ff</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf[ofs&nbsp;+&nbsp;<span class="number">1</span><span>]&nbsp;=&nbsp;(</span><span class="keyword">byte</span><span>)((value&nbsp;&gt;&gt;&gt;&nbsp;&nbsp;</span><span class="number">8</span><span>&nbsp;)&nbsp;&amp;&nbsp;</span><span class="number">0x0ff</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf[ofs&nbsp;&nbsp;&nbsp;&nbsp;]&nbsp;=&nbsp;(<span class="keyword">byte</span><span>)&nbsp;&nbsp;value;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;shortToByteArrayLE(&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;value,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>[]&nbsp;buf,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;ofs)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf[ofs&nbsp;+&nbsp;<span class="number">1</span><span>]&nbsp;=&nbsp;(</span><span class="keyword">byte</span><span>)((value&nbsp;&gt;&gt;&gt;&nbsp;&nbsp;</span><span class="number">8</span><span>&nbsp;)&nbsp;&amp;&nbsp;</span><span class="number">0x0ff</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf[ofs&nbsp;&nbsp;&nbsp;&nbsp;]&nbsp;=&nbsp;(<span class="keyword">byte</span><span>)&nbsp;&nbsp;value;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">///////////////////////////////////////////////////////////////////////////</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Gets&nbsp;bytes&nbsp;from&nbsp;an&nbsp;array&nbsp;into&nbsp;a&nbsp;long.</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;buf&nbsp;where&nbsp;to&nbsp;get&nbsp;the&nbsp;bytes</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;ofs&nbsp;index&nbsp;from&nbsp;where&nbsp;to&nbsp;read&nbsp;the&nbsp;data</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;64bit&nbsp;integer</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">long</span><span>&nbsp;byteArrayToLong(&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>[]&nbsp;buf,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;ofs)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;Looks&nbsp;more&nbsp;complex&nbsp;-&nbsp;but&nbsp;it&nbsp;is&nbsp;faster&nbsp;(at&nbsp;least&nbsp;on&nbsp;32bit&nbsp;platforms).</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="keyword">long</span><span>)((&nbsp;buf[ofs&nbsp;&nbsp;&nbsp;&nbsp;]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;&nbsp;</span><span class="number">24</span><span>)&nbsp;|&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((buf[ofs&nbsp;+&nbsp;<span class="number">1</span><span>]&nbsp;&amp;&nbsp;</span><span class="number">0x0ff</span><span>)&nbsp;&lt;&lt;&nbsp;</span><span class="number">16</span><span>)&nbsp;|&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((buf[ofs&nbsp;+&nbsp;<span class="number">2</span><span>]&nbsp;&amp;&nbsp;</span><span class="number">0x0ff</span><span>)&nbsp;&lt;&lt;&nbsp;&nbsp;</span><span class="number">8</span><span>&nbsp;)&nbsp;|&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;buf[ofs&nbsp;+&nbsp;<span class="number">3</span><span>]&nbsp;&amp;&nbsp;</span><span class="number">0x0ff</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;))&nbsp;&lt;&lt;&nbsp;</span><span class="number">32</span><span>)&nbsp;|&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="keyword">long</span><span>)((&nbsp;buf[ofs&nbsp;+&nbsp;</span><span class="number">4</span><span>]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;&nbsp;</span><span class="number">24</span><span>)&nbsp;|&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((buf[ofs&nbsp;+&nbsp;<span class="number">5</span><span>]&nbsp;&amp;&nbsp;</span><span class="number">0x0ff</span><span>)&nbsp;&lt;&lt;&nbsp;</span><span class="number">16</span><span>)&nbsp;|&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((buf[ofs&nbsp;+&nbsp;<span class="number">6</span><span>]&nbsp;&amp;&nbsp;</span><span class="number">0x0ff</span><span>)&nbsp;&lt;&lt;&nbsp;&nbsp;</span><span class="number">8</span><span>&nbsp;)&nbsp;|&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;buf[ofs&nbsp;+&nbsp;<span class="number">7</span><span>]&nbsp;&amp;&nbsp;</span><span class="number">0x0ff</span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;))&nbsp;&amp;&nbsp;0x0ffffffffL);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">///////////////////////////////////////////////////////////////////////////</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Converts&nbsp;a&nbsp;long&nbsp;to&nbsp;bytes,&nbsp;which&nbsp;are&nbsp;put&nbsp;into&nbsp;an&nbsp;array.</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;value&nbsp;the&nbsp;64bit&nbsp;integer&nbsp;to&nbsp;convert</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;buf&nbsp;the&nbsp;target&nbsp;buf</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;ofs&nbsp;where&nbsp;to&nbsp;place&nbsp;the&nbsp;bytes&nbsp;in&nbsp;the&nbsp;buf</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;longToByteArray(&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">long</span><span>&nbsp;value,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>[]&nbsp;buf,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;ofs)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;tmp&nbsp;=&nbsp;(</span><span class="keyword">int</span><span>)(value&nbsp;&gt;&gt;&gt;&nbsp;</span><span class="number">32</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf[ofs&nbsp;&nbsp;&nbsp;&nbsp;]&nbsp;=&nbsp;(<span class="keyword">byte</span><span>)&nbsp;(tmp&nbsp;&gt;&gt;&gt;&nbsp;</span><span class="number">24</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf[ofs&nbsp;+&nbsp;<span class="number">1</span><span>]&nbsp;=&nbsp;(</span><span class="keyword">byte</span><span>)((tmp&nbsp;&gt;&gt;&gt;&nbsp;</span><span class="number">16</span><span>)&nbsp;&amp;&nbsp;</span><span class="number">0x0ff</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf[ofs&nbsp;+&nbsp;<span class="number">2</span><span>]&nbsp;=&nbsp;(</span><span class="keyword">byte</span><span>)((tmp&nbsp;&gt;&gt;&gt;&nbsp;&nbsp;</span><span class="number">8</span><span>&nbsp;)&nbsp;&amp;&nbsp;</span><span class="number">0x0ff</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf[ofs&nbsp;+&nbsp;<span class="number">3</span><span>]&nbsp;=&nbsp;(</span><span class="keyword">byte</span><span>)&nbsp;&nbsp;tmp;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tmp&nbsp;=&nbsp;(<span class="keyword">int</span><span>)value;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf[ofs&nbsp;+&nbsp;<span class="number">4</span><span>]&nbsp;=&nbsp;(</span><span class="keyword">byte</span><span>)&nbsp;(tmp&nbsp;&gt;&gt;&gt;&nbsp;</span><span class="number">24</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf[ofs&nbsp;+&nbsp;<span class="number">5</span><span>]&nbsp;=&nbsp;(</span><span class="keyword">byte</span><span>)((tmp&nbsp;&gt;&gt;&gt;&nbsp;</span><span class="number">16</span><span>)&nbsp;&amp;&nbsp;</span><span class="number">0x0ff</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf[ofs&nbsp;+&nbsp;<span class="number">6</span><span>]&nbsp;=&nbsp;(</span><span class="keyword">byte</span><span>)((tmp&nbsp;&gt;&gt;&gt;&nbsp;&nbsp;</span><span class="number">8</span><span>&nbsp;)&nbsp;&amp;&nbsp;</span><span class="number">0x0ff</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf[ofs&nbsp;+&nbsp;<span class="number">7</span><span>]&nbsp;=&nbsp;(</span><span class="keyword">byte</span><span>)&nbsp;&nbsp;tmp;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">///////////////////////////////////////////////////////////////////////////</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Converts&nbsp;values&nbsp;from&nbsp;an&nbsp;integer&nbsp;array&nbsp;to&nbsp;a&nbsp;long.</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;buf&nbsp;where&nbsp;to&nbsp;get&nbsp;the&nbsp;bytes</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;ofs&nbsp;index&nbsp;from&nbsp;where&nbsp;to&nbsp;read&nbsp;the&nbsp;data</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;64bit&nbsp;integer</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">long</span><span>&nbsp;intArrayToLong(&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>[]&nbsp;buf,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;ofs)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;(((</span><span class="keyword">long</span><span>)&nbsp;buf[ofs&nbsp;&nbsp;&nbsp;&nbsp;])&nbsp;&lt;&lt;&nbsp;</span><span class="number">32</span><span>)&nbsp;|&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(((<span class="keyword">long</span><span>)&nbsp;buf[ofs&nbsp;+&nbsp;</span><span class="number">1</span><span>])&nbsp;&amp;&nbsp;0x0ffffffffL);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">///////////////////////////////////////////////////////////////////////////</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Converts&nbsp;a&nbsp;long&nbsp;to&nbsp;integers&nbsp;which&nbsp;are&nbsp;put&nbsp;into&nbsp;an&nbsp;array.</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;value&nbsp;the&nbsp;64bit&nbsp;integer&nbsp;to&nbsp;convert</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;buf&nbsp;the&nbsp;target&nbsp;buf</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;ofs&nbsp;where&nbsp;to&nbsp;place&nbsp;the&nbsp;bytes&nbsp;in&nbsp;the&nbsp;buf</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">void</span><span>&nbsp;longToIntArray(&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">long</span><span>&nbsp;value,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>[]&nbsp;buf,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;ofs)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf[ofs&nbsp;&nbsp;&nbsp;&nbsp;]&nbsp;=&nbsp;(<span class="keyword">int</span><span>)(value&nbsp;&gt;&gt;&gt;&nbsp;</span><span class="number">32</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buf[ofs&nbsp;+&nbsp;<span class="number">1</span><span>]&nbsp;=&nbsp;(</span><span class="keyword">int</span><span>)&nbsp;value;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">///////////////////////////////////////////////////////////////////////////</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Makes&nbsp;a&nbsp;long&nbsp;from&nbsp;two&nbsp;integers&nbsp;(treated&nbsp;unsigned).</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;lo&nbsp;lower&nbsp;32bits</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;hi&nbsp;higher&nbsp;32bits</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;built&nbsp;long</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">long</span><span>&nbsp;makeLong(&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;lo,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;hi)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;(((</span><span class="keyword">long</span><span>)&nbsp;hi&nbsp;&lt;&lt;&nbsp;</span><span class="number">32</span><span>)&nbsp;|&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;((<span class="keyword">long</span><span>)&nbsp;lo&nbsp;&amp;&nbsp;0x00000000ffffffffL));&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">///////////////////////////////////////////////////////////////////////////</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Gets&nbsp;the&nbsp;lower&nbsp;32&nbsp;bits&nbsp;of&nbsp;a&nbsp;long.</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;val&nbsp;the&nbsp;long&nbsp;integer</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;lower&nbsp;32&nbsp;bits</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;longLo32(&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">long</span><span>&nbsp;val)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;(</span><span class="keyword">int</span><span>)val;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">///////////////////////////////////////////////////////////////////////////</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Gets&nbsp;the&nbsp;higher&nbsp;32&nbsp;bits&nbsp;of&nbsp;a&nbsp;long.</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;val&nbsp;the&nbsp;long&nbsp;integer</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;higher&nbsp;32&nbsp;bits</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;longHi32(&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">long</span><span>&nbsp;val)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;(</span><span class="keyword">int</span><span>)(val&nbsp;&gt;&gt;&gt;&nbsp;</span><span class="number">32</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">///////////////////////////////////////////////////////////////////////////</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;our&nbsp;table&nbsp;for&nbsp;hex&nbsp;conversion</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">final</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">char</span><span>[]&nbsp;HEXTAB&nbsp;=&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">'0'</span><span>,&nbsp;</span><span class="string">'1'</span><span>,&nbsp;</span><span class="string">'2'</span><span>,&nbsp;</span><span class="string">'3'</span><span>,&nbsp;</span><span class="string">'4'</span><span>,&nbsp;</span><span class="string">'5'</span><span>,&nbsp;</span><span class="string">'6'</span><span>,&nbsp;</span><span class="string">'7'</span><span>,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string">'8'</span><span>,&nbsp;</span><span class="string">'9'</span><span>,&nbsp;</span><span class="string">'a'</span><span>,&nbsp;</span><span class="string">'b'</span><span>,&nbsp;</span><span class="string">'c'</span><span>,&nbsp;</span><span class="string">'d'</span><span>,&nbsp;</span><span class="string">'e'</span><span>,&nbsp;</span><span class="string">'f'</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;};&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Converts&nbsp;a&nbsp;byte&nbsp;array&nbsp;to&nbsp;a&nbsp;hex&nbsp;string.</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;data&nbsp;the&nbsp;byte&nbsp;array</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;hex&nbsp;string</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;String&nbsp;bytesToHexStr(&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>[]&nbsp;data)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;bytesToHexStr(data,&nbsp;</span><span class="number">0</span><span>,&nbsp;data.length);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">///////////////////////////////////////////////////////////////////////////</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Converts&nbsp;a&nbsp;byte&nbsp;array&nbsp;to&nbsp;a&nbsp;hex&nbsp;string.</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;data&nbsp;the&nbsp;byte&nbsp;array</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;ofs&nbsp;start&nbsp;index&nbsp;where&nbsp;to&nbsp;get&nbsp;the&nbsp;bytes</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;len&nbsp;number&nbsp;of&nbsp;bytes&nbsp;to&nbsp;convert</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;hex&nbsp;string</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;String&nbsp;bytesToHexStr(&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>[]&nbsp;data,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;ofs,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;len)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;pos,&nbsp;c;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;StringBuffer&nbsp;sbuf;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sbuf&nbsp;=&nbsp;<span class="keyword">new</span><span>&nbsp;StringBuffer();&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sbuf.setLength(len&nbsp;&lt;&lt;&nbsp;<span class="number">1</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pos&nbsp;=&nbsp;<span class="number">0</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c&nbsp;=&nbsp;ofs&nbsp;+&nbsp;len;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">while</span><span>&nbsp;(ofs&nbsp;&lt;&nbsp;c)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sbuf.setCharAt(pos++,&nbsp;HEXTAB[(data[ofs&nbsp;&nbsp;]&nbsp;&gt;&gt;&nbsp;<span class="number">4</span><span>)&nbsp;&amp;&nbsp;</span><span class="number">0x0f</span><span>]);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sbuf.setCharAt(pos++,&nbsp;HEXTAB[&nbsp;data[ofs++]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&nbsp;<span class="number">0x0f</span><span>]);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;sbuf.toString();&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">///////////////////////////////////////////////////////////////////////////</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Converts&nbsp;a&nbsp;hex&nbsp;string&nbsp;back&nbsp;into&nbsp;a&nbsp;byte&nbsp;array&nbsp;(invalid&nbsp;codes&nbsp;will&nbsp;be</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;skipped).</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;hex&nbsp;hex&nbsp;string</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;data&nbsp;the&nbsp;target&nbsp;array</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;srcofs&nbsp;from&nbsp;which&nbsp;character&nbsp;in&nbsp;the&nbsp;string&nbsp;the&nbsp;conversion&nbsp;should</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;begin,&nbsp;remember&nbsp;that&nbsp;(nSrcPos&nbsp;modulo&nbsp;2)&nbsp;should&nbsp;equals&nbsp;0&nbsp;normally</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;dstofs&nbsp;to&nbsp;store&nbsp;the&nbsp;bytes&nbsp;from&nbsp;which&nbsp;position&nbsp;in&nbsp;the&nbsp;array</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;len&nbsp;number&nbsp;of&nbsp;bytes&nbsp;to&nbsp;extract</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;number&nbsp;of&nbsp;extracted&nbsp;bytes</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;hexStrToBytes(&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String&nbsp;hex,&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>[]&nbsp;data,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;srcofs,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;dstofs,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;len)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;i,&nbsp;j,&nbsp;strlen,&nbsp;avail_bytes,&nbsp;dstofs_bak;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>&nbsp;abyte;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">boolean</span><span>&nbsp;convertOK;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;check&nbsp;for&nbsp;correct&nbsp;ranges</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;strlen&nbsp;=&nbsp;hex.length();&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;avail_bytes&nbsp;=&nbsp;(strlen&nbsp;-&nbsp;srcofs)&nbsp;&gt;&gt;&nbsp;<span class="number">1</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(avail_bytes&nbsp;&lt;&nbsp;len)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;len&nbsp;=&nbsp;avail_bytes;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;nOutputCapacity&nbsp;=&nbsp;data.length&nbsp;-&nbsp;dstofs;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(len&nbsp;&gt;&nbsp;nOutputCapacity)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;len&nbsp;=&nbsp;nOutputCapacity;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;convert&nbsp;now</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dstofs_bak&nbsp;=&nbsp;dstofs;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span><span>&nbsp;(i&nbsp;=&nbsp;</span><span class="number">0</span><span>;&nbsp;i&nbsp;&lt;&nbsp;len;&nbsp;i++)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;abyte&nbsp;=&nbsp;<span class="number">0</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;convertOK&nbsp;=&nbsp;<span class="keyword">true</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">for</span><span>&nbsp;(j&nbsp;=&nbsp;</span><span class="number">0</span><span>;&nbsp;j&nbsp;&lt;&nbsp;</span><span class="number">2</span><span>;&nbsp;++j)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;abyte&nbsp;&lt;&lt;=&nbsp;<span class="number">4</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">char</span><span>&nbsp;cActChar&nbsp;=&nbsp;hex.charAt(srcofs++);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;((cActChar&nbsp;&gt;=&nbsp;</span><span class="string">'a'</span><span>)&nbsp;&amp;&amp;&nbsp;(cActChar&nbsp;&lt;=&nbsp;</span><span class="string">'f'</span><span>))&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;abyte&nbsp;|=&nbsp;(<span class="keyword">byte</span><span>)&nbsp;(cActChar&nbsp;-&nbsp;</span><span class="string">'a'</span><span>)&nbsp;+&nbsp;</span><span class="number">10</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><span>&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;((cActChar&nbsp;&gt;=&nbsp;</span><span class="string">'0'</span><span>)&nbsp;&amp;&amp;&nbsp;(cActChar&nbsp;&lt;=&nbsp;</span><span class="string">'9'</span><span>))&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;abyte&nbsp;|=&nbsp;(<span class="keyword">byte</span><span>)&nbsp;(cActChar&nbsp;-&nbsp;</span><span class="string">'0'</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">else</span><span>&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;convertOK&nbsp;=&nbsp;<span class="keyword">false</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(convertOK)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data[dstofs++]&nbsp;=&nbsp;abyte;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;(dstofs&nbsp;-&nbsp;dstofs_bak);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">///////////////////////////////////////////////////////////////////////////</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Converts&nbsp;a&nbsp;byte&nbsp;array&nbsp;into&nbsp;a&nbsp;Unicode&nbsp;string.</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;data&nbsp;the&nbsp;byte&nbsp;array</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;ofs&nbsp;where&nbsp;to&nbsp;begin&nbsp;the&nbsp;conversion</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;len&nbsp;number&nbsp;of&nbsp;bytes&nbsp;to&nbsp;handle</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;the&nbsp;string</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;String&nbsp;byteArrayToStr(&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>[]&nbsp;data,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;ofs,&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;len)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">int</span><span>&nbsp;avail_capacity,&nbsp;sbuf_pos;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;StringBuffer&nbsp;sbuf;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;we&nbsp;need&nbsp;two&nbsp;bytes&nbsp;for&nbsp;every&nbsp;character</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;len&nbsp;&amp;=&nbsp;~<span class="number">1</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">//&nbsp;enough&nbsp;bytes&nbsp;in&nbsp;the&nbsp;buf?</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;avail_capacity&nbsp;=&nbsp;data.length&nbsp;-&nbsp;ofs;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">if</span><span>&nbsp;(avail_capacity&nbsp;&lt;&nbsp;len)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;len&nbsp;=&nbsp;avail_capacity;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sbuf&nbsp;=&nbsp;<span class="keyword">new</span><span>&nbsp;StringBuffer();&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sbuf.setLength(len&nbsp;&gt;&gt;&nbsp;<span class="number">1</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sbuf_pos&nbsp;=&nbsp;<span class="number">0</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">while</span><span>&nbsp;(</span><span class="number">0</span><span>&nbsp;&lt;&nbsp;len)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sbuf.setCharAt(&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sbuf_pos++,&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="keyword">char</span><span>)((data[ofs&nbsp;&nbsp;&nbsp;&nbsp;]&nbsp;&lt;&lt;&nbsp;</span><span class="number">8</span><span>&nbsp;)&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;(data[ofs&nbsp;+&nbsp;<span class="number">1</span><span>]&nbsp;&amp;&nbsp;</span><span class="number">0x0ff</span><span>)));&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ofs&nbsp;+=&nbsp;<span class="number">2</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;len&nbsp;-=&nbsp;<span class="number">2</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;sbuf.toString();&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">///////////////////////////////////////////////////////////////////////////</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Reverses&nbsp;between&nbsp;endians&nbsp;for&nbsp;integers</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;i&nbsp;the&nbsp;integer&nbsp;to&nbsp;convert&nbsp;endian</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;integer&nbsp;of&nbsp;reversed&nbsp;endian</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">int</span><span>&nbsp;reverseEndian(</span><span class="keyword">int</span><span>&nbsp;i)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>[]&nbsp;temp&nbsp;=&nbsp;</span><span class="keyword">new</span><span>&nbsp;</span><span class="keyword">byte</span><span>[</span><span class="number">4</span><span>];&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp[<span class="number">0</span><span>]&nbsp;=&nbsp;(</span><span class="keyword">byte</span><span>)(i&nbsp;&gt;&gt;&nbsp;</span><span class="number">24</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp[<span class="number">1</span><span>]&nbsp;=&nbsp;(</span><span class="keyword">byte</span><span>)(i&nbsp;&gt;&gt;&nbsp;</span><span class="number">16</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp[<span class="number">2</span><span>]&nbsp;=&nbsp;(</span><span class="keyword">byte</span><span>)(i&nbsp;&gt;&gt;&nbsp;</span><span class="number">8</span><span>&nbsp;);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp[<span class="number">3</span><span>]&nbsp;=&nbsp;(</span><span class="keyword">byte</span><span>)i;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;(temp[</span><span class="number">3</span><span>]&nbsp;&lt;&lt;&nbsp;</span><span class="number">24</span><span>)&nbsp;&amp;&nbsp;</span><span class="number">0xFF000000</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;(temp[<span class="number">2</span><span>]&nbsp;&lt;&lt;&nbsp;</span><span class="number">16</span><span>)&nbsp;&amp;&nbsp;</span><span class="number">0x00FF0000</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;(temp[<span class="number">1</span><span>]&nbsp;&lt;&lt;&nbsp;</span><span class="number">8</span><span>&nbsp;)&nbsp;&amp;&nbsp;</span><span class="number">0x0000FF00</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;temp[<span class="number">0</span><span>]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&nbsp;</span><span class="number">0x000000FF</span><span>;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">/**</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;Reverses&nbsp;between&nbsp;endians&nbsp;for&nbsp;integers</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@param&nbsp;i&nbsp;the&nbsp;integer&nbsp;to&nbsp;convert&nbsp;endian</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;@return&nbsp;integer&nbsp;of&nbsp;reversed&nbsp;endian</span>&nbsp;</span></li><li><span><span class="comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">public</span><span>&nbsp;</span><span class="keyword">final</span><span>&nbsp;</span><span class="keyword">static</span><span>&nbsp;</span><span class="keyword">short</span><span>&nbsp;reverseEndianShort(</span><span class="keyword">short</span><span>&nbsp;s)&nbsp;{&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">byte</span><span>[]&nbsp;temp&nbsp;=&nbsp;</span><span class="keyword">new</span><span>&nbsp;</span><span class="keyword">byte</span><span>[</span><span class="number">2</span><span>];&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp[<span class="number">0</span><span>]&nbsp;=&nbsp;(</span><span class="keyword">byte</span><span>)(s&nbsp;&gt;&gt;&nbsp;</span><span class="number">8</span><span>&nbsp;);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp[<span class="number">1</span><span>]&nbsp;=&nbsp;(</span><span class="keyword">byte</span><span>)s;&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword">return</span><span>&nbsp;(</span><span class="keyword">short</span><span>)((temp[</span><span class="number">1</span><span>]&nbsp;&lt;&lt;&nbsp;</span><span class="number">8</span><span>&nbsp;)&nbsp;&amp;&nbsp;</span><span class="number">0x0FF00</span><span>&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp[<span class="number">0</span><span>]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&nbsp;</span><span class="number">0x000FF</span><span>);&nbsp;&nbsp;</span></span></li><li><span>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;</span></li><li><span>}&nbsp;&nbsp;</span></li></ol></div>

  


  <div id="bottoms" class="clearfix">
    
    <div id="share_weibo">分享到：
      <a data-type="sina" href="javascript:;" title="分享到新浪微博" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img src="assets/1571225657-18e900b8666ce6f233d25ec02f95ee59.jpg"></a>
      <a data-type="qq" href="javascript:;" title="分享到腾讯微博" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img src="assets/1571225657-72dd548719f0ace4d5f9bca64e1d7715.jpg"></a>
    </div>
  </div>

  <div class="blog_nav">
    <div class="pre_next">
      <a href="https://www.iteye.com/blog/180447" class="next" title="ケータイ少女 script.arc的解压缩程序 (Java)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">ケータイ少女 script.arc的解压缩程序 (Ja ...</a>
      |
      <a href="https://www.iteye.com/blog/180023" class="pre" title="Visual C++ 2008 Feature Pack发布了" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Visual C++ 2008 Feature Pack发布了</a>
    </div>
  </div>
  <div class="blog_bottom">
    <ul>
      <li>2008-04-08 13:38</li>
      <li>浏览 2655</li>
      <li><a href="#comments">评论(0)</a></li>
      
      
            
      <li class="last"><a href="https://www.iteye.com/wiki/blog/180434" target="_blank" class="more" referrerpolicy="no-referrer" rel="noopener noreferrer">查看更多</a></li>
    </ul>    
  </div>
    
  <div class="blog_comment">
    <h5>评论</h5>
    <a id="comments" name="comments" data-mx-warn="Empty URL"></a>
    
    
    
  </div>

  <div class="blog_comment">
    <h5>发表评论</h5>
            <p style="text-align:center; margin-top:30px;margin-bottom:0px;"><a href="https://www.iteye.com/login" style="background-color: white; --darkreader-inline-bgcolor:#191a1b;" data-darkreader-inline-bgcolor="" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"> <img src="assets/1571225657-cf6d69dfbb92d2238c3e50c97eb9e7bf.png" style="vertical-align:middle; margin-right: 10px;"></a><a href="https://www.iteye.com/login" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">  您还没有登录,请您登录后再发表评论 </a></p>
      </div>
  </div>
  <div>
    <div style="" id="_8n9zpvikkbr"></div>
    <!-- 多条广告如下脚本只需引入一次 -->
    
  </div>
</div>







      </div></DIV></DIV>
        
      </div>
    </body>
  </html>