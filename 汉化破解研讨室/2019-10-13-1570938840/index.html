
  <!DOCTYPE html>
  <html id="" class="">
    <!-- OriginalSrc: https://bbs.sumisora.net/read.php?tid=10877004&fpage=12 -->
    <head>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />

      <title>椎名里緒系统破解记录|【汉化破解研讨室】|【游戏汉化交流区】 - 『澄空学园』 GalGame专题网</title>
      

<link rel="stylesheet" type="text/css" href="assets/1570938840-5f21d2d0f0e14c54e3e080ff47c8ec08.css" referrerpolicy="no-referrer">
<link type="text/css" href="assets/1570938840-2f10d407050ab6b2185fb483267feb32.css" rel="stylesheet" referrerpolicy="no-referrer">
<link href="assets/1570938840-6ea61090578ddc8e91dc9b26707cebc8.css" rel="stylesheet" type="text/css" referrerpolicy="no-referrer">
<link rel="stylesheet" type="text/css" href="assets/1570938840-46d427da9cafb653c4ed606490c99b3a.css" referrerpolicy="no-referrer">


<style class="darkreader darkreader--fallback" media="screen"></style>
<style class="darkreader darkreader--text" media="screen"></style>
<style class="darkreader darkreader--invert" media="screen"></style>
<style class="darkreader darkreader--inline" media="screen">[data-darkreader-inline-bgcolor] {
  background-color: var(--darkreader-inline-bgcolor) !important;
}
[data-darkreader-inline-bgimage] {
  background-image: var(--darkreader-inline-bgimage) !important;
}
[data-darkreader-inline-border] {
  border-color: var(--darkreader-inline-border) !important;
}
[data-darkreader-inline-border-bottom] {
  border-bottom-color: var(--darkreader-inline-border-bottom) !important;
}
[data-darkreader-inline-border-left] {
  border-left-color: var(--darkreader-inline-border-left) !important;
}
[data-darkreader-inline-border-right] {
  border-right-color: var(--darkreader-inline-border-right) !important;
}
[data-darkreader-inline-border-top] {
  border-top-color: var(--darkreader-inline-border-top) !important;
}
[data-darkreader-inline-boxshadow] {
  box-shadow: var(--darkreader-inline-boxshadow) !important;
}
[data-darkreader-inline-color] {
  color: var(--darkreader-inline-color) !important;
}
[data-darkreader-inline-fill] {
  fill: var(--darkreader-inline-fill) !important;
}
[data-darkreader-inline-stroke] {
  stroke: var(--darkreader-inline-stroke) !important;
}
[data-darkreader-inline-outline] {
  outline-color: var(--darkreader-inline-outline) !important;
}</style>
<style class="darkreader darkreader--user-agent" media="screen">html {
    background-color: #191a1b !important;
}
html, body, input, textarea, select, button {
    background-color: #191a1b;
}
html, body, input, textarea, select, button {
    border-color: #5a5956;
    color: #f0ebe2;
}
a {
    color: #4791e7;
}
table {
    border-color: #4f4e4c;
}
::placeholder {
    color: #bfb9ac;
}
::selection {
    background-color: #125cb4;
    color: #fffffd;
}
::-moz-selection {
    background-color: #125cb4;
    color: #fffffd;
}
input:-webkit-autofill,
textarea:-webkit-autofill,
select:-webkit-autofill {
    background-color: #565a0f !important;
    color: #f0ebe2 !important;
}
::-webkit-scrollbar {
    background-color: #1d1f1f;
    color: #cbc5b9;
}
::-webkit-scrollbar-thumb {
    background-color: #2c2d2d;
}
::-webkit-scrollbar-thumb:hover {
    background-color: #343636;
}
::-webkit-scrollbar-thumb:active {
    background-color: #404142;
}
::-webkit-scrollbar-corner {
    background-color: #191a1b;
}
* {
    scrollbar-color: #2c2d2d #1d1f1f;
}</style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style type="text/css"> 
.tr3 td,.tr3 th{border-right:1px solid #D5E5E8;}
.y-style{text-align:center;}
.tr1 th{border-right:1px solid #D5E5E8;}
.tr1 td.td1{border-left:0}
 

.signature img { max-height:250px !important; }
</style>
<style class="darkreader darkreader--sync" media="screen"></style>
<style class="darkreader darkreader--override" media="screen">.jfk-bubble {
    background-color: #000000 !important;
}
.vimvixen-hint {
    background-color: #765500 !important;
    border-color: #d5b22e !important;
    color: #f9edcc !important;
}</style>
<style type="text/css">@keyframes fadeInOpacity{0%{opacity:0}to{opacity:1}}:hover>*>.fbvd--wrapper{animation-name:fadeInOpacity;animation-duration:.3s;opacity:1}.fbvd--wrapper{position:absolute;top:10px;left:10px;opacity:0;text-align:center;margin:0;z-index:5}.fbvd--wrapper a{background: url("") no-repeat 3px 4.55px; background-color: #fff; display:inline-block;font:700 14px Helvetica,Arial,sans-serif;color:#4b4f56;text-decoration:none;vertical-align:middle;padding:0px 8px 0px;margin-right:8px;border-radius:2px; line-height: 22px; padding-left:19px; border: 1px solid #e7e7e7; background-size: 13px}.fbvd--wrapper a:last-child{margin-right:0}.fbvd--wrapper a:hover{text-decoration:none}.fbvd--wrapper a:focus{box-shadow:0 0 1px 2px rgba(88,144,255,.75),0 1px 1px rgba(0,0,0,.15);outline:none}.fbvd--wrapper b{font-size:13px;position:relative;top:1px;color:#3b5998;font-weight:400}</style>
<style class="darkreader darkreader--sync" media="screen"></style>

      <style class="mx-wc-style">
        .mx-wc-main img {max-width: 100%;}
        .mx-wc-main{
          box-sizing: content-box;
          background-color: rgb(25, 26, 27) !important;
          margin: 0 auto;
          margin-top: 20px;
          max-width: 1349px;
        }
        @media (min-width: 768px) {
          .mx-wc-main { padding: 15px 15px 80px 15px }
        }
        @media (max-width: 767px) {
          .mx-wc-main { padding: 15px 3px 80px 3px }
        }
  
      </style>
    </head>
    <body style="background-color: #ffffff !important; min-height: 100%; height: auto; position: static !important; overflow: auto !important; padding-bottom: 0px !important;" id="" class="">
      <div class="mx-wc-main">
        <div id="wrapA" class="mx-wc-selected-elem mx-wc-1570938840" style="display: block; float: none !important; position: relative !important; top: 0px !important; left: 0px !important; margin: 0px !important; flex: unset !important; width: 100% !important; max-width: 100% !important; box-sizing: border-box !important;">

<div id="header">
<div class="toptool tar">	<span>
	<a href="https://bbs.sumisora.net/read.php?tid=10877004&amp;fpage=12&amp;skinco=simple" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">手机版</a>

	| <a style="cursor:pointer;" id="td_skin" data-mx-warn="Empty URL">风格切换<img src="assets/1570938840-5c8e409588b73ce4284cf5b9bd619e15.gif"></a>
	| <a href="https://bbs.sumisora.net/read.php?tid=10894912" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">学生手册</a>
	</span>
</div>
<table cellspacing="0" cellpadding="0" align="center" width="100%">
<tbody><tr>
	<td class="banner"><a href="https://bbs.sumisora.net/" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img id="forumlogo" src="assets/1570938840-7ac78a0e1e3ce795251288b0c8bd4b1b.png"></a></td>
	<td class="banner" id="banner" align="right"></td>
</tr>
<tr><td align="center" height="1" colspan="2"></td></tr>
</tbody></table>
<div id="h_guide" class="guide" colspan="2"><span class="s3">»</span>

	<span style="font-weight:bold" class="s3">silasu</span>&nbsp;<a href="https://bbs.sumisora.net/login.php?action=quit&amp;verify=034be2bd" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">退出</a> |
	<a id="td_profile" href="https://bbs.sumisora.net/profile.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">控制面板</a>
	| <a id="td_msg" href="https://bbs.sumisora.net/message.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">

	短消息</a>

	| <a id="td_sort" href="https://bbs.sumisora.net/sort.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">统计排行</a>

	| <a href="https://bbs.sumisora.net/member.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">会员</a>

	| <a href="https://bbs.sumisora.net/search.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">搜索</a>
	| <a style="cursor:pointer;" id="td_hack" data-mx-warn="Empty URL">社区服务<img src="assets/1570938840-5c8e409588b73ce4284cf5b9bd619e15.gif"></a>

	| <a href="https://bbs.sumisora.net/hack.php?H_name=galgamevote" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">GALGAME角色人气投票活动</a>

 | <a href="https://bbs.sumisora.net/yume/polls/" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">近期关注</a><!--[if lte IE 6]>
 | <a href="read.php?tid=10955539" style="color:red">本站已停止支持IE6，请升级或更换浏览器</a>
<![endif]-->
</div>



</div>
<div id="main">




<div class="t3" style="margin-top:8px"><table width="100%" cellspacing="0" cellpadding="0" align="center">
	<tbody><tr><td class="b"><img src="assets/1570938840-ca4a91079181c2a5cb3514b2e5b5f035.gif" align="absmiddle"> <a href="https://bbs.sumisora.net/index.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">『澄空学园』</a> » <a href="https://bbs.sumisora.net/thread.php?fid=77" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">【游戏汉化交流区】</a> » <a href="https://bbs.sumisora.net/thread.php?fid=78&amp;page=12" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">【汉化破解研讨室】</a> » <a href="https://bbs.sumisora.net/read.php?tid=10877004" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">椎名里緒系统破解记录</a> <a href="https://bbs.sumisora.net/rss.php?tid=10877004" target="_blank" title="Rss订阅本帖最新内容" referrerpolicy="no-referrer" rel="noopener noreferrer"><img align="absmiddle" src="assets/1570938840-b4369735f1bfb33ab69477230a8ba635.png"></a></td></tr>
</tbody></table></div>

<!--ads begin-->

<!--ads end-->
<div class="t3"><table width="100%" align="center" cellspacing="0" cellpadding="0">
	<tbody><tr><td align="left"><div class="fl"></div></td><td align="right" style="padding-bottom:.2em"><a href="https://bbs.sumisora.net/post.php?action=reply&amp;fid=78&amp;tid=10877004" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img src="assets/1570938840-132cb83b134d7ecd9b390389d489bc43.png"></a>

<a href="https://bbs.sumisora.net/post.php?fid=78" style="margin-left:.5em" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img src="assets/1570938840-8cab7ee31ae503cf78e5410d40cec291.png" id="td_post"></a>

</td></tr>
</tbody></table></div>



<form name="delatc" method="post">


<div class="t" style="margin-bottom: 0px; border-bottom: 0px; --darkreader-inline-border-bottom: initial;" data-darkreader-inline-border-bottom=""><table cellspacing="0" cellpadding="0" width="100%">
	<tbody><tr><th class="h"><strong class="fl w"><b>本页主题:</b> 椎名里緒系统破解记录</strong>
	<span class="fr w"><a data-mx-warn="Empty URL">&nbsp;</a><a href="https://bbs.sumisora.net/job.php?action=previous&amp;fid=78&amp;tid=10877004&amp;fpage=12&amp;goto=previous" class="fn" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">上一主题</a> | <a href="https://bbs.sumisora.net/job.php?action=previous&amp;fid=78&amp;tid=10877004&amp;fpage=12&amp;goto=next" class="fn" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">下一主题</a> | <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span> </th>
	</tr>
	<tr><td></td></tr>
	<tr class="tr2"><td colspan="2" class="tar">

		<a id="usetool" style="cursor:pointer" onclick="sendmsg('pw_ajax.php?action=usetool','',this.id)" data-mx-warn="Empty URL">[使用道具]</a>

		<br></td>
	</tr>
	<tr><td></td></tr>
</tbody></table></div>

<a name="tpc" data-mx-warn="Empty URL"></a>
<div class="t t2" style="border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top=""><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570938840-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>悠久扬笛</b>
<div style="margin:.3em 0 .4em .2em">晚期封包破解毒瘾综合病患者</div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=48269" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570938840-cda034108948fa8bcba292fef486a404.jpg" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_0"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空一年生下学期</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570938840-0e03c5ece6b57c19681c4186b2d07c62.gif"><br>

<span class="user-info2" id="showface_0">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">295</span><br>
学分: <span class="s2 f9">5 点</span><br>
澄空币: <span class="s3 f9">1490 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2006-04-23<br>
		最后登录:2008-01-22 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_tpc" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10877004&amp;pid=tpc&amp;article=0" onclick="return sendurl(this,4,event)" id="quote_tpc" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10877004&amp;pid=tpc&amp;article=0" id="modify_tpc" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=48269" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10877004&amp;pid=tpc" onclick="return sendurl(this,8)" id="report_tpc" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10877004&amp;uid=48269" title="只看楼主的所有帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('tpc')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_tpc" class="fl"><img src="assets/1570938840-aa90e25d0c0169ac3f62e5ad9d1d3e72.gif" align="left" border="0">&nbsp;椎名里緒系统破解记录</h1>
			

			<div id="p_tpc" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_tpc">这篇文章适合中或上等水平且有一定破解经验的人阅读。<br><br>最近硬盘没地了，被太多没解包的游戏填满了，为了腾地，准备解包几个常见的封包格式。<br>机器上最多的当属krikri的xp3，然后是RealLive和.WAR 3种封包。因为krikri和RealLive的解包工具很多了，而.WAR的信息几乎没有，所以这次就来破解.WAR的格式。<br><br>找了个Will/Guilty的乙女蹂躙遊戯体験版（汗）来破解。首先看了一下目录结构，基本上都是WAR封包文件，还有有个OTOME.ini，打开一看最上面，有“[椎名里緒 v2.37]”的字样，这难道是系统名？？看起来更像人名。G一下，看来确实是系统名字，不过大家似乎也对这个名字感到惊奇，除此以外也没找到什么有用信息。那么还是开始破解吧。<br><br>把OTOME.EXE拖到oly里，一上来就报“模块入口点超出代码范围”的提示信息，看来是加壳了，于是把exe拖到PEiD，PEiD说什么也没找到，看来得自己手动脱了，要是太麻烦就放弃。这里之所以要做脱壳，主要是因为希望在关键地方下的断点不要消失，因为在解壳后的代码位置下断点是无效的，oly一重新加载（更别说关闭在启动了）之前的断点就都没了，这样极不方便。所以必须脱壳以后把它恢复成普通exe再下断点才行。<br>重新用oly加载，选否不进行分析，程序停在这里：<br><br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code1'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code1" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="lit">00872000</span><span class="pln"> </span><span class="pun">&gt;</span><span class="pln">&nbsp; </span><span class="lit">90</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NOP
</span><span class="lit">00872001</span><span class="pln">&nbsp; &nbsp; </span><span class="lit">53</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PUSH&nbsp; &nbsp; EBX
</span><span class="lit">00872002</span><span class="pln">&nbsp; &nbsp; </span><span class="lit">51</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PUSH&nbsp; &nbsp; ECX
</span><span class="lit">00872003</span><span class="pln">&nbsp; &nbsp; </span><span class="lit">52</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PUSH&nbsp; &nbsp; EDX
</span><span class="lit">00872004</span><span class="pln">&nbsp; &nbsp; </span><span class="lit">56</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PUSH&nbsp; &nbsp; ESI
</span><span class="lit">00872005</span><span class="pln">&nbsp; &nbsp; </span><span class="lit">57</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PUSH&nbsp; &nbsp; EDI
</span><span class="lit">00872006</span><span class="pln">&nbsp; &nbsp; BE </span><span class="lit">00104000</span><span class="pln">&nbsp; &nbsp;  MOV&nbsp; &nbsp;  ESI</span><span class="pun">,</span><span class="pln"> OTOME</span><span class="pun">.</span><span class="lit">00401000</span><span class="pln">
</span><span class="lit">0087200B</span><span class="pln">&nbsp; &nbsp; B9 </span><span class="lit">20380600</span><span class="pln">&nbsp; &nbsp;  MOV&nbsp; &nbsp;  ECX</span><span class="pun">,</span><span class="pln"> </span><span class="lit">63820</span><span class="pln">
</span><span class="lit">00872010</span><span class="pln">&nbsp; &nbsp; BB A36CCF00&nbsp; &nbsp;  MOV&nbsp; &nbsp;  EBX</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0CF6CA3</span><span class="pln">
</span><span class="lit">00872015</span><span class="pln">&nbsp; &nbsp; B8 FFFFFFFF&nbsp; &nbsp;  MOV&nbsp; &nbsp;  EAX</span><span class="pun">,</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pln">
</span><span class="lit">0087201A</span><span class="pln">&nbsp; &nbsp; </span><span class="lit">33D2</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; XOR&nbsp; &nbsp;  EDX</span><span class="pun">,</span><span class="pln"> EDX
</span><span class="lit">0087201C</span><span class="pln">&nbsp; &nbsp; </span><span class="lit">8D6424</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp; &nbsp; &nbsp;  LEA&nbsp; &nbsp;  ESP</span><span class="pun">,</span><span class="pln"> DWORD PTR SS</span><span class="pun">:[</span><span class="pln">ESP</span><span class="pun">]</span><span class="pln">
</span><span class="lit">00872020</span><span class="pln">&nbsp; &nbsp; </span><span class="lit">8BF8</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; &nbsp;  EDI</span><span class="pun">,</span><span class="pln"> EAX
</span><span class="lit">00872022</span><span class="pln">&nbsp; &nbsp; </span><span class="lit">8D9C9B</span><span class="pln"> </span><span class="lit">11370000</span><span class="pln"> LEA&nbsp; &nbsp;  EBX</span><span class="pun">,</span><span class="pln"> DWORD PTR DS</span><span class="pun">:[</span><span class="pln">EBX</span><span class="pun">+</span><span class="pln">EBX</span><span class="pun">*</span><span class="lit">4</span><span class="pun">+</span><span class="lit">371</span><span class="pun">&gt;</span><span class="pln">
</span><span class="lit">00872029</span><span class="pln">&nbsp; &nbsp; </span><span class="lit">8A16</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; &nbsp;  DL</span><span class="pun">,</span><span class="pln"> BYTE PTR DS</span><span class="pun">:[</span><span class="pln">ESI</span><span class="pun">]</span><span class="pln">
</span><span class="lit">0087202B</span><span class="pln">&nbsp; &nbsp; </span><span class="lit">90</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NOP
</span><span class="lit">0087202C</span><span class="pln">&nbsp; &nbsp; C1E8 </span><span class="lit">08</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp;  SHR&nbsp; &nbsp;  EAX</span><span class="pun">,</span><span class="pln"> </span><span class="lit">8</span><span class="pln">
</span><span class="lit">0087202F</span><span class="pln">&nbsp; &nbsp; </span><span class="lit">32D3</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; XOR&nbsp; &nbsp;  DL</span><span class="pun">,</span><span class="pln"> BL
</span><span class="lit">00872031</span><span class="pln">&nbsp; &nbsp; </span><span class="lit">81E7</span><span class="pln"> FF000000&nbsp;  AND&nbsp; &nbsp;  EDI</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0FF</span><span class="pln">
</span><span class="lit">00872037</span><span class="pln">&nbsp; &nbsp; </span><span class="lit">8816</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; &nbsp;  BYTE PTR DS</span><span class="pun">:[</span><span class="pln">ESI</span><span class="pun">],</span><span class="pln"> DL
</span><span class="lit">00872039</span><span class="pln">&nbsp; &nbsp; </span><span class="lit">33FA</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; XOR&nbsp; &nbsp;  EDI</span><span class="pun">,</span><span class="pln"> EDX
</span><span class="lit">0087203B</span><span class="pln">&nbsp; &nbsp; </span><span class="lit">46</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; INC&nbsp; &nbsp;  ESI
</span><span class="lit">0087203C</span><span class="pln">&nbsp; &nbsp; </span><span class="lit">3304BD</span><span class="pln"> </span><span class="lit">60208700</span><span class="pln"> XOR&nbsp; &nbsp;  EAX</span><span class="pun">,</span><span class="pln"> DWORD PTR DS</span><span class="pun">:[</span><span class="pln">EDI</span><span class="pun">*</span><span class="lit">4</span><span class="pun">+</span><span class="lit">872060</span><span class="pun">]</span><span class="pln">
</span><span class="lit">00872043</span><span class="pln">&nbsp; &nbsp; </span><span class="lit">49</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DEC&nbsp; &nbsp;  ECX
</span><span class="lit">00872044</span><span class="pln">&nbsp; </span><span class="pun">^</span><span class="pln"> </span><span class="lit">75</span><span class="pln"> DA&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  JNZ&nbsp; &nbsp;  SHORT OTOME</span><span class="pun">.</span><span class="lit">00872020</span><span class="pln">
</span><span class="lit">00872046</span><span class="pln">&nbsp; &nbsp; </span><span class="lit">83F0</span><span class="pln"> FF&nbsp; &nbsp; &nbsp; &nbsp;  XOR&nbsp; &nbsp;  EAX</span><span class="pun">,</span><span class="pln"> FFFFFFFF
</span><span class="lit">00872049</span><span class="pln">&nbsp; &nbsp; </span><span class="lit">5F</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; POP&nbsp; &nbsp;  EDI
</span><span class="lit">0087204A</span><span class="pln">&nbsp; &nbsp; </span><span class="lit">3D</span><span class="pln"> C0AD5EC0&nbsp; &nbsp;  CMP&nbsp; &nbsp;  EAX</span><span class="pun">,</span><span class="pln"> C05EADC0
</span><span class="lit">0087204F</span><span class="pln">&nbsp; &nbsp; </span><span class="lit">5E</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; POP&nbsp; &nbsp;  ESI
</span><span class="lit">00872050</span><span class="pln">&nbsp; &nbsp; </span><span class="lit">5A</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; POP&nbsp; &nbsp;  EDX
</span><span class="lit">00872051</span><span class="pln">&nbsp; &nbsp; </span><span class="lit">59</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; POP&nbsp; &nbsp;  ECX
</span><span class="lit">00872052</span><span class="pln">&nbsp; &nbsp; </span><span class="lit">5B</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; POP&nbsp; &nbsp;  EBX
</span><span class="lit">00872053</span><span class="pln">&nbsp; &nbsp; B8 D6BCB8DD&nbsp; &nbsp;  MOV&nbsp; &nbsp;  EAX</span><span class="pun">,</span><span class="pln"> DDB8BCD6
</span><span class="lit">00872058</span><span class="pln">&nbsp; &nbsp; </span><span class="lit">74</span><span class="pln"> </span><span class="lit">01</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  JE&nbsp; &nbsp; &nbsp; SHORT OTOME</span><span class="pun">.</span><span class="lit">0087205B</span><span class="pln">
</span><span class="lit">0087205A</span><span class="pln">&nbsp; &nbsp; C3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RETN
</span><span class="lit">0087205B</span><span class="pln">&nbsp; </span><span class="pun">-</span><span class="pln"> E9 </span><span class="lit">523ABCFF</span><span class="pln">&nbsp; &nbsp;  JMP&nbsp; &nbsp;  OTOME</span><span class="pun">.</span><span class="lit">00435AB2</span></pre><br><br>先f9直接运行，ok，程序能正常运行，表示没有anti-debugger，而且也没用常见的壳代码引发的异常，看来可能会比较简单。然后重新启动oly，这回f8单步走，走到最后的长跳转“JMP&nbsp; &nbsp;  OTOME.00435AB2”，直接就跳到了一个熟悉的地方：<br><br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code2'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code2" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="lit">00435AB2</span><span class="pln"> </span><span class="pun">&gt;/</span><span class="pln">$&nbsp; </span><span class="lit">55</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PUSH&nbsp; &nbsp; EBP
</span><span class="lit">00435AB3</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8BEC</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; &nbsp;  EBP</span><span class="pun">,</span><span class="pln"> ESP
</span><span class="lit">00435AB5</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">6A</span><span class="pln"> FF&nbsp; &nbsp; &nbsp; &nbsp;  PUSH&nbsp; &nbsp; </span><span class="pun">-</span><span class="lit">1</span><span class="pln">
</span><span class="lit">00435AB7</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">68</span><span class="pln"> F8554600&nbsp;  PUSH&nbsp; &nbsp; OTOME</span><span class="pun">.</span><span class="lit">004655F8</span><span class="pln">
</span><span class="lit">00435ABC</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">68</span><span class="pln"> </span><span class="lit">70814300</span><span class="pln">&nbsp;  PUSH&nbsp; &nbsp; OTOME</span><span class="pun">.</span><span class="lit">00438170</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  </span><span class="pun">;</span><span class="pln">&nbsp; SE </span><span class="pun">处理程序安装</span><span class="pln">
</span><span class="lit">00435AC1</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">64</span><span class="pun">:</span><span class="pln">A1 </span><span class="lit">0000000</span><span class="pun">&gt;</span><span class="pln">MOV&nbsp; &nbsp;  EAX</span><span class="pun">,</span><span class="pln"> DWORD PTR FS</span><span class="pun">:[</span><span class="lit">0</span><span class="pun">]</span><span class="pln">
</span><span class="lit">00435AC7</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">50</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PUSH&nbsp; &nbsp; EAX
</span><span class="lit">00435AC8</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">64</span><span class="pun">:</span><span class="lit">8925</span><span class="pln"> </span><span class="lit">00000</span><span class="pun">&gt;</span><span class="pln">MOV&nbsp; &nbsp;  DWORD PTR FS</span><span class="pun">:[</span><span class="lit">0</span><span class="pun">],</span><span class="pln"> ESP
</span><span class="lit">00435ACF</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">83EC</span><span class="pln"> </span><span class="lit">58</span><span class="pln">&nbsp; &nbsp; &nbsp;  SUB&nbsp; &nbsp;  ESP</span><span class="pun">,</span><span class="pln"> </span><span class="lit">58</span><span class="pln">
</span><span class="lit">00435AD2</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">53</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PUSH&nbsp; &nbsp; EBX
</span><span class="lit">00435AD3</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">56</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PUSH&nbsp; &nbsp; ESI
</span><span class="lit">00435AD4</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">57</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PUSH&nbsp; &nbsp; EDI
</span><span class="lit">00435AD5</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8965</span><span class="pln"> E8&nbsp; &nbsp; &nbsp;  MOV&nbsp; &nbsp;  DWORD PTR SS</span><span class="pun">:[</span><span class="pln">EBP</span><span class="pun">-</span><span class="lit">18</span><span class="pun">],</span><span class="pln"> ESP
</span><span class="lit">00435AD8</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; FF15 F8514600 CALL&nbsp; &nbsp; DWORD PTR DS</span><span class="pun">:[&lt;&amp;</span><span class="pln">kernel32</span><span class="pun">.</span><span class="typ">GetVers</span><span class="pun">&gt;;</span><span class="pln">&nbsp; kernel32</span><span class="pun">.</span><span class="typ">GetVersion</span><span class="pln">
</span><span class="lit">00435ADE</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">33D2</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; XOR&nbsp; &nbsp;  EDX</span><span class="pun">,</span><span class="pln"> EDX
</span><span class="lit">00435AE0</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8AD4</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; &nbsp;  DL</span><span class="pun">,</span><span class="pln"> AH</span></pre><br><br>这里就是脱壳后的入口点。马上右键，选“用OllyDump脱壳调试进程”，选脱壳，保存，关闭当前oly，把原始的exe备份一下，然后把脱壳后的exe改名为OTOME.EXE。看大小大了很多，看来这壳只是个exe解压缩器而已。<br><br>双击运行OTOME.EXE，报错，说RestoreLastError不存在。这个也是常见的问题，到G上搜一下这个名字就有了。启动UE，搜索ascii字符串“RestoreLastError”，然后手动改为“GetLastError”，保存关闭UE。再次双击OTOME.EXE，启动成功，但是屏幕闪了一下又退出了，猜测exe内部有检查文件crc或者有stolen code。<br><br>检查exe crc的常规做法是CreateFile目标exe文件，然后像对待一般文件那样ReadFile和SetFilePointer。我们通常不用关心它的具体算法实现，只要在关键的比较crc值的地方改动一下就行了。<br><br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code3'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code3" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="lit">00402A52</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; C1EE </span><span class="lit">02</span><span class="pln">&nbsp; &nbsp; &nbsp;  SHR&nbsp; &nbsp;  ESI</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pln">
</span><span class="lit">00402A55</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">33C9</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; XOR&nbsp; &nbsp;  ECX</span><span class="pun">,</span><span class="pln"> ECX
</span><span class="lit">00402A57</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8D7E</span><span class="pln"> FE&nbsp; &nbsp; &nbsp;  LEA&nbsp; &nbsp;  EDI</span><span class="pun">,</span><span class="pln"> DWORD PTR DS</span><span class="pun">:[</span><span class="pln">ESI</span><span class="pun">-</span><span class="lit">2</span><span class="pun">]</span><span class="pln">
</span><span class="lit">00402A5A</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">33ED</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; XOR&nbsp; &nbsp;  EBP</span><span class="pun">,</span><span class="pln"> EBP
</span><span class="lit">00402A5C</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">3BF9</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CMP&nbsp; &nbsp;  EDI</span><span class="pun">,</span><span class="pln"> ECX
</span><span class="lit">00402A5E</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">894C24</span><span class="pln"> </span><span class="lit">14</span><span class="pln">&nbsp; &nbsp;  MOV&nbsp; &nbsp;  DWORD PTR SS</span><span class="pun">:[</span><span class="pln">ESP</span><span class="pun">+</span><span class="lit">14</span><span class="pun">],</span><span class="pln"> ECX
</span><span class="lit">00402A62</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">76</span><span class="pln"> </span><span class="lit">38</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp;  JBE&nbsp; &nbsp;  SHORT CLEAVAGE</span><span class="pun">.</span><span class="lit">00402A9C</span><span class="pln">
</span><span class="lit">00402A64</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8BC3</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; &nbsp;  EAX</span><span class="pun">,</span><span class="pln"> EBX
</span><span class="lit">00402A66</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8D53</span><span class="pln"> </span><span class="lit">04</span><span class="pln">&nbsp; &nbsp; &nbsp;  LEA&nbsp; &nbsp;  EDX</span><span class="pun">,</span><span class="pln"> DWORD PTR DS</span><span class="pun">:[</span><span class="pln">EBX</span><span class="pun">+</span><span class="lit">4</span><span class="pun">]</span><span class="pln">
</span><span class="lit">00402A69</span><span class="pln">&nbsp; </span><span class="pun">|&gt;</span><span class="pln">&nbsp; </span><span class="lit">8B30</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">/</span><span class="pln">MOV&nbsp; &nbsp;  ESI</span><span class="pun">,</span><span class="pln"> DWORD PTR DS</span><span class="pun">:[</span><span class="pln">EAX</span><span class="pun">]</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">；</span><span class="pln"> </span><span class="pun">计算</span><span class="pln">exe</span><span class="pun">的</span><span class="pln">crc
</span><span class="lit">00402A6B</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">81FE</span><span class="pln"> </span><span class="lit">61592E59</span><span class="pln"> </span><span class="pun">|</span><span class="pln">CMP&nbsp; &nbsp;  ESI</span><span class="pun">,</span><span class="pln"> </span><span class="lit">592E5961</span><span class="pln">
</span><span class="lit">00402A71</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">75</span><span class="pln"> </span><span class="lit">17</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp;  </span><span class="pun">|</span><span class="pln">JNZ&nbsp; &nbsp;  SHORT CLEAVAGE</span><span class="pun">.</span><span class="lit">00402A8A</span><span class="pln">
</span><span class="lit">00402A73</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">813A</span><span class="pln"> </span><span class="lit">6164616D</span><span class="pln"> </span><span class="pun">|</span><span class="pln">CMP&nbsp; &nbsp;  DWORD PTR DS</span><span class="pun">:[</span><span class="pln">EDX</span><span class="pun">],</span><span class="pln"> </span><span class="lit">6D616461</span><span class="pln">
</span><span class="lit">00402A79</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">75</span><span class="pln"> </span><span class="lit">0F</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp;  </span><span class="pun">|</span><span class="pln">JNZ&nbsp; &nbsp;  SHORT CLEAVAGE</span><span class="pun">.</span><span class="lit">00402A8A</span><span class="pln">
</span><span class="lit">00402A7B</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">83C1</span><span class="pln"> </span><span class="lit">02</span><span class="pln">&nbsp; &nbsp; &nbsp;  </span><span class="pun">|</span><span class="pln">ADD&nbsp; &nbsp;  ECX</span><span class="pun">,</span><span class="pln"> </span><span class="lit">2</span><span class="pln">
</span><span class="lit">00402A7E</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">83C2</span><span class="pln"> </span><span class="lit">08</span><span class="pln">&nbsp; &nbsp; &nbsp;  </span><span class="pun">|</span><span class="pln">ADD&nbsp; &nbsp;  EDX</span><span class="pun">,</span><span class="pln"> </span><span class="lit">8</span><span class="pln">
</span><span class="lit">00402A81</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">83C0</span><span class="pln"> </span><span class="lit">08</span><span class="pln">&nbsp; &nbsp; &nbsp;  </span><span class="pun">|</span><span class="pln">ADD&nbsp; &nbsp;  EAX</span><span class="pun">,</span><span class="pln"> </span><span class="lit">8</span><span class="pln">
</span><span class="lit">00402A84</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">894424</span><span class="pln"> </span><span class="lit">20</span><span class="pln">&nbsp; &nbsp;  </span><span class="pun">|</span><span class="pln">MOV&nbsp; &nbsp;  DWORD PTR SS</span><span class="pun">:[</span><span class="pln">ESP</span><span class="pun">+</span><span class="lit">20</span><span class="pun">],</span><span class="pln"> EAX
</span><span class="lit">00402A88</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; EB </span><span class="lit">07</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp;  </span><span class="pun">|</span><span class="pln">JMP&nbsp; &nbsp;  SHORT CLEAVAGE</span><span class="pun">.</span><span class="lit">00402A91</span><span class="pln">
</span><span class="lit">00402A8A</span><span class="pln">&nbsp; </span><span class="pun">|&gt;</span><span class="pln">&nbsp; </span><span class="lit">017424</span><span class="pln"> </span><span class="lit">14</span><span class="pln">&nbsp; &nbsp;  </span><span class="pun">|</span><span class="pln">ADD&nbsp; &nbsp;  DWORD PTR SS</span><span class="pun">:[</span><span class="pln">ESP</span><span class="pun">+</span><span class="lit">14</span><span class="pun">],</span><span class="pln"> ESI
</span><span class="lit">00402A8E</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">83D5</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp; &nbsp; &nbsp;  </span><span class="pun">|</span><span class="pln">ADC&nbsp; &nbsp;  EBP</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pln">
</span><span class="lit">00402A91</span><span class="pln">&nbsp; </span><span class="pun">|&gt;</span><span class="pln">&nbsp; </span><span class="lit">41</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">|</span><span class="pln">INC&nbsp; &nbsp;  ECX
</span><span class="lit">00402A92</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">83C2</span><span class="pln"> </span><span class="lit">04</span><span class="pln">&nbsp; &nbsp; &nbsp;  </span><span class="pun">|</span><span class="pln">ADD&nbsp; &nbsp;  EDX</span><span class="pun">,</span><span class="pln"> </span><span class="lit">4</span><span class="pln">
</span><span class="lit">00402A95</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">83C0</span><span class="pln"> </span><span class="lit">04</span><span class="pln">&nbsp; &nbsp; &nbsp;  </span><span class="pun">|</span><span class="pln">ADD&nbsp; &nbsp;  EAX</span><span class="pun">,</span><span class="pln"> </span><span class="lit">4</span><span class="pln">
</span><span class="lit">00402A98</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">3BCF</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">|</span><span class="pln">CMP&nbsp; &nbsp;  ECX</span><span class="pun">,</span><span class="pln"> EDI
</span><span class="lit">00402A9A</span><span class="pln">&nbsp; </span><span class="pun">|.^</span><span class="pln"> </span><span class="lit">72</span><span class="pln"> CD&nbsp; &nbsp; &nbsp; &nbsp;  \JB&nbsp; &nbsp; &nbsp; SHORT CLEAVAGE</span><span class="pun">.</span><span class="lit">00402A69</span><span class="pln">
</span><span class="lit">00402A9C</span><span class="pln">&nbsp; </span><span class="pun">|&gt;</span><span class="pln">&nbsp; </span><span class="lit">336C24</span><span class="pln"> </span><span class="lit">14</span><span class="pln">&nbsp; &nbsp;  XOR&nbsp; &nbsp;  EBP</span><span class="pun">,</span><span class="pln"> DWORD PTR SS</span><span class="pun">:[</span><span class="pln">ESP</span><span class="pun">+</span><span class="lit">14</span><span class="pun">]</span><span class="pln">
</span><span class="lit">00402AA0</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8B5424</span><span class="pln"> </span><span class="lit">20</span><span class="pln">&nbsp; &nbsp;  MOV&nbsp; &nbsp;  EDX</span><span class="pun">,</span><span class="pln"> DWORD PTR SS</span><span class="pun">:[</span><span class="pln">ESP</span><span class="pun">+</span><span class="lit">20</span><span class="pun">]</span><span class="pln">
</span><span class="lit">00402AA4</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">8B0A</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MOV&nbsp; &nbsp;  ECX</span><span class="pun">,</span><span class="pln"> DWORD PTR DS</span><span class="pun">:[</span><span class="pln">EDX</span><span class="pun">]</span><span class="pln">
</span><span class="lit">00402AA6</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">5F</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; POP&nbsp; &nbsp;  EDI
</span><span class="lit">00402AA7</span><span class="pln">&nbsp; &nbsp; &nbsp; </span><span class="lit">33C0</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; XOR&nbsp; &nbsp;  EAX</span><span class="pun">,</span><span class="pln"> EAX
</span><span class="lit">00402AA9</span><span class="pln">&nbsp; &nbsp; &nbsp; </span><span class="lit">5E</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; POP&nbsp; &nbsp;  ESI
</span><span class="lit">00402AAA</span><span class="pln">&nbsp; &nbsp; &nbsp; </span><span class="lit">3BCD</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CMP&nbsp; &nbsp;  ECX</span><span class="pun">,</span><span class="pln"> EBP&nbsp; </span><span class="pun">&lt;--</span><span class="pln"> </span><span class="pun">校验和比较，</span><span class="pln">hack</span><span class="pun">成</span><span class="pln">cmp ebp</span><span class="pun">,</span><span class="pln"> ebp
</span><span class="lit">00402AAC</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">5D</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; POP&nbsp; &nbsp;  EBP
</span><span class="lit">00402AAD</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">0F94C0</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; SETE&nbsp; &nbsp; AL
</span><span class="lit">00402AB0</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">5B</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; POP&nbsp; &nbsp;  EBX
</span><span class="lit">00402AB1</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">83C4</span><span class="pln"> </span><span class="lit">0C</span><span class="pln">&nbsp; &nbsp; &nbsp;  ADD&nbsp; &nbsp;  ESP</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0C</span><span class="pln">
</span><span class="lit">00402AB4</span><span class="pln">&nbsp; \.&nbsp; C3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RETN</span></pre><br><br>如上修改，保存exe，退出oly，删除当前exe，把刚才保存的去掉crc检查的exe重新命名为OTOME.EXE，双击运行，这次游戏启动成功了～看来没有stolen code，果然是个压缩壳而已。<br><br>到目前为止还算顺利，所以马上在CreateFile下断点准备分析封包了。首先是读取decode.bin这个文件，显然当前目录下没这玩意。再f9，就去访问TRON_T0.WAR了，看来这系统有可能支持资源预读功能了。f9了好几次，几乎都是先读取一个资源文件，然后再读取WAR封包，看来几乎可以确定支持资源预读了，等把WAR拆开后利用这个特性再分析内部资源格式就容易多了～<br><br>重启oly，回到第一个CreateFile访问TRON_T0.WAR的地方，正式开始破解WAR格式。停在CreateFile以后，f8一下，记住eax的HANDLE值，然后在所有的ReadFile和SetFilePointer处下断点，再f9，停在一个ReadFile处，看HANDLE就是刚才的值，ok～首先读取12字节，马上WinHex一下TRON_T0.WAR和其他WAR，前12字节就是WAR的magic：8字节和一个4字节的不知意义的数据。跟踪分析程序，很快能得到这个：<br><br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code4'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code4" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="pln">&nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">WAR_header</span><span class="pun">.</span><span class="pln">magic</span><span class="pun">[</span><span class="lit">6</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="str">'.'</span><span class="pun">)</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; version </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">WAR_header</span><span class="pun">.</span><span class="pln">magic</span><span class="pun">[</span><span class="lit">5</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="lit">10</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> WAR_header</span><span class="pun">.</span><span class="pln">magic</span><span class="pun">[</span><span class="lit">7</span><span class="pun">])</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="lit">10</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">0x14a0</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; </span><span class="kwd">else</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; version </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">WAR_header</span><span class="pun">.</span><span class="pln">magic</span><span class="pun">[</span><span class="lit">5</span><span class="pun">]</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="lit">10</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> WAR_header</span><span class="pun">.</span><span class="pln">magic</span><span class="pun">[</span><span class="lit">6</span><span class="pun">])</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="lit">10</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> WAR_header</span><span class="pun">.</span><span class="pln">magic</span><span class="pun">[</span><span class="lit">7</span><span class="pun">]</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">0x14a0</span><span class="pun">;</span></pre><br><br>这里的version实际上就是版本号“1.7”的数字形式：170。至于另一个版本分支暂时先不考虑，因为所有的WAR都是1.7，这个分支以后再分析。最后程序把170这个值保存在一个全局变量里了。用oly的常量引用功能找到所有对这个地址的引用，发现额外的2处，不管怎么说先在这2处下2个断点就闪人吧，什么时候用的着了断点自然会停下来。<br><br>然后接下来是对剩下的那个4字节的处理：<br><br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code5'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code5" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; WAR_header</span><span class="pun">.</span><span class="pln">index_offset </span><span class="pun">^=</span><span class="pln"> </span><span class="lit">0xF182AD82</span><span class="pun">;</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// 解密4字节值</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; pkg</span><span class="pun">-&gt;</span><span class="pln">pio</span><span class="pun">-&gt;</span><span class="pln">readvec</span><span class="pun">(</span><span class="pln">pkg</span><span class="pun">,</span><span class="pln"> index_buffer</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0xa0000</span><span class="pun">,</span><span class="pln"> WAR_header</span><span class="pun">.</span><span class="pln">index_offset</span><span class="pun">,</span><span class="pln"> IO_SEEK_SET</span><span class="pun">):</span></pre><br><br>那4字节是一个接近文件结尾的偏移值，然后读取655360字节到一个全局缓冲区里，实际读取的数据不足655360。根据经验，这个偏移应该就是索引段偏移，读取的数据应该就是索引段数据，看内容明显是加密过的了。<br><br>在这个索引数据缓冲区内下内存访问断点，然后f9，停在这里：<br><br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code6'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code6" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="lit">00440D52</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">0FBE0F</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; MOVSX&nbsp;  ECX</span><span class="pun">,</span><span class="pln"> BYTE PTR DS</span><span class="pun">:[</span><span class="pln">EDI</span><span class="pun">]</span></pre><br><br>首先右键查找-&gt;所有参看文本字串，看一下这个位置的前后有没有什么调试信息可以利用。很明显没有任何调试字符串，上面字串是“sequencer”，调用了mci族的API，和解密没关系；下面是“cdaudio”，也调用了mci族的API。看来上下文没有什么参考的价值了。先不急于马上分析解密代码，先大概了解一下解密算法的结构，通常总要有个解密循环来处理整个解密数据，或者是一个专门的函数每次解密其中的一部分要用到的数据。<br>我们一路f8，但是不要出当前函数，很快的，发现2个浮点指令：<br><br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code7'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code7" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="lit">00440E28</span><span class="pln">&nbsp; </span><span class="pun">|&gt;</span><span class="pln"> \DB45 F4&nbsp; &nbsp; &nbsp;  FILD&nbsp; &nbsp; DWORD PTR SS</span><span class="pun">:[</span><span class="pln">EBP</span><span class="pun">-</span><span class="pln">C</span><span class="pun">]</span><span class="pln">
</span><span class="lit">00440E2B</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; DD5D E8&nbsp; &nbsp; &nbsp;  FSTP&nbsp; &nbsp; QWORD PTR SS</span><span class="pun">:[</span><span class="pln">EBP</span><span class="pun">-</span><span class="lit">18</span><span class="pun">]</span></pre><br><br>啊，有点讨厌的预感，继暂时无视它，继续f8。到达一个函数调用，在这个函数的call指令的下面一条指令处下断点，然后f8跨过它。这样做的好处是如果这个函数内部也访问了加密数据，那么我们不会因为可能停在一个很深的地方而找不到现在所处的返回位置，所以事先在返回地址处下好断点，同时也可以知道这个函数是不是也参与了直接的解密行为，还是只是一个辅助函数。f8以后直接跨过了，看来只是个辅助函数。对于后面的函数也这么处理，当前主要是找到真正的解密函数的入口位置，然后观察解密后的数据，判断这个数据到底是干吗用的。接下来会看到一些浮点指令，而且看样子这些浮点数也是解密算法的一部分，啊～很讨厌啊。<br>终于眼前一亮：<br><br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code8'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code8" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="lit">00440EB8</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">68</span><span class="pln"> C4804700&nbsp;  PUSH&nbsp; &nbsp; OTOME</span><span class="pun">.</span><span class="lit">004780C4</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  </span><span class="pun">;</span><span class="pln"> </span><span class="str">/String = "Crypt Type 20011002 - Copyright(C) 2000 Y.Yamada/</span><span class="pln">STUDIO </span><span class="pun">傛偟偔傫</span><span class="str">"
00440EBD&nbsp; |.&nbsp; 81E3 FF000000 AND&nbsp; &nbsp;  EBX, 0FF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ; |
00440EC3&nbsp; |.&nbsp; 03DE&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ADD&nbsp; &nbsp;  EBX, ESI&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ; |
00440EC5&nbsp; |.&nbsp; FF15 0C524600 CALL&nbsp; &nbsp; DWORD PTR DS:[&lt;&amp;kernel32.lstrlen&gt;; \lstrlenA</span></pre><br><br>看到这个"Crypt Type 20011002 - Copyright(C) 2000 Y.Yamada/STUDIO よしくん"，二话不说，G去！<br><br><br>结果什么也没找到orz 看来这个算法可能是作者自己写的，网上也没参考代码。20011002吗？时间不早了，为啥网上还是没什么破解信息？<br>再往下走一点，哦yeah，看到一个循环，估计就是我们要找的解密循环，马上在循环的外面下一个断点，而且这个循环也是这个函数最后的代码了。所以直接大方的f9吧。<br>接下来就是在这个循环内不断的发生内存访问和内存写入断点，因此确认这个循环是解密循环，马上取消内存访问断点，f9让它直接停在循环外观看解密结果。<br>天哪，解密完的数据还是一团糟糕，看来这个函数只是解出个半成品出来。在退出该函数之前，在这个函数开始位置标上decode，下个断点好了。然后再次在这个内存区域上下内存访问断点，看来噩梦没结束。<br>哦yeah2，一出来就是一个xor循环。把断点下在循环后面，然后解除内存断点，f9！晕，还是乱糟糟，重新下回内存访问断点orz....后面应该还有解密处理。<br><br>f8继续往下走，很快的看到这个函数调用：<br><br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code9'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code9" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="lit">0043FFAC</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">52</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PUSH&nbsp; &nbsp; EDX&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">/</span><span class="typ">Arg5</span><span class="pln">
</span><span class="lit">0043FFAD</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; C1E1 </span><span class="lit">08</span><span class="pln">&nbsp; &nbsp; &nbsp;  SHL&nbsp; &nbsp;  ECX</span><span class="pun">,</span><span class="pln"> </span><span class="lit">8</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="pln">
</span><span class="lit">0043FFB0</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">03C8</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ADD&nbsp; &nbsp;  ECX</span><span class="pun">,</span><span class="pln"> EAX&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="pln">
</span><span class="lit">0043FFB2</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">51</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PUSH&nbsp; &nbsp; ECX&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="typ">Arg4</span><span class="pln">
</span><span class="lit">0043FFB3</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">68</span><span class="pln"> F8FF0900&nbsp;  PUSH&nbsp; &nbsp; </span><span class="lit">9FFF8</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="typ">Arg3</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0009FFF8</span><span class="pln">
</span><span class="lit">0043FFB8</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">68</span><span class="pln"> A0E27200&nbsp;  PUSH&nbsp; &nbsp; OTOME</span><span class="pun">.</span><span class="lit">0072E2A0</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="typ">Arg2</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0072E2A0</span><span class="pln">
</span><span class="lit">0043FFBD</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">68</span><span class="pln"> </span><span class="lit">98E27C00</span><span class="pln">&nbsp;  PUSH&nbsp; &nbsp; OTOME</span><span class="pun">.</span><span class="lit">007CE298</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="typ">Arg1</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">007CE298</span><span class="pln">
</span><span class="lit">0043FFC2</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; C745 </span><span class="lit">10</span><span class="pln"> </span><span class="lit">00000</span><span class="pun">&gt;</span><span class="pln">MOV&nbsp; &nbsp;  DWORD PTR SS</span><span class="pun">:[</span><span class="pln">EBP</span><span class="pun">+</span><span class="lit">10</span><span class="pun">],</span><span class="pln"> </span><span class="lit">0A0000</span><span class="pln">&nbsp; &nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">|</span><span class="pln">
</span><span class="lit">0043FFC9</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; E8 B2150000&nbsp;  CALL&nbsp; &nbsp; OTOME</span><span class="pun">.</span><span class="lit">00441580</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  </span><span class="pun">;</span><span class="pln"> \OTOME</span><span class="pun">.</span><span class="lit">00441580</span></pre><br><br>这里除了0072E2A0这个乱糟糟的数据区域外，007CE298是另一个全局内存区域，看一下它的内容，全0。估计是要对乱糟糟的数据进行什么处理然后复制到007CE298里吧。还是采用老办法f8跨过，在返回的地方下个断点。<br><br>这回f8的时候停在这个函数里面了，是1个xor解密循环。都跟我混了半天了也知道怎么做了吧。哦yeah3～经过这次xor解密这回看到了0x78 0xda！！！！！！！！！！！！！！！！！！而且下面的“1.2.3”也很是说明了问题，于是马上在这个函数入口点标记uncompress，取消内存断点，f9直接返回到上一处调用。这时查看007CE298的内容吧：哼哼哼哼哼哈哈哈。。。。。就是索引段咯。<br><br>好了，到目前为止，我们已经知道了解密索引段的大概过程了，解密代码的位置也找到了。我们把decode以外的断点都取消（不是删除！），然后oly重新启动，f9断点停在decode处：440d20，开始分析decode函数。<br><br>首先的2条浮点指令没什么实际作用：<br><br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code10'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code10" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="lit">00440D34</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; D97D FE&nbsp; &nbsp; &nbsp;  FSTCW&nbsp;  WORD PTR SS</span><span class="pun">:[</span><span class="pln">EBP</span><span class="pun">-</span><span class="lit">2</span><span class="pun">]</span><span class="pln">
</span><span class="lit">00440D37</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; D96D F4&nbsp; &nbsp; &nbsp;  FLDCW&nbsp;  WORD PTR SS</span><span class="pun">:[</span><span class="pln">EBP</span><span class="pun">-</span><span class="pln">C</span><span class="pun">]</span></pre><br><br>FSTCW将当前浮点数状态寄存器保存起来，然后重新将该状态值初始化为0x27f，该寄存器具体涵义参见Intel手册。这里应该能猜出既然有保存，应该在结尾有弹出旧的状态值，果然：<br><br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code11'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code11" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="lit">00440F8B</span><span class="pln">&nbsp; </span><span class="pun">|&gt;</span><span class="pln"> \D</span><span class="lit">96D</span><span class="pln"> FE&nbsp; &nbsp; &nbsp;  FLDCW&nbsp;  WORD PTR SS</span><span class="pun">:[</span><span class="pln">EBP</span><span class="pun">-</span><span class="lit">2</span><span class="pun">]</span><span class="pln">
</span><span class="lit">00440F8E</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; </span><span class="lit">6A</span><span class="pln"> </span><span class="lit">00</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp;  PUSH&nbsp; &nbsp; </span><span class="lit">0</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">;</span><span class="pln"> </span><span class="pun">/</span><span class="typ">Timeout</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0.</span><span class="pln"> ms
</span><span class="lit">00440F90</span><span class="pln">&nbsp; </span><span class="pun">|.</span><span class="pln">&nbsp; FF15 </span><span class="lit">34514600</span><span class="pln"> CALL&nbsp; &nbsp; DWORD PTR DS</span><span class="pun">:[&lt;&amp;</span><span class="pln">kernel32</span><span class="pun">.</span><span class="typ">Sleep</span><span class="pun">&gt;]</span><span class="pln"> </span><span class="pun">;</span><span class="pln"> \Sleep</span></pre><br><br>当然这些实际上对于破解都是可以忽略的，我们继续，通过分析大概得到这样的代码：<br><br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code12'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code12" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="kwd">static</span><span class="pln"> </span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> seed</span><span class="pun">;</span><span class="pln"> 

</span><span class="com">#define</span><span class="pln"> M_PI&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="lit">3.141592653589793</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> M_RPI&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="lit">3.183098861837907e-1</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">/* 1/pi */</span><span class="pln">
</span><span class="com">#define</span><span class="pln"> MACHEPF&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="lit">4.656612873077393e-10</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">/* 2^-24 */</span><span class="pln">

</span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">double</span><span class="pln"> sub_func_440670</span><span class="pun">(</span><span class="kwd">double</span><span class="pln"> a</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">double</span><span class="pln"> ret </span><span class="pun">=</span><span class="pln"> a</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">double</span><span class="pln"> st0 </span><span class="pun">=</span><span class="pln"> ret</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">double</span><span class="pln"> st1 </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-(</span><span class="pln">a </span><span class="pun">*</span><span class="pln"> a</span><span class="pun">);</span><span class="pln">

&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">3</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">1000</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">+=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">double</span><span class="pln"> tmp</span><span class="pun">;</span><span class="pln">

&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; st0 </span><span class="pun">*=</span><span class="pln"> st1 </span><span class="pun">/</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">));</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmp </span><span class="pun">=</span><span class="pln"> st0 </span><span class="pun">/</span><span class="pln"> i</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">tmp</span><span class="pun">)</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ret </span><span class="pun">+=</span><span class="pln"> tmp</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln">

&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">return</span><span class="pln"> ret</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">double</span><span class="pln"> sub_func_440480</span><span class="pun">(</span><span class="kwd">double</span><span class="pln"> a</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">int</span><span class="pln"> flag </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">double</span><span class="pln"> ret </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">double</span><span class="pln"> v28 </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">double</span><span class="pln"> v10 </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> a</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">double</span><span class="pln"> v20 </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2.0</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">double</span><span class="pln"> v18 </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2.0</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">double</span><span class="pln"> v30 </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">double</span><span class="pln"> v8 </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">do</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v8 </span><span class="pun">+=</span><span class="pln"> v10</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v10 </span><span class="pun">*=</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i </span><span class="pun">/</span><span class="pln"> a</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">v8 </span><span class="pun">&lt;</span><span class="pln"> v18</span><span class="pun">)</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v18 </span><span class="pun">=</span><span class="pln"> v8</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">else</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; flag </span><span class="pun">|=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">

&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v28 </span><span class="pun">+=</span><span class="pln"> v10</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v10 </span><span class="pun">*=</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i </span><span class="pun">/</span><span class="pln"> a</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">v28 </span><span class="pun">&lt;</span><span class="pln"> v20</span><span class="pun">)</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v20 </span><span class="pun">=</span><span class="pln"> v28</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">else</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; flag </span><span class="pun">|=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">

&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v8 </span><span class="pun">-=</span><span class="pln"> v10</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v10 </span><span class="pun">*=</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i </span><span class="pun">/</span><span class="pln"> a</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">v8 </span><span class="pun">&gt;</span><span class="pln"> ret</span><span class="pun">)</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ret </span><span class="pun">=</span><span class="pln"> v8</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">else</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; flag </span><span class="pun">|=</span><span class="pln"> </span><span class="lit">4</span><span class="pun">;</span><span class="pln">

&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v28 </span><span class="pun">-=</span><span class="pln"> v10</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v10 </span><span class="pun">*=</span><span class="pln"> </span><span class="pun">++</span><span class="pln">i </span><span class="pun">/</span><span class="pln"> a</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">v28 </span><span class="pun">&gt;</span><span class="pln"> v30</span><span class="pun">)</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v30 </span><span class="pun">=</span><span class="pln"> v28</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">else</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; flag </span><span class="pun">|=</span><span class="pln"> </span><span class="lit">8</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="pln">flag </span><span class="pun">!=</span><span class="pln"> </span><span class="lit">15</span><span class="pun">);</span><span class="pln">

&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">((</span><span class="pln">M_PI </span><span class="pun">-</span><span class="pln"> cos</span><span class="pun">(</span><span class="pln">a</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ret </span><span class="pun">+</span><span class="pln"> v18</span><span class="pun">))</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="pun">(</span><span class="pln">sin</span><span class="pun">(</span><span class="pln">a</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">v30 </span><span class="pun">+</span><span class="pln"> v20</span><span class="pun">)))</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">double</span><span class="pln"> func_440610</span><span class="pun">(</span><span class="kwd">double</span><span class="pln"> a</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">-</span><span class="pln">func_440610</span><span class="pun">(-</span><span class="pln">a</span><span class="pun">);</span><span class="pln">

&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">18.0</span><span class="pun">)</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">return</span><span class="pln"> sub_func_440670</span><span class="pun">(</span><span class="pln">a</span><span class="pun">);</span><span class="pln">

&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">return</span><span class="pln"> sub_func_440480</span><span class="pun">(</span><span class="pln">a</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">long</span><span class="pln"> func_4406E0</span><span class="pun">(</span><span class="kwd">double</span><span class="pln"> a</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">double</span><span class="pln"> v8</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">double</span><span class="pln"> v10</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">double</span><span class="pln"> v18</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">double</span><span class="pln"> v20</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">double</span><span class="pln"> v28</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">double</span><span class="pln"> ret</span><span class="pun">;</span><span class="pln">

&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1.0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v10 </span><span class="pun">=</span><span class="pln"> sqrt</span><span class="pun">(</span><span class="pln">a </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">while</span><span class="pln"> </span><span class="pun">(</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">double</span><span class="pln"> c</span><span class="pun">,</span><span class="pln"> d</span><span class="pun">;</span><span class="pln">

&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; seed </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1566083941</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> seed </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v18 </span><span class="pun">=</span><span class="pln"> seed</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; seed </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1566083941</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> seed </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v20 </span><span class="pun">=</span><span class="pln"> seed</span><span class="pun">;</span><span class="pln">

&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; c </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> v18 </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2.3283064365386963e-10</span><span class="com">/* 2^-25 */</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; d </span><span class="pun">=</span><span class="pln"> v20 </span><span class="pun">*</span><span class="pln"> MACHEPF </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1.0</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">c </span><span class="pun">*</span><span class="pln"> c </span><span class="pun">+</span><span class="pln"> d </span><span class="pun">*</span><span class="pln"> d </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">

&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v8 </span><span class="pun">=</span><span class="pln"> d </span><span class="pun">/</span><span class="pln"> c</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ret </span><span class="pun">=</span><span class="pln"> v8 </span><span class="pun">*</span><span class="pln"> v10 </span><span class="pun">+</span><span class="pln"> a </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1.0</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ret </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">

&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">double</span><span class="pln"> ex </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1.0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> log</span><span class="pun">(</span><span class="pln">ret </span><span class="pun">/</span><span class="pln"> </span><span class="pun">(</span><span class="pln">a </span><span class="pun">-</span><span class="pln"> </span><span class="lit">1.0</span><span class="pun">))</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> v8 </span><span class="pun">*</span><span class="pln"> v10</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">ex </span><span class="pun">&lt;</span><span class="pln"> </span><span class="pun">-</span><span class="lit">50.0</span><span class="pun">)</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">continue</span><span class="pun">;</span><span class="pln">

&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; seed </span><span class="pun">=</span><span class="pln"> seed </span><span class="pun">*</span><span class="pln"> </span><span class="lit">1566083941</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; v28 </span><span class="pun">=</span><span class="pln"> seed</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">((</span><span class="pln">v28 </span><span class="pun">*</span><span class="pln"> </span><span class="lit">2.3283064365386963e-10</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">exp</span><span class="pun">(</span><span class="pln">ex</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="pun">(</span><span class="pln">v8 </span><span class="pun">*</span><span class="pln"> v8 </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)))</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">break</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// 这个分支暂时没进来过</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; printf</span><span class="pun">(</span><span class="str">"not supported\n"</span><span class="pun">);</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln">

&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">long</span><span class="pun">)(</span><span class="pln">ret </span><span class="pun">*</span><span class="pln"> </span><span class="lit">256.0</span><span class="pun">);</span><span class="pln">
</span><span class="pun">}</span><span class="pln">

</span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> decode</span><span class="pun">(</span><span class="pln">BYTE </span><span class="pun">*</span><span class="pln">cipher</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> cipher_length</span><span class="pun">)</span><span class="pln">
</span><span class="pun">{</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">int</span><span class="pln"> sFPU_CW_4</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">int</span><span class="pln"> xor</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">int</span><span class="pln"> v5</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">char</span><span class="pln"> </span><span class="pun">*</span><span class="pln">key </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Crypt Type 20011002 - Copyright(C) 2000 Y.Yamada/STUDIO 傛偟偔傫"</span><span class="pun">;</span><span class="pln">

&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">cipher_length </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">3</span><span class="pun">)</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">return</span><span class="pun">;</span><span class="pln">

&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// 这里有处理另一种版本分支的代码，暂时忽略；另外这里对cipher_length != 0xa0000的情况也有</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// 特殊处理，暂时也忽略。</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; seed </span><span class="pun">=</span><span class="pln"> cipher_length</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; sFPU_CW_4 </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">char</span><span class="pun">)</span><span class="pln">cipher_length </span><span class="pun">^</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">char</span><span class="pun">)</span><span class="pln">cipher</span><span class="pun">[</span><span class="lit">0</span><span class="pun">];</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; xor </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">char</span><span class="pun">)</span><span class="pln">cipher</span><span class="pun">[</span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">^</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">char</span><span class="pun">)(</span><span class="pln">cipher_length </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">cipher_length </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">1024</span><span class="pun">)</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cipher_length </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1024</span><span class="pun">;</span><span class="pln">

&nbsp; &nbsp; &nbsp; &nbsp; v5 </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">double</span><span class="pln"> qword0 </span><span class="pun">=</span><span class="pln"> sFPU_CW_4</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; seed </span><span class="pun">^=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">DWORD</span><span class="pun">)(</span><span class="pln">func_440610</span><span class="pun">(</span><span class="pln">sFPU_CW_4</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="lit">100000000.0</span><span class="pun">);</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">double</span><span class="pln"> ret</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">sFPU_CW_4 </span><span class="pun">|</span><span class="pln"> xor</span><span class="pun">)</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ret </span><span class="pun">=</span><span class="pln"> acos</span><span class="pun">(</span><span class="pln">qword0 </span><span class="pun">/</span><span class="pln"> sqrt</span><span class="pun">(</span><span class="pln">sFPU_CW_4 </span><span class="pun">*</span><span class="pln"> sFPU_CW_4 </span><span class="pun">+</span><span class="pln"> xor </span><span class="pun">*</span><span class="pln"> xor</span><span class="pun">));</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">else</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ret </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">

&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">double</span><span class="pln"> sFPU_CW </span><span class="pun">=</span><span class="pln"> M_RPI </span><span class="pun">*</span><span class="pln"> ret </span><span class="pun">*</span><span class="pln"> </span><span class="lit">180.0</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">xor </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; sFPU_CW </span><span class="pun">=</span><span class="pln"> </span><span class="lit">360.0</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> sFPU_CW</span><span class="pun">;</span><span class="pln">

&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">int</span><span class="pln"> v11 </span><span class="pun">=</span><span class="pln"> v5 </span><span class="pun">+</span><span class="pln"> </span><span class="pun">(</span><span class="pln">BYTE</span><span class="pun">)</span><span class="pln">func_4406E0</span><span class="pun">(</span><span class="pln">sFPU_CW</span><span class="pun">);</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">int</span><span class="pln"> _rem </span><span class="pun">=</span><span class="pln"> v11 </span><span class="pun">%</span><span class="pln"> strlen</span><span class="pun">(</span><span class="pln">key</span><span class="pun">);</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">DWORD k </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> cipher_length</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; BYTE tmp</span><span class="pun">;</span><span class="pln">

&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; seed </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1566083941</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> seed </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cipher</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">^=</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">unsigned</span><span class="pln"> </span><span class="kwd">long</span><span class="pun">)(</span><span class="pln">seed </span><span class="pun">*</span><span class="pln"> </span><span class="lit">5.960464477539062e-08</span><span class="pun">);</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tmp </span><span class="pun">=</span><span class="pln"> </span><span class="pun">((</span><span class="pln">cipher</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">7</span><span class="pun">)</span><span class="pln"> </span><span class="pun">|</span><span class="pln"> </span><span class="pun">(</span><span class="pln">cipher</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">);</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cipher</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> key</span><span class="pun">[</span><span class="pln">_rem</span><span class="pun">]</span><span class="pln"> </span><span class="pun">^</span><span class="pln"> tmp </span><span class="pun">^</span><span class="pln"> key</span><span class="pun">[</span><span class="pln">k</span><span class="pun">];</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; _rem </span><span class="pun">=</span><span class="pln"> cipher</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> strlen</span><span class="pun">(</span><span class="pln">key</span><span class="pun">);</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(++</span><span class="pln">k </span><span class="pun">&gt;=</span><span class="pln"> strlen</span><span class="pun">(</span><span class="pln">key</span><span class="pun">))</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; k </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln">
</span><span class="pun">}</span></pre><br><br>这里主函数是decode，其他函数都是其调用的子函数。<br>这里分析的很痛苦，花了我将近2天时间，尤其是有些浮点数，从oly中看到的精度比实际精度小，这样运算得到的结果就不对，最后解密的数据也错了，其实就是小数点后16位的精度缺失导致的...orz<br>这段解密代码看样子似乎是应用了某种数学算法，希望有高人指点一下，能把上面的那些子函数分析一下，看看到底是什么数学运算，也不枉费我费那么大力气把它C语言化（我是真的讨厌内联汇编）。<br><br>这段过了剩下的就相当简单了：<br><br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code13'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code13" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">0xa0000</span><span class="pln"> </span><span class="pun">/</span><span class="pln"> </span><span class="lit">4</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">((</span><span class="pln">u32 </span><span class="pun">*)</span><span class="pln">crypt_index</span><span class="pun">)[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">^=</span><span class="pln"> WAR_header</span><span class="pun">.</span><span class="pln">index_offset</span><span class="pun">;</span><span class="pln">

&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">int</span><span class="pln"> key </span><span class="pun">=</span><span class="pln"> version </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">24</span><span class="pln"> </span><span class="pun">|</span><span class="pln"> version </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">16</span><span class="pln"> </span><span class="pun">|</span><span class="pln"> version </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">8</span><span class="pln"> </span><span class="pun">|</span><span class="pln"> version</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">key</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; BYTE xor </span><span class="pun">=</span><span class="pln"> </span><span class="pun">~(</span><span class="pln">key </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">16</span><span class="pln"> </span><span class="pun">|</span><span class="pln"> key</span><span class="pun">);</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">0xa0000</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">8</span><span class="pun">;</span><span class="pln"> i</span><span class="pun">++)</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">(</span><span class="pln">crypt_index </span><span class="pun">+</span><span class="pln"> </span><span class="lit">8</span><span class="pun">)[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">^=</span><span class="pln"> xor</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln">

&nbsp; &nbsp; &nbsp; &nbsp; DWORD index_buffer_len </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0xa0000</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; BYTE </span><span class="pun">*</span><span class="pln">index_buffer </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">BYTE </span><span class="pun">*)</span><span class="pln">malloc</span><span class="pun">(</span><span class="pln">index_buffer_len</span><span class="pun">);</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">index_buffer</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; free</span><span class="pun">(</span><span class="pln">crypt_index</span><span class="pun">);</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">-</span><span class="pln">CUI_EMEM</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln">

&nbsp; &nbsp; &nbsp; &nbsp; uncompress</span><span class="pun">(</span><span class="pln">index_buffer</span><span class="pun">,</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">index_buffer_len</span><span class="pun">,</span><span class="pln"> crypt_index </span><span class="pun">+</span><span class="pln"> </span><span class="lit">8</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0xa0000</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">8</span><span class="pun">);</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; free</span><span class="pun">(</span><span class="pln">crypt_index</span><span class="pun">);</span></pre><br><br>最后index_buffer保存的就是解密后的索引段数据。<br><br>我又测试了一下其他的.WAR封包，运气不错，索引段似乎解密的都很正确T_T。<br>用相面法看了一下索引段，猜出如下格式：<br><br><h6 class="quote"><a href="javascript:" onclick="CopyCode(document.getElementById('code14'));" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Copy code</a></h6><pre class="prettyprint" id="code14" style="border-radius:5px;font-family:monaco,consolas,monospace;font-size:12px;overflow-x:auto;line-height:1.4em"><span class="kwd">typedef</span><span class="pln"> </span><span class="kwd">struct</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; s8 name</span><span class="pun">[</span><span class="lit">16</span><span class="pun">];</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; u32 offset</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; u32 comprlen</span><span class="pun">;</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; u32 uncomprlen</span><span class="pun">;</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// ?</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; u32 key0</span><span class="pun">;</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// ?</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; u32 key1</span><span class="pun">;</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// ?</span><span class="pln">
&nbsp; &nbsp; &nbsp; &nbsp; u32 flags</span><span class="pun">;</span><span class="pln">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// ?</span><span class="pln">
</span><span class="pun">}</span><span class="pln"> </span><span class="typ">WAR_entry_t</span><span class="pun">;</span></pre><br><br>后面写着“？”的是我拿不准的地方；其中2个key的参测源于索引段前8字节，因为解压的时候前8字节没有参与，<br>所以可能和这里每个资源的这8字节相互呼应。<br>但是有offset和comprlen已经足够了写出拆WAR的代码了，这样为以后进行资源分析提供了不少便利。<br>成功提取出所有WAR的内部资源，不出意料所有解出的资源文件都是一团糟糕，很可能decode()还有解密资源数据的用处。<br>最后值得关注的就是每个封包内部都有一个0x255字节长的DECODE.BIN资源文件，而且每个文件的内容都完全相同。记得<br>游戏一开始读取的资源就是decode.bin，嗯，所以试试把DECODE.BIN放到游戏根目录下再启动游戏看看有什么事情发生。<br>哦yeah，游戏直接非法退出了！！！！<br><br>不管怎么说，到现在为止，最麻烦的地方已经过了，下面就是资源段其他未知字段涵义以及资源提取了。呼～让我休息一会儿......<br><div id="alert_tpc" style="color: gray; margin-top: 30px; --darkreader-inline-color:#bfb9ac;" data-darkreader-inline-color="">[ 此贴被悠久扬笛在2008-01-13 14:35重新编辑 ]</div></div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_tpc" class="c"></div>

		<div><img class="signature" src="assets/1570938840-f23b8ffd0b6b327441aa828c9cd3243d.gif" align="absbottom"></div>
		<div class="signature" style="max-height:380px;maxHeight:380px; overflow:hidden;"><table width="100%"><tbody><tr><td>【crass游戏资源提取器,欢迎大家充当小白鼠测试－ω－】
<br>http://bbs.jgames.net/ForumDisplay-213387-0-1-1.html</td><td></td></tr></tbody></table></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2008-01-13 14:14 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 楼主(悠久扬笛) 的帖子');" data-mx-warn="Empty URL">[楼 主]</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="1321230" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570938840-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>悠久扬笛</b>
<div style="margin:.3em 0 .4em .2em">晚期封包破解毒瘾综合病患者</div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=48269" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570938840-cda034108948fa8bcba292fef486a404.jpg" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_1"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空一年生下学期</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570938840-0e03c5ece6b57c19681c4186b2d07c62.gif"><br>

<span class="user-info2" id="showface_1">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">295</span><br>
学分: <span class="s2 f9">5 点</span><br>
澄空币: <span class="s3 f9">1490 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2006-04-23<br>
		最后登录:2008-01-22 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_1321230" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10877004&amp;pid=1321230&amp;article=1" onclick="return sendurl(this,4,event)" id="quote_1321230" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10877004&amp;pid=1321230&amp;article=1" id="modify_1321230" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=48269" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10877004&amp;pid=1321230" onclick="return sendurl(this,8)" id="report_1321230" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10877004&amp;uid=48269" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('1321230')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_1321230" class="fl">&nbsp;</h1>
			

			<div id="p_1321230" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_1321230">占楼2222222222222222222222</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_1321230" class="c"></div>

		<div><img class="signature" src="assets/1570938840-f23b8ffd0b6b327441aa828c9cd3243d.gif" align="absbottom"></div>
		<div class="signature" style="max-height:380px;maxHeight:380px; overflow:hidden;"><table width="100%"><tbody><tr><td>【crass游戏资源提取器,欢迎大家充当小白鼠测试－ω－】
<br>http://bbs.jgames.net/ForumDisplay-213387-0-1-1.html</td><td></td></tr></tbody></table></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2008-01-13 14:14 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 1楼(悠久扬笛) 的帖子');" data-mx-warn="Empty URL">1 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="1321231" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570938840-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>悠久扬笛</b>
<div style="margin:.3em 0 .4em .2em">晚期封包破解毒瘾综合病患者</div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=48269" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570938840-cda034108948fa8bcba292fef486a404.jpg" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_2"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空一年生下学期</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570938840-0e03c5ece6b57c19681c4186b2d07c62.gif"><br>

<span class="user-info2" id="showface_2">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">295</span><br>
学分: <span class="s2 f9">5 点</span><br>
澄空币: <span class="s3 f9">1490 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2006-04-23<br>
		最后登录:2008-01-22 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_1321231" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10877004&amp;pid=1321231&amp;article=2" onclick="return sendurl(this,4,event)" id="quote_1321231" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10877004&amp;pid=1321231&amp;article=2" id="modify_1321231" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=48269" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10877004&amp;pid=1321231" onclick="return sendurl(this,8)" id="report_1321231" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10877004&amp;uid=48269" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('1321231')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_1321231" class="fl">&nbsp;</h1>
			

			<div id="p_1321231" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_1321231">占楼33333333333333333</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_1321231" class="c"></div>

		<div><img class="signature" src="assets/1570938840-f23b8ffd0b6b327441aa828c9cd3243d.gif" align="absbottom"></div>
		<div class="signature" style="max-height:380px;maxHeight:380px; overflow:hidden;"><table width="100%"><tbody><tr><td>【crass游戏资源提取器,欢迎大家充当小白鼠测试－ω－】
<br>http://bbs.jgames.net/ForumDisplay-213387-0-1-1.html</td><td></td></tr></tbody></table></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2008-01-13 14:14 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 2楼(悠久扬笛) 的帖子');" data-mx-warn="Empty URL">2 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="1321232" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570938840-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>悠久扬笛</b>
<div style="margin:.3em 0 .4em .2em">晚期封包破解毒瘾综合病患者</div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=48269" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570938840-cda034108948fa8bcba292fef486a404.jpg" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_3"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空一年生下学期</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570938840-0e03c5ece6b57c19681c4186b2d07c62.gif"><br>

<span class="user-info2" id="showface_3">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">295</span><br>
学分: <span class="s2 f9">5 点</span><br>
澄空币: <span class="s3 f9">1490 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2006-04-23<br>
		最后登录:2008-01-22 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_1321232" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10877004&amp;pid=1321232&amp;article=3" onclick="return sendurl(this,4,event)" id="quote_1321232" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10877004&amp;pid=1321232&amp;article=3" id="modify_1321232" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=48269" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10877004&amp;pid=1321232" onclick="return sendurl(this,8)" id="report_1321232" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10877004&amp;uid=48269" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('1321232')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_1321232" class="fl">&nbsp;</h1>
			

			<div id="p_1321232" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_1321232">占楼444444444444444444</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_1321232" class="c"></div>

		<div><img class="signature" src="assets/1570938840-f23b8ffd0b6b327441aa828c9cd3243d.gif" align="absbottom"></div>
		<div class="signature" style="max-height:380px;maxHeight:380px; overflow:hidden;"><table width="100%"><tbody><tr><td>【crass游戏资源提取器,欢迎大家充当小白鼠测试－ω－】
<br>http://bbs.jgames.net/ForumDisplay-213387-0-1-1.html</td><td></td></tr></tbody></table></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2008-01-13 14:15 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 3楼(悠久扬笛) 的帖子');" data-mx-warn="Empty URL">3 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="1321233" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570938840-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>悠久扬笛</b>
<div style="margin:.3em 0 .4em .2em">晚期封包破解毒瘾综合病患者</div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=48269" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570938840-cda034108948fa8bcba292fef486a404.jpg" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_4"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空一年生下学期</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570938840-0e03c5ece6b57c19681c4186b2d07c62.gif"><br>

<span class="user-info2" id="showface_4">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">295</span><br>
学分: <span class="s2 f9">5 点</span><br>
澄空币: <span class="s3 f9">1490 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2006-04-23<br>
		最后登录:2008-01-22 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_1321233" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10877004&amp;pid=1321233&amp;article=4" onclick="return sendurl(this,4,event)" id="quote_1321233" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10877004&amp;pid=1321233&amp;article=4" id="modify_1321233" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=48269" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10877004&amp;pid=1321233" onclick="return sendurl(this,8)" id="report_1321233" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10877004&amp;uid=48269" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('1321233')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_1321233" class="fl">&nbsp;</h1>
			

			<div id="p_1321233" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_1321233">占楼55555555555555555555</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_1321233" class="c"></div>

		<div><img class="signature" src="assets/1570938840-f23b8ffd0b6b327441aa828c9cd3243d.gif" align="absbottom"></div>
		<div class="signature" style="max-height:380px;maxHeight:380px; overflow:hidden;"><table width="100%"><tbody><tr><td>【crass游戏资源提取器,欢迎大家充当小白鼠测试－ω－】
<br>http://bbs.jgames.net/ForumDisplay-213387-0-1-1.html</td><td></td></tr></tbody></table></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2008-01-13 14:15 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 4楼(悠久扬笛) 的帖子');" data-mx-warn="Empty URL">4 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="1321272" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570938840-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>dwing</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=98042" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570938840-bc3b3631a24154c2d9ba8189508a5212.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_5"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空二年生上学期</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570938840-3699e74cfe4e975552e8db25eb7cc233.gif"><br>

<span class="user-info2" id="showface_5">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">144</span><br>
学分: <span class="s2 f9">20 点</span><br>
澄空币: <span class="s3 f9">880 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2007-03-03<br>
		最后登录:2019-09-29 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_1321272" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10877004&amp;pid=1321272&amp;article=5" onclick="return sendurl(this,4,event)" id="quote_1321272" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10877004&amp;pid=1321272&amp;article=5" id="modify_1321272" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=98042" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10877004&amp;pid=1321272" onclick="return sendurl(this,8)" id="report_1321272" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10877004&amp;uid=98042" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('1321272')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_1321272" class="fl">&nbsp;</h1>
			

			<div id="p_1321272" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_1321272">不错,看到如此详细的文章.<br>用浮点指令解码的确实很少见,不过还是应该庆幸没遇到花指令或VM.<br><br>如果是我,可能就没耐心分析,直接copy这些可重入的运算函数代码了.<div id="alert_1321272" style="color: gray; margin-top: 30px; --darkreader-inline-color:#bfb9ac;" data-darkreader-inline-color="">[ 此贴被dwing在2008-01-13 15:36重新编辑 ]</div></div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_1321272" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2008-01-13 14:49 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 5楼(dwing) 的帖子');" data-mx-warn="Empty URL">5 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="1321395" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570938840-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>Lighting</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=35360" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570938840-44b4a7612809c73e5e0d14d0599bc7a3.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_6"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空二年生上学期</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570938840-3699e74cfe4e975552e8db25eb7cc233.gif"><br>

<span class="user-info2" id="showface_6">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">211</span><br>
学分: <span class="s2 f9">9 点</span><br>
澄空币: <span class="s3 f9">737 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2006-01-27<br>
		最后登录:2017-06-06 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_1321395" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10877004&amp;pid=1321395&amp;article=6" onclick="return sendurl(this,4,event)" id="quote_1321395" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10877004&amp;pid=1321395&amp;article=6" id="modify_1321395" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=35360" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10877004&amp;pid=1321395" onclick="return sendurl(this,8)" id="report_1321395" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10877004&amp;uid=35360" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('1321395')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_1321395" class="fl">&nbsp;</h1>
			

			<div id="p_1321395" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_1321395"><img src="assets/1570938840-8c36eb6a7ca4d36c145d570f3aae115d.gif"> 同楼上的……直接COPY下来内联算了………………………………= v&nbsp; =<br><br>~~我们是懒人~~</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_1321395" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2008-01-13 16:25 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 6楼(Lighting) 的帖子');" data-mx-warn="Empty URL">6 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="1322649" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570938840-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>joyful</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=87224" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570938840-bc3b3631a24154c2d9ba8189508a5212.gif" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_7"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空一年生上学期</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570938840-f43195cd588caa26c296fcc61910b3e6.gif"><br>

<span class="user-info2" id="showface_7">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">121</span><br>
学分: <span class="s2 f9">0 点</span><br>
澄空币: <span class="s3 f9">1120 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2007-01-26<br>
		最后登录:2013-02-25 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_1322649" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10877004&amp;pid=1322649&amp;article=7" onclick="return sendurl(this,4,event)" id="quote_1322649" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10877004&amp;pid=1322649&amp;article=7" id="modify_1322649" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=87224" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10877004&amp;pid=1322649" onclick="return sendurl(this,8)" id="report_1322649" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10877004&amp;uid=87224" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('1322649')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_1322649" class="fl">&nbsp;</h1>
			

			<div id="p_1322649" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_1322649">啊啊啊啊啊，终于让我等到了！！！<br>早就希望有人能写出一篇这样的破解文章来指导了，汉公大大你真是太好了～～ <img src="assets/1570938840-ca6ac492963a92579e253737c292a7c4.gif"> <br>抱走了回去慢慢研究，期待汉公大大接下来的教程～～</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_1322649" class="c"></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2008-01-14 16:14 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 7楼(joyful) 的帖子');" data-mx-warn="Empty URL">7 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

<a name="a" data-mx-warn="Empty URL"></a><a name="1323441" data-mx-warn="Empty URL"></a>
<div class="t t2"><table cellspacing="0" cellpadding="0" width="100%" style="table-layout: fixed; border-top: 0px; --darkreader-inline-border-top: initial;" data-darkreader-inline-border-top="">
	<tbody><tr class="tr1"><th style="width:20%" rowspan="2" class="r_two">

		<img src="assets/1570938840-1cde2ccde0fc90dbe6db3784fc6ec383.gif" title="该用户目前不在线" align="absmiddle">

<b>John_He</b>
<div style="margin:.3em 0 .4em .2em"></div>
<div class="user-pic"><table style="border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left=""><tbody><tr><td width="1">

<a href="https://bbs.sumisora.net/profile.php?action=show&amp;uid=13960" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img class="pic" src="assets/1570938840-0f2e4f5011b2d25a89df900614e2781f.jpg" style="max-width:185px;max-height:200px;overflow:hidden" border="0"></a>

</td><td style="vertical-align:top"><span id="sf_8"></span></td></tr></tbody></table>
</div>
		级别: <font color="#555555" data-darkreader-inline-color="" style="--darkreader-inline-color:#cfc9be;">澄空一年生下学期</font><br>
		<img style="margin:.2em 0 .6em" src="assets/1570938840-0e03c5ece6b57c19681c4186b2d07c62.gif"><br>

<span class="user-info2" id="showface_8">
<span class="user-infoWrap2">


精华:

		<span class="s4">0</span>
<br>
发帖: <span class="s1 f9">190</span><br>
学分: <span class="s2 f9">5 点</span><br>
澄空币: <span class="s3 f9">893 KID</span><br>

		GPA: <span class="s2 f9">0 点</span><br>

		<span class="gray">注册时间:2005-07-12<br>
		最后登录:2016-02-24 <br><br> 
		</span>
		</span></span>
		</th>
		<th height="100%" class="r_one" valign="top" id="td_1323441" style="padding: 5px 15px 0px; border: 0px; width: 80%; overflow: hidden; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<div class="tiptop">
			<span class="fl" style="white-space:nowrap;">
			<a href="https://bbs.sumisora.net/post.php?action=quote&amp;fid=78&amp;tid=10877004&amp;pid=1323441&amp;article=8" onclick="return sendurl(this,4,event)" id="quote_1323441" title="引用回复这个帖子" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">引用</a> <a href="https://bbs.sumisora.net/post.php?action=modify&amp;fid=78&amp;tid=10877004&amp;pid=1323441&amp;article=8" id="modify_1323441" onclick="return sendurl(this,4,event)" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">编辑</a>
			<a href="https://bbs.sumisora.net/message.php?action=write&amp;touid=13960" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">短信</a>

			<a href="https://bbs.sumisora.net/operate.php?action=report&amp;tid=10877004&amp;pid=1323441" onclick="return sendurl(this,8)" id="report_1323441" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">举报</a>

			<a href="https://bbs.sumisora.net/read.php?tid=10877004&amp;uid=13960" title="只看该作者的所有回复" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">只看</a>

			<a style="cursor:pointer;" onclick="copyUrl('1323441')" title="此楼地址" data-mx-warn="Empty URL">锚点</a>
			</span>

			<div class="c"></div>
			</div>
			<h1 id="subject_1323441" class="fl">&nbsp;</h1>
			

			<div id="p_1323441" class="c"></div>

<!--
-->

			<div class="tpc_content" id="read_1323441">感谢一个，非常有参考价值的说……<br><br>俺也是十分讨厌内联汇编的，用栈变量的时候不可以破坏EBP，比较麻烦……<br><br>另：不知道有没有内建字库或者二进制脚本的分析……</div>
		</th>
	</tr>
	<tr class="tr1 r_one">
		<th style="vertical-align: bottom; padding-left: 15px; border: 0px; --darkreader-inline-border-top: initial; --darkreader-inline-border-right: initial; --darkreader-inline-border-bottom: initial; --darkreader-inline-border-left: initial;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">

		<div id="w_1323441" class="c"></div>

		<div><img class="signature" src="assets/1570938840-f23b8ffd0b6b327441aa828c9cd3243d.gif" align="absbottom"></div>
		<div class="signature" style="max-height:380px;maxHeight:380px; overflow:hidden;"><table width="100%"><tbody><tr><td>俺的blog装修了……<br><a href="http://blog.163.com/john_he_" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">http://blog.163.com/john_he_</a></td><td></td></tr></tbody></table></div>

		<div class="tipad"><span style="float:right">
<a href="javascript:scroll(0,0)" title="顶端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">顶端</a> <a href="javascript:scroll(0,999999)" title="底端" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">底端</a></span>
			
			<span class="gray"> 2008-01-15 00:38 | 
	
			</span>

			<span><a class="s3" title="回复此楼" style="cursor:pointer;" onclick="postreply('回 8楼(John_He) 的帖子');" data-mx-warn="Empty URL">8 楼</a></span>

		</div></th>
	</tr></tbody></table>
</div>

</form>
<div class="t3" style="margin:initial"><table cellspacing="0" cellpadding="0" width="100%" align="center">
	<tbody><tr><td align="left"></td>
		<td valign="center" align="right">
		<a class="abtn f_two" id="readlog" onclick="sendmsg('pw_ajax.php?action=readlog','',this.id);" data-mx-warn="Empty URL">帖子浏览记录<img src="assets/1570938840-5c8e409588b73ce4284cf5b9bd619e15.gif"></a>
		<select onchange="Fjump(this.options[this.selectedIndex].value)"><option value="" selected="">快速跳至</option>
<option value="1">&gt;&gt; 『澄空学园 办公楼区』</option>
<option value="2"> &nbsp;|- 【校园公告栏】</option>
<option value="5"> &nbsp;|- 【论坛意见箱】</option>
<option value="113">&gt;&gt; 『澄空学园 资讯社』</option>
<option value="47"> &nbsp;|- 【新鲜速报】</option>
<option value="103"> &nbsp;|- 【新作介绍】</option>
<option value="8"> &nbsp; &nbsp;|-  【电子杂志下载区】</option>
<option value="104"> &nbsp;|- 【杂志专题】</option>
<option value="7">&gt;&gt; 『澄空学园 教学楼区』</option>
<option value="62"> &nbsp;|- 【AGE主题学部】</option>
<option value="39"> &nbsp;|- 【Akabeesoft2主题学部】</option>
<option value="100"> &nbsp;|- 【AUGUST主题学部】</option>
<option value="42"> &nbsp;|- 【CIRCUS主题学部】</option>
<option value="40"> &nbsp;|- 【Cotton-Nekoneko主题学部】</option>
<option value="64"> &nbsp;|- 【GIGA主题学部】</option>
<option value="38"> &nbsp;|- 【Key主题学部】</option>
<option value="10"> &nbsp;|- 【KID主题学部】</option>
<option value="37"> &nbsp;|- 【Leaf主题学部】</option>
<option value="70"> &nbsp;|- 【minori主题学部】</option>
<option value="12"> &nbsp;|- 【Navel主题学部】</option>
<option value="65"> &nbsp;|- 【Nitro+主题学部】</option>
<option value="14"> &nbsp;|- 【Type-Moon应援会】</option>
<option value="17"> &nbsp; &nbsp;|-  【TM精华区】</option>
<option value="98"> &nbsp;|- 【Will主题学部】</option>
<option value="116"> &nbsp;|- 【FAVORITE主题学部】</option>
<option value="108"> &nbsp;|- 【ALcot主题学部】</option>
<option value="55"> &nbsp;|- 【GALGAME综合作品讨论室】</option>
<option value="97"> &nbsp; &nbsp;|-  【Light主题学部】</option>
<option value="117"> &nbsp; &nbsp;|-  【CUFFS主题学部】</option>
<option value="15"> &nbsp; &nbsp;|-  【Liar Soft主题学部】</option>
<option value="57"> &nbsp; &nbsp;|-  【Purple 主题学部】</option>
<option value="13"> &nbsp; &nbsp;|-  【工画堂主题学部】</option>
<option value="35"> &nbsp;|- 【GALGAME综合杂谈室】</option>
<option value="99"> &nbsp;|- 【ぱれっと主题学部】</option>
<option value="122"> &nbsp;|- 【SAGA PLANETS研讨室】</option>
<option value="123"> &nbsp;|- 【Lump of Sugar 研讨室】</option>
<option value="86">&gt;&gt; 『澄空学园 图书馆』</option>
<option value="80"> &nbsp;|- 【游戏鉴赏室】</option>
<option value="56"> &nbsp;|- 【GALGAME攻略馆】</option>
<option value="115"> &nbsp;|- 【作品出处问询室】</option>
<option value="63"> &nbsp;|- 【Galgame疑问求助室】</option>
<option value="18">&gt;&gt; 『澄空学园 教辅楼区』</option>
<option value="73"> &nbsp;|- 【同人游戏区】</option>
<option value="60"> &nbsp;|- 【二次元轻小说社】</option>
<option value="20"> &nbsp;|- 【日语自学教室】</option>
<option value="61"> &nbsp; &nbsp;|-  【日语学习资料区】</option>
<option value="118"> &nbsp; &nbsp;|-  【日语参考文章区】</option>
<option value="21"> &nbsp;|- 【一般游戏社团】</option>
<option value="24"> &nbsp;|- 【多媒体课堂】</option>
<option value="88">&gt;&gt; 『澄空学园 原创综合区』</option>
<option value="79"> &nbsp;|- 【原创游戏部】</option>
<option value="36"> &nbsp; &nbsp;|-  【ss-square】</option>
<option value="89"> &nbsp;|- 【MAD研究室】</option>
<option value="91"> &nbsp;|- 【莉可屋 REC ROOM】</option>
<option value="119"> &nbsp; &nbsp;|-  【澄空百合社翻唱作品】</option>
<option value="19"> &nbsp;|- 【澄空文学部】</option>
<option value="120"> &nbsp; &nbsp;|-  【落日余晖】</option>
<option value="23"> &nbsp;|- 【绘画工房】</option>
<option value="69"> &nbsp;|- 【活动投票区】</option>
<option value="74"> &nbsp;|- 【友谊赛投票区】</option>
<option value="58"> &nbsp;|- 【澄空部活室】</option>
<option value="41"> &nbsp;|- 【暑假原创作品活动专区】</option>
<option value="59"> &nbsp;|- 【实物周边交流区】</option>
<option value="85"> &nbsp; &nbsp;|-  【ComicMarket相关资料】</option>
<option value="82"> &nbsp; &nbsp;|-  【新品介绍】</option>
<option value="84"> &nbsp; &nbsp;|-  【综合交流】</option>
<option value="83"> &nbsp; &nbsp;|-  【好物收集】</option>
<option value="81"> &nbsp; &nbsp;|-  【交易求购】</option>
<option value="95"> &nbsp;|- 【澄空放送部】</option>
<option value="111"> &nbsp; &nbsp;|-  【放送策划室】</option>
<option value="27"> &nbsp;|- 【水下乐园LeMU】</option>
<option value="46"> &nbsp; &nbsp;|-  【美工作品收藏室】</option>
<option value="26"> &nbsp; &nbsp;|-  【COS自爆馆】</option>
<option value="90"> &nbsp; &nbsp;|-  【澄空期刊室】</option>
<option value="71"> &nbsp;|- 【澄空演剧部】</option>
<option value="9"> &nbsp; &nbsp;|-  演剧部排练室</option>
<option value="52"> &nbsp;|- 【废帖回收站】</option>
<option value="29">&gt;&gt; 『澄空学园 好物交流站』</option>
<option value="50"> &nbsp;|- 【澄空学园字幕作品】</option>
<option value="51"> &nbsp;|- 【澄空学园漫画作品】</option>
<option value="77"> &nbsp;|- 【游戏汉化交流区】</option>
<option value="28"> &nbsp; &nbsp;|-  【CK-GAL中文化小组】</option>
<option value="106"> &nbsp; &nbsp;|-  【PRO2】</option>
<option value="49"> &nbsp; &nbsp;|-      【桜】</option>
<option value="30"> &nbsp;|- 【资源求助区】</option>
<option value="32"> &nbsp;|- 【澄空音乐厅】</option>
<option value="33"> &nbsp;|- 【澄空美术馆】</option>
<option value="34"> &nbsp;|- 【动漫租售屋】</option>
<option value="44">&gt;&gt; 『澄空学园 课余工作区』</option>
<option value="45"> &nbsp;|- 【澄空漫画汉化组】</option>
<option value="48"> &nbsp;|-  【澄空学园字幕组】</option>
<option value="101"> &nbsp; &nbsp;|-  字幕组资料区</option>
<option value="72"> &nbsp;|- 【澄空学园分流组】</option>
<option value="87"> &nbsp;|- 【澄空学园新闻组】</option>
<option value="96"> &nbsp;|- 【澄空学园文学社】</option>
<option value="75"> &nbsp;|- 【澄空学园百合社】</option>
<option value="112"> &nbsp;|- 【澄空学园编辑部】</option>
<option value="114"> &nbsp;|- 【澄空学园美工部】</option>
<option value="121"> &nbsp;|-  【澄空祭运行委员会】</option>
</select></td>
		
	</tr>
	<tr><td style="padding-top: 12px;text-align: left;"><img src="assets/1570938840-ca4a91079181c2a5cb3514b2e5b5f035.gif" align="absbottom"> <b><a href="https://bbs.sumisora.net/index.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">『澄空学园』</a> » <a href="https://bbs.sumisora.net/thread.php?fid=78&amp;page=12" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">【汉化破解研讨室】</a></b> </td>
	<td style="padding-top: 12px;text-align: right;"><a href="https://bbs.sumisora.net/post.php?action=reply&amp;fid=78&amp;tid=10877004" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img src="assets/1570938840-132cb83b134d7ecd9b390389d489bc43.png"></a>

<a href="https://bbs.sumisora.net/post.php?fid=78" style="margin-left:.5em" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><img src="assets/1570938840-8cab7ee31ae503cf78e5410d40cec291.png" id="td_post1"></a>
</td>
	</tr>
</tbody></table></div>




<form name="FORM" method="post" action="post.php?" enctype="multipart/form-data" onsubmit="return checkpost(document.FORM);">
<div class="t" style="margin-top:8px"><table cellspacing="0" cellpadding="0" align="center" width="100%">
	<tbody><tr>
		<td class="h" colspan="3"><b>快速发帖</b></td>
	</tr>
	<tr></tr>
	<tr class="tr2"><td colspan="100" style="border-bottom: 0px; --darkreader-inline-border-bottom: initial;" data-darkreader-inline-border-bottom=""></td></tr>
	<tr>
		<td valign="top" width="20%" class="f_one" style="padding:7px">
		<fieldset id="smiliebox" style="border: 1px solid rgb(213, 229, 232); --darkreader-inline-border-top:#354e51; --darkreader-inline-border-right:#354e51; --darkreader-inline-border-bottom:#354e51; --darkreader-inline-border-left:#354e51;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
		<legend>内容</legend>
		<br>
		<input type="checkbox" name="atc_usesign" value="1" checked="">使用签名<br>
		<input type="checkbox" name="atc_convert" value="1" checked="">Wind Code自动转换 <br>
	 	<input type="checkbox" id="atc_autoimg" name="atc_autoimg" value="1" onchange="onAutoImgchange()" checked="" title="此设置会记在浏览器中"><label for="atc_autoimg" title="此设置会记在浏览器中">自动分析img</label><br><br>
	 	
		<input type="checkbox" name="atc_requiresell" value="1" disabled="">出售此帖
		<input class="input" type="text" maxlength="3" size="3" name="atc_money" value="0">
		<br>
		<input type="checkbox" name="atc_requirervrc" value="1">加密此帖
		<input class="input" type="text" maxlength="6" size="3" name="atc_rvrc" value="0">
		<br>
		<br><br><a href="https://bbs.sumisora.net/read.php?tid=10925672" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">如何在帖子中贴图？</a>
		<br><a href="https://bbs.sumisora.net/read.php?tid=10942243" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Wind Code使用教程</a>
		<br><a href="https://bbs.sumisora.net/yume/recover/" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">恢复帖子内容</a>
		</fieldset>
		</td>
		<td width="60%" class="f_one" style="padding:7px">
		<div>


<blockquote style="width: 96%;" class="blockquote">澄空娘：『如果遇到论坛打不开，不要按F5或者刷新按钮，点击地址栏然后按回车可以更快刷开论坛
』</blockquote>

		<input type="text" class="input" name="atc_title" value="Re:椎名里緒系统破解记录" size="65">
		

		 认证码: <input class="input" type="text" name="gdcode" size="5" tabindex="6" onfocus="try{opencode('menu_gd',this)}catch(e){}"><br>
		

		</div><div style="padding:.3em 0">
		</div>
		<textarea onkeydown="quickpost(event)" id="atc_content" name="atc_content" rows="8" style="width:96%"></textarea>
		
		
		
		
		
		<div style="margin:5px 0">
		<div style="padding: 4px 10px 0px 0px; float: left; color: rgb(136, 136, 136); --darkreader-inline-color:#bfb9ac;" data-darkreader-inline-color="">按 Ctrl+Enter 直接提交</div>
		<input class="btn" type="submit" name="Submit" value=" 提 交 "></div>
		</td>
		<td width="20%" class="f_one">
		<div style="padding:3px; text-align:center; width:200px;">
		<fieldset id="smiliebox" style="border: 1px solid rgb(213, 229, 232); --darkreader-inline-border-top:#354e51; --darkreader-inline-border-right:#354e51; --darkreader-inline-border-bottom:#354e51; --darkreader-inline-border-left:#354e51;" data-darkreader-inline-border-top="" data-darkreader-inline-border-right="" data-darkreader-inline-border-bottom="" data-darkreader-inline-border-left="">
			<legend>表情</legend>
			<div id="menu_show"></div>
<span style="float:right; margin:3px 10px 5px;"><a id="td_face" style="cursor:pointer;" onclick="showDefault();" align="absmiddle" unselectable="on" data-mx-warn="Empty URL">[更多]</a></span>
<span style="float:left; margin:3px 10px 5px;"><a id="td_generalface" style="cursor:pointer;" onclick="showfaces();$('#td_generalface').fadeOut();" align="absmiddle" data-mx-warn="Empty URL">[显示表情]</a></span>
		</fieldset></div>
		
		
		</td>
	</tr>
</tbody></table></div></form>







</div>
<div id="bottom"></div><br>
<center class="gray">
<small><span id="windspend">Total 0.068585(s) query 6, Time is now 10-13 11:43, 
Load is low.
</span> <br>
Powered by <a href="http://www.phpwind.net/" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><b>PHPWind</b></a> <a href="http://www.phpwind.net/" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><b style="color: rgb(255, 153, 0); --darkreader-inline-color:#f7b24b;" data-darkreader-inline-color="">v6.3.2</b></a> Code © 2003-08 <a href="http://www.phpwind.com/" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer"><b>PHPWind.com</b></a> Corporation</small>
</center><br>
<div id="footer">
	<span class="f12 fl"></span><a href="https://bbs.sumisora.net/sendmail.php" target="_blank" referrerpolicy="no-referrer" rel="noopener noreferrer">Contact us</a>

</div>
</div>
        
      </div>
    </body>
  </html>